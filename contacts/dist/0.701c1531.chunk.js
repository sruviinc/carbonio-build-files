"use strict";(self.webpackChunkcarbonio_contacts_ui=self.webpackChunkcarbonio_contacts_ui||[]).push([[0],{9310:(e,t,a)=>{a.d(t,{H:()=>p});var l=a(7559),n=a.n(l),o=a(4702),r=a(2509),i=a(4710),c=a.n(i),s=a(8136);const m=c()(o.Avatar).withConfig({displayName:"contact-compact-view__AvatarMobile",componentId:"sc-1g02no7-0"})(["position:relative;top:0.9375rem;"]),d=c()(o.Row).withConfig({displayName:"contact-compact-view__AvatarHeader",componentId:"sc-1g02no7-1"})(["background:linear-gradient( to right,",","," );"],(({theme:e,bg:t})=>e.avatarColors[t]),(({theme:e,bg2:t})=>e.avatarColors[t]));function u(e){let t=0;for(let a=0;a<e.length;a++)t+=e.charCodeAt(a);return"avatar_"+(t%50+1)}const p=({contact:e,toggleOpen:t,open:a})=>{const i=(0,s.n)(e),c=(0,l.useMemo)((()=>(0,r.trim)(`${Object.values(e.email).length>0?Object.values(e.email)[0].mail:""}, ${Object.values(e.phone).length>0?Object.values(e.phone)[0].number:""}`,", ")),[e.email,e.phone]);return n().createElement(n().Fragment,null,n().createElement(o.Responsive,{mode:"desktop",target:window.top},n().createElement(o.Drag,{style:{width:"100%"}},n().createElement(o.Row,{width:"fill",height:"fit",mainAlignment:"flex-start"},n().createElement(o.Avatar,{label:`${e.firstName} ${e.lastName}`,picture:e.image,size:"large",fallbackIcon:"PeopleOutline"}),n().createElement(o.Row,{orientation:"vertical",takeAvailableSpace:!0,mainAlignment:"center",crossAlignment:"flex-start",padding:{horizontal:"large",vertical:"small"},height:"fill"},n().createElement(o.Text,{size:"medium",weight:"bold"},i),n().createElement(o.Text,{size:"small",weight:"bold",color:"secondary"},(0,r.trim)(`${e?.jobTitle&&`${e.jobTitle}, `} ${(e?.department??"")&&`${e.department}, `} ${(e?.company??"")&&`${e.company}, `}`,", ")),n().createElement(o.Text,{size:"small",color:"secondary"},c)),t&&n().createElement(o.IconButton,{size:"medium",onClick:t,icon:a?"ArrowIosUpward":"ArrowIosDownward"})))),n().createElement(o.Responsive,{mode:"mobile",target:window.top},n().createElement(o.Row,{padding:{vertical:"large"},width:"90vw",height:"fit",mainAlignment:"flex-start"},n().createElement(d,{takeAvailableSpace:!0,height:"fit",bg:u(`${e.firstName} ${e.lastName}`),bg2:u(`${e.firstName}${e.lastName}`)},n().createElement(m,{label:`${e.firstName} ${e.lastName}`,picture:e.image,size:"large",fallbackIcon:"EmailOutline"}))),n().createElement(o.Row,{padding:{vertical:"extralarge"},width:"fill",height:"fit",mainAlignment:"flex-start"},n().createElement(o.Row,{orientation:"vertical",takeAvailableSpace:!0,mainAlignment:"center",crossAlignment:"flex-start",padding:{horizontal:"large",vertical:"small"},height:"fill"},n().createElement(o.Text,{size:"large",weight:"bold"},i),n().createElement(o.Text,{weight:"bold",color:"secondary"},(0,r.trim)(`${e.jobTitle&&`${e.jobTitle}, `} ${e.department&&`${e.department}, `} ${e.company&&`${e.company}, `}`,", ")),n().createElement(o.Text,{color:"secondary"},c))),t&&n().createElement(o.Button,{label:a?"Show Less Information":"Show More Information",backgroundColor:a?"secondary":"primary",onClick:t,width:"fill"})))}},8136:(e,t,a)=>{a.d(t,{M:()=>i,n:()=>c});var l=a(7559),n=a(4577),o=a(2509),r=a(8153);const i=e=>{if((e.firstName||e.middleName||e.lastName)&&!e.displayName)return(0,o.trim)(`${e.firstName||""} ${e.middleName||""} ${e.lastName||""} ${e.nameSuffix||""}`);if(e.displayName)return e.displayName;const t=Object.keys(e.email);return e.email&&t.length>0?`<${(0,n.t)("label.no_name","No Name")}> ${e.email[t[0]].mail}`:void 0},c=e=>{const[t]=(0,r.useTranslation)();return(0,l.useMemo)((()=>{if(e){const a=i(e);if(a)return a;if(e.email&&Object.keys(e.email).length>0)return`<${t("label.no_name","No Name")}> ${e.email[0].mail}`}return`<${t("label.no_data","No Data")}>`}),[e,t])}},3201:(e,t,a)=>{a.d(t,{$0:()=>r,Do:()=>o,oK:()=>n});var l=a(2509);function n({contacts:e},t){return e?.contacts?.[t]}function o({contacts:e},t,a){return(0,l.find)(e?.contacts?.[t],["id",a])}function r({contacts:e},t){return e?.status?.[t]}},6e3:(e,t,a)=>{a.d(t,{A:()=>q});var l=a(7559),n=a.n(l),o=a(4702),r=a(4577),i=a(2509),c=a(8153),s=a(7760),m=a(8698),d=a(4710),u=a.n(d);const p={setEmptyContact:"newContact",setExistingContact:"existingContact",setInput:"setInput",setRowInput:"addField",setSelect:"setSelect"};function b(e,t){switch(t.type){case p.setEmptyContact:return{parent:"7",address:{},email:{},phone:{},URL:{},jobTitle:"",department:"",namePrefix:"",company:"",firstName:"",middleName:"",nickName:"",lastName:"",nameSuffix:"",image:"",notes:""};case p.setExistingContact:return{...e,...t.payload.existingContact};case p.setSelect:return"address"===t.payload.ev.name?{...e,[t.payload.ev.name]:{...e[t.payload.ev.name],[t.payload.id]:{...e[t.payload.ev.name][t.payload.id],[t.payload.subField]:t.payload.ev.value}}}:{...e,[t.payload.ev.name]:{...e[t.payload.ev.name],[t.payload.id]:{[t.payload.subField]:t.payload.ev.value}}};case p.setRowInput:return{...e,[t.name]:t.payload};case p.setInput:return{...e,[t.payload.name]:t.payload.value};default:return e}}const f=(0,l.createContext)(0),g=n().forwardRef((function({background:e,label:t,children:a},r){const i=(0,l.useContext)(f);return n().createElement(o.Container,{ref:r,background:e,orientation:"vertical",width:"fill",height:"fit",crossAlignment:"flex-start",padding:{vertical:"large",horizontal:"small"}},n().createElement(o.Text,{size:"large",weight:i>0?"regular":"medium",overflow:"break-word"},t),n().createElement(f.Provider,{value:i+1},a))})),h=({children:e,wrap:t})=>n().createElement(o.Row,{orientation:"horizontal",mainAlignment:"space-between",crossAlignment:"flex-start",width:"fill",wrap:t||"nowrap"},e),y=({name:e,label:t,types:a,typeField:r,typeLabel:c,subFields:s,fieldLabels:m,wrap:d,value:u,dispatch:b})=>{const f=(0,l.useMemo)((()=>(0,i.reduce)(a,((e,t)=>({...e,[t.value]:(0,i.filter)(u,(e=>e[c]===t.value)).length})),{})),[u,c,a]),y=(0,l.useMemo)((()=>(0,i.reduce)(s,((e,t)=>(0,i.set)(e,t,"")),r?{[r]:a[0].value}:{})),[s,r,a]),w=(0,l.useCallback)((t=>{const a=`${t}${l=e,l.replace(/^\w/,(e=>e.toUpperCase()))}`;var l;const n=(e,t)=>u[e]?n(`${a}${t}`,t+1):e;return n(`${a}${f[t]>0?f[t]+1:""}`,2)}),[u,e,f]),v=(0,l.useCallback)((()=>{const t=(a,l)=>u[a]||"email1"===a?t(`${e}${l}`,l+1):a;return t(u[e]?e+2:e,1)}),[u,e]),E=(0,l.useCallback)((()=>{b({type:p.setRowInput,payload:{...u,[a&&a[0].value?w(a[0].value):v()]:y},name:e})}),[b,y,w,v,e,a,u]),C=(0,l.useCallback)((t=>{const a={...u},l=a[t],n={isRemove:"true"};Object.keys(l).forEach((e=>{"type"===e?n.type=l.type:n[e]=""})),a[t]=n,b({type:p.setRowInput,payload:a,name:e})}),[b,e,u]),k=(0,l.useCallback)(((t,a,l)=>{t!==u[l][a]&&b(a===r?{type:p.setRowInput,payload:{...(0,i.omit)(u,[l]),[w(t)]:{...u[l],type:t}},name:e}:{type:p.setRowInput,payload:{...u,[l]:{...u[l],[a]:t}},name:e})}),[u,e,w,b,r]);(0,l.useEffect)((()=>{(0===Object.values(u).length||(e=>{let t=0;return Object.keys(e).forEach((a=>{e[a].isRemove||(t+=1)})),0===t})(u))&&E()}),[E,u]);const N=(0,i.omitBy)(u,(e=>e.isRemove));return n().createElement(g,{label:t},(0,i.map)(Object.entries(N),(([l,f],g)=>n().createElement(h,{wrap:d?"wrap":"nowrap",key:`${t}${l}`},(0,i.map)(s,((t,a)=>n().createElement(o.Padding,{right:"small",top:"small",key:`${m[a]}${l}`,style:{width:d?"32%":"100%",flexGrow:1}},n().createElement(o.Input,{inputName:e,label:m[a],defaultValue:f[t],onChange:e=>b({type:p.setSelect,payload:{ev:e.target,id:l,subField:t}}),style:{border:"1px solid lightgray"},backgroundColor:"white"})))),n().createElement(o.Container,{style:{flexGrow:1,minWidth:r?"12.5rem":"6.5rem"},width:r?"calc(32% + 0.5rem)":"6.5rem",orientation:"horizontal",mainAlignment:"space-between",crossAlignment:"flex-start",padding:{top:"small",right:"small"}},n().createElement(o.Padding,{right:"small",style:{width:"calc(100% - 5.5rem)"}},r&&c&&a&&a.length>0&&n().createElement(o.Select,{style:{border:"1px solid lightgray"},backgroundColor:"white",items:a,label:c,onChange:e=>k(e,r,l),defaultSelection:(0,i.find)(a,["value",u[l][r]])})),n().createElement(o.Container,{orientation:"horizontal",mainAlignment:"flex-end",height:"fit",width:"5.5rem",style:{minWidth:"5.5rem"}},g>=Object.entries(N).length-1?n().createElement(n().Fragment,null,n().createElement(o.Padding,{right:"small"},n().createElement(o.IconButton,{icon:"Plus",customSize:{iconSize:"medium",paddingSize:"medium"},iconColor:"gray6",backgroundColor:"primary",onClick:()=>E()})),n().createElement(o.IconButton,{icon:"Minus",iconColor:"gray6",customSize:{iconSize:"medium",paddingSize:"medium"},backgroundColor:"secondary",onClick:()=>C(l)})):n().createElement(o.IconButton,{icon:"Minus",iconColor:"gray6",backgroundColor:"secondary",onClick:()=>C(l)})))))))};var w=a(6317);const v=u().div.withConfig({displayName:"select-label-factory__Square",componentId:"sc-1u4yqsc-0"})(["width:1rem;height:1rem;background:",";border-radius:0.25rem;opacity:",";"],(({color:e})=>e),(({disabled:e})=>e?.5:1)),E=u()(o.Container).withConfig({displayName:"select-label-factory__ColorContainer",componentId:"sc-1u4yqsc-1"})(["border-bottom:0.0625rem solid ",";transition:background 0.2s ease-out;&:hover{background:",";}"],(({theme:e})=>e.palette.gray2.regular),(({theme:e,background:t})=>(0,o.getColor)(`${t}.hover`,e))),C=u()(o.Text).withConfig({displayName:"select-label-factory__TextUpperCase",componentId:"sc-1u4yqsc-2"})(["text-transform:capitalize;color:",";"],(({theme:e,disabled:t})=>t?e.palette.text.disabled:e.palette.text.regular)),k=u()(o.Text).withConfig({displayName:"select-label-factory__LabelText",componentId:"sc-1u4yqsc-3"})(["color:","};"],(({theme:e,disabled:t,$showPrimary:a})=>t?e.palette.text.disabled:a?e.palette.primary.regular:e.palette.secondary.regular)),N=u()(o.Icon).withConfig({displayName:"select-label-factory__StyledIcon",componentId:"sc-1u4yqsc-4"})(["color:","};"],(({theme:e,disabled:t,$showPrimary:a})=>t?e.palette.text.disabled:a?e.palette.primary.regular:e.palette.secondary.regular)),x=({selected:e,label:t,open:a,focus:l,disabled:r})=>n().createElement(E,{orientation:"horizontal",width:"fill",crossAlignment:"center",mainAlignment:"space-between",borderRadius:"half",padding:{all:"small"},background:"gray5",style:{cursor:r?"no-drop":"pointer"}},n().createElement(o.Row,{width:"100%",takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Row,{orientation:"vertical",crossAlignment:"flex-start",mainAlignment:"flex-start",padding:{left:"small"}},n().createElement(k,{size:"small",disabled:r,$showPrimary:a||l},t),n().createElement(o.Row,null,n().createElement(o.Padding,{right:"small"},n().createElement(v,{color:e[0].color,disabled:r})),n().createElement(C,{disabled:r},e[0].label)))),n().createElement(N,{size:"large",icon:a?"ChevronUpOutline":"ChevronDownOutline",disabled:r,$showPrimary:a||l,style:{alignSelf:"center"}}));var $=a(5302);const S=({folder:e})=>{const t=(0,$.e0)(e.value??"");return n().createElement(n().Fragment,null,n().createElement(o.Row,{wrap:"nowrap"},n().createElement(o.Padding,{right:"small"},n().createElement(v,{color:e.color})),n().createElement(w.qN,null,e.label),n().createElement(o.Row,{takeAvailableSpace:!0},t&&t.id!==r.FOLDERS.USER_ROOT&&n().createElement(o.Padding,{left:"small",style:{overflow:"hidden"}},n().createElement(w.qN,{color:"gray1"},`(${t.name})`)))))},R=({defaultFolderId:e,onChange:t,label:a,folderItems:r,disabled:c})=>{const s=(0,l.useMemo)((()=>(0,i.map)(r,(e=>({label:e.label,value:e.value,color:e.color,customComponent:n().createElement(S,{folder:e})})))),[r]),m=(0,l.useMemo)((()=>{const t=(0,i.find)(s,["value",e]),a={value:t?.value??s?.[0]?.value,label:t?.label??s?.[0]?.label,color:t?.color??s?.[0]?.color};return(0,i.find)(s,["value",e])??a}),[s,e]),d=(0,l.useCallback)((e=>t(e)),[t]);return s&&m?n().createElement(o.Select,{label:a,onChange:d,items:s,defaultSelection:m,disablePortal:!0,disabled:c,LabelFactory:x}):null};var A=a(2816),I=a(9310),_=a(7848),T=a(586),O=a(5428),F=a(3201),z=a(7134),P=a(2710);const j=u()(o.Text).withConfig({displayName:"edit-view__ItalicText",componentId:"sc-q3zoka-0"})(["font-style:italic;color:",";padding-right:0.5rem;"],(({theme:e})=>e.palette.gray1.regular)),L=e=>(0,i.reduce)(e,((e,t,a)=>(0,i.filter)(t,((e,t)=>"name"!==t&&"type"!==t&&""!==e)).length>0?{...e,[a]:t}:e),{}),M=e=>({...e,address:L(e.address),email:L(e.email),phone:L(e.phone),URL:L(e.URL)}),D=({name:e,label:t,value:a,dispatch:l,autoFocus:r=!1})=>n().createElement(o.Container,{padding:{all:"small"}},n().createElement(o.Input,{backgroundColor:"white",inputName:e,label:t,defaultValue:a,onChange:e=>l({type:p.setInput,payload:e.target}),autoFocus:r,style:{border:"1px solid lightgray"}}));function q({panel:e,onClose:t,onTitleChanged:a}){const{folderId:d,editId:u}=(0,m.useParams)(),f=(0,s.useDispatch)(),g=(0,_.G)((e=>(0,F.Do)(e,d,u))),[w,v]=(0,l.useReducer)(b),[E,C]=(0,l.useState)(g),[k,N]=(0,l.useState)(r.FOLDERS.CONTACTS),x=Object.keys(g??{}),[S]=(0,c.useTranslation)(),L=(0,o.useSnackbar)();(0,l.useEffect)((()=>{!E&&x?.length>0&&C(g);let t=!0;return u&&"new"!==u&&g&&t&&v({type:p.setExistingContact,payload:{existingContact:g}}),u&&"new"===u&&t&&v({type:p.setEmptyContact,payload:{}}),e||t&&v({type:p.setEmptyContact,payload:{}}),()=>{t=!1}}),[E,u,g,x?.length,e]);const q=(0,l.useMemo)((()=>{if(!w)return{};const e=M(w);return(0,P.t)(E,e)}),[E,w]),U=(0,$.Fi)(),B=(0,l.useMemo)((()=>{const e=(0,i.find)(U,["id",k]);return(0,z.k0)(S,k,e.name)}),[U,k,S]),H=(0,l.useMemo)((()=>(0,i.filter)(U,(e=>!(0,A.vF)(e.id)&&!(0,A.jX)(e.id)&&!(0,A.bc)(e.id)&&(!e.isLink||e.perm&&-1!==e.perm.indexOf("w"))))),[U]),W=(0,l.useMemo)((()=>(0,i.map)(H,(e=>({label:(0,A.wL)(e.id).id===r.FOLDERS.CONTACTS?S("folders.contacts","Contacts"):e.name,value:e.id,color:r.ZIMBRA_STANDARD_COLORS[e.color||0].hex})))),[H,S]),G=(0,l.useMemo)((()=>u&&"new"!==u&&g&&Object.keys(q).length<1||!(w?.firstName||w?.lastName)),[w?.firstName,w?.lastName,u,g,q]),V=(0,l.useMemo)((()=>w?.namePrefix||w?.firstName||w?.middleName||w?.nickName||w?.lastName||w?.nameSuffix?`${w?.namePrefix??""} ${w?.firstName??""} ${w?.middleName??""} ${w?.nickName??""} ${w?.lastName??""} ${w?.nameSuffix??""}`:S("label.new_contact","New contact")),[w?.firstName,w?.lastName,w?.middleName,w?.namePrefix,w?.nameSuffix,w?.nickName,S]);(0,l.useEffect)((()=>{e||a&&a(V)}),[a,e,V]);const J=(0,r.useReplaceHistoryCallback)(),K=(0,l.useCallback)((()=>{const a=M(w);a.id?f((0,O.P)({updatedContact:a,existingContact:g})).then((t=>{e&&J(`/folder/${d}/contacts/${t.payload[0].id}`)})).catch(r.report):f((0,T.v)(a)).then((a=>{e&&!a.error?J(`/folder/${d}/contacts/${a.payload[0].id}`):a.type.includes("fulfilled")&&(t&&t(),L({key:"edit",replace:!0,type:"success",label:S("label.new_contact_created","New contact created"),autoHideTimeout:3e3,hideButton:!0}))})).catch(r.report)}),[w,L,g,d,t,e,J,f,S]),X=(0,l.useMemo)((()=>[{label:S("types.work","work"),value:"work"},{label:S("types.home","home"),value:"home"},{label:S("types.other","other"),value:"other"}]),[S]),Z=(0,l.useMemo)((()=>[{label:S("types.mobile","mobile"),value:"mobile"},{label:S("types.work","work"),value:"work"},{label:S("types.home","home"),value:"home"},{label:S("types.other","other"),value:"other"}]),[S]);return w?n().createElement(o.Container,{mainAlignment:"flex-start",crossAlignment:"flex-start",background:"gray6",height:"fill"},n().createElement(o.Container,{padding:{all:"medium"},height:"fit",crossAlignment:"flex-start",background:"gray6","data-testid":"EditContact"},n().createElement(o.Row,{orientation:"horizontal",mainAlignment:"space-between",width:"fill"},n().createElement(o.Container,{height:"fit",width:"fit"},!u&&n().createElement(j,null,S("label.contact_created_in_folder",{name:B,defaultValue:'This contact will be created in the "{{name}}" folder'}))),n().createElement(o.Tooltip,{label:S("message.require_field","Fill one required * field"),placement:"top",disabled:!G},n().createElement(o.Button,{label:S("label.save","Save"),onClick:K,disabled:G}))),n().createElement(o.Padding,{value:"medium small"},n().createElement(I.H,{contact:w})),n().createElement(h,null,n().createElement(D,{name:"namePrefix",label:S("name.prefix","Prefix"),value:w.namePrefix,dispatch:v}),n().createElement(D,{name:"firstName",label:`${S("name.first_name","First Name")}*`,value:w.firstName,dispatch:v,autoFocus:!0}),n().createElement(D,{name:"middleName",label:S("name.middle_name","Middle Name"),value:w.middleName,dispatch:v})),n().createElement(h,null,n().createElement(D,{name:"nickName",label:S("name.nickName","Nickname"),value:w.nickName,dispatch:v}),n().createElement(D,{name:"lastName",label:`${S("name.last_name","Last Name")}*`,value:w.lastName,dispatch:v}),n().createElement(D,{name:"nameSuffix",label:S("name.suffix","Suffix"),value:w.nameSuffix,dispatch:v})),n().createElement(h,null,n().createElement(D,{name:"jobTitle",label:S("job.title","Job Role"),value:w.jobTitle,dispatch:v}),n().createElement(D,{name:"department",label:S("job.department","Department"),value:w.department,dispatch:v}),n().createElement(D,{name:"company",label:S("job.company","Company"),value:w.company,dispatch:v})),n().createElement(h,null,n().createElement(D,{name:"notes",label:S("label.notes","Notes"),value:w.notes,dispatch:v})),!u&&n().createElement(h,null,n().createElement(o.Padding,{horizontal:"small",top:"small",style:{width:"100%"}},n().createElement(o.Row,{padding:{bottom:"small"},crossAlignment:"flex-start",orientation:"vertical"},n().createElement(o.Text,{size:"large",weight:"medium",overflow:"break-word"},S("label.destination_address_book","Destination address book"))),n().createElement(R,{defaultFolderId:k,onChange:e=>{v({type:p.setInput,payload:{name:"parent",value:e}}),N(e)},label:S("share.contact_folder","Address Book"),folderItems:W,disabled:!1}))),n().createElement(y,{name:"email",label:S("section.title.mail","E-mail address"),subFields:["mail"],fieldLabels:[S("label.email","E-mail")],value:w.email,dispatch:v}),n().createElement(y,{name:"phone",label:S("section.title.phone_number","Phone contact"),typeLabel:S("select.default","Select type"),typeField:"type",types:Z,subFields:["number"],fieldLabels:[S("section.field.number","Number")],value:w.phone,dispatch:v}),n().createElement(y,{name:"URL",label:S("label.website","Website"),typeLabel:S("select.default","Select type"),typeField:"type",types:X,subFields:["url"],fieldLabels:[S("section.field.website","Website URL")],value:w.URL,dispatch:v}),n().createElement(y,{name:"address",label:S("section.title.address","Address"),typeField:"type",typeLabel:S("select.default","Select type"),types:X,subFields:["street","city","postalCode","country","state"],fieldLabels:[S("section.field.street","Street"),S("section.field.city","City"),S("section.field.postalCode","PostalCode"),S("section.field.country","Country"),S("section.field.state","State")],wrap:!0,value:w.address,dispatch:v}))):null}},2710:(e,t,a)=>{a.d(t,{t:()=>n});var l=a(2509);const n=(e,t)=>function e(t,a){return(0,l.transform)(t,((t,n,o)=>{(0,l.isEqual)(n,a[o])||(t[o]=(0,l.isObject)(n)&&(0,l.isObject)(a[o])?e(n,a[o]):n)}))}(e,t)}}]);
//# sourceMappingURL=0.701c1531.chunk.js.map