"use strict";(self.webpackChunkcarbonio_contacts_ui=self.webpackChunkcarbonio_contacts_ui||[]).push([[725],{3041:(e,t,n)=>{n.d(t,{p:()=>l});var a=n(7559),o=n.n(a),r=n(4702),i=n(8153);const l=({email:e,onRemove:t})=>{const[n]=(0,i.useTranslation)(),l=(0,a.useCallback)((()=>t()),[t]);return o().createElement(r.Row,{width:"fill",mainAlignment:"space-between",padding:"small",gap:"0.5rem","data-testid":"member-list-item",wrap:"nowrap"},o().createElement(r.Row,{wrap:"nowrap",gap:"0.5rem",flexShrink:1,minWidth:"1rem"},o().createElement(r.Avatar,{size:"medium",label:e}),o().createElement(r.Row,{flexShrink:1,minWidth:"1rem"},o().createElement(r.TextWithTooltip,{size:"small"},e))),o().createElement(r.Button,{type:"outlined",size:"medium",label:n("members_list_item_component.button.remove","remove"),icon:"Trash2Outline",color:"error",onClick:l,minWidth:"fit-content"}))}},8312:(e,t,n)=>{n.d(t,{e0:()=>d}),n(3619);var a=n(2509),o=n(1621);function r(e,t){const n=e.toLowerCase(),a=t.toLowerCase();return n>a?1:a>n?-1:0}const i={orderedContactGroups:[],unorderedContactGroups:[],offset:0};function l(e,t,n){const o=(0,a.findIndex)(e,(e=>r(n.title,e.title)<0));if(o<e.length&&o>=0)e.splice(o,0,n);else if(0===t.length)t.push(n);else{const e=(0,a.findIndex)(t,(e=>r(n.title,e.title)<0));t.splice(e,0,n)}}const d=(0,o.vt)()(((e,t)=>({...i,reset:()=>{e(i)},updateContactGroup:n=>{const{orderedContactGroups:a,unorderedContactGroups:o,offset:r}=t(),i=a.findIndex((e=>e.id===n.id)),d=[...a],s=[...o];if(i>=0)d.splice(i,1),l(d,s,n),e((()=>({orderedContactGroups:d,unorderedContactGroups:s,offset:d.length===a.length||-1===r?r:r+d.length-a.length})));else{const t=o.findIndex((e=>e.id===n.id));if(!(t>=0))throw new Error("Contact group not found");s.splice(t,1),l(d,s,n),e((()=>({orderedContactGroups:d,unorderedContactGroups:s,offset:d.length===a.length||-1===r?r:r+d.length-a.length})))}},setOffset:t=>e((()=>({offset:t}))),addContactGroups:n=>{const{orderedContactGroups:o,unorderedContactGroups:r}=t();if(r.length>0){const t=(0,a.differenceBy)(r,n,(e=>e.id));e((()=>({orderedContactGroups:[...o??[],...n],unorderedContactGroups:t})))}else e((()=>({orderedContactGroups:[...o??[],...n]})))},removeContactGroup:n=>{const{orderedContactGroups:a,unorderedContactGroups:o,offset:r}=t();if(a.findIndex((e=>e.id===n))>=0)e((()=>({orderedContactGroups:a.filter((e=>e.id!==n)),offset:r-1})));else{if(!(o.findIndex((e=>e.id===n))>=0))throw new Error("Contact group not found");e((()=>({unorderedContactGroups:o.filter((e=>e.id!==n))})))}},addContactGroupInSortedPosition:n=>{const{orderedContactGroups:a,unorderedContactGroups:o,offset:r}=t(),i=[...a],d=[...o];l(i,d,n),e((()=>({orderedContactGroups:i,unorderedContactGroups:d,offset:i.length===a.length||-1===r?r:r+i.length-a.length})))}})))},2788:(e,t,n)=>{n.d(t,{A:()=>C,w:()=>h}),n(3619);var a=n(7559),o=n.n(a),r=n(4702),i=n(4577),l=n(2509),d=n(8153),s=n(4710),c=n.n(s),u=n(3041),m=n(9812),p=n(7626),g=n(7770);function h(e){return 0===e.trim().length||e.length>m.n}const f=c()(r.ListV2).withConfig({displayName:"common-contact-group-board__List",componentId:"sc-1f18734-0"})(["min-height:0;"]),C=({onSave:e,nameValue:t,memberListEmails:n,isOnSaveDisabled:s,setMemberListEmails:c,initialNameValue:h,initialMemberListEmails:C,setNameValue:b})=>{const[w]=(0,d.useTranslation)(),{updateBoard:G}=(0,i.useBoardHooks)(),E=(0,a.useCallback)((e=>{b(e.target.value),G({title:e.target.value})}),[b,G]),v=(0,a.useMemo)((()=>0===t.trim().length?w("board.newContactGroup.input.name_input.error.required","Group name is required, enter a name to proceed"):t.length>m.n?w("board.newContactGroup.input.name_input.error.max_length","Maximum length allowed is 256 characters"):void 0),[w,t]),[_,y]=(0,a.useState)([]),k=(0,a.useCallback)((()=>{b(h),c(C),G({title:h}),y([])}),[C,h,c,b,G]),x=(0,a.useCallback)((()=>{const e=[],t=[];_.forEach((n=>{n.error||n.duplicated||void 0===n.email?t.push(n):e.push(n.email)})),y(t),c((t=>[...t,...e]))}),[_,c]),A=(0,a.useCallback)((e=>{const t=n.filter((t=>t!==e));c(t),y((e=>e.map((e=>{const n=void 0!==e.email&&t.includes(e.email),a=[...e.actions??[]];return!n&&e.duplicated&&(0,l.remove)(a,(e=>"duplicated"===e.id)),{...e,duplicated:n,actions:a}}))))}),[n,c]),S=(0,a.useMemo)((()=>{let e=0,t=0,n=0;if(_.forEach((a=>{a.duplicated?t+=1:a.error?n+=1:e+=1})),!(e>0))return n>0&&t>0?w("board.newContactGroup.input.contact_input.error.invalid_already_present_addresses","Invalid and already present addresses"):n>0&&0===t?w("board.newContactGroup.input.contact_input.error.invalid_address",{count:n,defaultValue_one:"Invalid address",defaultValue_other:"Invalid addresses"}):t>0&&0===n?w("board.newContactGroup.input.contact_input.error.address_already_present",{count:t,defaultValue_one:"Address already present",defaultValue_other:"Addresses already present"}):void 0}),[_,w]),I=(0,a.useMemo)((()=>!(0,l.some)(_,(e=>!e.error&&!e.duplicated))),[_]),V=(0,a.useMemo)((()=>n.map((e=>o().createElement(u.p,{key:e,email:e,onRemove:()=>A(e)})))),[n,A]);return o().createElement(r.Container,{crossAlignment:"flex-end",background:"gray5",padding:{horizontal:"large",bottom:"2.625rem"},height:"fill",minHeight:"30rem"},o().createElement(r.Container,{gap:"0.5rem",orientation:"horizontal",mainAlignment:"flex-end",height:"fit",padding:{vertical:"0.5rem"}},o().createElement(r.Button,{disabled:!1,size:"medium",label:w("label.discard","discard"),onClick:k,type:"outlined"}),o().createElement(r.Button,{disabled:s,size:"medium",label:w("label.save","save"),icon:"SaveOutline",onClick:e})),o().createElement(r.Container,{height:"fit",orientation:"horizontal",mainAlignment:"flex-start",gap:"1rem",padding:"1rem 0"},o().createElement(r.Avatar,{size:"large",label:t,icon:"PeopleOutline"}),o().createElement(r.Container,{height:"fit",crossAlignment:"flex-start",minWidth:0},o().createElement(r.Text,{weight:"bold"},t),o().createElement(r.Text,{color:"gray1"},w("board.newContactGroup.addresses.label","Addresses"),": ",n.length))),o().createElement(r.Container,{background:"gray6",mainAlignment:"flex-start",crossAlignment:"flex-start",padding:{horizontal:"large",top:"large"},gap:"0.5rem",height:"calc(100% - 8rem)"},o().createElement(r.Input,{label:w("board.newContactGroup.input.name_input.name.label","Group name*"),backgroundColor:"gray5",borderColor:"gray3",value:t,onChange:E,description:v,hasError:0===t.trim().length||t.length>m.n}),o().createElement(r.Row,{padding:{top:"0.5rem"}},o().createElement(r.Text,{color:"secondary"},w("board.newContactGroup.input.contact_input.title","Addresses list"))),o().createElement(r.Container,{orientation:"horizontal",height:"fit",crossAlignment:"flex-start"},o().createElement(g.p,{"data-testid":"contact-group-contact-input",defaultValue:_,onChange:e=>{const t=(0,l.uniqBy)(e,(e=>e.email)).map((e=>{const t=void 0!==e.email&&n.includes(e.email),a=!e.actions?.find((e=>"duplicated"===e.id)),o=[...e.actions??[],...t&&a?[{id:"duplicated",color:"error",type:"icon",icon:"AlertCircle"}]:[]];return{...e,duplicated:t,actions:o}}));y(t)},placeholder:w("board.newContactGroup.input.contact_input.placeholder","Type an address, click ‘+’ to add to the group"),icon:"Plus",iconAction:x,iconDisabled:I,description:S,hasError:_.length>0&&I,chipDisplayName:p.P.email})),o().createElement(f,{"data-testid":"members-list"},V)))}},4253:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var a=n(7559),o=n.n(a),r=n(4702),i=n(4577),l=n(8153),d=n(2788),s=n(9812),c=n(4362),u=n(8312);const m=()=>{const[e]=(0,l.useTranslation)(),{closeBoard:t}=(0,i.useBoardHooks)(),n=(0,r.useSnackbar)(),{context:m}=(0,i.useBoard)(),p=e("board.newContactGroup.name","New Group"),[g,h]=(0,a.useState)(p),[f,C]=(0,a.useState)([]),b=(0,a.useCallback)((()=>{c.u.createContactGroup(g,f).then((a=>{if(window.location.pathname.includes(s.M3.route.contactGroups)){u.e0.getState().addContactGroupInSortedPosition(a);const e=window.document.getElementById(a.id);e&&e.scrollIntoView({block:"end"}),m?.navigateTo(`${s.M3.route.contactGroups}/${a.id}`)}else u.e0.getState().reset();n({key:(new Date).toLocaleString(),type:"success",label:e("board.newContactGroup.snackbar.contact_group_created","Contact group successfully created")}),t()})).catch((()=>{n({key:(new Date).toLocaleString(),type:"error",label:e("label.error_try_again","Something went wrong, please try again")})}))}),[g,f,n,e,t,m]);return o().createElement(d.A,{onSave:b,nameValue:g,memberListEmails:f,isOnSaveDisabled:(0,d.w)(g),setMemberListEmails:C,initialNameValue:p,initialMemberListEmails:[],setNameValue:h})}}}]);
//# sourceMappingURL=newContactGroupView.ff7f9107.chunk.js.map