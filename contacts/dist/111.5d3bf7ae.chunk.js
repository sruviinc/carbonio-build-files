"use strict";(self.webpackChunkcarbonio_contacts_ui=self.webpackChunkcarbonio_contacts_ui||[]).push([[111],{8689:(e,t,a)=>{a.d(t,{A:()=>d});var n=a(7559),l=a.n(n),i=a(4702),r=a(4577),o=a(8153),c=a(8698),m=a(6e3);function s({editPanelId:e,folderId:t}){const[a]=(0,o.useTranslation)(),c=(0,n.useCallback)((()=>(0,r.replaceHistory)(`/folder/${t}`)),[t]);return l().createElement(i.Container,{height:"3.0625rem"},l().createElement(i.Container,{orientation:"horizontal",mainAlignment:"flex-start",height:"3rem",padding:{left:"large",right:"large"}},l().createElement(i.Padding,{right:"medium"},l().createElement(i.Icon,{size:"medium",icon:"EditOutline"})),l().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},l().createElement(i.Text,{size:"medium"},e&&"new"!==e?a("label.edit","Edit"):a("label.create","Create"))),l().createElement(i.IconButton,{icon:"Close",size:"small",onClick:c})),l().createElement(i.Divider,null))}function d(){const{editId:e,folderId:t}=(0,c.useParams)();return l().createElement(l().Fragment,null,l().createElement(s,{editPanelId:e,folderId:t}),l().createElement(i.Container,{height:"fit",style:{maxHeight:"100%",overflowY:"auto"}},l().createElement(m.A,{panel:!0})))}},2295:(e,t,a)=>{a.d(t,{A:()=>x}),a(3619);var n=a(7559),l=a.n(n),i=a(4702),r=a(4577),o=a(2509),c=a(8153),m=a(7760),s=a(8698),d=a(2816),u=a(9310),p=a(2354);function g(e){switch(e){case"mail":return"EmailOutline";case"mobile":return"SmartphoneOutline";case"home":return"HomeOutline";case"work":return"BriefcaseOutline";case"fax":return"";default:return"PersonOutline"}}function f({children:e,width:t}){return l().createElement(i.Row,{orientation:"horizontal",mainAlignment:"space-between",width:t||"fill",wrap:"nowrap",crossAlignment:"flex-start",padding:{horizontal:"small",vertical:"small"}},e)}function E({field:e,label:t,width:a,limit:n,items:r}){return l().createElement(l().Fragment,null,r?l().createElement(i.Container,null,l().createElement(i.Dropdown,{width:"100%",maxWidth:"100%",items:r,placement:"bottom-end",display:"block"},l().createElement(i.Container,{mainAlignment:"flex-start",crossAlignment:"flex-start",padding:{all:"small"}},l().createElement(i.Text,{color:"secondary"},t),l().createElement(i.Row,{takeAvailableSpace:!0,wrap:"nowrap",height:"fit",width:"100%",orientation:"horizontal",mainAlignment:"flex-start",padding:{top:"extrasmall"}},l().createElement(i.Row,{takeAvailableSpace:!0,wrap:"nowrap",height:"fit",orientation:"horizontal",mainAlignment:"flex-start",padding:{top:"extrasmall"}},l().createElement(i.Text,{size:"medium",overflow:"break-word"},e)),l().createElement(i.IconButton,{size:"small",icon:"ArrowIosDownward"}))))):l().createElement(i.Container,{mainAlignment:"flex-start",crossAlignment:"flex-start",padding:{all:"small"},width:a||"48%",style:{minHeight:"3rem",maxWidth:n?"calc(100% - 3rem)":"100%"}},l().createElement(i.Text,{color:"secondary"},t),l().createElement(i.Row,{takeAvailableSpace:!0,wrap:"nowrap",height:"fit",width:"fill",orientation:"horizontal",mainAlignment:"flex-start",padding:{top:"extrasmall"}},l().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},l().createElement(i.Text,{size:"medium",overflow:"break-word"},e)),r&&l().createElement(i.Dropdown,{items:r,placement:"bottom-end"},l().createElement(i.Container,null,l().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"}),l().createElement(i.IconButton,{size:"small",icon:"ArrowIosDownward"}))))))}function h({type:e,values:t,width:a,defaultType:r,showIcon:m}){const[s]=(0,c.useTranslation)(),[d,u]=(0,n.useState)(0),[p,f]=(0,n.useMemo)((()=>{switch(e){case"mail":return["mail",s("section.title.mail","E-mail address")];case"phone_number":return["number",s("section.title.phone_number","Phone contact")];case"url":return["url",s("label.website",{count:t.length,defaultValue_one:"website",defaultValue_other:"websites"})];case"address":return["address",s("section.title.address",{count:t.length,defaultValue_one:"address",defaultValue_other:"addresses"})];default:return[e,e]}}),[s,e,t.length]),h=(0,n.useMemo)((()=>(0,o.reduce)(t,((t,a,n)=>{let l=e;switch(e){case"mail":l=a.mail;break;case"phone_number":l=a.number;break;case"url":l=a.url;break;case"address":l=a.address}return t.push({id:n.toString(),label:l,icon:m?g(a.type||r||"other"):null,onClick:()=>u(n)}),t}),[])),[r,t,m,e]);return l().createElement(i.Container,{orientation:"horizontal",width:a||"48%",crossAlignment:"center",mainAlignment:"space-between"},l().createElement(E,{label:f,field:t&&t[d]&&t[d][p],icon:t&&t[d]&&m&&g(t[d].type||r||"other"),width:a||"fill",items:t.length>1&&h}))}const b=function({contact:e,onEdit:t,onDelete:a,onMail:m,onMove:s}){const[g,b]=(0,n.useState)(!0),w=(0,n.useCallback)((()=>{b(!g)}),[b,g]),[v]=(0,c.useTranslation)(),k=(0,n.useMemo)((()=>Object.values(e.email)),[e]),y=(0,n.useMemo)((()=>Object.values(e.URL)),[e]),C=(0,n.useMemo)((()=>Object.values(e.phone)),[e]),A=(0,n.useMemo)((()=>Object.values(e.address)),[e]),x=(0,r.useTags)(),T=(0,n.useCallback)((e=>(0,r.runSearch)([{avatarBackground:r.ZIMBRA_STANDARD_COLORS[e?.color??0].hex,avatarIcon:"Tag",background:"gray2",hasAvatar:!0,isGeneric:!1,isQueryFilter:!0,label:`tag:${e?.name}`,value:`tag:"${e?.name}"`}],"contacts")),[]),I=(0,n.useMemo)((()=>(0,o.reduce)(x,((t,a)=>((0,o.includes)(e.tags,a.id)&&t.push({...a,color:r.ZIMBRA_STANDARD_COLORS[a.color??0].hex,label:a.name,onClick:()=>T(a),customComponent:l().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},l().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"space-between"},l().createElement(i.Row,{mainAlignment:"flex-end"},l().createElement(i.Padding,{right:"small"},l().createElement(i.Icon,{icon:"Tag",color:r.ZIMBRA_STANDARD_COLORS[a.color??0].hex}))),l().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},l().createElement(i.Text,null,a.name))))}),t)),[])),[e.tags,x,T]),R=(0,n.useMemo)((()=>I.length>1?"TagsMoreOutline":"Tag"),[I]),S=(0,n.useMemo)((()=>1===I.length?I[0].color:void 0),[I]),_=(0,p.nK)(I),O=(0,n.useCallback)((()=>{T(x?.[e?.tags[0]])}),[e.tags,T,x]),D=(0,n.useMemo)((()=>e.tags?.length>1&&_),[e.tags?.length,_]),M=(0,n.useMemo)((()=>e.tags&&0!==e.tags?.length&&!D&&_&&(0,o.every)(e.tags,(e=>""!==e))),[_,e.tags,D]),[z,P]=(0,n.useState)(!1),B=(0,n.useCallback)((e=>{e.stopPropagation(),P((e=>!e))}),[]),N=(0,n.useCallback)((()=>{P(!1)}),[]),H=(0,n.useMemo)((()=>x[e?.tags?.[0]]?.name),[e?.tags,x]);return l().createElement(i.Row,{"data-testid":"PreviewPanel",padding:{all:"extrasmall"},width:"100%",mainAlignment:"baseline",style:{overflowY:"auto"}},l().createElement(i.Responsive,{mode:"desktop",target:window.top},l().createElement(i.Container,{"data-testid":"contact-preview-content-desktop",background:"gray6",height:"fit",padding:{all:"medium"}},l().createElement(i.Row,{width:"fill",height:"fit",takeAvailableSpace:!0,mainAlignment:"flex-end",padding:{horizontal:"extrasmall"}},!(0,d.vF)(e.parent)&&l().createElement(i.IconButton,{icon:"MailModOutline",onClick:m,disabled:(0,o.isEmpty)(e?.email)}),M&&l().createElement(i.Padding,{left:"small"},l().createElement(i.Tooltip,{label:H,disabled:D},l().createElement(i.IconButton,{"data-testid":"TagIcon",size:"large",onClick:O,icon:R,color:S}))),D&&l().createElement(i.Dropdown,{items:I,forceOpen:z,onClose:N},l().createElement(i.Padding,{left:"small"},l().createElement(i.IconButton,{size:"large","data-testid":"TagIcon",icon:R,onClick:B,color:S}))),l().createElement(i.IconButton,{icon:"Trash2Outline",onClick:a}),l().createElement(i.IconButton,{icon:(0,d.vF)(e.parent)?"RestoreOutline":"MoveOutline",onClick:s}),l().createElement(i.Padding,{right:"small"}),!(0,d.vF)(e.parent)&&l().createElement(i.Button,{icon:"EditOutline",label:v("label.edit"),onClick:t})),l().createElement(i.Container,{padding:{all:"small",top:"extrasmall"}},l().createElement(u.H,{contact:e,open:g,toggleOpen:w}))),l().createElement(i.Collapse,{orientation:"vertical",open:g,crossSize:"100%",disableTransition:!0},l().createElement(i.Container,{background:"gray6",width:"fill",crossAlignment:"flex-start",mainAlignment:"flex-start",padding:{vertical:"large",horizontal:"extralarge"},style:{overflowY:"auto"}},l().createElement(f,null,e.namePrefix&&l().createElement(E,{field:e.namePrefix,label:v("name.prefix","Prefix")}),e.firstName&&l().createElement(E,{field:e.firstName,label:v("name.first_name","First Name")}),e.middleName&&l().createElement(E,{field:e.middleName,label:v("name.middle_name","Middle Name")}),e.lastName&&l().createElement(E,{field:e.lastName,label:v("name.last_name","Last Name")}),e.nameSuffix&&l().createElement(E,{field:e.nameSuffix,label:v("name.suffix","Suffix")})),l().createElement(f,null,C.length>0&&l().createElement(h,{type:"phone_number",values:C,showIcon:!0}),k.length>0&&l().createElement(h,{type:"mail",values:k,defaultType:"email",showIcon:!1})),l().createElement(f,null,e.jobTitle&&l().createElement(E,{field:e.jobTitle,label:v("job.title","Job Role")}),e.department&&l().createElement(E,{field:e.department,label:v("job.department","Department")}),e.company&&l().createElement(E,{field:e.company,label:v("job.company","Company")})),e.notes&&l().createElement(f,null),e.notes&&l().createElement(f,null,l().createElement(E,{field:e.notes,label:v("label.notes","Notes"),width:"fill"})),A.length>0&&l().createElement(i.Row,{width:"fill",mainAlignment:"flex-start",padding:{top:"large"}},l().createElement(i.Text,{color:"secondary",overflow:"break-word",style:{paddingLeft:"1rem"}},v("section.title.address","Address")),(0,o.map)(A,((e,t)=>l().createElement(f,{crossAlignment:"flex-start",key:t},e.type&&l().createElement(E,{field:e.type,label:v("label.type","Type")}),e.street&&l().createElement(E,{field:e.street,label:v("section.field.street","Street")}),e.city&&l().createElement(E,{field:e.city,label:v("section.field.city","City")}),e.postalCode&&l().createElement(E,{field:e.postalCode,label:v("section.field.postalCode","PostalCode")}),e.country&&l().createElement(E,{field:e.country,label:v("section.field.country","Country")}),e.state&&l().createElement(E,{field:e.state,label:v("section.field.state","State")}))))),y.length>0&&l().createElement(i.Row,{width:"fill",mainAlignment:"flex-start",padding:{top:"large"}},l().createElement(i.Text,{color:"secondary",overflow:"break-word",style:{paddingLeft:"1rem"}},v("label.website","Website")),(0,o.map)(y,(({url:e},t)=>{const a=e.match("^(\\w+:)?\\/\\/.+$")?e:`https://${e}`;return l().createElement(f,{crossAlignment:"flex-start",key:t},l().createElement(i.Link,{style:{paddingLeft:"0.5rem"},underlined:!0,href:a,target:"_blank"},e))})))))),l().createElement(i.Responsive,{mode:"mobile",target:window.top},l().createElement(i.Container,{"data-testid":"contact-preview-content-mobile",background:"gray6",height:"fit",padding:{all:"medium"}},l().createElement(i.Container,null,l().createElement(u.H,{contact:e,open:g,toggleOpen:w}))),l().createElement(i.Collapse,{orientation:"vertical",open:g,crossSize:"100%",disableTransition:!0},l().createElement(i.Container,{background:"gray6",width:"fill",crossAlignment:"flex-start",mainAlignment:"flex-start",padding:{vertical:"large",horizontal:"extralarge"},style:{overflowY:"auto"}},l().createElement(f,null,l().createElement(E,{field:e.namePrefix,label:v("name.prefix","Prefix")}),l().createElement(E,{field:e.firstName,label:v("name.first_name","First Name")})),l().createElement(f,null,l().createElement(E,{field:e.lastName,label:v("name.last_name","Last Name")}),l().createElement(h,{type:"phone_number",values:C,showIcon:!0})),l().createElement(f,null,l().createElement(h,{type:"mail",values:k,defaultType:"email",showIcon:!1}),l().createElement(E,{field:e.jobTitle,label:v("job.title","Job Role")})),l().createElement(f,null,l().createElement(E,{field:e.company,label:v("job.company","Company")}))))))},w=({displayName:e,onClose:t,onEdit:a,onDelete:n,onMove:r})=>l().createElement(i.Container,{height:"3.0625rem"},l().createElement(i.Responsive,{mode:"desktop",target:window.top},l().createElement(i.Container,{"data-testid":"contact-preview-header-desktop",orientation:"horizontal",mainAlignment:"flex-start",height:"3rem",padding:{left:"large",right:"large"}},l().createElement(i.Padding,{right:"medium"},l().createElement(i.Icon,{size:"medium",icon:"PeopleOutline"})),l().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},l().createElement(i.Text,{size:"medium"},e)),l().createElement(i.IconButton,{icon:"Close",size:"small",onClick:t}))),l().createElement(i.Responsive,{mode:"mobile",target:window.top},l().createElement(i.Container,{orientation:"horizontal","data-testid":"contact-preview-header-mobile",mainAlignment:"flex-start",height:"3rem",padding:{left:"large"}},l().createElement(i.Padding,{right:"medium"},l().createElement(i.Icon,{size:"medium",icon:"ArrowBackOutline",onClick:t})),l().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},l().createElement(i.Text,{size:"medium"},e)),l().createElement(i.Dropdown,{"data-testid":"preview-header-dropdown-mobile",items:[{id:"edit",icon:"EditOutline",label:"Edit",onClick:a},{id:"delete",icon:"TrashOutline",label:"Delete",onClick:n},{id:"move",icon:"MoveOutline",label:"Move",onClick:r}]},l().createElement(i.IconButton,{size:"medium",icon:"MoreVertical"})))),l().createElement(i.Divider,null));var v=a(6060),k=a(7848),y=a(8136),C=a(9602),A=a(3201);function x(){const[e]=(0,c.useTranslation)(),t=(0,s.useLocation)(),a=(0,s.useHistory)(),{pathname:u}=(0,s.useLocation)(),p=(0,m.useDispatch)(),{folderId:g,contactId:f}=(0,s.useParams)(),E=f,h=(0,k.G)((e=>(0,A.Do)(e,g,E))),x=(0,i.useSnackbar)(),T=((0,i.useModal)(),(0,v.y)()),I=(0,n.useCallback)((()=>(0,r.replaceHistory)(`/folder/${g}/edit/${E}`)),[E,g]),R=(0,n.useCallback)((()=>{(0,o.includes)(t?.pathname,"search")?a.push((0,o.head)((0,o.split)(u,"/folder"))):(0,r.replaceHistory)(`/folder/${g}`)}),[g,a,u,t?.pathname]),S=(0,n.useCallback)((()=>{p((0,C.H)({contactsIDs:[h.id],originID:h.parent,destinationID:(0,d.vF)(h.parent)?void 0:r.FOLDERS.TRASH,op:(0,d.vF)(h.parent)?"delete":"move"})).then((t=>{t.type.includes("fulfilled")?(R(),x({key:"trash",replace:!0,type:"info",label:(0,d.vF)(h.parent)?e("messages.snackbar.contact_deleted_permanently","Contact permanently deleted"):e("messages.snackbar.contact_moved_to_trash","Contact moved to trash"),autoHideTimeout:(0,d.vF)(h.parent)?3e3:5e3,hideButton:(0,d.vF)(h.parent),actionLabel:"Undo",onActionClick:()=>{p((0,C.H)({contactsIDs:[h.id],originID:r.FOLDERS.TRASH,destinationID:h.parent,op:"move"})).then((t=>{t.type.includes("fulfilled")?((0,r.replaceHistory)(`/folder/${g}/contacts/${h.id}`),x({key:"trash",replace:!0,type:"success",label:e("messages.snackbar.contact_restored","Contact restored"),autoHideTimeout:3e3,hideButton:!0})):x({key:"edit",replace:!0,type:"error",label:e("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})}))}})):x({key:"edit",replace:!0,type:"error",label:e("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})}))}),[h,p,e,x,g,R]),_=(0,n.useCallback)((()=>null),[]),O=(0,n.useCallback)((()=>null),[]),D=(0,n.useCallback)((()=>{const[e,t]=(0,r.getAction)("contact-list","mail-to",[h]);t&&e.onClick(h)}),[h]),M=(0,n.useCallback)((()=>{T.execute({contacts:[h]})}),[h,T]),z=(0,y.n)(h);return h&&z?l().createElement(l().Fragment,null,l().createElement(w,{displayName:z,onClose:R,onEdit:I,onDelete:S,onMove:M}),l().createElement(b,{contact:h,onEdit:I,onDelete:S,onPrint:_,onArchieve:O,onMail:D,onMove:M}),l().createElement(i.Divider,null)):null}}}]);
//# sourceMappingURL=111.5d3bf7ae.chunk.js.map