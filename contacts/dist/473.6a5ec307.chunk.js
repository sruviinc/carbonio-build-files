"use strict";(self.webpackChunkcarbonio_contacts_ui=self.webpackChunkcarbonio_contacts_ui||[]).push([[473],{6060:(e,t,a)=>{a.d(t,{y:()=>g}),a(3619);var l=a(7559),n=a.n(l),o=a(4702),r=a(2509),c=a(8153),i=a(2816),s=a(5302),d=a(8585),m=a(9812),u=a(4362);const g=()=>{const[e]=(0,c.useTranslation)(),t=(0,o.useSnackbar)(),a=(0,o.useModal)(),g=(0,l.useCallback)(((a,l)=>u.u.moveContact(a,l).then((()=>(t({key:"move-contact-success",replace:!0,type:"success",label:e("messages.snackbar.contact_moved","Contact moved"),autoHideTimeout:m.fT.defaultSnackbar,hideButton:!0}),!0))).catch((()=>(t({key:"move-contact-error",replace:!0,type:"error",label:e("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:m.fT.defaultSnackbar,hideButton:!0}),!1)))),[t,e]),p=(0,l.useCallback)((({contacts:e,newParentAddressBook:t}={})=>{if(!e||0===e.length)return!1;if(t){if(!e.map((e=>e.parent)).some((e=>e!==t.id)))return!1;if(!(0,i._u)(t))return!1;if((0,i.jX)(t.id))return!1}const a=e.reduce(((e,t)=>{const a=(0,s.L2)(t.parent);return a&&e.push(a),e}),[]);return!(0,r.every)(a,(e=>(0,i.iQ)({folder:e})))}),[]),h=(0,l.useCallback)((({contacts:e,newParentAddressBook:t}={})=>{if(!e||0===e.length)return;if(!p({contacts:e,newParentAddressBook:t}))return;const l=e.map((e=>e.id));if(t)g(l,t.id);else{const t=a({children:n().createElement(d.n,{contacts:e,onMove:e=>{g(l,e).then((e=>e&&t()))},onClose:()=>t()})},!0)}}),[p,a,g]);return(0,l.useMemo)((()=>({id:m.kM.moveContacts,label:e("label.move","Move"),icon:"MoveOutline",execute:h,canExecute:p})),[p,h,e])}},6317:(e,t,a)=>{a.d(t,{qN:()=>u,qy:()=>p});var l=a(7559),n=a.n(l),o=a(4702),r=a(4577),c=a(8153),i=a(4710),s=a.n(i);const d=s().div.withConfig({displayName:"color-select__Square",componentId:"sc-1o5yp9d-0"})(["width:1.125rem;height:1.125rem;position:relative;top:-0.1875rem;border:0.0625rem solid ",";background:",";border-radius:0.25rem;"],(({theme:e})=>e.palette.gray2.regular),(({color:e})=>e)),m=s()(o.Container).withConfig({displayName:"color-select__ColorContainer",componentId:"sc-1o5yp9d-1"})(["border-bottom:0.0625rem solid ",";cursor:'pointer';"],(({theme:e})=>e.palette.gray2.regular)),u=s()(o.Text).withConfig({displayName:"color-select__TextUpperCase",componentId:"sc-1o5yp9d-2"})(["text-transform:capitalize;"]),g=({selected:e,label:t,open:a,focus:l})=>n().createElement(m,{orientation:"horizontal",width:"fill",crossAlignment:"center",mainAlignment:"space-between",borderRadius:"half",background:"gray5",padding:{all:"small"}},n().createElement(o.Row,{width:"100%",takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Row,{orientation:"vertical",crossAlignment:"flex-start",mainAlignment:"flex-start",padding:{left:"small"}},n().createElement(o.Text,{size:"small",color:a||l?"primary":"secondary"},t),n().createElement(u,null,e[0].label)),n().createElement(o.Padding,{right:"small"},n().createElement(d,{color:r.ZIMBRA_STANDARD_COLORS[parseInt(e[0].value,10)].hex}))),n().createElement(o.Icon,{size:"large",icon:a?"ChevronUpOutline":"ChevronDownOutline",color:a||l?"primary":"secondary",style:{alignSelf:"center"}})),p=({onChange:e,defaultColor:t=0,label:a})=>{const[i]=(0,c.useTranslation)(),s=(0,l.useMemo)((()=>r.ZIMBRA_STANDARD_COLORS.map(((e,t)=>{const a=i(`color.${e.zLabel}`,"{{color}}",{context:r.ZIMBRA_STANDARD_COLORS,replace:{color:e.zLabel}});return{label:a,value:t.toString(),customComponent:n().createElement(o.Container,{width:"100%",mainAlignment:"space-between",orientation:"horizontal",height:"fit"},n().createElement(o.Padding,{left:"small"},n().createElement(u,null,a)),n().createElement(d,{color:e.hex}))}}))),[i]),m=(0,l.useMemo)((()=>s[t]),[s,t]);return n().createElement(o.Select,{label:a,onChange:e,items:s,defaultSelection:m,LabelFactory:g,"data-testid":"color-select"})}},7125:(e,t,a)=>{a.d(t,{Q:()=>M}),a(3619);var l=a(7559),n=a.n(l),o=a(4702),r=a(2509),c=a(8153),i=a(4710),s=a.n(i),d=a(4577);const m=n().forwardRef((function({crumbs:e,collapserProps:t,dropdownProps:a,size:l="large",tooltipLabel:r,...c},i){const s=e.length,d=r??e.reduce(((e,t)=>`${e}/${t.label}`),""),m=e.shift();return n().createElement(o.Tooltip,{label:d},n().createElement(o.Row,{mainAlignment:"flex-start",wrap:"nowrap",width:"fill"},n().createElement(o.Container,{width:"fit",mainAlignment:"flex-start",padding:{left:"small",right:"extrasmall"}},n().createElement(o.Text,{size:l,color:1===s?"text":"secondary"},m?.label??"")),n().createElement(o.Row,{mainAlignment:"flex-start",maxWidth:"70%"},n().createElement(o.Breadcrumbs,{crumbs:e,dropdownProps:{disabled:!0}}))))}));var u=a(2816),g=a(9518),p=a(7134);function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},h.apply(this,arguments)}const b="2.6rem",f=s().div.withConfig({displayName:"flat-folders-accordion__FolderAccordionPlaceholder",componentId:"sc-1fkecot-0"})(["height:",";"],b),E=s()(o.Row).withConfig({displayName:"flat-folders-accordion__RootAccordion",componentId:"sc-1fkecot-1"})(["cursor:pointer;"]),C=s()(o.Container).withConfig({displayName:"flat-folders-accordion__CustomContainer",componentId:"sc-1fkecot-2"})(["&:hover{background-color:",";}"],(({theme:e,active:t})=>t?e.palette.highlight.active:e.palette.gray6.hover)),w=s()(o.ListItem).withConfig({displayName:"flat-folders-accordion__CustomListItemHelper",componentId:"sc-1fkecot-3"})([""]),k=s()(w).attrs((({background:e="gray6",active:t,activeBackground:a="highlight",selected:l,selectedBackground:n="gray5",theme:r})=>({$baseBackgroundColor:(0,o.getColor)(t&&a||l&&n||e,r),$focusBackgroundColor:(0,o.getColor)(`${t&&a||"gray6"}.focus`,r)}))).withConfig({displayName:"flat-folders-accordion__CustomListItem",componentId:"sc-1fkecot-4"})([""]),y=({folder:e,onFolderSelected:t,...a})=>{const[i]=(0,c.useTranslation)(),s=(0,g.fX)(e),d=(0,g.dk)(e),f=(e=>{if(!e)return[];if((0,u.jX)(e?.id))return[e.name??""];const t=/^\/?(.*)$/gm.exec(e.absFolderPath??"");return t?t[1].split("/"):[]})(e),E=f.map(((t,a)=>({id:`${a} `,label:0===a?(0,p.k0)(i,e.id,t):t}))),C=(0,l.useCallback)((()=>{t?t(e):r.noop}),[t,e]);return n().createElement(o.Container,h({width:"fill","main-alignment":"flex-start",orientation:"vertical",crossAlignment:"flex-start",padding:{top:"small",right:"small",bottom:"small",left:"extralarge"},height:b,onClick:C,wrap:"nowrap"},a),n().createElement(o.Row,{mainAlignment:"flex-start",wrap:"nowrap",width:"fill"},n().createElement(o.Container,{width:"fit"},n().createElement(o.Icon,{color:d,icon:s||"FolderOutline",size:"large"})),n().createElement(m,{crumbs:E,size:"large"})))},v=({folder:e,childrenFolders:t,isOpen:a=!1,onFolderSelected:r,onOpenStatusChange:c,selectedFolderId:i,allowRootSelection:s})=>{const[m,g]=(0,l.useState)(a),p=(0,d.useUserAccount)(),h=(0,u.bp)(e.id)?p.name:e.name,b=(0,l.useCallback)((e=>{e.stopPropagation(),g((e=>(c&&c(!e),!e)))}),[c]),w=(0,l.useCallback)((t=>{t.stopPropagation(),m||g(!0),s&&r&&r(e)}),[m,s,r,e]);return n().createElement(E,{width:"fill","data-testid":`folder-accordion-root-${e.id}`},n().createElement(C,{orientation:"horizontal",width:"fill",height:"fit",mainAlignment:"space-between",padding:"small",onClick:w,background:i===e.id?"highlight.active":"gray6",active:i===e.id},n().createElement(o.Container,{orientation:"horizontal",width:"fill",mainAlignment:"flex-start"},n().createElement(o.Padding,{horizontal:"small"},n().createElement(o.Avatar,{label:h,size:"medium"})),n().createElement(o.Tooltip,{label:h,placement:"right",maxWidth:"100%"},n().createElement(o.Text,null,h))),n().createElement(o.Padding,{right:"small"},n().createElement(o.IconButton,{customSize:{iconSize:"large",paddingSize:0},onClick:b,icon:m?"ChevronUp":"ChevronDown"}))),n().createElement(o.Collapse,{crossSize:"100%",orientation:"vertical",open:m,disableTransition:!1},n().createElement(o.ListV2,null,t.map((e=>n().createElement(k,{key:e.id,selected:i===e.id,active:i===e.id},(t=>t?n().createElement(y,{"data-testid":`folder-accordion-item-${e.id}`,folder:e,onFolderSelected:r}):n().createElement(f,null))))))))},T=({roots:e,onFolderSelected:t,selectedFolderId:a,allowRootSelection:l})=>n().createElement(o.Container,{orientation:"vertical",style:{overflowY:"auto"}},e.map(((e,o)=>n().createElement(v,{key:e.id,folder:e,childrenFolders:e.children,isOpen:!0,onFolderSelected:t,selectedFolderId:a,allowRootSelection:l}))));var A=a(5302);const S=s()(o.Container).withConfig({displayName:"folder-tree-selector__ScrollableContainer",componentId:"sc-eq9ovx-0"})(["overflow-y:auto;display:block;"]),_=(e,t,a)=>{const l=[];return(0,g.sO)(t).forEach((t=>{!1===a?.showTrashFolder&&((0,u.vF)(t.id)||(0,u.iQ)({folder:t}))||!1===a?.showLinkedFolders&&(0,u.PJ)(t)||(a?.excludeIds&&a?.excludeIds.includes(t.id)||l.push({...t,name:(0,p.k0)(e,t.id,t.name),children:[]}),t.children&&l.push(..._(e,t.children,a)))})),l};function x(e,t){return(0,r.filter)(e,(e=>{const a=e.name?.toLowerCase();return(0,r.startsWith)(a,t.toLowerCase())}))}const M=({inputLabel:e,onNewFolderClick:t,selectedFolderId:a,onFolderSelected:r,allowRootSelection:i,allowFolderCreation:s,showTrashFolder:d,showSharedAccounts:m,showLinkedFolders:g,excludeIds:p})=>{const[h]=(0,c.useTranslation)(),[b,f]=(0,l.useState)(""),E=(0,A.a4)(a??""),C=(0,A.sW)(),w=(0,l.useMemo)((()=>m?C:C.filter((e=>(0,u.bp)(e.id)))),[C,m]),k=(0,l.useMemo)((()=>((e,t,a)=>t.map((t=>({...t,children:_(e,t.children,a)}))))(h,w,{showTrashFolder:d,showLinkedFolders:g,excludeIds:p})),[p,w,g,d,h]),y=function(e,t){return e.reduce(((e,a)=>((0,u.jX)(a.id)&&e.push({...a,children:a.children?x(a.children,t):[]}),e.filter((e=>!!e.children?.length)))),[])}(k,b),v=E?E.name:"";return n().createElement(n().Fragment,null,n().createElement(o.Input,{"data-testid":"folder-name-filter",inputName:v,label:e??h("label.filter_folders","Filter folders"),backgroundColor:"gray5",value:b,onChange:e=>f(e.target.value)}),n().createElement(S,{height:"auto",orientation:"vertical",mainAlignment:"flex-start",minHeight:"30vh",maxHeight:"60vh"},n().createElement(T,{roots:y,onFolderSelected:r,selectedFolderId:a,allowRootSelection:i})),t&&n().createElement(o.Container,{padding:{top:"medium",bottom:"medium"},mainAlignment:"center",crossAlignment:"flex-start"},n().createElement(o.Button,{type:"ghost",label:h("label.new_folder","New Folder"),color:"primary",onClick:t})))}},8585:(e,t,a)=>{a.d(t,{n:()=>i});var l=a(7559),n=a.n(l),o=a(4702),r=a(8153),c=a(7125);const i=({mode:e="move",contacts:t,onClose:a,onMove:i})=>{const[s]=(0,r.useTranslation)(),[d,m]=(0,l.useState)(),u=(0,l.useMemo)((()=>"restore"===e?1===t.length?s("contact.modal.restore_single.title",{contactDesc:`${t[0].firstName} ${t[0].lastName}`,defaultValue:"Restore {{contactDesc}}'s contact"}):s("contact.modal.restore_multiple.title",{count:t.length,defaultValue:"Restore {{count}} contacts"}):1===t.length?s("contact.modal.move_single.title",{contactDesc:`${t[0].firstName} ${t[0].lastName}`,defaultValue:"Move {{contactDesc}}'s contact"}):s("contact.modal.move_multiple.title",{count:t.length,defaultValue:"Move {{count}} contacts"})),[t,e,s]),g=(0,l.useMemo)((()=>"restore"===e?s("label.restore","Restore"):s("label.move","Move")),[e,s]),p=(0,l.useMemo)((()=>void 0===d),[d]),h=(0,l.useMemo)((()=>{const e=new Set(t.map((e=>e.parent)));return e.size>1?[]:Array.from(e.values())}),[t]),b=(0,l.useCallback)((()=>{d&&i(d.id)}),[i,d]),f=(0,l.useCallback)((e=>{m(e)}),[]);return n().createElement(n().Fragment,null,n().createElement(o.ModalHeader,{title:u,onClose:a,showCloseIcon:!0}),n().createElement(o.Divider,null),n().createElement(o.Padding,{vertical:"medium"},n().createElement(o.Container,{gap:"0.5rem",mainAlignment:"flex-start",crossAlignment:"flex-start",height:"fit"},n().createElement(c.Q,{onFolderSelected:f,showSharedAccounts:!0,showTrashFolder:!1,showLinkedFolders:!0,excludeIds:h,allowRootSelection:!1,allowFolderCreation:!1}))),n().createElement(o.Divider,null),n().createElement(o.ModalFooter,{confirmLabel:g,confirmDisabled:p,onConfirm:b}))}},9518:(e,t,a)=>{a.d(t,{dk:()=>s,fX:()=>i,sO:()=>c});var l=a(4577),n=a(2509),o=a(2816);const r=e=>{const{id:t,zid:a}=(0,o.wL)(e.id);if((0,o.jX)(e.id))return null===a?"0100":`0500-${e.name.toLowerCase()}`;if((0,o.PJ)(e))return`5000-${e.name.toLowerCase()}`;switch(t){case l.FOLDERS.CONTACTS:return"1000";case l.FOLDERS.AUTO_CONTACTS:return"2000";case l.FOLDERS.TRASH:return"4000";default:return`3000-${e.name.toLowerCase()}`}},c=(e,t)=>(0,n.sortBy)(e,t??r).map((e=>({...e,children:c(e.children,t)}))),i=e=>{const{id:t}=(0,o.wL)(e.id);if(t&&(0,o.jX)(t))return null;switch(t){case l.FOLDERS.CONTACTS:return"PersonOutline";case l.FOLDERS.AUTO_CONTACTS:return"EmailOutline";case l.FOLDERS.TRASH:return"Trash2Outline";default:return"FolderOutline"}},s=e=>e.color?l.ZIMBRA_STANDARD_COLORS[e.color].hex:l.ZIMBRA_STANDARD_COLORS[0].hex},2354:(e,t,a)=>{a.d(t,{qQ:()=>A,TL:()=>S,wA:()=>C,VZ:()=>w,kv:()=>_,nK:()=>x}),a(3619);var l=a(7559),n=a.n(l),o=a(4702),r=a(4577),c=a(2509),i=a(8153),s=a(7848),d=a(9602),m=a(9967);let u=function(e){return e.NEW="new",e.DELETE="delete",e.EDIT="edit",e.APPLY="apply",e}({});var g=a(6317),p=a(9767),h=a(4743);const b=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+/,f=({onClose:e,editMode:t=!1,tag:a,contact:c})=>{const m=(0,o.useSnackbar)(),[u]=(0,i.useTranslation)(),[f,E]=(0,l.useState)(a?.name||""),[C,w]=(0,l.useState)(a?.color||0),k=(0,s.j)(),y=(0,l.useMemo)((()=>t?u("label.edit_tag_name",{name:a?.name,defaultValue:'Edit "{{name}}" tag'}):u("label.create_tag","Create a new Tag")),[t,u,a?.name]),v=(0,l.useMemo)((()=>u("label.tag_name","Tag name")),[u]),T=(0,l.useCallback)((e=>w(Number(e))),[]),A=(0,l.useCallback)((e=>E(e.target.value)),[]),S=(0,l.useMemo)((()=>f.length>=128),[f]),_=(0,l.useMemo)((()=>b.test(f)),[f]),x=(0,l.useMemo)((()=>S||_),[S,_]),M=(0,l.useMemo)((()=>""===f||x),[f,x]),R=(0,l.useCallback)((({id:e,tagName:t})=>{k((0,d.H)({op:"tag",contactsIDs:[e],tagName:t})).then((()=>{m({key:"tag",replace:!0,hideButton:!0,type:"info",label:u("snackbar.tag_applied",{tag:t,defaultValue:'"{{tag}}" tag applied'}),autoHideTimeout:3e3})})).catch((()=>{m({key:"tag",replace:!0,type:"error",label:u("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})}))}),[m,k,u]),O=(0,l.useCallback)((()=>(0,r.createTag)({name:f,color:C}).then((t=>{t.tag&&(c?R({id:c.id,tagName:t.tag?.[0]?.name}):m({key:"new-tag",replace:!0,type:"info",label:u("messages.snackbar.tag_created",{name:f,defaultValue:"Tag {{name}} successfully created"}),autoHideTimeout:3e3,hideButton:!0})),e()}))),[f,C,e,c,R,m,u]),I=(0,l.useCallback)((()=>{Promise.all([(0,r.renameTag)(`${a?.id}`,f),(0,r.changeTagColor)(`${a?.id}`,Number(C))]).then((()=>{e(),m({key:"update-tag",replace:!0,type:"info",label:u("messages.snackbar.tag_updated","Tag successfully updated"),autoHideTimeout:3e3,hideButton:!0})})).catch((()=>{e(),m({key:"update-tag-error",replace:!0,type:"error",label:u("messages.snackbar.tag_not_updated","Something went wrong, tag not updated. Please try again."),autoHideTimeout:3e3,hideButton:!0})}))}),[C,m,f,e,u,a]);return n().createElement(n().Fragment,null,n().createElement(h.r,{onClose:e,title:y}),n().createElement(o.Input,{label:v,value:f,onChange:A,backgroundColor:"gray5",textColor:x?"error":"text",hasError:x}),x&&n().createElement(o.Padding,{all:"small"},S&&n().createElement(o.Text,{size:"extrasmall",color:"error",overflow:"break-word"},u("label.tag_max_length","Max 128 characters are allowed")),_&&n().createElement(o.Text,{size:"extrasmall",color:"error",overflow:"break-word"},u("label.no_special_char_allowed","Name should not contain any special character"))),n().createElement(o.Padding,{top:"small"}),n().createElement(g.qy,{onChange:T,label:u("label.select_color","Select Color"),defaultColor:C}),n().createElement(p.A,{onConfirm:t?I:O,label:t?u("label.edit","edit"):u("label.create","Create"),disabled:M}))},E=({onClose:e,tag:t})=>{const a=(0,o.useSnackbar)(),[c]=(0,i.useTranslation)(),s=(0,l.useMemo)((()=>c("label.delete_tag_name",{name:t?.name,defaultValue:'Delete "{{name}}" tag'})),[c,t?.name]),d=(0,l.useCallback)((()=>{(0,r.deleteTag)(t?.id).then((l=>{l.action&&a({key:"delete-tag",replace:!0,type:"success",label:c("messages.snackbar.tag_deleted",{name:t?.name,defaultValue:"{{name}} Tag deleted successfully"}),autoHideTimeout:3e3,hideButton:!0}),e()}))}),[a,e,c,t]);return n().createElement(n().Fragment,null,n().createElement(h.r,{onClose:e,title:s}),n().createElement(o.Container,{padding:{horizontal:"large"}},n().createElement(o.Text,null,c("message.delete_tag_message1",{name:t?.name,defaultValue:'Are you sure to delete "{{name}}" Tag?'})),n().createElement(o.Text,{overflow:"break-word",style:{textAlign:"center"}},c("message.delete_tag_message2","Once deleted, it will be removed from every item marked with it."))),n().createElement(p.A,{onConfirm:d,label:c("label.delete","Delete"),disabled:!1,background:"error"}))},C=({t:e,context:t,contact:a})=>({id:u.NEW,icon:"TagOutline",label:e("label.create_tag","Create Tag"),onClick:e=>{e&&e.stopPropagation();const l=t.createModal({children:n().createElement(m.tv,null,n().createElement(f,{onClose:()=>l(),contact:a}))},!0)}}),w=({t:e,createModal:t})=>({id:u.NEW,icon:"TagOutline",label:e("label.create_tag","Create Tag"),onClick:e=>{e&&e.stopPropagation();const a=t({children:n().createElement(m.tv,null,n().createElement(f,{onClose:()=>a()}))},!0)}}),k=({t:e,createModal:t,tag:a})=>({id:u.EDIT,icon:"Edit2Outline",label:e("label.edit_tag","Edit Tag"),onClick:e=>{e&&e.stopPropagation();const l=t({children:n().createElement(m.tv,null,n().createElement(f,{onClose:()=>l(),tag:a,editMode:!0}))},!0)}}),y=({t:e,createModal:t,tag:a})=>({id:u.DELETE,icon:"Untag",label:e("label.delete_tag","Delete Tag"),onClick:e=>{e&&e.stopPropagation();const l=t({children:n().createElement(m.tv,null,n().createElement(E,{onClose:()=>l(),tag:a}))},!0)}}),v=({tag:e,contact:t})=>{const[a]=(0,i.useTranslation)(),m=(0,o.useSnackbar)(),u=(0,s.j)(),[g,p]=(0,l.useState)((0,c.includes)(t.tags,e.id)),[h,b]=(0,l.useState)(!1),f=(0,l.useCallback)((l=>{p((e=>!e)),u((0,d.H)({op:l?"!tag":"tag",contactsIDs:[t.id],tagName:e.name})).then((t=>{t.type.includes("fulfilled")?m({key:"tag",replace:!0,hideButton:!0,type:"info",label:l?a("snackbar.tag_removed",{tag:e.name,defaultValue:'"{{tag}}" tag removed'}):a("snackbar.tag_applied",{tag:e.name,defaultValue:'"{{tag}}" tag applied'}),autoHideTimeout:3e3}):m({key:"tag",replace:!0,type:"error",label:a("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})}))}),[t.id,m,u,a,e.name]),E=(0,l.useMemo)((()=>r.ZIMBRA_STANDARD_COLORS[e.color||0].hex),[e.color]),C=(0,l.useMemo)((()=>g?"Tag":"TagOutline"),[g]),w=(0,l.useMemo)((()=>g?"Untag":"Tag"),[g]);return n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start",onClick:()=>f(g),onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1)},n().createElement(o.Padding,{right:"small"},n().createElement(o.Checkbox,{value:g})),n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},n().createElement(o.Text,null,e.name)),n().createElement(o.Row,{mainAlignment:"flex-end"},n().createElement(o.Icon,{icon:h?w:C,color:E}))))},T=({tag:e,ids:t,tags:a,contacts:m,deselectAll:u,folderId:g})=>{const[p]=(0,i.useTranslation)(),h=(0,o.useSnackbar)(),b=(0,s.j)(),[f,E]=(0,l.useState)(!1),C=(0,c.reduce)(a,((e,t)=>{const a=(0,c.map)(m,(e=>(0,c.includes)(e.tags,t.id)));return(0,c.every)(a)&&e.push(t.id),e}),[]),[w,k]=(0,l.useState)((0,c.includes)(C,e.id)),y=(0,l.useCallback)((a=>{k((e=>!e)),b((0,d.H)({op:a?"!tag":"tag",contactsIDs:t,tagName:e.name})).then((t=>{t.type.includes("fulfilled")?(u&&u(),(0,r.replaceHistory)(`/folder/${g}/`),h({key:"tag",replace:!0,hideButton:!0,type:"info",label:a?p("snackbar.tag_removed",{tag:e.name,defaultValue:'"{{tag}}" tag removed'}):p("snackbar.tag_applied",{tag:e.name,defaultValue:'"{{tag}}" tag applied'}),autoHideTimeout:3e3})):h({key:"tag",replace:!0,type:"error",label:p("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})}))}),[b,t,e.name,u,g,h,p]),v=(0,l.useMemo)((()=>w?"Tag":"TagOutline"),[w]),T=(0,l.useMemo)((()=>w?"Untag":"Tag"),[w]),A=(0,l.useMemo)((()=>r.ZIMBRA_STANDARD_COLORS[e.color||0].hex),[e.color]);return n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start",onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),onClick:e=>{e.preventDefault(),y(w)}},n().createElement(o.Padding,{right:"small"},n().createElement(o.Checkbox,{value:w})),n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},n().createElement(o.Text,null,e.name)),n().createElement(o.Row,{mainAlignment:"flex-end"},n().createElement(o.Icon,{icon:f?T:v,color:A}))))},A=({t:e,tags:t,ids:a,contacts:l,deselectAll:r,folderId:i})=>{const s=(0,c.reduce)(t,((e,o)=>{const c={id:o.id,label:o.name,icon:"TagOutline",keepOpen:!0,customComponent:n().createElement(T,{tag:o,tags:t,ids:a,contacts:l,deselectAll:r,folderId:i})};return e.push(c),e}),[]);return{id:u.APPLY,items:s,customComponent:n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},n().createElement(o.Padding,{right:"small"},n().createElement(o.Icon,{icon:"TagsMoreOutline"})),n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Padding,{right:"small"},n().createElement(o.Text,null,e("label.tags","Tags")))))}},S=({t:e,contact:t,tags:a,context:l})=>{const r=(0,c.reduce)(a,((e,a)=>{const l={id:a.id,label:a.name,icon:"TagOutline",keepOpen:!0,customComponent:n().createElement(v,{tag:a,contact:t})};return e.push(l),e}),[]),i={id:"new_tag",keepOpen:!0,customComponent:n().createElement(o.Button,{label:e("label.new_tag","New Tag"),type:"outlined",width:"fill",size:"small",onClick:()=>l.createAndApplyTag({t:e,context:l,contact:t}).onClick()})};return r.push(i),{id:u.APPLY,items:r,label:e("label.tag","Tag"),icon:"TagsMoreOutline",customComponent:n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},n().createElement(o.Padding,{right:"small"},n().createElement(o.Icon,{icon:"TagsMoreOutline"})),n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Padding,{right:"small"},n().createElement(o.Text,null,e("label.tags","Tags")))))}},_=({tag:e,t})=>{const a=(0,o.useModal)(),n=(0,o.useSnackbar)();return(0,l.useMemo)((()=>[w({t,createModal:a}),k({t,createModal:a,tag:e}),y({t,tag:e,createSnackbar:n,createModal:a})]),[a,n,t,e])},x=e=>{const t=(()=>{const e=(0,r.useTags)();return(0,l.useMemo)((()=>(0,c.reduce)(e,((e,t)=>(e.push(t),e)),[])),[e])})();return(0,l.useMemo)((()=>(0,c.reduce)(e,((e,a)=>{let l=!1;return(0,c.find)(t,{id:a?.id})&&(l=!0),l}),!1)),[e,t])}},9767:(e,t,a)=>{a.d(t,{A:()=>r});var l=a(7559),n=a.n(l),o=a(4702);const r=({mainAlignment:e="center",crossAlignment:t="center",onConfirm:a,label:l,secondaryAction:r,secondaryLabel:c="Cancel",primaryBtnType:i="default",secondaryBtnType:s="default",disabled:d,secondaryDisabled:m,background:u="primary",secondarybackground:g,color:p="primary",secondaryColor:h="secondary",size:b="small",showDivider:f=!0,tooltip:E,secondaryTooltip:C})=>n().createElement(o.Container,{mainAlignment:e,crossAlignment:t,padding:{top:"medium"}},f&&n().createElement(o.Divider,null),n().createElement(o.Container,{orientation:"horizontal",padding:{top:"medium"},mainAlignment:"flex-end",crossAlignment:"flex-end"},r&&n().createElement(o.Padding,{right:"small",vertical:"small"},C?n().createElement(o.Tooltip,{label:C,placement:"top",maxWidth:"fit"},n().createElement(o.Button,{backgroundColor:g,color:h,type:s,onClick:r,label:c,disabled:m,size:b})):n().createElement(o.Button,{backgroundColor:g,color:h,type:s,onClick:r,label:c,disabled:m,size:b})),n().createElement(o.Padding,{vertical:"small"},E?n().createElement(o.Tooltip,{label:E,placement:"top",maxWidth:"fit"},n().createElement(o.Button,{size:b,color:p,onClick:a,label:l,type:i,disabled:d,backgroundColor:u})):n().createElement(o.Button,{size:b,color:p,onClick:a,label:l,type:i,disabled:d,backgroundColor:u}))))},4743:(e,t,a)=>{a.d(t,{r:()=>r});var l=a(7559),n=a.n(l),o=a(4702);const r=({title:e,onClose:t})=>n().createElement(o.Row,{orientation:"horizontal",mainAlignment:"space-between",takeAvailableSpace:!0,width:"100%"},n().createElement(o.Text,{weight:"bold",size:"large"},e),n().createElement(o.IconButton,{size:"medium",style:{padding:0,margin:0},onClick:t,icon:"CloseOutline"}),n().createElement(o.Divider,null),n().createElement(o.Padding,{bottom:"medium"}))}}]);
//# sourceMappingURL=473.6a5ec307.chunk.js.map