"use strict";(self.webpackChunkcarbonio_calendars_ui=self.webpackChunkcarbonio_calendars_ui||[]).push([[38],{45859:(e,t,a)=>{a.d(t,{j:()=>n});var l=a(6017);const n=()=>{const{prefs:e}=(0,l.useUserSettings)();return e}},73459:(e,t,a)=>{a.d(t,{V:()=>c,a:()=>m});var l=a(85583),n=a(6017),r=a(80781);const o=(0,l.createAsyncThunk)("appointment/create new appointment",(async({draft:e,editor:t},{rejectWithValue:a})=>{if(t){const l=(0,r.Mq)({...t,draft:e}),o=await(0,n.soapFetch)("CreateAppointment",l),i=o?.Fault?{...o.Fault,error:!0}:o;return i?.error?a(i):{response:o,editor:{...t,isNew:!1,isSeries:!!t.recur,isInstance:!t.recur,isException:!1,inviteId:o.invId}}}}));var i=a(74713),s=a(98764),d=a(89458);const c=({draft:e=!0,isNew:t=!0,editor:a,dispatch:l})=>t?(({draft:e,editor:t,dispatch:a})=>a(o({draft:e,editor:t})).then((({payload:e})=>{const{response:t}=e;return e?.response&&a((0,d.C)({id:e.editor.id,editor:e.editor})),Promise.resolve({response:t,editor:e.editor})})))({draft:e,editor:a,dispatch:l}):(({draft:e,editor:t,dispatch:a})=>a((0,i.Q)({draft:e,editor:t})).then((({payload:e})=>{const{response:t,error:l}=e;return t&&!l?(a((0,d.C)({id:e.editor.id,editor:e.editor})),Promise.resolve({response:t,editor:e.editor})):Promise.resolve(e)})))({draft:e,editor:a,dispatch:l}),m=({isNew:e,editor:t,dispatch:a})=>t?.isProposeNewTime?(async({editorId:e,dispatch:t})=>t((0,s.k)({id:e})).then((({payload:a})=>{if(a){const{response:l,editor:n,error:r}=a;if(l&&!r)return t((0,d.C)({id:e,editor:n})),Promise.resolve({response:l,editor:n})}return Promise.resolve(a)})))({editorId:t.id,dispatch:a}):c({draft:!1,isNew:e,editor:t,dispatch:a})},97147:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M:()=>uploadParts});var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(51235),lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__),_utilities__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2244);const uploadParts=async files=>Promise.all((0,lodash__WEBPACK_IMPORTED_MODULE_0__.map)(files,(file=>fetch("/service/upload?fmt=extended,raw",{headers:{"Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest","Content-Type":`${file.type||"application/octet-stream"};`,"Content-Disposition":`attachment; filename="${(0,_utilities__WEBPACK_IMPORTED_MODULE_1__.QR)(file.name)}"`},method:"POST",body:file}).then((e=>e.text())).then((txt=>eval(`[${txt}]`))).then((e=>e[2][0])))))},22797:(e,t,a)=>{a.d(t,{C:()=>n});var l=a(51235);const n=e=>(0,l.sortBy)((0,l.map)(e?.split(","),(e=>({day:e.split(":")[0],working:"N"!==e.split(":")[1],start:e.split(":")[2],end:e.split(":")[3]}))),"day")},49066:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ft});var l=a(92652),n=a.n(l),r=a(6017),o=a(97363),i=a(51235),s=a(91750),d=a.n(s);const c=d()(o.IconCheckbox).withConfig({displayName:"editor-styled-components__ResizedIconCheckbox",componentId:"sc-dzce8q-0"})(["[class^='Padding__Comp']{padding:0.375rem;svg{height:1.25rem;width:1.25rem;fill:"," background:",";border-radius:50%;}"],(({disabled:e,theme:t,value:a})=>e?t.palette.secondary.disabled:a?t.palette.gray6.regular:t.palette.currentColor.regular),(({value:e,theme:t})=>e?t.palette.primary.regular:t.palette.currentColor.regular));var m=a(97147),u=a(68242),b=a(11584),h=a(89458),p=a(750),g=a.n(p);const f=d().input.withConfig({displayName:"editor-attachments-button__FileInput",componentId:"sc-1cbx9vd-0"})(["display:none;"]),y=({editorId:e})=>{const t=(0,l.useRef)(null),[a,s]=(0,l.useState)(!1),d=(0,u.C)((0,b.Z5)(e)),p=(0,u.C)((0,b.V5)(e)),y=(0,u.C)((0,b.JN)(e)),v=(0,u.C)((0,b.BG)(e)),E=(0,u.T)(),C=(0,l.useCallback)((()=>{s(!1),t.current&&t.current.click()}),[]),[w,_]=(({editorId:e})=>{const[t,a]=(0,r.useIntegratedFunction)("get-link"),n=(0,o.useSnackbar)(),s=(0,u.C)((0,b.a4)(e)),d=(0,u.C)((0,b.dm)(e)),c=(0,u.C)((0,b.Qt)(e)),m=(0,u.T)(),p=(0,l.useMemo)((()=>(0,r.t)("label.public_link_description",{title:c,date:g()().format("yyyy-MM-DD_hh:mm"),defaultValue:"Generated from {{title}} on {{date}}"})),[c]);return[(0,l.useCallback)((a=>{const l=(0,i.map)(a,(e=>t({node:e,type:"createLink",description:p})));Promise.allSettled(l).then((t=>{const a=(0,i.filter)(t,["status","fulfilled"]),l=t.length===a?.length,o=t.length===(0,i.filter)(t,["status","rejected"])?.length,c=l?"info":"warning",u=l?(0,r.t)("message.snackbar.all_link_copied","Public link copied successfully"):o?(0,r.t)("message.snackbar.link_copying_error","There seems to be a problem while generating public link, please try again"):(0,r.t)("message.snackbar.some_link_copying_error","There seems to be a problem while generating public url for some files, please try again");n({key:"public-link",replace:!0,type:c,hideButton:!0,label:u,autoHideTimeout:4e3});const b=[(0,i.map)(a,(e=>e.value.url)).join("\n").concat(`\n${d}`),` ${(0,i.map)(a,(e=>`<p><a href="${e.value.url}"> ${e.value.url}</a></p>`)).join("")}`.concat(s)];m((0,h.Yj)({id:e,richText:b[0],plainText:b[1]}))}))}),[t,p,n,d,s,m,e]),a]})({editorId:e}),[k,x]=(({editorId:e})=>{const t=(0,o.useSnackbar)(),a=(0,u.C)((0,b.Z5)(e)),n=(0,u.C)((0,b.JN)(e)),[s,d]=(0,r.useIntegratedFunction)("upload-to-target-and-get-target-id"),c=(0,u.T)(),m=(0,l.useCallback)((l=>{const o=(0,i.map)(l,(e=>(async(e,t)=>({res:await t({nodeId:e.id,targetModule:"CALENDARS"}),node:e}))(e,s)));d&&Promise.allSettled(o).then((l=>{const o=(0,i.filter)(l,["status","fulfilled"]),s=l.length===o?.length,d=l.length===(0,i.filter)(l,["status","rejected"])?.length,m=s?"info":"warning",u=s?(0,r.t)("message.snackbar.all_att_added","Attachments added successfully"):d?(0,r.t)("message.snackbar.att_err_adding","There seems to be a problem when adding attachments, please try again"):(0,r.t)("message.snackbar.some_att_add_fails","There seems to be a problem when adding some attachments, please try again");t({key:"calendar-moved-root",replace:!0,type:m,hideButton:!0,label:u,autoHideTimeout:4e3});const b=(0,i.map)(o,(e=>({contentType:e.value.node.mime_type,disposition:"attachment",filename:e.value.node.name,name:void 0,size:e.value.node.size,aid:e.value.res.attachmentId}))),p=[...a??[],...b];c((0,h.nX)({id:e,attach:{aid:(0,i.map)(o,(e=>e.value.res.attachmentId)),mp:n},attachmentFIles:p}))}))}),[a,t,c,e,d,n,s]);return[m,d]})({editorId:e}),T=(0,l.useMemo)((()=>({title:(0,r.t)("label.choose_file","Choose file"),confirmAction:w,confirmLabel:(0,r.t)("label.share_public_link","Share Public Link"),allowFiles:!0,allowFolders:!1})),[w]),[A,I]=(0,r.getIntegratedFunction)("select-nodes"),z=(0,l.useMemo)((()=>({label:(0,r.t)("composer.attachment.url","Add public link from Files"),icon:"Link2",id:"carbonio_files_action_link",disabled:!I||!_,onClick:()=>{s(!1),A&&A(T)}})),[T,A,I,_]),M=(0,l.useMemo)((()=>({title:(0,r.t)("label.choose_file","Choose file"),confirmAction:k,confirmLabel:(0,r.t)("label.select","Select"),allowFiles:!0,allowFolders:!1})),[k]),S=(0,l.useMemo)((()=>({label:(0,r.t)("composer.attachment.files","Add from Files"),icon:"DriveOutline",id:"carbonio_files_action",disabled:!I||!x,onClick:()=>{s(!1),A&&A(M)}})),[M,A,I,x]),R=(0,l.useMemo)((()=>[{id:"localAttachment",icon:"MonitorOutline",label:(0,r.t)("composer.attachment.local","Add from local"),onClick:C,customComponent:n().createElement(n().Fragment,null,n().createElement(o.Icon,{icon:"MonitorOutline",size:"medium"}),n().createElement(o.Padding,{horizontal:"extrasmall"}),n().createElement(o.Text,null,(0,r.t)("composer.attachment.local","Add from local")))},{...S,id:S.id??""},{...z,id:z.id??""}]),[C,S,z]),P=(0,l.useCallback)((()=>{t?.current?.files&&(async(e,t,a)=>({payload:await(0,m.M)(a),mp:t,files:a}))(0,y,t.current.files).then((({payload:t,mp:a})=>{const l=(0,i.map)(t,(e=>({contentType:e.ct,disposition:"attachment",filename:e.filename,name:void 0,size:e.s,aid:e.aid}))),n=[...d??[],...l];E((0,h.nX)({id:e,attach:{aid:(0,i.union)(p,(0,i.map)(t,(e=>e.aid))),mp:a},attachmentFiles:n}))}))}),[e,y,d,E,p]);return n().createElement(n().Fragment,null,n().createElement(o.Tooltip,{label:(0,r.t)("tooltip.add_attachments","Add attachments")},n().createElement(o.Dropdown,{items:R,display:"inline-block",width:"fit",forceOpen:a},n().createElement(c,{onChange:()=>null,icon:"AttachOutline",onClick:()=>s(!a),value:a,disabled:v?.attachmentsButton}))),n().createElement(f,{type:"file",ref:t,onChange:P,multiple:!0}))},v=({editorId:e})=>{const t=(0,u.C)((0,b.gC)(e)),a=(0,u.C)((0,b.BG)(e)),i=(0,u.T)(),s=(0,l.useCallback)((()=>{i((0,h.vF)({id:e,isRichText:!t}))}),[i,e,t]);return n().createElement(o.Tooltip,{label:(0,r.t)("tooltip.enable_disable_rich_text","Enable/Disable rich text editor")},n().createElement(c,{icon:"Text",value:t,onClick:s,onChange:()=>null,disabled:a?.richTextButton}))};var E=a(93747),C=a(73459),w=a(59379),_=a(37312),k=a(18671);const x=({onClose:e,action:t,isSending:a=!1,isNew:i,editorId:s,editor:d})=>{const c=(0,l.useMemo)((()=>(0,r.t)("message.edit_series_warning","As you proceed with the series modification, all previously deleted or modified instances will be restored with the new series settings.")),[]),m=(0,r.useBoard)(),h=(0,u.C)((0,b.dE)(s))?.length,p=(0,u.C)((0,b.l_)(s))?.length,g=(0,u.C)((0,b.tl)(s))?.length,f=(0,u.T)(),y=(0,o.useSnackbar)(),v=(0,l.useMemo)((()=>(0,r.t)("label.warning","Warning")),[]),E=(0,l.useMemo)((()=>(0,r.t)("label.continue","Continue")),[]),C=(0,l.useMemo)((()=>(0,r.t)("label.discard_changes","Discard Changes")),[]),w=(0,l.useCallback)((()=>{a?t({isNew:i,editor:d,dispatch:f}).then((({response:t})=>{y({key:"calendar-moved-root",replace:!0,type:t?"info":"warning",hideButton:!0,label:t?(0,r.t)("message.appointment_invitation_sent","Appointment invitation sent"):(0,r.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3}),e()})):t({draft:!!h||!!p||!!g,isNew:i,editor:d,dispatch:f}).then((({response:t})=>{y({key:"calendar-moved-root",replace:!0,type:t?"info":"warning",hideButton:!0,label:t?(0,r.t)("message.snackbar.calendar_edits_saved","Edits saved correctly"):(0,r.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3}),e()}))}),[t,h,y,f,d,g,i,a,p,e]),x=(0,l.useCallback)((()=>{e(),m&&(0,r.closeBoard)(m?.id)}),[m,e]);return n().createElement(o.Container,{padding:{all:"large"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(k.x,{title:v,onClose:e}),n().createElement(o.Container,{padding:{top:"large",bottom:"large"},crossAlignment:"flex-start"},n().createElement(o.Text,{overflow:"break-word"},c)),n().createElement(_.Z,{onConfirm:w,label:E,secondaryAction:x,secondaryLabel:C,secondaryBtnType:"outlined",secondaryColor:"primary",additionalAction:e}))},T=({editorId:e})=>{const t=(0,u.C)((0,b.Qt)(e)),a=(0,u.C)((0,b.Dg)(e)),r=(0,u.C)((0,b.sw)(e)),i=(0,o.useModal)(),s=(0,o.useSnackbar)(),d=(0,u.C)((0,b.BG)(e)),c=(0,u.C)((0,b.dE)(e))?.length,m=(0,u.C)((0,b.l_)(e))?.length,h=(0,u.C)((0,b.tl)(e))?.length,[p]=(0,E.useTranslation)(),g=(0,u.T)(),f=(0,l.useCallback)((()=>{if(!r.isSeries||a||r.isInstance)(0,C.V)({draft:!!c||!!m||!!h,isNew:a,editor:r,dispatch:g}).then((({response:e})=>{s({key:"calendar-moved-root",replace:!0,type:e?"info":"warning",hideButton:!0,label:e?p("message.snackbar.calendar_edits_saved","Edits saved correctly"):p("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3})}));else{const t=i({size:"large",children:n().createElement(w.g,null,n().createElement(x,{action:C.V,isSending:!1,onClose:()=>t(),isNew:a,editorId:e,editor:r})),onClose:()=>{t()}},!0)}}),[r,a,i,e,c,m,h,g,s,p]);return n().createElement(o.Button,{label:p("label.save","Save"),icon:"SaveOutline",disabled:d?.saveButton||!t?.length,onClick:f,type:"outlined"})},A=({editorId:e})=>{const t=(0,u.C)((0,b.dE)(e)),a=(0,u.C)((0,b.Qt)(e)),i=(0,u.C)((0,b.UR)(e)),s=(0,u.C)((0,b.l_)(e)),d=(0,u.C)((0,b.tl)(e)),c=(0,u.C)((0,b.Dg)(e)),m=(0,u.C)((0,b.sw)(e)),h=(0,o.useModal)(),p=(0,o.useSnackbar)(),g=(0,u.C)((0,b.BG)(e)),[f]=(0,E.useTranslation)(),y=(0,r.useBoard)(),v=(0,u.T)(),_=(0,l.useMemo)((()=>g?.sendButton||!t?.length&&!i?.length&&!s?.length&&!d?.length||!a?.length),[t?.length,g?.sendButton,d?.length,s?.length,i?.length,a?.length]),k=(0,l.useCallback)((()=>{if(!m.isSeries||c||m.isInstance)(0,C.a)({isNew:c,editor:m,dispatch:v}).then((({response:e})=>{m?.panel&&e&&(0,r.replaceHistory)(""),y&&e&&(0,r.closeBoard)(y?.id),p({key:"calendar-moved-root",replace:!0,type:e?"info":"warning",hideButton:!0,label:e?f("message.appointment_invitation_sent","Appointment invitation sent"):f("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3})}));else{const t=h({size:"large",children:n().createElement(w.g,null,n().createElement(x,{action:C.a,isSending:!0,onClose:()=>t(),isNew:c,editorId:e,editor:m})),onClose:()=>{t()}},!0)}}),[y,h,p,v,m,e,c,f]);return n().createElement(o.Button,{label:f("action.send","Send"),icon:"PaperPlane",disabled:_,onClick:k})},I=({editorId:e})=>n().createElement(o.Row,{orientation:"horizontal",padding:{top:"small",bottom:"small"},height:"fit",width:"fill",mainAlignment:"flex-end"},n().createElement(v,{editorId:e}),n().createElement(y,{editorId:e}),n().createElement(T,{editorId:e}),n().createElement(o.Padding,{left:"medium"}),n().createElement(A,{editorId:e})),z=({editorId:e})=>{const t=(0,u.C)((0,b.TJ)(e)),a=(0,u.C)((0,b.BG)(e)),s=(0,u.T)(),d=(0,l.useCallback)((a=>{a&&s((0,h._b)({id:e,allDay:!t}))}),[t,s,e]);return(0,i.isNil)(t)?null:n().createElement(o.Checkbox,{label:(0,r.t)("label.all_day","All day"),onClick:d,value:t,disabled:a?.allDay,"data-testid":"editor-allDay"})};var M=a(34130);const S=({editorId:e})=>{const t=(0,u.C)((0,b.Z5)(e)),a=(0,u.C)((0,b.l9)(e)),r=(0,u.C)((0,b.Qt)(e))??"",o=(0,u.T)(),i=(0,l.useCallback)(((t,a)=>{o((0,h.nX)({id:e,attach:t,attachmentFiles:a}))}),[o,e]),s=(0,u.C)((0,b.BG)(e));return t?.length>0?n().createElement(M.A,{attachments:t,id:a,onAttachmentsChange:i,isEditor:!0,subject:r,disabled:s?.attachments}):null};var R=a(84974),P=a(11933);var V=a(38828);const B=d().div.withConfig({displayName:"editor-attendees__AttendeesContainer",componentId:"sc-15kamzk-0"})(["width:calc( 100% - "," );height:fit-content;background:",";border-bottom:0.0625rem solid ",";[class^='Chip__ChipComp']{[class^='Text__Comp']{color:",";}}"],(({hasTooltip:e})=>e?"3rem":"0rem"),(({theme:e})=>e.palette.gray5.regular),(({theme:e})=>e.palette.gray2.regular),(({theme:e})=>e.palette.text.regular)),N=({editorId:e})=>{const[t]=(0,E.useTranslation)(),[a,s]=(0,r.useIntegratedComponent)("contact-input"),d=(0,u.T)(),c=(0,u.C)((0,b.dE)(e)),m=(0,u.C)((0,b.KN)(e)),p=(0,u.C)((0,b.UR)(e)),g=(0,u.C)((0,b.BG)(e)),f=(0,u.C)((0,b.jJ)(e)),y=(0,u.C)((0,b.EU)(e)),v=(0,u.C)((0,b.TJ)(e)),C=(0,u.C)((0,b.Ur)(e)),w=(0,o.useSnackbar)(),[_,k]=(0,l.useState)(!!p?.length),[x,T]=(0,l.useState)([]),A=(0,l.useCallback)((()=>k((e=>!e))),[]),I=(0,V.z)(f,c,m),z=(0,l.useMemo)((()=>(0,i.some)(c??[],{error:!0})),[c]),M=(0,l.useMemo)((()=>(0,i.some)(p??[],{error:!0})),[p]);(0,l.useEffect)((()=>{(async function(e){const t=await(0,P.Q)().then((e=>{const t=[];return e?.folders&&(0,i.filter)(e.folders,["folderId",1]).forEach((e=>{e.ownerId&&e.ownerEmail&&t.push({id:e.ownerId,address:e.ownerEmail})})),t})),a=function(){const e=(0,r.getUserAccount)();if(e)return{id:e.id,address:e.name}}(),l=a?[a].concat(...t):t,n=(0,i.sortBy)(l,(t=>t.address===e?0:1));return(0,i.map)(n,(e=>e.id))})(C?C.address:"").then((e=>{T(e)})).catch((()=>{w({key:"ordered-account-ids",replace:!0,type:"error",label:t("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})}))}),[w,C,t]);const S=(0,l.useCallback)((t=>{d((0,h.vR)({id:e,attendees:t}))}),[d,e]),N=(0,l.useCallback)((t=>{d((0,h.Zl)({id:e,optionalAttendees:t}))}),[d,e]),D=(0,l.useMemo)((()=>c?.length>0?(0,i.map)(c,(e=>{const a=(0,i.find)(I,["email",e.email]),l=e.actions&&!e.error||!e.email?(0,i.reject)(e.actions,["icon","EditOutline"]):e.actions;if(a){const n=(0,R._)(a,f,y,I,v)&&!(0,i.find)(l,["id","unavailable"])?[...l??[],{id:"unavailable",label:t("attendee_unavailable","Attendee not available at the selected time of the event"),color:"error",type:"icon",icon:"AlertTriangle"}]:l;return{...e,error:!!e.email&&e.error,actions:n}}return{...e,error:!!e.email&&e.error,actions:l}})):[]),[v,c,I,y,f,t]);return n().createElement(n().Fragment,null,n().createElement(B,null,n().createElement(o.Container,{orientation:"horizontal",background:"white",style:{overflow:"hidden"},padding:{all:"none"}},n().createElement(o.Container,{background:"white",style:{overflow:"hidden"}},s?n().createElement(a,{placeholder:t("label.attendees","Attendees"),onChange:S,defaultValue:D,disabled:g?.attendees,dragAndDropEnabled:!0,orderedAccountIds:x}):n().createElement(o.ChipInput,{placeholder:t("label.attendees","Attendees"),background:"white",onChange:S,defaultValue:D,hasError:z,description:z?"":void 0,disabled:g?.attendees,style:{border:"1px solid lightgray"}})),n().createElement(o.Container,{width:"fit",background:"white",padding:{right:"medium",left:"extrasmall"},orientation:"horizontal"},n().createElement(o.Button,{label:t("label.optionals","Optionals"),type:"ghost",color:"secondary",style:{padding:0},onClick:A})))),n().createElement(R.G,{label:t("attendees_unavailable","One or more attendees are not available at the selected time of the event"),list:I,items:c,editorId:e}),_&&n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(B,null,s?n().createElement(a,{placeholder:t("label.optionals","Optionals"),onChange:N,defaultValue:p,disabled:g?.optionalAttendees,dragAndDropEnabled:!0,orderedAccountIds:x}):n().createElement(o.ChipInput,{placeholder:t("label.optionals","Optionals"),background:"white",onChange:N,defaultValue:p,hasError:M,description:M?"":void 0,disabled:g?.optionalAttendees,style:{border:"1px solid lightgray"}}))))};var D=a(7183),O=a(83201);const F=({editorId:e})=>{const t=(0,u.C)((0,b.TH)(e)),a=(0,u.C)((0,b.BG)(e)),r=(0,u.T)(),i=(0,l.useCallback)((t=>{if(t){const a=(0,O._H)(t),l={id:e,calendar:a};r((0,h.A5)(l))}}),[r,e]);return t?n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(D.g,{calendarId:t,onCalendarChange:i,disabled:a?.calendar,excludeTrash:!0})):null},q=d().textarea.withConfig({displayName:"editor-composer__TextArea",componentId:"sc-p6k21t-0"})(["box-sizing:border-box;padding:",";background:",";height:fit-content;min-height:9.375rem;flex-grow:1;width:100%;border:none;resize:none;& :focus,:active{box-shadow:none;border:none;outline:none;}"],(e=>e.theme.sizes.padding.large),(e=>e.theme.palette.gray5.regular)),U=d().div.withConfig({displayName:"editor-composer__EditorWrapper",componentId:"sc-p6k21t-1"})(["width:100%;height:100%;overflow-y:auto;position:relative;.tox .tox-editor-header{z-index:0;}> .tox:not(.tox-tinymce-inline){width:100%;border:none;.tox-editor-header{background-color:",";}.tox-toolbar__primary{background:none;background-color:",";border-radius:",";}}> .tox{.tox-edit-area{margin-left:calc(-1rem + ",");overflow-y:auto;max-height:100%;}.tox-edit-area__iframe{height:100%;padding-bottom:",";}&.tox-tinymce{height:100%;}}"],(e=>e.theme.palette.gray6.regular),(e=>e.theme.palette.gray4.regular),(e=>e.theme.borderRadius),(e=>e.theme.sizes.padding.large),(e=>e.theme.sizes.padding.large)),W=({editorId:e})=>{const t=(0,u.C)((0,b.dm)(e)),a=(0,u.C)((0,b.BG)(e)),o=(0,u.T)(),[s,d]=(0,l.useState)(t??""),c=(0,l.useMemo)((()=>(0,i.debounce)((([t,a])=>{o((0,h.Yj)({id:e,richText:a,plainText:t}))}),500,{trailing:!0,leading:!1})),[o,e]),m=(0,l.useMemo)((()=>(0,r.t)("messages.format_as_plain_text","Format as Plain Text")),[]),p=(0,l.useCallback)((e=>{d(e.target.value),c([e.target.value,e.target.value])}),[c]);return n().createElement(q,{placeholder:m,value:s,onChange:p,disabled:a?.composer,"data-testid":"editor-textArea"})},L=({Composer:e,editorId:t})=>{const a=(0,u.C)((0,b.BG)(t)),r=(0,u.C)((0,b.a4)(t)),o=(0,u.T)(),[s,d]=(0,l.useState)(r??""),c=(0,l.useMemo)((()=>(0,i.debounce)((([e,a])=>{o((0,h.Yj)({id:t,richText:a,plainText:e}))}),500,{trailing:!0,leading:!1})),[o,t]),m=(0,l.useCallback)((e=>{d(e[1]),c(e)}),[c]);return n().createElement(U,null,n().createElement(e,{onEditorChange:m,minHeight:"12.5rem",value:s,disabled:a?.composer,"data-testid":"editor-composer",customInitOptions:{auto_focus:!1}}))},j=({editorId:e})=>{const[t,a]=(0,r.useIntegratedComponent)("composer"),l=(0,u.C)((0,b.gC)(e));return n().createElement(n().Fragment,null,a&&l?n().createElement(L,{Composer:t,editorId:e}):n().createElement(W,{editorId:e}))};function $({start:e,end:t,allDay:a,diff:i,onChange:s}){const d=(0,l.useCallback)((t=>s({end:g()(t).valueOf(),start:g()(t).valueOf()>e?e:g()(t).valueOf()-i})),[s,e,i]),c=(0,l.useMemo)((()=>a?"dd/MM/yyyy":"dd/MM/yyyy HH:mm"),[a]),m=(0,l.useMemo)((()=>`${a?(0,r.t)("label.end_date","End date"):(0,r.t)("label.end_date_and_time","End date and time")}`),[a]);return n().createElement(o.DateTimePicker,{width:"100%",label:m,defaultValue:t,onChange:d,dateFormat:c,includeTime:!a})}function H({start:e,allDay:t,diff:a,onChange:i}){const s=(0,l.useCallback)((e=>{const t=g()(e).valueOf();return i({start:t,end:t+a})}),[i,a]),d=(0,l.useMemo)((()=>`${t?(0,r.t)("label.start_date","Start date"):(0,r.t)("label.start_date_and_time","Start date and time")}`),[t]),c=(0,l.useMemo)((()=>t?"dd/MM/yyyy":"dd/MM/yyyy HH:mm"),[t]);return n().createElement(o.DateTimePicker,{width:"100%",label:d,defaultValue:e,onChange:s,dateFormat:c,includeTime:!t})}const G=({editorId:e})=>{const t=(0,u.C)((0,b.TJ)(e)),a=(0,u.C)((0,b.jJ)(e)),r=(0,u.C)((0,b.EU)(e)),i=(0,l.useMemo)((()=>g()(r).diff(g()(a))),[r,a]),s=(0,u.C)((0,b.BG)(e)),d=(0,u.T)(),c=(0,l.useCallback)((({start:t,end:a})=>{d((0,h.Fy)({id:e,start:t,end:a}))}),[d,e]);return a&&r?n().createElement(n().Fragment,null,n().createElement(o.Row,{takeAvailableSpace:!0},n().createElement(H,{start:new Date(a),onChange:c,diff:i,allDay:t,disabled:s?.datePicker})),n().createElement(o.Padding,{left:"small"}),n().createElement(o.Row,{takeAvailableSpace:!0},n().createElement($,{start:a,end:new Date(r),onChange:c,diff:i,allDay:t,disabled:s?.datePicker}))):null},Y=d().div.withConfig({displayName:"editor-resource-component__SkeletonTile",componentId:"sc-jpllsr-0"})(["width:",";max-width:",";min-width:",";height:",";max-height:",";min-height:",";border-radius:",";background:",";"],(({width:e})=>e??"1rem"),(({width:e})=>e??"1rem"),(({width:e})=>e??"1rem"),(({height:e})=>e??"1rem"),(({height:e})=>e??"1rem"),(({height:e})=>e??"1rem"),(({radius:e})=>e??"0.125rem"),(({theme:e})=>e.palette.gray2.regular)),J=()=>n().createElement(o.Container,{orientation:"horizontal",mainAlignment:"flex-start",crossAlignment:"center",minWidth:"16rem",minHeight:"2rem"},n().createElement(Y,{radius:"50%",width:"2rem",height:"2rem"}),n().createElement(o.Container,{orientation:"vertical",crossAlignment:"flex-start",padding:{left:"small"}},n().createElement(Y,{radius:"0.25rem",width:9.375*Math.random()+4+"rem",height:"0.875rem",style:{marginBottom:"0.25rem"}}),n().createElement(Y,{radius:"0.25rem",width:9.375*Math.random()+4+"rem",height:"0.75rem"}))),Q=e=>({id:e.id,label:e.fileAsStr,value:e.fileAsStr,email:e._attrs.email,type:e._attrs.zimbraCalResType}),K=({editorId:e,onChange:t,placeholder:a,resourcesValue:r,onInputType:s,options:d,setOptions:c,warningLabel:m,disabled:h,singleWarningLabel:p})=>{const g=(0,l.useRef)(null),f=(0,u.C)((0,b.jJ)(e)),y=(0,u.C)((0,b.EU)(e)),v=(0,u.C)((0,b.TJ)(e)),E=(0,u.C)((0,b.KN)(e)),C=(0,V.z)(f,r,E),w=(0,l.useCallback)((e=>{if("string"==typeof e)return{label:e};const t={label:"no label"};return null!==e&&"object"==typeof e?{...t,...e}:t}),[]),_=(0,l.useMemo)((()=>r?.length?(0,i.map)(r,(e=>{const t=(0,i.find)(C,["email",e.email]);if(t&&(0,R._)(t,f,y,C,v)){const t=[{id:"unavailable",label:p,color:"error",type:"icon",icon:"AlertTriangle"}];return{...e,actions:t}}return e})):[]),[v,C,y,r,p,f]),k=(0,l.useMemo)((()=>[{type:"keydown",callback:()=>{d?.[0]?.value&&t&&"loading"!==d?.[0]?.id&&(t([..._,d[0].value]),g.current&&(g.current.value="",c([])))},keys:[{key:"Enter",ctrlKey:!1}],haveToPreventDefault:!0}]),[t,d,_,c]);return(0,o.useKeyboard)(g,k),n().createElement(n().Fragment,null,n().createElement(o.Container,{width:"100%",height:"100%"},n().createElement(o.ChipInput,{inputRef:g,confirmChipOnBlur:!1,placeholder:a,separators:[],value:_,options:d,onInputType:s,onAdd:w,onChange:t,disabled:h,background:"white",style:{border:"1px solid lightgray"}})),n().createElement(R.G,{label:m,list:C,items:_,editorId:e}))},X=async(e,t=0,a=20)=>{const l=await(0,r.soapFetch)("AutoCompleteGal",{name:e,limit:a,needExp:1,offset:t,type:"resource",_jsns:"urn:zimbraAccount"});return l?.Fault?{...l.Fault,error:!0}:l};var Z=a(58753);const ee=({editorId:e})=>{const t=(0,u.T)(),[a]=(0,E.useTranslation)(),r=(0,u.C)((0,b.BG)(e)),o=(0,u.C)((0,b.tl)(e)),s=(0,l.useMemo)((()=>(0,i.map)(o,(e=>({id:e.id,label:e.label,email:e.email,avatarIcon:"BriefcaseOutline",avatarBackground:"transparent",avatarColor:"gray0"})))),[o]),[d,c]=(0,l.useState)([]),m=(0,l.useCallback)((a=>{if(a){const l=a.length>0?(0,i.uniqBy)(a,"label"):[];t((0,h.cU)({id:e,equipment:l}))}}),[t,e]),p=(0,l.useMemo)((()=>a("label.equipment","Equipment")),[a]),g=(0,l.useMemo)((()=>a("attendees_equipments_unavailable","One or more Equipments are not available at the selected time of the event")),[a]),f=(0,l.useMemo)((()=>a("attendee_equipment_unavailable","Equipment not available at the selected time of the event")),[a]),y=(0,l.useCallback)((e=>{e.textContent&&""!==e.textContent&&(c([{id:"loading",label:"loading",customComponent:n().createElement(J,null),disabled:!0}]),X(e.textContent).then((e=>{if(!e.error){const t=(0,i.filter)(e.cn,(e=>"Equipment"===e._attrs.zimbraCalResType)),a=(0,i.map)(t,(e=>Q(e))),l=(0,i.map)(t,(e=>({id:e.fileAsStr,label:e.fileAsStr,icon:"BriefcaseOutline",value:Q(e)})));Z.n.setState({equipment:(0,i.uniqBy)(a,"label")}),c(l)}})))}),[]);return n().createElement(K,{onChange:m,editorId:e,onInputType:y,placeholder:p,resourcesValue:s??[],options:d,setOptions:c,warningLabel:g,disabled:r?.equipment,singleWarningLabel:f})};var te=a(60397);const ae=({label:e,color:t})=>n().createElement(o.Container,{width:"fit",mainAlignment:"flex-start",orientation:"horizontal"},n().createElement(te.bK,{color:t}),n().createElement(o.Padding,{left:"small"},n().createElement(o.Text,null,e))),le=({editorId:e})=>{const[t]=(0,E.useTranslation)(),a=(0,l.useMemo)((()=>(e=>[{label:e("label.free","Free"),value:"F",color:"#ffffff",customComponent:n().createElement(ae,{label:e("label.free","Free"),color:"#ffffff"})},{label:e("label.tentative","Tentative"),value:"T",color:"#ffc107",customComponent:n().createElement(ae,{label:e("label.tentative","Tentative"),color:"#ffc107"})},{label:e("label.busy","Busy"),value:"B",color:"#d5e3f6",customComponent:n().createElement(ae,{label:e("label.busy","Busy"),color:"#d5e3f6"})},{label:e("label.out_of_office","Out of office"),value:"O",color:"#d5e3f6",customComponent:n().createElement(ae,{label:e("label.out_of_office","Out of office"),color:"#2b73d2"})}])(t)),[t]),r=(0,u.C)((0,b.Xq)(e)),s=(0,u.C)((0,b.BG)(e)),d=(0,u.T)(),c=(0,l.useCallback)((e=>(0,i.find)(a,["value",e])??a[0]),[a]),[m,p]=(0,l.useState)(c(r)),g=(0,l.useCallback)((t=>{d((0,h.lG)({id:e,freeBusy:t})),p(c(t))}),[d,e,c]);return(0,l.useEffect)((()=>{r&&p(c(r))}),[r,c]),m?n().createElement(o.Select,{items:a,background:"white",label:t("label.display","Display"),onChange:g,selection:m,disabled:s?.freeBusy,LabelFactory:te.ZP,style:{border:"1px solid lightgray"}}):null},ne=({editorId:e})=>{const[t]=(0,E.useTranslation)(),a=(0,u.C)((0,b.qn)(e)),[r,s]=(0,l.useState)(a??""),d=(0,u.C)((0,b.BG)(e)),c=(0,u.T)();(0,l.useEffect)((()=>{a&&s(a)}),[a]);const m=(0,l.useMemo)((()=>(0,i.debounce)((t=>{c((0,h.jf)({id:e,location:t}))}),500,{trailing:!0,leading:!1})),[c,e]),p=(0,l.useCallback)((e=>{s(e.target.value),m(e.target.value)}),[m]);return(0,i.isNil)(a)?null:n().createElement(o.Input,{label:t("label.location","Location"),value:r,onChange:p,disabled:d?.location,backgroundColor:"white","data-testid":"editor-location",style:{border:"1px solid lightgray"}})},re=({editorId:e})=>{const t=(0,u.T)(),[a]=(0,E.useTranslation)(),r=(0,u.C)((0,b.BG)(e)),o=(0,u.C)((0,b.l_)(e)),s=(0,l.useMemo)((()=>(0,i.map)(o,(e=>({id:e.id,label:e.label,email:e.email,avatarIcon:"BuildingOutline",avatarBackground:"transparent",avatarColor:"gray0"})))),[o]),[d,c]=(0,l.useState)([]),m=(0,l.useCallback)((a=>{if(a){const l=a.length>0?(0,i.uniqBy)(a,"label"):[];t((0,h.xs)({id:e,meetingRoom:l}))}}),[t,e]),p=(0,l.useMemo)((()=>a("label.meeting_room","Meeting room")),[a]),g=(0,l.useMemo)((()=>a("attendees_rooms_unavailable","One or more Meeting Rooms are not available at the selected time of the event")),[a]),f=(0,l.useMemo)((()=>a("attendee_room_unavailable","Room not available at the selected time of the event")),[a]),y=(0,l.useCallback)((e=>{e.textContent&&""!==e.textContent&&(c([{id:"loading",label:"loading",customComponent:n().createElement(J,null),disabled:!0}]),X(e.textContent).then((e=>{if(!e.error){const t=(0,i.filter)(e.cn,(e=>"Location"===e._attrs.zimbraCalResType)),a=(0,i.map)(t,(e=>Q(e))),l=(0,i.map)(t,(e=>({id:e.fileAsStr,label:e.fileAsStr,icon:"BuildingOutline",value:Q(e)})));Z.n.setState({meetingRoom:(0,i.uniqBy)(a,"label")}),c(l)}})))}),[]);return n().createElement(K,{onChange:m,editorId:e,onInputType:y,placeholder:p,resourcesValue:s??[],options:d,setOptions:c,warningLabel:g,disabled:r?.equipment,singleWarningLabel:f})},oe=({editorId:e})=>{const[t]=(0,E.useTranslation)(),a=(()=>{const e=(0,r.useUserAccount)();return(0,l.useMemo)((()=>{const t=(0,i.sortBy)(e.identities.identity,(({name:e})=>"DEFAULT"===e?0:1));return(0,i.map)(t,((e,t)=>{const a=e._attrs?.zimbraPrefIdentityName?`${e._attrs?.zimbraPrefIdentityName}`:"",l=e._attrs?.zimbraPrefFromDisplay?`${e._attrs?.zimbraPrefFromDisplay}`:"",n=e._attrs?.zimbraPrefFromAddress?`(<${e._attrs?.zimbraPrefFromAddress}>)`:"";return{value:`${t}`,label:(0,i.compact)([a,l,n]).join(" "),address:e._attrs?.zimbraPrefFromAddress,fullName:e._attrs?.zimbraPrefFromDisplay,type:e._attrs?.zimbraPrefFromAddressType,identityName:e.name}}))}),[e.identities.identity])})(),s=(0,u.C)((0,b.Ur)(e)),d=(0,u.C)((0,b.BG)(e)),c=(0,u.T)(),m=(0,l.useCallback)((t=>{const l=(0,i.find)(a,["value",t])??s;c((0,h.zz)({id:e,sender:l}))}),[a,s,c,e]),p=(0,l.useMemo)((()=>(0,i.upperFirst)(t("label.from","From"))),[t]);return s?n().createElement(o.Select,{style:{border:"1px solid lightgray"},background:"white",items:a,label:p,selection:s,onChange:m,disabled:d?.organizer}):null},ie=({editorId:e})=>{const[t]=(0,E.useTranslation)(),a=(0,u.T)(),r=(0,u.C)((0,b.Rf)(e)),i=(0,u.C)((0,b.BG)(e)),s=(0,l.useCallback)((()=>{const t="PRI"===r?"PUB":"PRI";a((0,h.S6)({id:e,class:t}))}),[r,a,e]);return n().createElement(o.Checkbox,{label:t("label.private","Private"),onClick:s,value:"PRI"===r,disabled:i?.private})},se=d()(o.Container).withConfig({displayName:"editor-reminder__ColorContainer",componentId:"sc-1swooex-0"})(["border-bottom:0.0625rem solid ",";"],(({theme:e})=>e.palette.gray2.regular)),de=d()(o.Text).withConfig({displayName:"editor-reminder__TextUpperCase",componentId:"sc-1swooex-1"})(["text-transform:capitalize;"]),ce=({selected:e,label:t,open:a,focus:l})=>n().createElement(se,{orientation:"horizontal",width:"fill",crossAlignment:"center",mainAlignment:"space-between",borderRadius:"half",background:"gray5",padding:{all:"small"}},n().createElement(o.Row,{width:"100%",takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Row,{orientation:"vertical",crossAlignment:"flex-start",mainAlignment:"flex-start",padding:{left:"small"}},n().createElement(o.Text,{size:"small",color:a||l?"primary":"secondary"},t),n().createElement(o.Row,null,n().createElement(de,null,e[0].label)))),n().createElement(o.Icon,{size:"large",icon:a?"ChevronUpOutline":"ChevronDownOutline",color:a||l?"primary":"secondary",style:{alignSelf:"center"}})),me=({editorId:e})=>{const[t]=(0,E.useTranslation)(),a=(0,l.useMemo)((()=>(e=>[{label:e("reminder.never","Never"),value:"0"},{label:e("reminder.at_time_of_event","At the time of the event"),value:"-1"},{label:e("reminder.minute_before",{count:1,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),value:"1"},{label:e("reminder.minute_before",{count:5,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),value:"5"},{label:e("reminder.minute_before",{count:10,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),value:"10"},{label:e("reminder.minute_before",{count:15,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),value:"15"},{label:e("reminder.minute_before",{count:30,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),value:"30"},{label:e("reminder.minute_before",{count:45,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),value:"45"},{label:e("reminder.hour_before",{count:1,defaultValue_one:"{{count}} hour before",defaultValue_other:"{{count}} hours before"}),value:"60"},{label:e("reminder.hour_before",{count:2,defaultValue_one:"{{count}} hour before",defaultValue_other:"{{count}} hours before"}),value:"120"},{label:e("reminder.hour_before",{count:4,defaultValue_one:"{{count}} hour before",defaultValue_other:"{{count}} hours before"}),value:"240"},{label:e("reminder.hour_before",{count:5,defaultValue_one:"{{count}} hour before",defaultValue_other:"{{count}} hours before"}),value:"300"},{label:e("reminder.hour_before",{count:18,defaultValue_one:"{{count}} hour before",defaultValue_other:"{{count}} hours before"}),value:1080..toString()},{label:e("reminder.day_before",{count:1,defaultValue_one:"{{count}} day before",defaultValue_other:"{{count}} days before"}),value:1440..toString()},{label:e("reminder.day_before",{count:2,defaultValue_one:"{{count}} day before",defaultValue_other:"{{count}} days before"}),value:2880..toString()},{label:e("reminder.day_before",{count:3,defaultValue_one:"{{count}} day before",defaultValue_other:"{{count}} days before"}),value:4320..toString()},{label:e("reminder.day_before",{count:4,defaultValue_one:"{{count}} day before",defaultValue_other:"{{count}} days before"}),value:5760..toString()},{label:e("reminder.week_before",{count:1,defaultValue_one:"{{count}} week before",defaultValue_other:"{{count}} weeks before"}),value:10080..toString()},{label:e("reminder.week_before",{count:2,defaultValue_one:"{{count}} week before",defaultValue_other:"{{count}} weeks before"}),value:20160..toString()}])(t)),[t]),r=(0,u.C)((0,b.L6)(e)),s=(0,u.C)((0,b.BG)(e)),d=(0,u.T)(),c=(0,l.useCallback)((e=>(0,i.find)(a,["value",e])??a[0]),[a]),[m,p]=(0,l.useState)(void 0),g=(0,l.useCallback)((t=>{d((0,h.D7)({id:e,reminder:t})),p(c(t))}),[d,e,c]);return(0,l.useEffect)((()=>{r&&p(c(r))}),[r,c]),m?n().createElement(o.Select,{items:a,disabled:s?.reminder,label:t("label.reminder","Reminder"),dropdownMaxHeight:"12.5rem",onChange:g,selection:m,disablePortal:!0,LabelFactory:ce,background:"white",style:{border:"1px solid lightgray"}}):null};var ue=a(21850);const be=async e=>{const t=await(0,r.soapFetch)("SearchCalendarResources",{attrs:`${ue.UM.EMAIL},${ue.UM.CAL_RES_TYPE},${ue.UM.FULL_NAME}`,searchFilter:{conds:{or:"1",cond:{attr:ue.UM.CAL_RES_TYPE,op:ue.sm.EQUAL,value:e}}},_jsns:"urn:zimbraAccount"});return t?.Fault?{...t.Fault,error:!0}:t},he=e=>({id:e.id,label:e._attrs.fullName,value:e._attrs.fullName,email:e._attrs.email,type:e._attrs.zimbraCalResType}),pe=({editorId:e})=>{const t=(0,u.C)((0,b.l_)(e)),a=(0,u.C)((0,b.tl)(e)),[n,r]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{n||(t&&be("Location").then((e=>{r(!0),Z.n.setState({meetingRoom:e.calresource?(0,i.map)(e.calresource,(e=>he(e))):void 0})})),a&&be("Equipment").then((e=>{r(!0),Z.n.setState({equipment:e.calresource?(0,i.map)(e.calresource,(e=>he(e))):void 0})})))}),[a,n,t,r]),null};var ge=a(23298),fe=a(31457);const ye=d()(o.Avatar).withConfig({displayName:"editor-summary__AvatarComp",componentId:"sc-ievfrj-0"})(["svg{width:1.5rem;min-width:1.5rem;height:1.5rem;min-height:1.5rem;}"]),ve=({children:e})=>n().createElement(o.Container,{mainAlignment:"flex-start",crossAlignment:"flex-start",padding:{top:"extrasmall"},orientation:"horizontal"},e),Ee=({editorId:e})=>{const[t]=(0,E.useTranslation)(),a=(0,u.C)((0,b.jJ)(e)),r=(0,u.C)((0,b.EU)(e)),s=(0,u.C)((0,b.Ox)(e)),d=(0,u.C)((0,b.qn)(e)),c=(0,u.C)((0,b.l_)(e)),m=(0,u.C)((0,b.tl)(e)),h=(0,u.C)((0,b.tu)(e)),p=(0,u.C)((0,b.Qt)(e)),f=(0,u.C)((0,b.R)(e)),y=(0,u.C)((0,b.TJ)(e)),v=(0,l.useMemo)((()=>c&&c.length>0?(0,i.map)(c,(e=>e.label)).join(", "):c),[c]),C=(0,l.useMemo)((()=>m&&m.length>0?(0,i.map)(m,(e=>e.label)).join(", "):m),[m]),w=(0,l.useMemo)((()=>h?.label),[h?.label]),_=(0,l.useMemo)((()=>g().tz.guess()),[]),k=(0,l.useMemo)((()=>(0,O.Li)(a??0,_,s)),[_,a,s]),x=(0,l.useMemo)((()=>(0,O.Li)(r??0,_,s)),[r,_,s]),{eventTimeString:T,eventTimezoneString:A,showTimezoneTooltip:I,eventTimezoneTooltip:z}=(0,fe.i)(k,x,y,s);return n().createElement(o.Row,{height:"fit",width:"fill",mainAlignment:"flex-start",wrap:"nowrap",padding:{top:"large",bottom:"medium"}},n().createElement(ye,{size:"large",icon:"Calendar2",style:{background:f?.color?.color??ge.V?.[0]?.color},label:""}),n().createElement(o.Row,{mainAlignment:"flex-start",crossAlignment:"flex-start",height:"fit",padding:{left:"large"},takeAvailableSpace:!0},n().createElement(o.Container,{mainAlignment:"space-between",orientation:"horizontal"},n().createElement(o.Text,{overflow:"ellipsis",weight:"bold",size:"small"},p||t("label.subject","Subject")),n().createElement(o.Icon,{icon:"Calendar2",customColor:f?.color?.color??ge.V?.[0]?.color})),n().createElement(ve,null,n().createElement(n().Fragment,null,n().createElement(o.Text,{overflow:"ellipsis",color:"secondary",weight:"bold",size:"small"},T),I&&n().createElement(o.Tooltip,{label:z},n().createElement(o.Padding,{left:"small"},n().createElement(o.Icon,{icon:"GlobeOutline",color:"gray1"}))))),n().createElement(ve,null,n().createElement(o.Text,{overflow:"ellipsis",color:"secondary",weight:"bold",size:"small"},A)),n().createElement(ve,null,n().createElement(o.Text,{overflow:"ellipsis",color:"secondary",size:"small"},d)),n().createElement(ve,null,n().createElement(o.Text,{overflow:"ellipsis",color:"secondary",size:"small"},v)),C&&n().createElement(ve,null,n().createElement(o.Text,{overflow:"ellipsis",color:"secondary",size:"small"},C)),w&&n().createElement(ve,null,n().createElement(o.Text,{overflow:"ellipsis",color:"secondary",size:"small"},w))))};var Ce=a(45859),we=a(75556);const _e=({editorId:e})=>{const[t]=(0,E.useTranslation)(),a=(0,u.C)((0,b.Ox)(e)),r=(0,u.C)((0,b.TJ)(e)),i=(0,u.T)(),s=(0,u.C)((0,b.BG)(e)),{zimbraPrefUseTimeZoneListInCalendar:d}=(0,Ce.j)(),c=(0,l.useMemo)((()=>(0,we.qX)(t)),[t]),m=t("timezones","Timezones"),[p,g]=(0,l.useState)((()=>{if(a&&"TRUE"===d){const e=(0,we.lH)(c,a);if(e)return{label:e,value:a}}})),f=(0,l.useCallback)((t=>{if(t){const a=(0,we.lH)(c,t);a&&g({label:a,value:t}),i((0,h.ln)({id:e,timezone:t}))}}),[i,e,c]);return"TRUE"!==d||r?null:n().createElement(o.Select,{label:m,items:c,multiple:!1,onChange:f,selection:p,disabled:s?.timezone})},ke=({editorId:e})=>{const[t]=(0,E.useTranslation)(),a=(0,u.C)((0,b.Qt)(e)),[s,d]=(0,l.useState)(a??""),c=(0,u.C)((0,b.BG)(e)),m=(0,u.T)(),p=(0,r.useBoardHooks)(),g=p?.updateBoard;(0,l.useEffect)((()=>{a&&d(a);const e=a?.length?a:t("new_appointment","New appointment");g({title:e})}),[t,a,g]);const f=(0,l.useMemo)((()=>(0,i.debounce)((t=>{m((0,h.Hg)({id:e,title:t}))}),500,{trailing:!0,leading:!1})),[m,e]),y=(0,l.useCallback)((e=>{d(e.target.value),f(e.target.value)}),[f]);return(0,i.isNil)(a)?null:n().createElement(o.Input,{label:t("label.event_title","Event title"),value:s,onChange:y,disabled:c?.title,"data-testid":"editor-title",autoFocus:!0,backgroundColor:"white",style:{border:"1px solid lightgray"}})},xe=({editorId:e})=>{const[t,a]=(0,r.useIntegratedComponent)("room-selector"),i=(0,u.C)((0,b.tu)(e)),s=(0,u.C)((0,b.BG)(e)),d=(0,u.T)(),c=(0,l.useCallback)((t=>{d((0,h.hU)({id:e,room:t}))}),[d,e]);return a?n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(t,{onChange:c,defaultValue:i,disabled:s?.virtualRoom})):null};var Te=a(6062);const Ae="DAI",Ie="WEE",ze="MON",Me="YEA",Se="NONE",Re="CUSTOM",Pe="everyday",Ve="working_day",Be="every_x_days",Ne="day_of_the_month",De="monthly_customized",Oe="quick_options",Fe="custom_options",qe="no_end",Ue="end_after_count",We="end_after_until",Le="every_year_on_month_day",je="every_year_on_custom_day",$e=(0,l.createContext)({}),He=({label:e,value:t,setValue:a,onChange:r,disabled:s})=>{const d=(0,l.useCallback)((e=>{if(""===e.target.value)r(1),a(e.target.value);else{const t=parseInt(e.target.value,10);(0,i.isNumber)(t)&&!(0,i.isNaN)(t)&&t>=0&&(a(t),r(t))}}),[r,a]);return n().createElement(o.Input,{label:e,onChange:d,backgroundColor:"gray5",disabled:s,value:t,hasError:(0,i.isNumber)(t)&&!(0,i.isNaN)(t)&&(t<1||t>99)||!(0,i.isNumber)(t)})},Ge={freq:Ae,interval:{ival:1},radioValue:Pe},Ye=({editorId:e})=>{const{frequency:t,setNewStartValue:a}=(0,l.useContext)($e),s=(0,u.C)((0,b.f6)(e)),d=(0,u.C)((0,b.jg)(e)),c=(0,u.C)((0,b.Q5)(e)),[m,h]=(0,l.useState)((()=>((e,t,a)=>{if((e===Ae||e===Ie)&&a?.wkday&&1===t?.ival){const e=(0,i.map)(["MO","TU","WE","TH","FR"],(e=>({day:e}))),t=(0,i.differenceWith)(e,a?.wkday,i.isEqual);return 0===t?.length?Ve:Ge.radioValue}return e!==Ae||1!==t?.ival||a?.wkday?e===Ae&&t&&t?.ival>1&&!a?.wkday?Be:Ge.radioValue:Pe})(s,d,c))),[p,g]=(0,l.useState)((()=>((e,t,a)=>{if(e===Ae)return(0,i.omitBy)({interval:a,byday:t},i.isNil);if(e===Ie&&t?.wkday&&1===a?.ival){const e=(0,i.map)(["MO","TU","WE","TH","FR"],(e=>({day:e}))),l=(0,i.differenceWith)(e,t?.wkday,i.isEqual);return 0===l?.length&&1===a?.ival?{interval:a,byday:t}:{interval:Ge.interval}}})(s,c,d))),[f,y]=(0,l.useState)(d?.ival??Ge?.interval?.ival),v=(0,l.useCallback)((e=>{switch(e){case Pe:g({interval:{ival:1}}),h(e);break;case Ve:g({byday:{wkday:(0,i.map)(["MO","TU","WE","TH","FR"],(e=>({day:e})))}}),h(e);break;case Be:(0,i.isNumber)(f)&&!(0,i.isNaN)(f)&&f>0&&g({interval:{ival:f}}),h(e);break;default:g({interval:{ival:1}}),h(Pe)}}),[f,g]),E=(0,l.useCallback)((e=>{m===Be&&g({interval:{ival:e}})}),[g,m]);return(0,l.useEffect)((()=>{p&&t===Ae&&a(p)}),[t,a,p]),t===Ae?n().createElement(o.RadioGroup,{value:m,onChange:v},n().createElement(o.Radio,{size:"small",iconColor:"primary",label:n().createElement(o.Padding,{vertical:"small"},n().createElement(o.Text,{overflow:"break-word"},(0,r.t)("label.every_day","Every day"))),value:Pe}),n().createElement(o.Radio,{size:"small",iconColor:"primary",label:n().createElement(o.Padding,{vertical:"small"},n().createElement(o.Text,{overflow:"break-word"},(0,r.t)("items.working_day","Every working day"))),value:Ve}),n().createElement(o.Radio,{size:"small",iconColor:"primary",label:n().createElement(o.Padding,{top:"small"},n().createElement(o.Row,{width:"fit",orientation:"horizontal",mainAlignment:"flex-start",wrap:"nowrap"},n().createElement(o.Text,{overflow:"break-word"},(0,r.t)("label.every","Every")),n().createElement(o.Padding,{horizontal:"small"},n().createElement(He,{disabled:m!==Be,value:f,onChange:E,label:(0,r.t)("label.days","Days"),setValue:y})),n().createElement(o.Text,{overflow:"break-word"},(0,r.t)("label.days","Days")))),value:Be})):null},Je=()=>{const[e]=(0,E.useTranslation)(),t=(0,l.useMemo)((()=>[{label:e("months.january","January"),value:"1"},{label:e("months.february","February"),value:"2"},{label:e("months.march","March"),value:"3"},{label:e("months.april","April"),value:"4"},{label:e("months.may","May"),value:"5"},{label:e("months.june","June"),value:"6"},{label:e("months.july","July"),value:"7"},{label:e("months.august","August"),value:"8"},{label:e("months.september","September"),value:"9"},{label:e("months.october","October"),value:"10"},{label:e("months.november","November"),value:"11"},{label:e("months.december","December"),value:"12"}]),[e]),a=(0,l.useMemo)((()=>[{label:e("items.first","First"),value:"1"},{label:e("items.second","Second"),value:"2"},{label:e("items.third","Third"),value:"3"},{label:e("items.fourth","Fourth"),value:"4"},{label:e("items.last","Last"),value:"-1"}]),[e]),n=(0,l.useMemo)((()=>[{label:e("label.week_day.monday","Monday"),value:"MO"},{label:e("label.week_day.tuesday","Tuesday"),value:"TU"},{label:e("label.week_day.wednesday","Wednesday"),value:"WE"},{label:e("label.week_day.thursday","Thursday"),value:"TH"},{label:e("label.week_day.friday","Friday"),value:"FR"},{label:e("label.week_day.saturday","Saturday"),value:"SA"},{label:e("label.week_day.sunday","Sunday"),value:"SU"}]),[e]),r=(0,l.useMemo)((()=>[{label:e("label.day","Day"),value:"MO,TU,WE,TH,FR,SA,SU"},{label:e("items.weekend_day","Weekend day"),value:"SA,SU"},{label:e("items.working_day","Working day"),value:"MO,TU,WE,TH,FR"},...n]),[e,n]),o=(0,l.useMemo)((()=>[{label:e("repeat.daily","Daily"),value:Ae},{label:e("repeat.weekly","Weekly"),value:Ie},{label:e("repeat.monthly","Monthly"),value:ze},{label:e("repeat.yearly","Yearly"),value:Me}]),[e]);return{months:t,ordinalNumbers:a,weekDays:n,weekOptions:r,repetitionItems:o}},Qe=({disabled:e,setValue:t,onChange:a,value:s,testId:d})=>{const c=(0,l.useCallback)((e=>{if(""===e.target.value)a(1),t(e.target.value);else{const l=parseInt(e.target.value,10);(0,i.isNumber)(l)&&!(0,i.isNaN)(l)&&l>=0&&(t(l),a(l))}}),[a,t]);return n().createElement(o.Input,{backgroundColor:"gray5",label:(0,r.t)("label.day","Day"),value:s,onChange:c,disabled:e,hasError:(0,i.isNumber)(s)&&!(0,i.isNaN)(s)&&(s<1||s>31)||!(0,i.isNumber)(s),"data-testid":d})},Ke=({value:e,setValue:t,onChange:a,disabled:s})=>{const{ordinalNumbers:d}=Je(),c=(0,l.useCallback)((e=>{if(e){const l=e?.split?.(","),n=(0,i.find)(d,(e=>{const t=e?.value?.split?.(",");return 0===(0,i.differenceWith)(t,l,i.isEqual).length}))??d[0];t(n),a(e)}}),[a,d,t]);return n().createElement(o.Select,{items:d,label:(0,r.t)("label.number","Number"),onChange:c,disablePortal:!0,width:"fit",disabled:s,selection:e})},Xe=({selection:e,setSelection:t,onChange:a,disabled:s=!1})=>{const{weekOptions:d}=Je(),c=(0,l.useMemo)((()=>(0,i.find)(d,(t=>0===(0,i.differenceWith)((0,i.map)(t.value.split(","),(e=>({day:e}))),(0,i.map)((e?.value??d?.[0]?.value)?.split(","),(e=>({day:e}))),i.isEqual).length))),[d,e]),m=(0,l.useCallback)((e=>{if(e){const l=(0,i.map)(e.split(","),(e=>({day:e}))),n=e?.split?.(","),r=(0,i.find)(d,(e=>{const t=e?.value?.split?.(",");return 0===(0,i.differenceWith)(t,n,i.isEqual).length}))??d[0];t(r),a(l)}}),[a,t,d]);return c?n().createElement(o.Select,{items:d,label:(0,r.t)("label.day","Day"),onChange:m,disablePortal:!0,width:"fit",disabled:s,selection:c}):null},Ze=()=>{const{frequency:e,setNewStartValue:t}=(0,l.useContext)($e),[a,s]=(0,l.useState)(Ne),[d,c]=(0,l.useState)(1),[m,u]=(0,l.useState)(1),[b,h]=(0,l.useState)(1),[p,g]=(0,l.useState)({bymonthday:{modaylist:d},interval:{ival:m}}),{weekOptions:f,ordinalNumbers:y}=Je(),[v,E]=(0,l.useState)(y?.[0]),[C,w]=(0,l.useState)(f?.[0]),_=(0,l.useCallback)((e=>{switch(e){case Ne:g({bymonthday:{modaylist:d},interval:{ival:m}}),s(e);break;case De:s(e),g({bysetpos:{poslist:v?.value},byday:{wkday:(0,i.map)(C?.value?.split?.(","),(e=>({day:e})))},interval:{ival:b}});break;default:s(Ne)}}),[C?.value,m,b,d,v?.value]),k=(0,l.useCallback)((e=>{e&&a===Ne&&g((t=>({...t??{},bymonthday:{modaylist:e}})))}),[a]),x=(0,l.useCallback)((e=>{a===Ne&&g((t=>({...t,interval:{ival:e}})))}),[g,a]),T=(0,l.useCallback)((e=>{a===De&&g((t=>({...t,interval:{ival:e}})))}),[g,a]),A=(0,l.useCallback)((e=>{e&&a===De&&g((t=>({...t??{},bysetpos:{poslist:e}})))}),[a]),I=(0,l.useCallback)((e=>{e&&a===De&&g((t=>({...t??{},byday:{wkday:e}})))}),[a]);return(0,l.useEffect)((()=>{p&&e===ze&&t(p)}),[e,t,p]),e===ze?n().createElement(o.RadioGroup,{value:a,onChange:_},n().createElement(o.Radio,{size:"small",iconColor:"primary",label:n().createElement(o.Row,{width:"fit",orientation:"horizontal",mainAlignment:"flex-start",wrap:"nowrap"},n().createElement(o.Padding,{horizontal:"small"},n().createElement(o.Text,null,(0,r.t)("label.day","Day"))),n().createElement(Qe,{value:d,setValue:c,onChange:k,disabled:a!==Ne,testId:"montly_day_input"}),n().createElement(o.Padding,{horizontal:"small"},n().createElement(o.Text,null,(0,r.t)("label.every","every"))),n().createElement(He,{value:m,setValue:u,label:(0,r.t)("label.months","Months"),onChange:x,disabled:a!==Ne})),value:Ne}),n().createElement(o.Radio,{size:"small",iconColor:"primary",label:n().createElement(o.Container,{orientation:"vertical",mainAlignment:"center",crossAlignment:"flex-start",width:"100%"},n().createElement(o.Container,{orientation:"horizontal",mainAlignment:"flex-start",crossAlignment:"center",width:"fill"},n().createElement(o.Padding,{horizontal:"small"},n().createElement(o.Text,null,(0,r.t)("label.the","The"))),n().createElement(Ke,{value:v,setValue:E,onChange:A,disabled:a!==De}),n().createElement(o.Padding,{horizontal:"small"}),n().createElement(Xe,{setSelection:w,onChange:I,selection:C,disabled:a!==De})),n().createElement(o.Container,{orientation:"horizontal",mainAlignment:"flex-start",crossAlignment:"center",padding:{vertical:"small"},width:"80%"},n().createElement(o.Padding,{horizontal:"small"},n().createElement(o.Text,null,(0,r.t)("label.of_every_month","of the month, every"))),n().createElement(Qe,{value:b,setValue:h,onChange:T,disabled:a!==De}),n().createElement(o.Padding,{horizontal:"small"},n().createElement(o.Text,null,(0,r.t)("label.months","Months"))))),value:De})):null};var et=a(97296);a.n(et)()();const tt=({editorId:e})=>{const{newEndValue:t,setNewEndValue:a}=(0,l.useContext)($e),r=(0,u.C)((0,b.jJ)(e)),s=(0,u.C)((0,b.Xt)(e)),d=(0,u.C)((0,b.zB)(e)),[c,m]=(0,l.useState)((()=>((e,t)=>e?Ue:t?We:qe)(s,d))),[h,p]=(0,l.useState)(s??"1"),f=(0,l.useMemo)((()=>d?new Date(g()(d).valueOf()):new Date(g()(r).valueOf())??new Date),[r,d]),[y,v]=(0,l.useState)(f),C=(0,l.useCallback)((e=>{if(""===e.target.value)a({count:{num:1}}),p(e.target.value);else{const t=parseInt(e.target.value,10);(0,i.isNumber)(t)&&!(0,i.isNaN)(t)&&t>0&&(p(t),c===Ue&&a({count:{num:t}}))}}),[a,c]),w=(0,l.useCallback)((e=>{switch(e){case qe:a(void 0),m(e);break;case Ue:a({count:{num:parseInt(`${h}`,10)}}),m(e);break;case We:a({until:{d:g()(y).format("YYYYMMDD")}}),m(e);break;default:a(void 0),m(qe)}}),[h,y,a]),_=(0,l.useMemo)((()=>t?.count?.num),[t]),[k]=(0,E.useTranslation)(),x=(0,l.useMemo)((()=>k("label.end_after","End after")),[k]),T=(0,l.useMemo)((()=>c!==We),[c]),A=(0,l.useCallback)((e=>{if(!T){const t=g()(e.valueOf()).format("YYYYMMDD");v(e.valueOf()),a({until:{d:t}})}}),[T,a]);return n().createElement(o.RadioGroup,{value:c,onChange:w},n().createElement(o.Radio,{size:"small",iconColor:"primary",label:k("label.no_end_date","No end date"),value:qe}),n().createElement(o.Radio,{size:"small",iconColor:"primary",label:n().createElement(o.Row,{width:"fill",orientation:"horizontal",mainAlignment:"flex-start",wrap:"nowrap"},n().createElement(o.Row,{width:"fit",orientation:"horizontal",mainAlignment:"flex-start",wrap:"nowrap",padding:{right:"small"}},n().createElement(o.Text,null,x)),n().createElement(o.Row,{width:"fit",orientation:"horizontal",mainAlignment:"flex-start",wrap:"nowrap"},n().createElement(o.Input,{backgroundColor:"gray5",width:"fit",label:k("label.occurrences","Occurence(s)"),value:h,disabled:c!==Ue,onChange:C,hasError:!(0,i.isNil)(_)&&(_>99||_<1||!(0,i.isNumber)(_))}))),value:Ue}),n().createElement(o.Radio,{size:"small",iconColor:"primary",label:n().createElement(o.Row,{width:"fill",orientation:"horizontal",mainAlignment:"flex-start",wrap:"nowrap"},n().createElement(o.Row,{width:"fit",orientation:"horizontal",mainAlignment:"flex-start",wrap:"nowrap",padding:{right:"small"}},n().createElement(o.Text,null,x)),n().createElement(o.Row,{width:"fit",orientation:"horizontal",mainAlignment:"flex-start",wrap:"nowrap"},n().createElement(o.Container,{crossAlignment:"flex-start",style:{maxWidth:"31.25rem"}},n().createElement(o.DateTimePicker,{label:x,includeTime:!1,defaultValue:f,onChange:A,disabled:T,dateFormat:"dd/MM/yyyy"})))),value:We}))};var at=a(22797);const lt=({value:e,setValue:t,disabled:a,onClick:r,isHidden:s})=>{const{weekDays:d}=Je(),c=(0,l.useCallback)((a=>{if((0,i.find)(e,{day:a.value})){const l=(0,i.reject)(e,{day:a.value});t(l),r(l)}else{const l=[...e,{day:a.value}];t(l),r(l)}}),[e,r,t]);return s?null:n().createElement(n().Fragment,null,(0,i.map)(d,(t=>{const l=!!(0,i.find)(e,(({day:e})=>e===t.value));return n().createElement(o.Container,{key:`week_day_${t.value}`,orientation:"horizontal",width:"fit",mainAlignment:"flex-start",padding:{horizontal:"small"}},n().createElement(o.Checkbox,{size:"small",key:t.label,onClick:()=>c(t),label:t.label.slice(0,3),value:l,disabled:a}))})))},nt={freq:Ie,interval:{ival:1},byday:{wkday:[{day:"MO"}]},radioValue:Oe},rt=({editorId:e})=>{const{frequency:t,setNewStartValue:a}=(0,l.useContext)($e),s=(0,u.C)((0,b.f6)(e)),d=(0,u.C)((0,b.jg)(e)),c=(0,u.C)((0,b.Q5)(e)),m=(0,Ce.j)(),h=(0,l.useMemo)((()=>(0,at.C)(m.zimbraPrefCalendarWorkingHours)),[m?.zimbraPrefCalendarWorkingHours]),{weekOptions:p}=Je(),[g,f]=(0,l.useState)((()=>((e,t,a,l)=>{if((e===Ae||e===Ie)&&a?.wkday){const e=(0,i.map)((0,i.filter)(l,["working",!0]),(e=>{const t=(0,i.find)(ge.n,["value",e.day])?.label?.slice(0,2);return{day:t}})),n=(0,i.differenceWith)(e,a?.wkday,i.isEqual);return 0===n?.length&&1===t?.ival?Oe:Fe}return e===Ie?1===t?.ival?Oe:Fe:nt.radioValue})(s,d,c,h))),[y,v]=(0,l.useState)(d?.ival??1),[E,C]=(0,l.useState)((()=>((e,t)=>(0,i.find)(e,(e=>0===(0,i.differenceWith)((0,i.map)(e?.value?.split?.(","),(e=>({day:e}))),t?.wkday??[],i.isEqual).length))??e[0])(p,c))),[w,_]=(0,l.useState)(c?.wkday??[]),[k,x]=(0,l.useState)((()=>((e,t,a,l)=>e===Ie?(0,i.omitBy)({interval:t,byday:a},i.isNil):e===Ae&&a?.wkday&&1===t?.ival?(0,i.find)(l,(e=>0===(0,i.differenceWith)((0,i.map)(e?.value?.split?.(","),(e=>({day:e}))),a?.wkday??{},i.isEqual).length))?{interval:t,byday:a}:{interval:nt.interval,byday:nt.byday}:void 0)(s,d,c,p))),T=(0,l.useCallback)((e=>{e&&g===Oe&&x((t=>({...t??{},byday:{wkday:e}})))}),[g]),A=(0,l.useCallback)((e=>{switch(e){case Oe:x({byday:{wkday:(0,i.map)(E?.value?.split?.(","),(e=>({day:e})))}}),f(e);break;case Fe:x({byday:{wkday:w},interval:{ival:y}}),f(e);break;default:x({byday:{wkday:(0,i.map)(E?.value?.split?.(","),(e=>({day:e})))}}),f(Oe)}}),[w,y,E?.value,x]),I=(0,l.useCallback)((e=>{g===Fe&&x((t=>({...t,interval:{ival:e}})))}),[x,g]),z=(0,l.useCallback)((e=>{e&&g===Fe&&x((t=>({...t,byday:{wkday:e}})))}),[g]);return(0,l.useEffect)((()=>{k&&t===Ie&&a(k)}),[t,a,k]),t===Ie?n().createElement(o.RadioGroup,{value:g,onChange:A},n().createElement(o.Radio,{size:"small",iconColor:"primary",label:n().createElement(o.Row,{width:"fit",orientation:"horizontal",mainAlignment:"flex-start",wrap:"nowrap"},n().createElement(o.Text,{overflow:"break-word"},(0,r.t)("label.every","Every")),n().createElement(o.Padding,{horizontal:"small"},n().createElement(Xe,{setSelection:C,onChange:T,selection:E,disabled:g!==Oe}))),value:Oe,name:Oe}),n().createElement(o.Radio,{size:"small",iconColor:"primary",label:n().createElement(o.Container,{orientation:"vertical",width:"fit",mainAlignment:"flex-start",crossAlignment:"flex-start"},n().createElement(o.Row,{width:"fit",orientation:"horizontal",mainAlignment:"flex-start",wrap:"nowrap"},n().createElement(o.Text,{overflow:"break-word"},(0,r.t)("label.every","Every")),n().createElement(o.Padding,{horizontal:"small"},n().createElement(He,{label:(0,r.t)("label.weeks_on","Week(s) on"),onChange:I,setValue:v,value:y,disabled:g!==Fe})))),value:Fe}),n().createElement(o.Row,{width:"fit",orientation:"horizontal",mainAlignment:"flex-start",crossAlignment:"flex-start",wrap:"nowrap"},n().createElement(lt,{isHidden:g!==Fe,value:w,setValue:_,onClick:z,disabled:g!==Fe}))):null},ot=({value:e,setValue:t,onChange:a,disabled:s,testId:d})=>{const{months:c}=Je(),m=(0,l.useCallback)((e=>{if(e){const l=Number(e),n=e?.split?.(","),r=(0,i.find)(c,(e=>{const t=e?.value?.split?.(",");return 0===(0,i.differenceWith)(t,n,i.isEqual).length}))??c[0];t(r),a(l)}}),[c,a,t]);return n().createElement(o.Select,{items:c,label:(0,r.t)("label.month","Month"),onChange:m,disablePortal:!0,width:"fit",disabled:s,selection:e,"data-testid":d})},it=()=>{const{frequency:e,setNewStartValue:t}=(0,l.useContext)($e),[a,s]=(0,l.useState)(Le),[d,c]=(0,l.useState)(1),{weekOptions:m,ordinalNumbers:u,months:b}=Je(),[h,p]=(0,l.useState)(b[0]),[g,f]=(0,l.useState)(b[0]),[y,v]=(0,l.useState)({bymonthday:{modaylist:d},bymonth:{molist:h?.value}}),E=(0,l.useCallback)((e=>{a===Le&&v((t=>({...t,interval:{ival:e}})))}),[a]),C=(0,l.useCallback)((e=>{e&&a===Le&&v((t=>({...t??{},bymonth:{molist:e}})))}),[a]),w=(0,l.useCallback)((e=>{e&&a===je&&v((t=>({...t??{},bymonth:{molist:e}})))}),[a]),[_,k]=(0,l.useState)(u?.[0]),x=(0,l.useCallback)((e=>{e&&a===je&&v((t=>({...t??{},bysetpos:{poslist:e}})))}),[a]),[T,A]=(0,l.useState)(m?.[0]),I=(0,l.useCallback)((e=>{e&&a===je&&v((t=>({...t??{},byday:{wkday:e}})))}),[a]),z=(0,l.useCallback)((e=>{switch(e){case Le:v({bymonthday:{modaylist:d},bymonth:{molist:h?.value}}),s(e);break;case je:s(e),v({bysetpos:{poslist:_?.value},byday:{wkday:(0,i.map)(T?.value?.split?.(","),(e=>({day:e})))},bymonth:{molist:g?.value}});break;default:s(Le)}}),[T?.value,h?.value,g?.value,d,_?.value]);return(0,l.useEffect)((()=>{y&&e===Me&&t(y)}),[e,t,y]),e===Me?n().createElement(o.RadioGroup,{value:a,onChange:z},n().createElement(o.Radio,{size:"small",iconColor:"primary",label:n().createElement(o.Row,{width:"fit",orientation:"horizontal",mainAlignment:"flex-start",wrap:"nowrap"},n().createElement(o.Padding,{horizontal:"small"},n().createElement(o.Text,null,(0,r.t)("label.every_year_on","Every year on"))),n().createElement(Qe,{value:d,setValue:c,onChange:E,disabled:a!==Le,testId:"every_yearly_day_input"}),n().createElement(o.Padding,{horizontal:"small"},n().createElement(o.Text,null,(0,r.t)("label.of","of"))),n().createElement(ot,{value:h,setValue:p,onChange:C,disabled:a!==Le,testId:"every_yearly_month_input"})),value:Le}),n().createElement(o.Radio,{size:"small",iconColor:"primary",label:n().createElement(o.Container,{orientation:"vertical",mainAlignment:"center",crossAlignment:"flex-start",width:"100%"},n().createElement(o.Container,{orientation:"horizontal",mainAlignment:"flex-start",crossAlignment:"center",width:"fill"},n().createElement(o.Padding,{horizontal:"small"},n().createElement(o.Text,null,(0,r.t)("label.the","The"))),n().createElement(Ke,{value:_,setValue:k,onChange:x,disabled:a!==je}),n().createElement(o.Padding,{horizontal:"small"}),n().createElement(Xe,{onChange:I,disabled:a!==je,setSelection:A}),n().createElement(o.Padding,{horizontal:"small"},n().createElement(o.Text,null,(0,r.t)("label.of","of"))),n().createElement(ot,{value:g,setValue:f,onChange:w,disabled:a!==je}))),value:je})):null},st=()=>{const e=(0,l.useContext)($e),[t]=(0,E.useTranslation)(),{repetitionItems:a}=Je(),r=(0,l.useMemo)((()=>(0,i.find)(a,{value:e?.frequency})??a[0]),[a,e]);(0,l.useEffect)((()=>{if(r){const t=(0,i.find)(a,{value:e?.frequency})??a[0];e?.setFrequency(t?.value)}}),[e,r,a]);const s=(0,l.useCallback)((t=>{e?.setFrequency?.(t)}),[e]);return n().createElement(o.Select,{label:t("label.repeat","Repeat"),onChange:s,items:a,selection:r,disablePortal:!0})},dt=({editorId:e,onClose:t})=>{const a=(0,u.C)((0,b.f6)(e)),s=(0,u.C)((0,b.Xt)(e)),d=(0,u.C)((0,b.zB)(e)),c=(0,u.T)(),[m,p]=(0,l.useState)(a),[g,f]=(0,l.useState)(),[y,v]=(0,l.useState)((()=>((e,t)=>e?{count:{num:e}}:t?{until:{d:t}}:void 0)(s,d))),E=(0,l.useCallback)((()=>{const a={add:{rule:(0,i.omitBy)({...g??{},...y??{},freq:m},i.isNil)}};c((0,h.Of)({id:e,recur:a})),t(),f(void 0),v(void 0)}),[g,y,m,c,e,t]),C={newStartValue:g,setNewStartValue:f,newEndValue:y,setNewEndValue:v,frequency:m,setFrequency:p};return n().createElement($e.Provider,{value:C},n().createElement(o.ModalHeader,{title:(0,r.t)("label.custom_repeat","Custom Repeat"),showCloseIcon:!0,onClose:t,closeIconTooltip:"Close"}),n().createElement(o.Divider,null),n().createElement(o.ModalBody,null,n().createElement(o.Text,{weight:"bold",size:"large"},(0,r.t)("label.repeat","Repeat")),n().createElement(o.Padding,{top:"small"}),n().createElement(st,null),n().createElement(o.Padding,{vertical:"small"},n().createElement(Ye,{editorId:e}),n().createElement(rt,{editorId:e}),n().createElement(Ze,null),n().createElement(it,null)),n().createElement(o.Padding,{vertical:"medium"},n().createElement(o.Text,{weight:"bold",size:"large"},(0,r.t)("label.end","End"))),n().createElement(o.Padding,{vertical:"small"},n().createElement(tt,{editorId:e}))),n().createElement(o.Divider,null),n().createElement(o.ModalFooter,{onConfirm:E,confirmLabel:(0,r.t)("repeat.customize","Customize")}))},ct=({editorId:e})=>{const[t]=(0,E.useTranslation)(),a=(0,o.useModal)(),r=(0,l.useCallback)((()=>{const t=a({maxHeight:"90vh",children:n().createElement(w.g,null,n().createElement(dt,{editorId:e,onClose:()=>t()})),onClose:()=>{t()}},!0)}),[a,e]);return n().createElement(o.Container,{width:"fill",mainAlignment:"center",orientation:"horizontal"},n().createElement(o.Button,{type:"outlined",label:t("label.custom","Custom"),color:"primary",width:"fill",onClick:r}))},mt=({label:e})=>n().createElement(o.Container,{width:"fit",mainAlignment:"flex-start",orientation:"horizontal"},n().createElement(Te.sd,null,e)),ut=({selected:e,label:t,open:a,focus:l})=>n().createElement(Te.Qk,{orientation:"horizontal",width:"fill",crossAlignment:"center",mainAlignment:"space-between",borderRadius:"half",background:"gray5",padding:{all:"small"}},n().createElement(o.Row,{width:"100%",takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Row,{orientation:"vertical",crossAlignment:"flex-start",mainAlignment:"flex-start",padding:{left:"small"}},n().createElement(o.Text,{size:"small",color:a||l?"primary":"secondary"},t),n().createElement(o.Row,null,n().createElement(Te.sd,null,e[0].label)))),n().createElement(o.Icon,{size:"large",icon:a?"ChevronUpOutline":"ChevronDownOutline",color:a||l?"primary":"secondary",style:{alignSelf:"center"}})),bt=({editorId:e})=>{const t=(0,u.C)((0,b.pW)(e)),a=(0,u.C)((0,b.BG)(e)),[r]=(0,E.useTranslation)(),s=(0,u.C)((0,b.jJ)(e)),d=(0,u.T)(),c=(0,l.useMemo)((()=>[{label:r("label.none","None"),value:Se,customComponent:n().createElement(mt,{label:r("label.none","None")})},{label:r("label.every_day","Every day"),value:Ae,customComponent:n().createElement(mt,{label:r("label.every_day","Every day")})},{label:r("repeat.everyWeek","Every Week"),value:Ie,customComponent:n().createElement(mt,{label:r("repeat.everyWeek","Every Week")})},{label:r("repeat.everyMonth","Every Month"),value:ze,customComponent:n().createElement(mt,{label:r("repeat.everyMonth","Every Month")})},{label:r("repeat.everyYear","Every Year"),value:Me,customComponent:n().createElement(mt,{label:r("repeat.everyYear","Every Year")})},{label:r("label.custom","Custom"),value:Re,customComponent:n().createElement(ct,{editorId:e})}]),[e,r]),m=(0,l.useMemo)((()=>{const e=t?Re:Se;return(0,i.find)(c,{value:e})??c[0]}),[t,c]),[p,f]=(0,l.useState)(m),y=(0,l.useCallback)((t=>{if(t){const a={freq:t,interval:[{ival:1}]};switch(t){case Re:f((0,i.find)(c,{value:t})??c[0]);break;case Ae:case ze:case Me:f((0,i.find)(c,{value:t})??c[0]),d((0,h.Of)({id:e,recur:[{add:[{rule:[a]}]}]}));break;case Ie:f((0,i.find)(c,{value:t})??c[0]),d((0,h.Of)({id:e,recur:[{add:[{rule:[{...a,byday:{wkday:[{day:(0,i.toUpper)(`${g()(s).format("dddd").slice(0,2)}`)}]}}]}]}]}));break;default:f((0,i.find)(c,{value:Se})??c[0]),d((0,h.Of)({id:e,recur:void 0}))}}}),[c,d,e,s]);return m?n().createElement(o.Select,{label:r("label.repeat","Repeat"),onChange:y,items:c,selection:p,disablePortal:!0,disabled:a?.recurrence,LabelFactory:ut,background:"white",style:{border:"1px solid lightgray"}}):null};var ht=a(58542),pt=a(19321);const gt=({editorId:e,expanded:t})=>e?n().createElement(o.Container,{background:ht.Et,padding:{horizontal:"large",bottom:"large"},mainAlignment:"flex-start",crossAlignment:"flex-start",style:{overflow:"auto"},"data-testid":"EditorPanel"},n().createElement(Ee,{editorId:e}),n().createElement(I,{editorId:e}),n().createElement(o.Divider,null),n().createElement(o.Container,{height:"fit",background:ht.Et,mainAlignment:"flex-start",crossAlignment:"flex-start",padding:{all:"large",bottom:"extralarge"},style:{overflowY:"auto"}},n().createElement(oe,{editorId:e}),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(ke,{editorId:e})),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(ne,{editorId:e})),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(re,{editorId:e})),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(ee,{editorId:e})),n().createElement(xe,{editorId:e}),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(N,{editorId:e})),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(le,{editorId:e})),n().createElement(F,{editorId:e}),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"},mainAlignment:"flex-start"},n().createElement(ie,{editorId:e})),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(G,{editorId:e})),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(_e,{editorId:e})),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"},mainAlignment:"flex-start"},n().createElement(z,{editorId:e})),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(me,{editorId:e})),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(bt,{editorId:e,expanded:t})),n().createElement(S,{editorId:e,expanded:t}),n().createElement(o.Row,{height:"fit",width:"fill",padding:{top:"large"}},n().createElement(pt.Z,{variant:"outlined",style:{padding:"8px"}},n().createElement(j,{editorId:e})))),n().createElement(pe,{editorId:e})):null,ft=()=>{const e=(0,r.useBoard)();return e?.editor?.id?n().createElement(gt,{editorId:e?.editor?.id}):null}},34130:(e,t,a)=>{a.d(t,{A:()=>v});var l=a(92652),n=a.n(l),r=a(97363),o=a(80681),i=a(51235),s=a(93747),d=a(91750),c=a.n(d);const m=e=>{if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${(e/1024**t).toFixed(2).toString()} ${["B","KB","MB","GB","TB"][t]}`};var u=a(2244);const b=(e,t,a)=>a.length>1?`/service/home/~/?auth=co&id=${e}&filename=${t}&charset=UTF-8&part=${a.join(",")}&disp=a&fmt=zip`:`/service/home/~/?auth=co&id=${e}&part=${a.join(",")}&disp=a`,h=c()(r.Container).withConfig({displayName:"attachments-part__AttachmentHoverBarContainer",componentId:"sc-19us1m1-0"})(["display:none;height:0;"]),p=c()(r.Container).withConfig({displayName:"attachments-part__AttachmentContainer",componentId:"sc-19us1m1-1"})(["border-radius:0.125rem;width:calc(50% - 0.5rem);transition:0.2s ease-out;margin-bottom:",";margin-right:",";box-sizing:border-box;&:hover{background-color:",";& ","{display:flex;}}&:focus{background-color:",";}cursor:",";"],(({theme:e})=>e.sizes.padding.small),(({theme:e})=>e.sizes.padding.small),(({theme:e,background:t="transparent",disabled:a})=>a?"gray5":(0,r.getColor)(`${t}.hover`,e)),h,(({theme:e,background:t="transparent"})=>(0,r.getColor)(`${t}.focus`,e)),(({disabled:e})=>e?"default":"pointer")),g=c().a.withConfig({displayName:"attachments-part__AttachmentLink",componentId:"sc-19us1m1-2"})(["margin-bottom:",";position:relative;text-decoration:none;"],(({theme:e})=>e.sizes.padding.small)),f=c()(r.Text).withConfig({displayName:"attachments-part__AttachmentExtension",componentId:"sc-19us1m1-3"})(["display:flex;justify-content:center;align-items:center;width:2rem;height:2rem;border-radius:",";background-color:",";color:",";font-size:calc("," - 0.125rem);text-transform:uppercase;margin-right:",";"],(({theme:e})=>e.borderRadius),(({theme:e,disabled:t,background:a})=>t?e.palette.primary.disabled:a?.color||e.palette.primary.regular),(({theme:e})=>e.palette.gray6.regular),(({theme:e})=>e.sizes.font.small),(({theme:e})=>e.sizes.padding.small)),y=({link:e,id:t,part:a,isEditor:d,removeAttachment:c,disabled:b=!1,iconColors:y,att:v})=>{const{createPreview:E}=(0,l.useContext)(o.PreviewsManagerContext),C=(0,u.mD)(v),w=(0,l.useMemo)((()=>m(v.size)),[v.size]),[_]=(0,s.useTranslation)(),k=(0,l.useRef)(null),x=(0,l.useRef)(null),T=(0,l.useCallback)((()=>{k?.current&&k.current.click()}),[k]),A=(0,l.useCallback)((t=>{t.preventDefault();const a=(l=v.contentType,l?.startsWith("image")?"image":l?.endsWith("pdf")?"pdf":void 0);var l;a&&e?E({src:e,previewType:a,closeAction:{id:"close",icon:"ArrowBack",tooltipLabel:_("preview.close","Close Preview")},extension:v.filename.substring(v.filename.lastIndexOf(".")+1),filename:v.filename,size:m(v.size)}):x.current&&x.current.click()}),[v,E,e,_]);return n().createElement(p,{orientation:"horizontal",mainAlignment:"flex-start",height:"fit",background:b?"gray5":"gray3",disabled:b,padding:{right:"medium"}},n().createElement(r.Tooltip,{key:d?`${t}-Edit`:`${t}-Preview`,label:b?_("action.save_to_preview","Save to preview"):_("action.preview","Click to preview")},n().createElement(r.Row,{padding:{all:"small"},mainAlignment:"flex-start",onClick:A,takeAvailableSpace:!0},n().createElement(f,{background:(0,i.find)(y,(e=>e.extension===C)),disabled:b},C),n().createElement(r.Row,{orientation:"vertical",crossAlignment:"flex-start",takeAvailableSpace:!0},n().createElement(r.Padding,{style:{width:"100%"},bottom:"extrasmall"},n().createElement(r.Text,{disabled:b},v.filename)),n().createElement(r.Text,{disabled:b,color:"gray1",size:"small"},w)))),n().createElement(r.Row,{orientation:"horizontal",crossAlignment:"center"},n().createElement(h,{orientation:"horizontal"},b?n().createElement(r.Tooltip,{key:`${t}-DeletePermanentlyOutline`,label:_("label.delete","Delete")},n().createElement(r.IconButton,{size:"medium",icon:"DeletePermanentlyOutline",onClick:()=>c(a)})):n().createElement(r.Tooltip,{key:d?`${t}-EditOutline`:`${t}-DeletePermanentlyOutline`,label:d?_("label.delete","Delete"):_("label.download","Download")},n().createElement(r.IconButton,{size:"medium",icon:d?"DeletePermanentlyOutline":"DownloadOutline",onClick:d?()=>c(a):T})))),!b&&n().createElement(g,{rel:"noopener",ref:x,target:"_blank",href:`/service/home/~/?auth=co&id=${t}&part=${a}`}),n().createElement(g,{ref:k,rel:"noopener",target:"_blank",href:e}))},v=({attachments:e,id:t,subject:a,onAttachmentsChange:o,isEditor:d=!1,disabled:c})=>{const[m]=(0,s.useTranslation)(),[h,p]=(0,l.useState)(!1),g=(0,r.useTheme)(),f=(0,l.useMemo)((()=>e.length),[e]),v=(0,l.useMemo)((()=>{const l=(0,i.map)(e,"name");return t?b(t,a,l):void 0}),[e,t,a]),E=(0,l.useCallback)((a=>{const l=(0,i.filter)(e,(e=>e.name?e.name!==a:!e.aid||e.aid!==a));o&&o({aid:(0,i.reduce)(l,((e,t)=>t.aid?[...e,t.aid]:e),[]),mp:(0,i.reduce)(l,((e,a)=>a.name&&t?[...e,{part:a.name,mid:t}]:e),[])},l)}),[e,t,o]),C=(0,l.useCallback)((()=>{o&&o({mp:[]},[])}),[o]),w=(0,l.useMemo)((()=>h?e:e.slice(0,2)),[e,h]),_=(0,l.useMemo)((()=>(0,i.uniqBy)((0,i.map)(e,(e=>({extension:(0,u.mD)(e),color:(0,u.uY)(e.contentType,g)}))),"extension")),[e,g]);return n().createElement(n().Fragment,null,f>0&&n().createElement(r.Container,{mainAlignment:"flex-start",crossAlignment:"flex-start"},n().createElement(r.Row,{mainAlignment:"flex-start",padding:{top:"extrasmall",bottom:"medium"}},n().createElement(r.Padding,{right:"small"},f<3&&f>1&&n().createElement(r.Text,{color:"gray1"},m("label.attachment",{count:f,defaultValue_one:"Attachment",defaultValue_other:"{{count}} Attachments"})),1===f&&n().createElement(r.Text,{color:"gray1"},`1 ${m("label.attachment",{count:f,defaultValue_one:"Attachment",defaultValue_other:"{{count}} Attachments"})}`),f>2&&(h?n().createElement(r.Row,{onClick:()=>p(!1),style:{cursor:"pointer"}},n().createElement(r.Padding,{right:"small"},n().createElement(r.Text,{color:"primary"},m("label.attachment",{count:f,defaultValue_one:"Attachment",defaultValue_other:"{{count}} Attachments"}))),n().createElement(r.Icon,{icon:"ArrowIosUpward",color:"primary"})):n().createElement(r.Row,{onClick:()=>p(!0),style:{cursor:"pointer"}},n().createElement(r.Padding,{right:"small"},n().createElement(r.Text,{color:"primary"},m("label.show",{count:f,defaultValue_one:"Show",defaultValue_other:"Show all"})," ",m("label.attachment",{count:f,defaultValue_one:"Attachment",defaultValue_other:"{{count}} Attachments"}))),n().createElement(r.Icon,{icon:"ArrowIosDownward",color:"primary"})))),n().createElement(r.Link,{size:"medium",href:d?void 0:v,onClick:d?C:void 0,disabled:c},d?m("label.delete",{count:f,defaultValue_one:"Delete",defaultValue_other:"Delete all"}):m("label.download",{count:f,defaultValue_one:"Download",defaultValue_other:"Download all"}))),n().createElement(r.Container,{orientation:"horizontal",mainAlignment:"flex-start",crossAlignment:"flex-start",wrap:"wrap"},(0,i.map)(w,((e,l)=>n().createElement(y,{key:`att-${e.filename}-${l}`,link:t?b(t,a,[e.name]):void 0,id:t,part:e.name??e.aid,isEditor:d,removeAttachment:E,disabled:!e.name??c,iconColors:_,att:e}))))))}}}]);
//# sourceMappingURL=calendar-edit.3527ac8b.chunk.js.map