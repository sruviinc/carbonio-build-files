(self.webpackChunkcarbonio_calendars_ui=self.webpackChunkcarbonio_calendars_ui||[]).push([[331],{27399:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ne});var n=a(92652),r=a.n(n),i=a(97363),l=a(6017),o=a(93747),s=a(966),c=a(51235),d=a(91666),m=a(11933),u=a(93046),p=a(40300);const f=e=>{const[t,a]=(0,n.useState)(!0),[r,i]=(0,n.useState)(-1),o=(0,l.useNotify)();return(0,n.useEffect)((()=>{t&&e&&(a((e=>!e)),(0,d.J)({view:e}).then((t=>{(0,m.Q)().then((a=>{if(a?.folders){const n=(0,c.filter)(a.folders,["folderId",1]);if(n.length){const a=(0,c.reject)(t.folder[0].link,["rid",1]);(async(e,t)=>Promise.all((0,c.map)(e,(async({ownerEmail:e})=>{const a=await(0,d.J)({view:t},e);return a?.folder?.length?{...a.folder[0],oname:a.folder[0].name,owner:e,name:e}:a}))))(n,e).then((n=>{if(n.Fault){const n=[{...t.folder[0],link:a}];p.O.postMessage({op:"refresh",currentView:e,folder:n??[]})}else{const r=[{...t.folder[0],link:a},...n];p.O.postMessage({op:"refresh",currentView:e,folder:r??[]})}}))}else p.O.postMessage({op:"refresh",currentView:e,folder:t?.folder??[]})}}))})).catch((()=>{a(!0)})))}),[t,e]),(0,n.useEffect)((()=>{!t&&o.length>0&&(0,c.forEach)((0,c.sortBy)(o,"seq"),(e=>{!(0,c.isEmpty)(o)&&(e.seq>r||r>1&&1===e.seq)&&(!(0,c.isEmpty)(o)&&(e?.created?.folder||e?.modified?.folder||e.deleted||e?.created?.link||e?.modified?.link)&&p.O.postMessage({op:"notify",notify:e,state:u.t3.getState().folders}),i(e.seq))}))}),[t,o,r,e]),null};var g=a(50364),v=a(42128),h=a(68242),b=a(13963);const E=(e,t)=>a=>{const n=(0,c.pick)(a,["calendar","isRichText","organizer","sender","title","location","room","meetingRoom","equipment","attendees","optionalAttendees","allDay","freeBusy","class","start","end","timezone","reminder","recur","richText","plainText","disabled"]),r=(0,v.kn)({context:{dispatch:e,folders:t,panel:!1,...n}});(0,l.addBoard)({url:`${g.jh}/`,title:r?.title??"",editor:r})};var y=a(87466),w=a(59379),A=a(40232);const x=()=>((0,n.useEffect)((()=>{"Notification"in window?Notification.requestPermission():console.warn("This browser does not support desktop notifications")}),[]),r().createElement(r().Fragment,null));var T=a(750),_=a.n(T),C=a(2244),O=a(11783),R=a(83210),k=a(10733);const S=({reminderItem:e,toggleModal:t,removeReminder:a,setActiveReminder:l})=>{const{start:s,id:d,isRecurrent:m,end:u,alarmData:p,location:f,name:g,isOrg:v,key:b}=e,E=(0,h.T)(),[y]=(0,o.useTranslation)(),[w,A]=(0,n.useState)(_()().valueOf()),x=(0,n.useMemo)((()=>(0,O.vK)(f)),[f]),T=(0,n.useCallback)((()=>{E((0,R.m)({dismissItems:[{id:d,dismissedAt:_()().valueOf()}]})),a(b)}),[E,d,b,a]),S=((e,t)=>{const[a]=(0,o.useTranslation)(),r=(0,n.useMemo)((()=>_()(t?.[0]?.alarmInstStart).diff(_()(),"seconds")),[t]),i=(0,n.useMemo)((()=>[{id:a("reminder.at_time_of_event","At the time of the event"),label:a("reminder.at_time_of_event","At the time of the event"),value:0},{id:a("reminder.minute_before",{count:1,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),label:a("reminder.minute_before",{count:1,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),value:60},{id:a("reminder.minute_before",{count:5,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),label:a("reminder.minute_before",{count:5,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),value:300},{id:a("reminder.minute_before",{count:10,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),label:a("reminder.minute_before",{count:10,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),value:600},{id:a("reminder.minute_before",{count:15,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),label:a("reminder.minute_before",{count:15,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),value:900},{id:a("reminder.minute_before",{count:30,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),label:a("reminder.minute_before",{count:30,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"}),value:900},{id:a("reminder.hour_before",{count:1,defaultValue_one:"{{count}} hour before",defaultValue_other:"{{count}} hours before"}),label:a("reminder.hour_before",{count:1,defaultValue_one:"{{count}} hour before",defaultValue_other:"{{count}} hours before"}),value:3600}]),[a]),l=(0,n.useMemo)((()=>[{id:"reminder_after_1",label:a("reminder.minutes",{count:1,defaultValue_one:"{{count}} minute ",defaultValue_other:"{{count}} minutes"}),beforeEvent:!1,value:60},{id:"reminder_after_5",label:a("reminder.minutes",{count:5,defaultValue_one:"{{count}} minute",defaultValue_other:"{{count}} minutes"}),beforeEvent:!1,value:300},{id:"reminder_after_10",label:a("reminder.minutes",{count:10,defaultValue_one:"{{count}} minute",defaultValue_other:"{{count}} minutes"}),beforeEvent:!1,value:600},{id:"reminder_after_15",label:a("reminder.minutes",{count:15,defaultValue_one:"{{count}} minute",defaultValue_other:"{{count}} minutes"}),beforeEvent:!1,value:900},{id:"reminder_after_30",label:a("reminder.minutes",{count:30,defaultValue_one:"{{count}} minute",defaultValue_other:"{{count}} minutes "}),beforeEvent:!1,value:1800},{id:"reminder_after_60",label:a("reminder.hours",{count:1,defaultValue_one:"{{count}} hour",defaultValue_other:"{{count}} hours"}),beforeEvent:!1,value:3600}]),[a]);return(0,n.useMemo)((()=>{const t=t=>({id:t.id,label:t.label,onClick:()=>e(t.value/60,t.beforeEvent??!0)});return[...(0,c.filter)(i,(e=>e.value<=r)).map((e=>t(e))),{id:"reminder_divider",label:"",type:"divider"},...l.map((e=>t(e)))]}),[l,i,r,e])})((0,n.useCallback)(((e,t=!0)=>{const n=m?_()().set({hour:_()(s).hour(),minute:_()(s).minute()}).subtract(e,"minutes").valueOf():_()(s).subtract(e,"minutes").valueOf();E((0,k.J)({id:d,until:t?n:_()().add(e,"minutes").valueOf()})),a(b)}),[m,s,E,d,a,b]),p),D=(0,n.useMemo)((()=>{const{color:t,size:a,text:n}=(0,C.y5)(e,w);return r().createElement(i.Text,{color:t,size:a},n)}),[w,e]);return(0,n.useEffect)((()=>{const e=setInterval((()=>A(_()().valueOf())),3e4);return()=>clearInterval(e)}),[]),r().createElement(i.Container,{padding:{vertical:"small"},mainAlignment:"space-between",crossAlignment:"center",orientation:"horizontal"},r().createElement(i.Row,{mainAlignment:"space-evenly",crossAlignment:"center",orientation:"horizontal",width:"65%"},r().createElement(i.Row,{width:"20%",mainAlignment:"flex-start"},r().createElement(i.Icon,{icon:"PhoneCallOutline",size:"large"})),r().createElement(i.Row,{width:"80%",mainAlignment:"center",crossAlignment:"baseline",orientation:"vertical"},r().createElement(i.Row,null,r().createElement(i.Text,{size:"large"},g)),x&&r().createElement(i.Row,null,r().createElement(i.Text,null,r().createElement("a",{target:"_blank",href:x,rel:"noreferrer",onClick:e=>e.stopPropagation()},x))),r().createElement(i.Row,{padding:{top:"extrasmall"},wrap:"nowrap"},r().createElement(i.Text,{size:"large"},_()(s).format("HH:mm")," - ",_()(u).format("HH:mm")),r().createElement(i.Padding,{left:"small"},D)))),r().createElement(i.Row,{width:"35%",mainAlignment:"flex-end",crossAlignment:"center",orientation:"horizontal",padding:{horizontal:"large"}},r().createElement(i.Row,null,(_()(s).valueOf()<_()().valueOf()||_()(p[0].alarmInstStart).valueOf()<_()().valueOf())&&v?r().createElement(i.Tooltip,{placement:"top",label:y("label.set_new_time","Set new time")},r().createElement(i.IconButton,{icon:"ClockOutline",size:"large",onClick:()=>{l(e),t()}})):r().createElement(i.Tooltip,{placement:"top",label:y("label.snooze","Snooze")},r().createElement(i.Dropdown,{items:S,placement:"bottom-end"},r().createElement(i.IconButton,{icon:"Flip2Outline",size:"large",onClick:c.noop}))),r().createElement(i.Tooltip,{placement:"top",label:y("label.dismiss","Dismiss").toUpperCase()},r().createElement(i.IconButton,{icon:"BellOffOutline",size:"large",onClick:T})))))};var D=a(37312),z=a(18671);const I=({toggleModal:e,setNewTime:t})=>{const[a]=(0,o.useTranslation)();return r().createElement(i.Container,{mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},r().createElement(z.x,{title:a("label.set_new_time","Set new time")}),r().createElement(i.Padding,{vertical:"extrasmall"}),r().createElement(i.Container,{padding:{vertical:"medium"}},r().createElement(i.Text,{overflow:"break-word"},a("reminder.modal.set_new_time_message"))),r().createElement(D.Z,{onConfirm:t,secondaryAction:e,secondaryLabel:a("folder.modal.footer.go_back","Go back"),label:a("label.ok","OK")}))};var M=a(16990),N=a(46609);const j=({reminders:e,setReminders:t})=>{const[a,o]=(0,n.useState)(!1),[s,d]=(0,n.useState)(void 0),m=(0,n.useCallback)((()=>o(!a)),[a]),p=(0,h.T)(),f=(0,u.tc)(),b=(0,n.useMemo)((()=>!(0,c.isEmpty)(e)),[e]),E=(0,n.useCallback)((()=>{const a=(0,c.map)(e,(e=>({id:e.id,dismissedAt:_()().valueOf()})));o(!1),a.length>0&&(p((0,R.m)({dismissItems:a})),t({}))}),[p,e,t]),y=(0,n.useCallback)((a=>{const n=(0,c.omit)(e,a);t(n)}),[e,t]),w=(0,n.useCallback)((()=>{s&&p((0,N.E)({inviteId:s.inviteId})).then((({payload:e})=>{if(e){const t=(0,M.I)(e.m?.[0]),a={resource:{calendar:s.calendar,isRecurrent:s.isRecurrent,isException:!!s.isException,location:s.location,inviteId:s.inviteId,id:s.id},title:s.name,allDay:s.allDay,start:s.start,end:s.end},n=(0,v.kn)({event:a,invite:t,context:{dispatch:p,folders:f,panel:!1}});(0,l.addBoard)({url:`${g.jh}/`,title:n?.title??"",editor:n}),E()}}))}),[s,f,E,p]),A=(0,n.useMemo)((()=>(0,l.t)("label.appt_reminder",{count:Object.keys(e)?.length??1,defaultValue_one:"Appointment Reminder",defaultValue_other:"Appointment Reminders"})),[e]),x=(0,n.useMemo)((()=>(0,l.t)("label.dismiss",{count:Object.keys(e)?.length??1,defaultValue_one:"Dismiss",defaultValue_other:"Dismiss all"})),[e]);return r().createElement(i.CustomModal,{open:b,onClose:()=>null,maxHeight:"90vh","data-testid":"reminder-modal"},a?r().createElement(I,{toggleModal:m,setNewTime:w}):r().createElement(i.Container,{padding:{all:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit",width:"100%"},r().createElement(z.x,{title:A}),r().createElement(i.Container,{maxHeight:"20rem",style:{overflow:"auto",display:"block"}},(0,c.map)(e,(e=>r().createElement(S,{reminderItem:e,key:e.key,removeReminder:y,toggleModal:m,setActiveReminder:d})))),r().createElement(D.Z,{label:x,onConfirm:E})))},F=a.p+"20d012c938e8d0dcc703.mp3";var L=a(37255),P=a(89323),$=a(53776),B=a(85492);const Y=()=>{const[e,t]=(0,n.useState)({}),a=(0,h.C)($.sC),i=(0,h.C)($.i_),o=(0,h.T)(),s=(0,B.Zo)(),d=(0,B.p)(),m=(0,L.t)(),p=(0,u.tc)(),f=(0,n.useMemo)((()=>{const e=(0,c.filter)(a,"alarmData");return(0,c.compact)((0,c.map)(e,(e=>{const t=e?.l?.includes(":"),a=p?.[10];return(({appointment:e,calendar:t})=>{if(e.alarmData){const a=(0,l.getUserAccount)(),n=!(!e?.or?.a||!a?.name)&&e?.or?.a===a?.name;return{start:new Date(e?.alarmData?.[0]?.alarmInstStart),key:`${e?.id}-${e?.alarmData?.[0]?.alarmInstStart}`,isRecurrent:e.recur,end:new Date(e.alarmData[0].alarmInstStart+e.dur),alarmData:e.alarmData,location:e.loc,name:e.name,isOrg:n,id:e.id,inviteId:e.inviteId,calendar:t,isException:e.hasEx,allDay:e.allDay}}})({calendar:(t?(0,c.find)(p,(t=>`${t.zid}:${t.rid}`===e.l)):(0,c.find)(p,(t=>t.id===e.l)))??a,appointment:e})})))}),[a,p]),g=(0,n.useMemo)((()=>new Audio(F)),[]),v=(0,n.useMemo)((()=>({start:_()().subtract("7","days").valueOf(),end:_()().add("15","days").valueOf()})),[]),b=(0,n.useMemo)((()=>(0,c.filter)(f??[],(e=>e?.alarmData?.length&&e?.alarmData?.[0]?.nextAlarm&&e?.alarmData?.[0]?.nextAlarm>v?.start&&_()(e?.alarmData?.[0]?.nextAlarm).isSameOrAfter(_()(v?.start))&&_()(e?.alarmData?.[0]?.nextAlarm).isSameOrBefore(_()(v?.end))&&!(0,c.includes)(e?.inviteId,":")&&e?.calendar?.id!==l.FOLDERS.TRASH))),[f,v?.end,v?.start]);return(0,n.useEffect)((()=>{"init"!==i||(0,c.isEmpty)(p)||o((0,P.C)({spanEnd:d,spanStart:s,query:m}))}),[p,o,d,m,s,i]),(0,n.useEffect)((()=>{const a=setInterval((()=>{const a=[],n=(0,c.reduce)(b,((t,n)=>_()(n?.alarmData?.[0]?.nextAlarm).diff(_()(),"seconds",!0)<=0?((0,c.find)(e,{start:n.start,key:n.key,end:n.end})||a.push(n),{...t,[n.key]:n}):t),{});t(n),a?.length>0&&(g.play(),(0,c.forEach)(a,(e=>{const{text:t}=(0,C.y5)(e,_()().valueOf());var a;a=e?.name,new Notification(a,{body:t,vibrate:[200,100,200],dir:"ltr"})})))}),1e3);return()=>clearInterval(a)}),[b,g,e]),(0,c.isEmpty)(e)?null:r().createElement(j,{reminders:e,setReminders:t})};var V=a(33957),q=a(20309);const U=()=>{const e=(0,l.useRefresh)(),t=(0,l.useNotify)(),[a,r]=(0,n.useState)(-1),i=(0,h.T)(),o=(0,B.Zo)(),s=(0,B.p)(),[d,m]=(0,n.useState)(!1),u=(0,L.t)();return(0,n.useEffect)((()=>{(0,c.isEmpty)(e)||d||m(!0)}),[i,d,e]),(0,n.useEffect)((()=>{t.length>0&&(0,c.forEach)((0,c.sortBy)(t,"seq"),(e=>{if(!(0,c.isEmpty)(e)&&(e.seq>a||a>1&&1===e.seq)){if(e.created&&e.created.appt&&i((0,P.C)({spanEnd:s,spanStart:o,query:u})),e.modified&&e.modified.appt){const t=(0,c.reduce)(e.modified.appt,((e,t)=>t.l?[...e,t]:e),[]);t?.length>0&&i((0,V.fo)(t)),i((0,P.C)({spanEnd:s,spanStart:o,query:u}));const a=(0,c.reduce)(e.modified.appt,((e,t)=>t?.inv?.length>0?[...e,...t.inv]:e),[]);a?.length>0&&i((0,q.TC)(a))}e.deleted&&i((0,V.gD)(e.deleted)),r(e.seq)}}))}),[i,s,t,u,a,o]),null},H=(0,n.lazy)((()=>Promise.all([a.e(945),a.e(979)]).then(a.bind(a,98765)))),Z=(0,n.lazy)((()=>Promise.all([a.e(321),a.e(798),a.e(38)]).then(a.bind(a,49066)))),G=(0,n.lazy)((()=>Promise.all([a.e(321),a.e(798),a.e(751)]).then(a.bind(a,61207)))),W=(0,n.lazy)((()=>Promise.all([a.e(321),a.e(180),a.e(798),a.e(421)]).then(a.bind(a,72653)))),X=(0,n.lazy)((()=>Promise.all([a.e(945),a.e(809)]).then(a.bind(a,82454)))),K=()=>r().createElement(n.Suspense,{fallback:r().createElement(l.Spinner,null)},r().createElement(w.g,null,r().createElement(i.ModalManager,null,r().createElement(H,null)))),Q=()=>r().createElement(n.Suspense,{fallback:r().createElement(l.Spinner,null)},r().createElement(w.g,null,r().createElement(i.ModalManager,null,r().createElement(Z,null)))),J=()=>r().createElement(n.Suspense,{fallback:r().createElement(l.Spinner,null)},r().createElement(w.g,null,r().createElement(i.ModalManager,null,r().createElement(G,null)))),ee=e=>r().createElement(n.Suspense,{fallback:r().createElement(l.Spinner,null)},r().createElement(w.g,null,r().createElement(i.ModalManager,null,r().createElement(W,e)," "))),te=e=>r().createElement(n.Suspense,{fallback:r().createElement(l.Spinner,null)},r().createElement(w.g,null,r().createElement(i.ModalManager,null,r().createElement(X,e)," "))),ae=()=>{const e=(()=>{const e=(0,u.tc)(),t=(0,h.T)();return(0,n.useCallback)((a=>{a?.preventDefault?.();const n=(0,v.kn)({context:{panel:!1,dispatch:t,folders:e}});(0,l.addBoard)({url:`${g.jh}/`,title:n.title??"",editor:n})}),[e,t])})(),t=(0,u.tc)(),a=(0,h.T)(),[r]=(0,o.useTranslation)();return(0,n.useEffect)((()=>{const e=r("label.app_name","Calendars");(0,l.addRoute)({route:g.jh,position:200,visible:!0,label:e,primaryBar:"CalendarModOutline",secondaryBar:ee,appView:K}),(0,l.addSettingsView)({route:g.jh,label:e,component:J,subSections:(0,b.Dq)()}),(0,l.addSearchView)({route:g.jh,label:e,component:te}),(0,l.addBoardView)({route:g.jh,component:Q})}),[r]),(0,n.useEffect)((()=>{(0,l.registerFunctions)({id:A.T.CREATE_APPOINTMENT,fn:E(a,t)}),(0,l.registerActions)({action:()=>({id:"new-appointment",label:r("label.new_appointment","New Appointment"),icon:"CalendarModOutline",onClick:e,disabled:!1,group:g.XD,primary:!0}),id:"new-appointment",type:l.ACTION_TYPES.NEW}),(0,l.registerComponents)({id:"invites-reply",component:y.ZP})}),[t,a,e,r]),null};function ne(){return f(s.X1.appointment),r().createElement(w.g,null,r().createElement(ae,null),r().createElement(Y,null),r().createElement(U,null),r().createElement(x,null))}},28081:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var n=a(92652),r=a.n(n),i=a(97363),l=a(93747);const o=({mainAlignment:e="center",crossAlignment:t="center",onConfirm:a,label:o,secondaryAction:s,secondaryLabel:c,primaryBtnType:d="default",secondaryBtnType:m="default",disabled:u,secondaryDisabled:p,background:f="primary",secondarybackground:g,color:v="primary",secondaryColor:h="secondary",size:b="medium",showDivider:E=!0,tooltip:y,secondaryTooltip:w,paddingTop:A="medium",additionalAction:x,additionalBtnType:T="outlined",additionalColor:_="secondary",additionalLabel:C,primaryButtonIcon:O})=>{const[R]=(0,l.useTranslation)(),k=(0,n.useMemo)((()=>R("label.cancel","cancel")),[R]);return r().createElement(i.Container,{mainAlignment:e,crossAlignment:t,padding:{top:A}},E&&r().createElement(i.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",orientation:"horizontal",height:"fit"},r().createElement(i.Divider,null)),r().createElement(i.Container,{orientation:"horizontal",mainAlignment:"space-between"},x&&r().createElement(i.Container,{orientation:"horizontal",width:"fit"},r().createElement(i.Button,{color:_,type:T,onClick:x,label:C??k,size:b}),r().createElement(i.Padding,{horizontal:"extrasmall"})),r().createElement(i.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"flex-end",crossAlignment:"flex-start",orientation:"horizontal",height:"fit"},s&&r().createElement(i.Padding,{right:"small",vertical:"small"},w?r().createElement(i.Tooltip,{label:w,placement:"top",maxWidth:"fit"},r().createElement(i.Button,{backgroundColor:g,color:h,type:m,onClick:s,label:c??k,disabled:p,size:b})):r().createElement(i.Button,{backgroundColor:g,color:h,type:m,onClick:s,label:c??k,disabled:p,size:b})),r().createElement(i.Padding,{vertical:"small"},y?r().createElement(i.Tooltip,{label:y,placement:"top",maxWidth:"fit"},r().createElement(i.Button,{size:b,color:v,onClick:a,label:o,type:d,disabled:u,backgroundColor:v||f,icon:O,iconPlacement:"left"})):r().createElement(i.Button,{size:b,color:v,onClick:a,label:o,type:d,disabled:u,backgroundColor:v||f,icon:O,iconPlacement:"left"})))))}},4833:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(92652),r=a.n(n),i=a(97363);const l=({title:e,onClose:t,showCloseIcon:a=!0})=>r().createElement(i.Container,{mainAlignment:"space-between",width:"100%"},r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"space-between",width:"100%"},r().createElement(i.Row,{width:"calc(100% - 1.5rem)",takeAvailableSpace:!0,mainAlignment:"flex-start"},r().createElement(i.Text,{weight:"bold",size:"large"},e)),t&&a&&r().createElement(i.Row,{mainAlignment:"flex-start"},r().createElement(i.IconButton,{size:"medium",style:{padding:0,margin:0},onClick:t,icon:"CloseOutline"}))),r().createElement(i.Padding,{top:"medium"}),r().createElement(i.Divider,null),r().createElement(i.Padding,{bottom:"medium"}))},966:(e,t,a)=>{"use strict";a.d(t,{X1:()=>n});const n={search_folder:"search folder",tag:"tag",conversation:"conversation",message:"message",contact:"contact",document:"document",appointment:"appointment",virtual_conversation:"virtual conversation",remote_folder:"remote folder",wiki:"wiki",task:"task",chat:"chat"}},91666:(e,t,a)=>{"use strict";a.d(t,{J:()=>i});var n=a(6017),r=a(51235);const i=async({id:e,view:t},a)=>{const i=(0,r.omitBy)({_jsns:"urn:zimbraMail",folder:e?{l:e}:void 0,view:t,tr:1},r.isNil);return(0,n.soapFetch)("GetFolder",i,a)}},11933:(e,t,a)=>{"use strict";a.d(t,{Q:()=>i});var n=a(6017),r=a(51235);const i=async()=>{const e=await(0,n.soapFetch)("GetShareInfo",{_jsns:"urn:zimbraAccount",includeSelf:0});return"Fault"in e?Promise.reject(e.Fault):Promise.resolve({isFulfilled:!(0,r.isEmpty)(e),folders:e?.share??[]})}},93046:(e,t,a)=>{"use strict";a.d(t,{_E:()=>p,yj:()=>v,px:()=>E,vR:()=>w,WR:()=>m,t3:()=>l,tc:()=>u,mv:()=>y,f8:()=>g,mj:()=>h});var n=a(12902),r=a(30270),i=a(40300);const l=(0,r.Ue)()((e=>({folders:{},linksIdMap:{},searches:{},updateFolder:(t,a)=>{e((0,n.ZP)((e=>{e?.folders?.[t]&&(e.folders[t]={...e.folders[t],...a})})))}})));i.O.onmessage=({data:e})=>{l.setState(e)};var o=a(92652),s=a(6017),c=a(51235),d=a(53955);const m=e=>l((t=>t.folders?.[e])),u=()=>l((e=>e.folders)),p=()=>l.getState().folders;function f(e){const t=e?.parent&&(a=e.parent,l.getState()?.folders?.[a]);var a;return"oname"in e&&e?.oname===s.ROOT_NAME?e.id:t?f(t):e.id}const g=e=>l((t=>{const a=t.folders?.[e];if(a){const e=f(a);return t.folders?.[e]}})),v=e=>{const t=l.getState().folders?.[e];if(t){const e=f(t);return l.getState().folders?.[e]}},h=()=>l((e=>(0,c.filter)(e.folders,(e=>e.id?.split(":")?.includes(s.FOLDERS.USER_ROOT))))),b=()=>(0,c.filter)(l.getState().folders,(e=>e.id?.split(":")?.includes(s.FOLDERS.USER_ROOT)));function E(e){const t=b(),a=(0,c.find)(t,(t=>(0,c.some)(t.id?.split(":"),(t=>e?.split(":")?.includes(t)))));return a?.id}const y=e=>{const t=g(e);return(0,o.useMemo)((()=>(0,d.mf)(t?.children??[])),[t?.children])},w=()=>l.getState().updateFolder},53955:(e,t,a)=>{"use strict";a.d(t,{C_:()=>r,dK:()=>l,ek:()=>i,mf:()=>o});var n=a(6017);a(51235);const r=e=>e.id===n.FOLDERS.USER_ROOT||e.oname===n.ROOT_NAME,i=e=>!!e?.absFolderPath?.includes("/Trash/"),l=e=>{return t=e,a=n.FOLDERS.TRASH,t.id.split(":").includes(a)||i(e);var t,a},o=e=>{let t={};return e.forEach((e=>{t[e.id]=e,e.children&&(t={...t,...o(e.children)})})),t}},70656:(e,t,a)=>{"use strict";a.d(t,{el:()=>n});const n={USER_ROOT:"1",INBOX:"2",TRASH:"3",SPAM:"4",SENT:"5",DRAFTS:"6",CONTACTS:"7",TAGS:"8",CONVERSATIONS:"9",CALENDAR:"10",ROOT:"11",NOTEBOOK:"12",AUTO_CONTACTS:"13",IM_LOGS:"14",TASKS:"15",BRIEFCASE:"16"}},69882:(e,t,a)=>{"use strict";a.d(t,{F:()=>r});var n=a(6017);const r=()=>{const{prefs:e}=(0,n.getUserSettings)();return e}},82163:(e,t,a)=>{"use strict";a.d(t,{rR:()=>n});const n=(e,t)=>e.id.split(":").includes(t)},40300:(e,t,a)=>{"use strict";a.d(t,{O:()=>n});const n=new Worker(new URL(a.p+a.u(447),a.b))},78571:(e,t,a)=>{"use strict";a.d(t,{CX:()=>v,ZP:()=>h,cd:()=>g});var n=a(92652),r=a.n(n),i=a(97363),l=a(6017),o=a(51235),s=a(50364);const c=new RegExp(`${s.yE}(.*)${s.yE}`,"s"),d=e=>""===e||void 0===e?"":e.replace(/(?:https?:\/\/|www\.)+(?![^\s]*?")([\w.,@?!^=%&amp;:()/~+#-]*[\w@?!^=%&amp;()/~+#-])?/gi,(e=>{const t=document.createElement("div"),a=document.createElement("a");let n=e.replace(/&amp;/g,"&");return e.startsWith("http")||e.startsWith("https")||(n=`http://${e}`),a.href=n.replace(/&#64;/g,"@").replace(/&#61;/g,"="),a.target="_blank",a.innerHTML=e,t.appendChild(a),t.innerHTML.trim()})),m=e=>null!=e?e.replace(/(?:\r\n|\r|\n)/g,"<br/>"):"";function u({text:e}){const t=(0,n.useMemo)((()=>d(m(e))),[e]);return r().createElement(i.Text,{dangerouslySetInnerHTML:{__html:t},overflow:"break-word"})}function p({msgId:e,body:t,parts:a}){const i=(0,n.useRef)(),l=(0,n.useRef)(),s=(0,n.useCallback)(((e,t=16)=>{let a=e;return("string"==typeof e||e instanceof String)&&(a=a.replace("px","")),a=parseInt(a,10),1/t*a+"rem"}),[]),c=(0,n.useCallback)((()=>{if(!(0,o.isNull)(i.current)){const e=i.current.contentDocument.querySelector("html")?.scrollHeight;i.current.style.height="0",i.current.style.height=s(e??"0")}}),[s]),m=(0,n.useMemo)((()=>d(t)),[t]);return(0,n.useLayoutEffect)((()=>{(0,o.isNull)(i.current)||(0,o.isNull)(i.current.contentDocument)||(i.current.contentDocument.open(),i.current.contentDocument.write(`<div>${m}</div>`),i.current.contentDocument.close());const e=document.createElement("style");e.textContent="\n\t\t\tmax-width: 100% !important;\n\t\t\tbody {\n\t\t\t\tmax-width: 100% !important;\n\t\t\t\tmargin: 0;\n\t\t\t\toverflow-y: hidden;\n\t\t\t\tfont-family: Roboto, sans-serif;\n\t\t\t\tfont-size: 0.875rem;\n\t\t\t\tbackground-color: #ffffff;\n\t\t\t}\n\t\t\tbody pre, body pre * {\n\t\t\t\twhite-space: pre-wrap;\n\t\t\t\tword-wrap: anywhere !important;\n\t\t\t\ttext-wrap: suppress !important;\n\t\t\t}\n\t\t\timg {\n\t\t\t\tmax-width: 100%\n\t\t\t}\n\t\t\ttbody{position:relative !important}\n\t\t\ttd{\n\t\t\t\tmax-width: 100% !important;\n\t\t\t\toverflow-wrap: anywhere !important;\n\t\t\t}\n\t\t\t#bodyTable {\n\t\t\t\theight: fit-content\n\t\t\t}\n\t\t",(0,o.isNull)(i.current)||(0,o.isNull)(i.current.contentDocument)||i.current.contentDocument.head.append(e),c();const t=new ResizeObserver(c);return l.current&&t.observe(l.current),()=>t.disconnect()}),[c,e,a,m]),r().createElement("div",{ref:l,className:"force-white-bg",style:{width:"100%"}},r().createElement("iframe",{title:e,ref:i,onLoad:c,style:{border:"none",width:"100%"}}))}const f=()=>r().createElement(i.Container,{padding:{bottom:"medium"}},r().createElement(i.Text,null,`(${(0,l.t)("message.invite_has_no_message","This invite has no text message")}.)`));function g(e){if(e){const t=c.exec(e)?.[0];return(t?(0,o.replace)(e,t,""):e).trim()}return""}function v(e){let t=g(e);return t.startsWith("</div>")&&(t=`<html>${t.slice(12)}`),t}function h({fullInvite:e,inviteId:t,parts:a}){if(!e)return null;if(void 0===e.fragment||""===e.fragment)return r().createElement(f,null);if(e?.htmlDescription?.[0]?._content){const n=e?.htmlDescription?.[0]?._content??"",i=c?.exec(n)?.[0],l=i?(0,o.replace)(n,i,""):n;return r().createElement(p,{msgId:t,body:v(l),parts:a})}const n=e?.textDescription?.[0]?._content??"",i=c?.exec(n)?.[0],l=i?(0,o.replace)(n,i,""):n;return r().createElement(u,{text:g(l)})}},42128:(e,t,a)=>{"use strict";a.d(t,{kn:()=>v});var n=a(51235),r=a(750),i=a.n(r),l=a(97296),o=a.n(l),s=a(85259),c=a(69882),d=a(50364),m=a(83201),u=a(89458);o()(i());let p=0;const f=({start:e,duration:t})=>{const a=i()(e);if(t?.includes("m")){const e=60*parseInt(t,10),r=a.add(e,"s").valueOf();return(0,n.isNaN)(r)?a.valueOf()+3600:r}const r=parseInt(t,10),l=a.add(r,"s").valueOf();return(0,n.isNaN)(l)?a.valueOf()+3600:l},g={richTextButton:!1,attachmentsButton:!1,saveButton:!1,sendButton:!1,organizer:!1,title:!1,location:!1,meetingRoom:!1,virtualRoom:!1,equipment:!1,attendees:!1,optionalAttendees:!1,freeBusySelector:!1,calendarSelector:!1,private:!1,datePicker:!1,timezone:!1,allDay:!1,reminder:!1,recurrence:!1,attachments:!1,composer:!1},v=({event:e,invite:t,context:a})=>{const r=((e,t)=>{const a=(0,s.p)(),{zimbraPrefCalendarDefaultApptDuration:r,zimbraPrefCalendarApptReminderWarningTime:l,zimbraPrefDefaultCalendarId:o}=(0,c.F)(),m=(0,n.find)(a,["identityName","DEFAULT"]),u=(0,n.find)(t,["id",o??d.Ai.DEFAULT_CALENDAR_ID]),p=i().tz.guess(!0);return{attach:void 0,calendar:u?{id:u.id,name:u.name,rgb:u.rgb,color:u.color,owner:u?.owner}:void 0,panel:!1,isException:!1,exceptId:void 0,isSeries:!1,isInstance:!0,isRichText:!0,isNew:(0,n.startsWith)(e,"new"),attachmentFiles:[],organizer:m,sender:m,title:"",location:"",meetingRoom:void 0,equipment:void 0,room:void 0,attendees:[],optionalAttendees:[],allDay:!1,freeBusy:"B",class:"PUB",originalStart:i()().set("second",0).set("millisecond",0).valueOf(),originalEnd:f({start:i()().set("second",0).set("millisecond",0).valueOf(),duration:r}),start:i()().set("second",0).set("millisecond",0).valueOf(),end:f({start:i()().set("second",0).set("millisecond",0).valueOf(),duration:r}),inviteId:void 0,timezone:p,reminder:l,recur:void 0,richText:"",plainText:"",disabled:g,id:e}})((o=e?.resource?.id,p+=1,`${o??"new"}-${p}`),a.folders),l=(({editor:e,context:t})=>{const a=(0,n.omit)(t,["disabled","folders","dispatch"]);let r={...e};return(0,n.isEmpty)(t)||(r={...r,...a}),(0,n.isEmpty)(t?.disabled)||(r={...r,disabled:{...r.disabled,...t.disabled}}),r})({editor:(0,m.Nh)({invite:t,event:e,emptyEditor:r,context:a}),context:a});var o;return a.dispatch((0,u.RY)(l)),l}},85259:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var n=a(6017),r=a(51235);const i=()=>{const e=(0,n.getUserAccount)(),t=(0,r.sortBy)(e?.identities.identity,(({name:e})=>"DEFAULT"===e?0:1));return(0,r.map)(t,((e,t)=>{const a=e.name?`${e.name}`:void 0,n=e._attrs?.zimbraPrefFromDisplay?`${e._attrs?.zimbraPrefFromDisplay} `:void 0,i=e._attrs?.zimbraPrefFromAddress?`(<${e._attrs?.zimbraPrefFromAddress}>) `:void 0;return{value:`${t}`,label:(0,r.compact)([a,n,i]).join(" "),address:e._attrs?.zimbraPrefFromAddress,fullName:e._attrs?.zimbraPrefFromDisplay,type:e._attrs?.zimbraPrefFromAddressType,identityName:e.name}}))}},37312:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var n=a(92652),r=a.n(n),i=a(97363),l=a(6017);const o=({mainAlignment:e="center",crossAlignment:t="center",onConfirm:a,color:n="primary",label:o,secondaryAction:s,secondaryLabel:c=(0,l.t)("label.cancel","cancel"),primaryBtnType:d="default",secondaryBtnType:m="default",disabled:u,secondaryDisabled:p,background:f="primary",secondarybackground:g,secondaryColor:v="secondary",showDivider:h=!0,tooltip:b,additionalAction:E,additionalBtnType:y="outlined",additionalColor:w="secondary",additionalLabel:A=(0,l.t)("label.cancel","cancel")})=>r().createElement(i.Container,{mainAlignment:e,crossAlignment:t},h&&r().createElement(i.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",orientation:"horizontal",height:"fit"},r().createElement(i.Divider,null)),r().createElement(i.Container,{orientation:"horizontal",mainAlignment:"space-between"},E&&r().createElement(i.Container,{orientation:"horizontal",width:"fit"},r().createElement(i.Button,{color:w,type:y,onClick:E,label:A,width:"fit"}),r().createElement(i.Padding,{horizontal:"extrasmall"})),r().createElement(i.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"flex-end",crossAlignment:"flex-start",orientation:"horizontal",height:"fit"},s&&r().createElement(r().Fragment,null,r().createElement(i.Button,{backgroundColor:g,color:v,type:m,onClick:s,label:c,disabled:p,width:"fit"}),r().createElement(i.Padding,{horizontal:"extrasmall"})),b?r().createElement(i.Tooltip,{label:b,placement:"top",maxWidth:"fit"},r().createElement(i.Button,{width:"fit",color:n,onClick:a,label:o,type:d,disabled:u,backgroundColor:n||f})):r().createElement(i.Button,{width:"fit",color:n,onClick:a,label:o,type:d,disabled:u,backgroundColor:n||f}))))},18671:(e,t,a)=>{"use strict";a.d(t,{x:()=>l});var n=a(92652),r=a.n(n),i=a(97363);const l=({title:e,onClose:t})=>r().createElement(r().Fragment,null,r().createElement(i.Row,{orientation:"horizontal",mainAlignment:"space-between",takeAvailableSpace:!0,wrap:"nowrap",width:"100%"},r().createElement(i.Text,{weight:"bold",size:"large"},e),t&&r().createElement(i.IconButton,{size:"medium",style:{padding:{all:"small"},margin:0},onClick:t,icon:"CloseOutline"})),r().createElement(i.Container,{padding:{top:"small",bottom:"small"}},r().createElement(i.Divider,null)))},6062:(e,t,a)=>{"use strict";a.d(t,{Qk:()=>o,bK:()=>l,sd:()=>s});var n=a(97363),r=a(91750),i=a.n(r);const l=i().div.withConfig({displayName:"styled-components__Square",componentId:"sc-1pr1an-0"})(["width:1.125rem;height:1.125rem;position:relative;top:-0.1875rem;border:0.0625rem solid ",";background:",";border-radius:0.25rem;"],(({theme:e})=>e.palette.gray2.regular),(({color:e})=>e)),o=i()(n.Container).withConfig({displayName:"styled-components__ColorContainer",componentId:"sc-1pr1an-1"})(["border-bottom:0.0625rem solid ",";"],(({theme:e})=>e.palette.gray2.regular)),s=i()(n.Text).withConfig({displayName:"styled-components__TextUpperCase",componentId:"sc-1pr1an-2"})(["text-transform:capitalize;"])},80802:(e,t,a)=>{"use strict";a.d(t,{q:()=>c});var n=a(92652),r=a.n(n),i=a(97363),l=a(6017),o=a(51235),s=a(65107);const c=({event:e,disableOuterTooltip:t})=>{const[a,c]=(0,n.useState)(!1),d=(0,n.useCallback)((e=>{e.stopPropagation(),c((e=>!e))}),[]),m=(0,n.useCallback)((()=>{c(!1)}),[]),u=(0,l.useTags)(),p=(0,n.useMemo)((()=>(0,o.reduce)(u,((t,a)=>(0,o.includes)(e?.resource?.tags,a.id)?[...t,a]:t),[])),[e?.resource?.tags,u]),f=(0,n.useMemo)((()=>p?.length>1?"TagsMoreOutline":"Tag"),[p]),g=(0,n.useMemo)((()=>1===p?.length&&p?.[0]?.color?l.ZIMBRA_STANDARD_COLORS[p?.[0]?.color]?.hex:void 0),[p]),v=(0,n.useMemo)((()=>1===p?.length?p?.[0]?.name:""),[p]),h=(0,s.ab)(p),b=(0,n.useMemo)((()=>e?.resource?.tags?.length>1),[e?.resource?.tags]),E=(0,n.useMemo)((()=>e?.resource?.tags&&0!==e?.resource?.tags?.length&&""!==e?.resource?.tags?.[0]&&!b&&h),[e?.resource?.tags,b,h]),y=(0,n.useMemo)((()=>(0,o.reduce)(u,((t,a)=>((0,o.includes)(e?.resource?.tags,a.id)&&t.push({...a,color:parseInt(l.ZIMBRA_STANDARD_COLORS[a.color??0].hex,10),label:a.name,customComponent:r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"space-between"},r().createElement(i.Row,{mainAlignment:"flex-end"},r().createElement(i.Padding,{right:"small"},r().createElement(i.Icon,{icon:"Tag",color:l.ZIMBRA_STANDARD_COLORS[a.color??0].hex}))),r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},r().createElement(i.Text,null,a.name))))}),t)),[])),[e?.resource?.tags,u]);return r().createElement(r().Fragment,null,E&&r().createElement(i.Tooltip,{placement:"top",label:v},r().createElement(i.Padding,{left:"extrasmall"},r().createElement(i.Icon,{size:"medium","data-testid":"TagSingleIcon",icon:f,color:g,onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1),onFocus:()=>t(!0),onBlur:()=>t(!1)}))),b&&r().createElement(i.Dropdown,{items:y,forceOpen:a,onClose:m},r().createElement(i.Padding,{left:"extrasmall"},r().createElement(i.Icon,{size:"medium","data-testid":"TagMultiIcon",icon:f,onClick:d,color:g,onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1),onFocus:()=>t(!0),onBlur:()=>t(!1)}))))}},2244:(e,t,a)=>{"use strict";a.d(t,{uY:()=>h,QR:()=>E,mD:()=>b,UO:()=>T,qd:()=>w,y5:()=>y,ZE:()=>g,N4:()=>v,ay:()=>x});var n=a(6017),r=a(51235),i=a(750),l=a.n(i),o=a(93046),s=a(82163),c=a(21850),d=(a(23298),a(97207)),m=a(84418);const u=(0,a(85583).createAsyncThunk)("calendars/getMiniCalRequest",(async({start:e,end:t},{getState:a})=>{const i=(0,r.filter)((0,r.values)(a()?.calendars?.calendars),(e=>e.checked&&!e.broken));return(async({start:e,end:t,folder:a})=>(0,n.soapFetch)("GetMiniCal",{_jsns:"urn:zimbraMail",e:t,s:e,folder:a}))({start:e,end:t,folder:(0,r.map)(i,(e=>({id:e.id})))})}));var p=a(89323);const f=/^.+\.([^.]+)$/,g=e=>{const t=(0,o._E)(),a=e?.absFolderPath?.split("/");a?.pop();const n=(0,r.map)(a,(e=>(0,r.find)(t,(t=>t.name===e))??""))??[];return(0,r.some)(n,["isLink",!0])??!1},v=e=>{const t=(0,o.yj)(e.id);return t?.id===n.FOLDERS.USER_ROOT??!1},h=(e,t)=>{let a=0;for(let t=0;t<e?.length;t+=1)a+=e.charCodeAt(t);return t.avatarColors["avatar_"+(a%50+1)]},b=e=>{const t=f.exec(e.filename);if((0,r.isNil)(t))switch(e.contentType){case"text/html":return"html";case"text/css":return"css";case"text/xml":return"xml";case"image/gif":return"gif";case"image/jpeg":return"jpg";case"application/x-javascript":return"js";case"application/atom+xml":return"atom";case"application/rss+xml":return"rss";case"text/mathml":return"mml";case"text/plain":return"txt";case"text/vnd.sun.jme.app-descriptor":return"jad";case"text/vnd.wap.wml":return"wml";case"text/x-component":return"htc";case"image/png":return"png";case"image/tiff":return"tif,tiff";case"image/vnd.wap.wbmp":return"wbmp";case"image/x-icon":return"ico";case"image/x-jng":return"jng";case"image/x-ms-bmp":return"bmp";case"image/svg+xml":return"svg";case"image/webp":return"webp";case"application/java-archive":return"jar,war,ear";case"application/mac-binhex":return"hqx";case"application/msword":return"doc";case"application/pdf":return"pdf";case"application/postscript":return"ps,eps,ai";case"application/rtf":return"rtf";case"application/vnd.ms-excel":return"xls";case"application/vnd.ms-powerpoint":return"ppt";case"application/vnd.wap.wmlc":return"wmlc";case"application/vnd.google-earth.kml+xml":return"kml";case"application/vnd.google-earth.kmz":return"kmz";case"application/x-z-compressed":return"z";case"application/x-cocoa":return"cco";case"application/x-java-archive-diff":return"jardiff";case"application/x-java-jnlp-file":return"jnlp";case"application/x-makeself":return"run";case"application/x-perl":return"pl,pm";case"application/x-pilot":return"prc,pdb";case"application/x-rar-compressed":return"rar";case"application/x-redhat-package-manager":return"rpm";case"application/x-sea":return"sea";case"application/x-shockwave-flash":return"swf";case"application/x-stuffit":return"sit";case"application/x-tcl":return"tcl";case"application/x-x-ca-cert":return"der";case"application/x-xpinstall":return"xpi";case"application/xhtml+xml":return"xhtml";case"application/zip":return"zip";case"audio/midi":return"midi";case"audio/mpeg":case"video/mp":return"mp";case"audio/ogg":return"ogg";case"audio/x-realaudio":return"ra";case"video/gpp":return"gp";case"video/mpeg":return"mpeg";case"video/quicktime":return"mov";case"video/x-flv":return"flv";case"video/x-mng":return"mng";case"video/x-ms-asf":return"asf";case"video/x-ms-wmv":return"wmv";case"video/x-msvideo":return"avi";default:return"?"}return t[1]},E=e=>{let t="";for(let a=0;a<e.length;a+=1){const n=e.charCodeAt(a);if(n>127||34===n){let e=n.toString(10);for(;e.length<4;)e=`0${e}`;t+=`&#${e};`}else t+=e.charAt(a)}return t},y=(e,t)=>{const{start:a,end:r,alarmData:i}=e,o=l()(r).diff(l()(a),"seconds");if(a.valueOf()<t&&r.valueOf()>t)return{color:"info",size:"large",text:(0,n.t)("label.ongoing","Ongoing")};if(a.valueOf()===t)return{color:"info",size:"large",text:(0,n.t)("label.now","Now")};if(a.valueOf()<t)return{color:"error",size:"large",text:l()(a).from(l()())};if(i&&i?.[0]&&i?.[0]?.alarmInstStart){if(i[0].alarmInstStart<t&&l()(i[0].alarmInstStart).add(o,"seconds").valueOf()>t)return{color:"info",size:"large",text:(0,n.t)("label.ongoing","Ongoing")};if(i[0].alarmInstStart<t)return{color:"error",size:"large",text:l()(i[0].alarmInstStart).fromNow()}}return{color:"info",size:"large",text:l()(i[0].alarmInstStart).fromNow()}},w=({folderId:e,folderName:t})=>{switch(e){case n.FOLDERS.USER_ROOT:return(0,n.t)("label.root",t);case"all":return(0,n.t)("label.all_calendars","All calendars");case n.FOLDERS.CALENDAR:return(0,n.t)("label.calendar",t);case n.FOLDERS.TRASH:return(0,n.t)("label.trash",t);default:return t}},A=(e,t)=>(0,r.reduce)(e,((e,a)=>a.children.length>0?(0,s.rR)(a,d.X.ALL_CALENDAR)||a.checked!==t?[...e,...A(a.children,t)]:[...e,a.id,...A(a.children,t)]:(0,s.rR)(a,d.X.ALL_CALENDAR)||a.checked!==t?e:[...e,a.id]),[]);function x({folder:e,checked:t,dispatch:a,start:n,end:i,query:l}){const s=A([e],t),d=t?c.w4.UNCHECK:c.w4.CHECK,f=(0,r.map)(s,(e=>({id:e,op:d})));(0,m.f)(f).then((e=>{d!==c.w4.CHECK||e.Fault||(a((0,p.C)({spanEnd:i,spanStart:n,query:l})),a(u({start:n,end:i})).then((e=>{const t=(0,o.vR)();e?.payload?.Fault&&(0,r.forEach)(e?.payload?.Fault,(({id:e})=>{t(e,{broken:!0})}))})))}))}const T=({item:e,checked:t})=>e.id===n.FOLDERS.USER_ROOT||e.isLink&&e.oname===n.ROOT_NAME?"":(0,s.rR)(e,n.FOLDERS.TRASH)?t?"Trash2":"Trash2Outline":(0,s.rR)(e,d.X.ALL_CALENDAR)?t?"Calendar2":"CalendarOutline":e.isLink||g(e)?t?"SharedCalendar":"SharedCalendarOutline":t?"Calendar2":"CalendarOutline"},21850:(e,t,a)=>{"use strict";a.d(t,{GB:()=>r,UM:()=>l,lm:()=>i,sm:()=>o,w4:()=>n});const n={COLOR:"color",RENAME:"rename",MOVE:"move",DELETE:"delete",GRANT:"grant",REVOKE_GRANT:"!grant",CHECK:"check",UNCHECK:"!check",TRASH:"trash",EMPTY:"empty",FREE_BUSY:"fb"},r={REQUIRED:"REQ",OPTIONAL:"OPT",NON_PARTICIPANT:"NON"},i={COUNTER:"COUNTER",REQUEST:"REQUEST"},l={EMAIL:"email",CAL_RES_TYPE:"zimbraCalResType",FULL_NAME:"fullName"},o={EQUAL:"eq"}},23298:(e,t,a)=>{"use strict";a.d(t,{V:()=>r,n:()=>n});const n=[{value:"1",label:"SUNDAY"},{value:"2",label:"MONDAY"},{value:"3",label:"TUESDAY"},{value:"4",label:"WEDNESDAY"},{value:"5",label:"THURSDAY"},{value:"6",label:"FRIDAY"},{value:"7",label:"SATURDAY"}],r=[{color:"#000000",background:"#E6E9ED",label:"black"},{color:"#007AFF",background:"#F4FBFF",label:"blue"},{color:"#5AC8FA",background:"#E9F8FE",label:"cyan"},{color:"#34C759",background:"#EFF8F0",label:"green"},{color:"#AF52DE",background:"#F2EEF9",label:"purple"},{color:"#FF3B30",background:"#FDEDED",label:"red"},{color:"#FFCC00",background:"#FFF7DE",label:"yellow"},{color:"#FF2D55",background:"#FDECF1",label:"pink"},{color:"#8E8E93",background:"#F5F6F8",label:"grey"},{color:"#FF9500",background:"#FFF0EC",label:"orange"}]},50364:(e,t,a)=>{"use strict";a.d(t,{Ae:()=>f,Ah:()=>s,Ai:()=>l,Fq:()=>h,Go:()=>E,Lv:()=>m,XD:()=>n,Yt:()=>b,cp:()=>u,ee:()=>g,iJ:()=>c,jb:()=>d,jh:()=>r,lg:()=>i,rE:()=>y,ux:()=>v,yE:()=>o,zT:()=>p});const n="carbonio-calendars-ui",r="calendars",i={APP:"app",BOARD:"board",SEARCH:"search"},l={DEFAULT_CALENDAR_ID:"10"},o="-:::_::_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_::_:_::-",s="<html><body id='htmlmode'>",c="</body></html>",d={ROOM:"ROO",RESOURCE:"RES"},m={USER:"usr",PUBLIC:"pub"},u="99999999-9999-9999-9999-999999999999",p={ALL_DAY:"YYYYMMDD",LOCAL:"YYYYMMDD[T]HHmmss",UTC:"YYYYMMDD[T]HHmmss[Z]"},f="updateView",g=7,v=24,h=60,b=60,E=h*v*g,y=v*h},97207:(e,t,a)=>{"use strict";a.d(t,{X:()=>r,n:()=>n});let n=function(e){return e.MOVE_TO_ROOT="moveToRoot",e.EMPTY_TRASH="emptyTrash",e.REMOVE_FROM_LIST="removeFromList",e.SHARES_INFO="sharesInfo",e.EDIT="edit",e.NEW="new",e.DELETE="delete",e.SHARE="share",e.SHARE_URL="share_url",e.FIND_SHARES="find_shares",e.EXPORT_ICS="export_ics",e.UPLOAD="upload",e}({}),r=function(e){return e.ALL_CALENDAR="all",e.SHARES="shares",e}({})},29870:(e,t,a)=>{"use strict";a.d(t,{b:()=>r,l:()=>n});let n=function(e){return e.MEETING_ROOM="X-CRB-MEETING-ROOM",e}({}),r=function(e){return e.ROOM_NAME="ROOM-NAME",e.ROOM_LINK="ROOM-LINK",e}({})},38828:(e,t,a)=>{"use strict";a.d(t,{z:()=>c});var n=a(92652),r=a(51235),i=a(750),l=a.n(i),o=a(6017);const s=async({s:e,e:t,uid:a,excludeUid:n})=>(0,o.soapFetch)("GetFreeBusy",(0,r.omitBy)({_jsns:"urn:zimbraMail",s:e,e:t,uid:a,excludeUid:n},r.isNil)),c=(e,t,a)=>{const[i,o]=(0,n.useState)(e),c=(0,n.useMemo)((()=>(0,r.filter)(t,(e=>!!e.email))),[t]),[d,m]=(0,n.useState)(void 0);return(0,n.useEffect)((()=>{if(e&&c&&c.length>0){const t=l()(e).format("YYYY/MM/DD"),n=l()(e).startOf("day").valueOf(),u=l()(e).endOf("day").valueOf();if(!d){const e=(0,r.map)(c,(e=>e.email)).join(",");s({s:n,e:u,uid:e,excludeUid:a}).then((e=>{const a=(0,r.map)(e.usr,(e=>({...e,email:e.id,t:e.t??[],f:e.f??[],b:e.b??[],requestedDays:[t]})));a.length&&m(a)}))}if(d){const p=(0,r.differenceBy)(c,d,"email");if(p.length){const e=(0,r.map)(p,(e=>e.email)).join(",");s({s:n,e:u,uid:e,excludeUid:a}).then((e=>{const a=(0,r.map)(e.usr,(e=>({...e,email:e.id,t:e.t??[],f:e.f??[],b:e.b??[],requestedDays:[t]}))),n=d.concat(a);m(n)}))}const f=l()(i).format("YYYY/MM/DD");if(t!==f){o(e);const i=(0,r.filter)(d,(e=>!(0,r.includes)(e.requestedDays,t)));if(i.length>0){const e=(0,r.map)(i,(e=>e.email)).join(",");s({s:n,e:u,uid:e,excludeUid:a}).then((e=>{const a=(0,r.map)(e.usr,(e=>{const a=(0,r.find)(d,["id",e.id]);return a?{...a,email:a.email,t:(a?.t??[]).concat(e.t??[]),f:(a?.f??[]).concat(e.f??[]),b:(a?.b??[]).concat(e.b??[]),requestedDays:(a?.requestedDays??[]).concat([t])}:{...e,email:e.id,t:e.t??[],f:e.f??[],b:e.b??[],requestedDays:[t]}})),n=(0,r.differenceBy)(d,e.usr,"id");m(n.concat(a))}))}}}}}),[c,d,a,i,e]),(0,n.useMemo)((()=>d),[d])}},37255:(e,t,a)=>{"use strict";a.d(t,{t:()=>i});var n=a(51235),r=a(56346);const i=()=>{const e=(0,r.X)();return(0,n.map)((0,n.filter)(e,(e=>!0===e.checked&&!e.broken)),((e,t)=>0===t?`inid:"${e.id}"`:`OR inid:"${e.id}"`)).join(" ")}},56346:(e,t,a)=>{"use strict";a.d(t,{X:()=>l});var n=a(92652),r=a(51235),i=a(93046);const l=()=>{const e=(0,i.tc)();return(0,n.useMemo)((()=>(0,r.filter)(e,["checked",!0])),[e])}},31457:(e,t,a)=>{"use strict";a.d(t,{i:()=>d,u:()=>c});var n=a(92652),r=a.n(n),i=a(750),l=a.n(i),o=a(93747),s=a(83201);const c=(e,t,a,n)=>{const r=l()(e),i=l()(t),o="dddd, DD MMMM, YYYY",s="HH:mm",c=`${o} ${s}`,d=i.diff(r,"days"),m=d>0?`${r.format(o)} -\n\t           ${i.format(o)} - ${n}`:`${r.format(o)} - ${n}`,u=d>0?`${r.format(c)} - ${i.format(c)}`:`${r.format(c)} - ${i.format(s)}`;return a?m:u},d=(e,t,a,i)=>{const[d]=(0,o.useTranslation)(),m=d("label.all_day","All day"),u=(0,n.useMemo)((()=>l().tz.guess()),[]),p=(0,s.Li)(e,u),f=(0,s.Li)(t,u),g=(0,n.useMemo)((()=>(0,s.Li)(e,i)),[e,i]),v=(0,n.useMemo)((()=>(0,s.Li)(t,i)),[t,i]),h=(0,n.useCallback)(((e,t)=>t&&!a?`GMT ${l()(e).startOf("year").tz(t).format("Z")} ${t}`:`GMT ${l()(e).startOf("year").tz(u).format("Z")} ${u}`),[a,u]),b=(0,n.useCallback)(((e,t,a)=>r().createElement(r().Fragment,null,e,r().createElement("br",null),t,r().createElement("br",null),a)),[]),E=(0,n.useMemo)((()=>c(p,f,a,m)),[p,f,a,m]),y=(0,n.useMemo)((()=>c(g,v,a,m)),[g,v,a,m]),w=(0,n.useMemo)((()=>h(p,u)),[h,p,u]),A=(0,n.useMemo)((()=>h(g,i)),[h,g,i]),x=(0,n.useMemo)((()=>i&&e?(0,s.nk)(e,i):(0,s.nk)(e,u)),[u,e,i]),T=(0,n.useMemo)((()=>b(d("creation_timezone_tooltip","Date and time on creation timezone:"),y,A)),[y,A,b,d]),_=(0,n.useMemo)((()=>b(d("local_timezone_tooltip","Date and time on local timezone:"),E,w)),[b,d,E,w]);return{localTimeString:E,localTimezoneString:w,eventTimeString:y,eventTimezoneString:A,showTimezoneTooltip:x,localTimezoneTooltip:T,eventTimezoneTooltip:_}}},56206:(e,t,a)=>{"use strict";a.d(t,{Ik:()=>m,Kd:()=>v,N2:()=>g,Ns:()=>p,Rz:()=>d,Xb:()=>f,jS:()=>c,s1:()=>u});var n=a(6017),r=a(51235),i=a(35525),l=a(50364),o=a(23298),s=a(97225);const c=(e,t,a)=>(0,r.reduce)(e.mp??[],((e,n)=>n.cd&&n.cd===t?[...e,{part:n.part,mid:a}]:e),[]),d=e=>(0,r.groupBy)((0,r.uniqBy)((0,r.map)(e,(e=>({name:e.d,email:e.a,isOptional:"OPT"===e.role||!1,response:e.ptst,cutype:e.cutype}))),"email"),(e=>e.response)),m=e=>{const t={contentType:e.ct,size:e.s||0,name:e.part};return e.mp&&(t.parts=(0,r.map)(e.mp||[],m)),e.filename&&(t.filename=e.filename),e.content&&(t.content=e.content),e.ci&&(t.ci=e.ci),e.cd&&(t.disposition=e.cd),t},u=(e,t)=>(0,r.reduce)(e,((e,a)=>(a&&"attachment"===a.cd&&e.push(m(a)),a.mp?u(a.mp,e):t)),t),p=e=>e?(e=>0===e?.s||0===e?.m||0===e?.h||0===e?.d||0===e?.w)(e)?"-1":(0,r.isNil)(e.s)?(0,r.isNil)(e.m)?(0,r.isNil)(e.h)?(0,r.isNil)(e.d)?(0,r.isNil)(e.w)?"-1":(0,s.xN)(e.w).toString():(0,s.Q5)(e.d).toString():(0,s.wz)(e.h).toString():e.m.toString():e.s%l.Yt==0?(0,s.Aq)(e.s).toString():"1":"0",f=e=>{if(e&&e[0]&&"DISPLAY"===e[0].action){const t=e[0].trigger[0].rel[0];if(t){const e=(t.s||0)+(t.m||0)*l.Yt+(t.h||0)*l.Yt*l.Fq+(t.d||0)*l.Yt*l.Fq*l.ux+(t.w||0)*l.Yt*l.Fq*l.ux*l.ee;if((t.s||0)+(t.m||0)+(t.h||0)+(t.d||0)+(t.w||0)===0)return(0,n.t)("reminder.at_time_of_event","At the time of the event");if(e%(l.Yt*l.Fq*l.ux*l.ee)==0){const t=e/(l.Yt*l.Fq*l.ux*l.ee);return(0,n.t)("reminder.week_before",{count:t,defaultValue_one:"{{count}} week before",defaultValue_other:"{{count}} weeks before"})}if(e%(l.Yt*l.Fq*l.ux)==0){const t=e/(l.Yt*l.Fq*l.ux);return(0,n.t)("reminder.day_before",{count:t,defaultValue_one:"{{count}} day before",defaultValue_other:"{{count}} days before"})}if(e%(l.Yt*l.Fq)==0){const t=e/(l.Yt*l.Fq);return(0,n.t)("reminder.hour_before",{count:t,defaultValue_one:"{{count}} hour before",defaultValue_other:"{{count}} hours before"})}if(e%l.Yt==0){const t=e/l.Yt;return(0,n.t)("reminder.minute_before",{count:t,defaultValue_one:"{{count}} minute before",defaultValue_other:"{{count}} minutes before"})}return(0,n.t)("reminder.second_before",{count:e,defaultValue_one:"{{count}} second before",defaultValue_other:"{{count}} seconds before"})}}return"never"},g=e=>o.V?.[e??0]??o.V[0],v=({rgb:e,color:t})=>e?(e=>e?{color:e,label:"custom",background:(0,i.ph)(.9,e)}:o.V[0])(e):t?g(t):o.V[0]},55360:(e,t,a)=>{"use strict";a.d(t,{Wn:()=>l,Yv:()=>s});var n=a(51235);a(750);const r=(e,t=!1)=>(0,n.map)(e??[],(e=>Object?.keys(e)?.length>2?(e=>({alarm:e.alarm,allDay:e.allDay,draft:e.draft,inviteId:e.invId,isOrg:e.isOrg,dur:e.dur,loc:e?.loc,name:e.name,ptst:e.ptst,neverSent:e.neverSent,or:e.or,otherAtt:e.otherAtt,ex:e.ex,fr:e.fr,recur:e.recur,ridZ:e.ridZ,s:e.s,tzo:e.tzo}))(e):{...e,recur:t})),i=e=>({id:e.id,alarm:e.alarm,alarmData:e.alarmData,hasEx:e?.hasEx,fb:e.fb,fr:e.fr??"",d:e.d,fba:e.fba,md:e.md,flags:e.f??"",ms:e.ms,ptst:e.ptst,rev:e.rev,status:e.status,transp:e.transp,uid:e.uid,compNum:e.compNum,class:e.class,dur:e.dur,allDay:e.allDay,inst:r(e.inst,e.recur),draft:e.draft,inviteId:e.invId,isOrg:e.isOrg,loc:e.loc,otherAtt:e.otherAtt,recur:e.recur??!1,l:e.l,name:e.name,neverSent:e.neverSent,or:e.or,s:e.s,tags:(0,n.isNil)(e.t)?[]:(0,n.filter)(e.t.split(","),(e=>""!==e))}),l=e=>e?(0,n.reduce)(e,((e,t)=>({...e,[t.id]:i(t)})),{}):void 0,o=e=>(0,n.omitBy)({id:e?.id,alarm:e?.inv?.[0]?.comp?.[0]?.alarm,alarmData:e?.inv?.[0]?.comp?.[0]?.alarmData,fb:e?.inv?.[0]?.comp?.[0]?.fb,fr:e?.inv?.[0]?.comp?.[0]?.fr,d:e?.d,fba:e?.inv?.[0]?.comp?.[0]?.fba,md:e.md,flags:e?.inv?.[0]?.comp?.[0]?.f,ms:e?.inv?.[0]?.comp?.[0]?.ms,ptst:e?.ptst,rev:e.rev,status:e?.inv?.[0]?.comp?.[0]?.status,transp:e?.inv?.[0]?.comp?.[0]?.transp,uid:e.uid,compNum:e?.inv?.[0]?.compNum,class:e?.inv?.[0]?.comp?.[0]?.class,dur:e?.inv?.[0]?.comp?.[0]?.e?.[0]?.u&&e?.inv?.[0]?.comp?.[0]?.s?.[0]?.u?e.inv[0].comp[0].e[0].u-e.inv[0].comp[0].s[0].u:void 0,allDay:e?.inv?.[0]?.comp?.[0]?.allDay,inst:e?.id&&e?.inv?.[0]?.comp?.[0]&&1===e?.inv?.length?[{recur:!1,ridZ:e?.inv?.[0]?.comp?.[0]?.s?.[0]?.d,s:e?.inv?.[0]?.comp?.[0]?.s?.[0]?.u,title:e?.inv?.[0]?.comp?.[0]?.name}]:void 0,draft:e?.inv?.[0]?.comp?.[0]?.draft,inviteId:e?.id&&e?.inv?.[0]?`${e.id}-${e.inv[0].id}`:void 0,isOrg:e?.inv?.[0]?.comp?.[0]?.isOrg,loc:e?.inv?.[0]?.comp?.[0]?.loc,otherAtt:e?.inv?.[0]?.comp?.[0]?.otherAtt,recur:e?.inv?.[0]?.comp?.[0]?.recur,l:e.l,name:e?.inv?.[0]?.comp?.[0]?.name,meta:e?.meta,neverSent:e?.inv?.[0]?.comp?.[0]?.neverSent,or:e?.inv?.[0]?.comp?.[0]?.or,s:e.s},n.isNil),s=e=>e?(0,n.reduce)(e,((e,t)=>({...e,[t.id]:o(t)})),{}):void 0},11783:(e,t,a)=>{"use strict";a.d(t,{F0:()=>p,Y4:()=>u,vK:()=>c});var n=a(6017),r=a(51235),i=a(750),l=a.n(i),o=a(56206),s=a(93046);const c=e=>{const t=e?.match(/\bhttps?:\/\/\S+/g);return t?.length?t[0]:void 0},d=e=>{const t=(0,s.yj)(e.id);return{id:e.id,name:e.name,color:(0,o.Kd)({color:e.color,rgb:e?.rgb}),owner:e?.owner??t?.owner,perm:e?.perm}},m=({appt:e,calendar:t,inst:a,invite:n,iAmOrganizer:r})=>({id:e.id,inviteId:a?.inviteId??e.inviteId,ridZ:a?.ridZ,name:a?.name??e.name,calendar:d(t),flags:e.flags,dur:a?.dur??e.dur,iAmOrganizer:r,iAmVisitor:!(r||!t?.owner)??!1,iAmAttendee:(!r&&!t?.owner)??!1,status:a?.status??e.status,location:a?.loc??e.loc,locationUrl:c(a?.loc??e.loc??""),fragment:a?.fr??e.fr,class:a?.class??e.class,freeBusy:a?.fb??e.fb,hasChangesNotNotified:a?.draft??e.draft??!1,inviteNeverSent:a?.neverSent??e.neverSent??!1,hasOtherAttendees:a?.otherAtt??e.otherAtt??!1,isRecurrent:a?.recur??e.recur,isException:a?.ex??!1,hasException:a?.hasEx??e.hasEx??!1,participationStatus:a?.ptst??e.ptst,organizer:e?.or?.d||e?.or?.a?{name:e?.or?.d,email:e?.or?.a}:void 0,compNum:e.compNum,apptStart:a?.s,alarm:e.alarm,alarmData:n?.alarmData??e?.alarmData?.[0]?.alarm,uid:e.uid,tags:e.tags??[],neverSent:a?.neverSent??e.neverSent??!1,isRespRequested:"NE"===(a?.ptst??e.ptst)??!1}),u=({calendar:e,appointment:t,instance:a,invite:r})=>{const i=a?.allDay??t?.allDay,o=(a?a.s+(a?.tzo??0):void 0)||r?.start?.u||t.inst?.[0]?.s,s=a?.dur??t.dur,c=(0,n.getUserAccount)();return{start:i?new Date(l()(o).startOf("day").valueOf()):new Date(o),end:i?new Date(l()(o).add((d=s,d/3600/1e3/24-1),"days").endOf("day").valueOf()):new Date(o+s),resource:m({appt:t,iAmOrganizer:c?.name===t?.or?.a,calendar:e,inst:a,invite:r}),title:a?.name??t?.name??"",allDay:i,id:`${t.id}:${a?.inviteId??t.inviteId}:${a?.ridZ??""}`,isShared:t?.l?.includes(":"),haveWriteAccess:!e.perm||/w/.test(e.perm)};var d},p=(e,t)=>(0,r.isEmpty)(e)?[]:(0,r.reduce)(e,((e,a)=>{const n=a?.l?.includes(":"),i=n?(0,r.find)(t,(e=>`${e.zid}:${e.rid}`===a.l||e.id===a.l)):(0,r.find)(t,(e=>e.id===a.l));return i?[...e,...(0,r.map)(a.inst,(e=>u({calendar:i,appointment:a,instance:e})))]:e}),[])},83201:(e,t,a)=>{"use strict";a.d(t,{Li:()=>v,Nh:()=>E,O2:()=>f,_G:()=>p,_H:()=>b,am:()=>u,nk:()=>h});var n=a(51235),r=a(750),i=a.n(r),l=a(93046),o=a(69882),s=a(78571),c=a(50364),d=a(21850),m=a(29870);const u=e=>{const t=(0,n.find)(e,["name",m.l.MEETING_ROOM]);if(t)return{label:(0,n.find)(t.xparam,["name",m.b.ROOM_NAME])?.value,link:(0,n.find)(t.xparam,["name",m.b.ROOM_LINK])?.value}},p=e=>{const t=(0,n.filter)(e,["cutype",c.jb.ROOM]);return t.length?(0,n.map)(t,(e=>({label:e.d,email:e.a}))):void 0},f=e=>{const t=(0,n.filter)(e,["cutype",c.jb.RESOURCE]);return t.length?(0,n.map)(t,(e=>({label:e.d,email:e.a}))):void 0},g=(e,t)=>(0,n.map)((0,n.filter)(e,["role",t]),(e=>(0,n.omitBy)({company:void 0,email:e?.a,firstName:void 0,fullName:e?.d,id:`${e?.a} ${e.d}`,label:e?.d,lastName:void 0,isGroup:e.isGroup,exp:e.exp},n.isNil))),v=(e,t,a)=>{const n=i()(e).valueOf();if(t){const r=i()(e).tz(t),l=a?i()().tz(a).utcOffset():i()().utcOffset();return n+6e4*(r.utcOffset()-l)}return n},h=(e,t)=>i()(e).tz(t).utcOffset()!==i()(e).utcOffset(),b=e=>{const t=(0,l.yj)(e.id);return{id:e.id,name:e.name,rgb:e.rgb,color:e.color,owner:e.owner??t?.owner}},E=({invite:e,event:t,emptyEditor:a,context:r})=>{if(t&&e){const l=t?.resource?.isRecurrent,m=r?.isInstance??!!t?.resource?.ridZ,E=t?.resource?.isException??!1,y=t.resource.calendar.id??c.Ai.DEFAULT_CALENDAR_ID,w={isSeries:l,isInstance:m,isException:E},{start:A,end:x}=(({editorType:e,invite:t,event:a})=>{const{zimbraPrefCalendarDefaultApptDuration:n="3600"}=(0,o.F)(),r=n?.includes("m")?60*parseInt(n,10)*1e3:1e3*parseInt(n,10);if(a&&t?.start&&t?.end){if(e.isSeries&&!e.isInstance&&!e.isException&&t){const e=t?.start?.u??i()(t?.start?.d),n=t?.end?.u??i()(t?.end?.d),r=v(e,t?.tz),l=v(n,t?.tz);return t.tz&&h(e,t.tz)?{start:a?.allDay?i()(r)?.startOf("date").valueOf():r,end:a?.allDay?i()(l)?.endOf("date").valueOf():l}:{start:a?.allDay?i()(e)?.startOf("date").valueOf():i()(e).valueOf(),end:a?.allDay?i()(n)?.endOf("date").valueOf():i()(n).valueOf()}}const n=v(a.start,t?.tz),r=v(a.end,t?.tz);return t?.tz&&h(a.start,t.tz)?{start:a?.allDay?i()(n)?.startOf("date").valueOf():n,end:a?.allDay?i()(r)?.endOf("date").valueOf():r}:{start:a?.allDay?i()(a?.start)?.startOf("date").valueOf():i()(a?.start).valueOf(),end:a?.allDay?i()(a?.end)?.endOf("date").valueOf():i()(a?.end).valueOf()}}return{start:i()().set("second",0).set("millisecond",0).valueOf(),end:i()().set("second",0).set("millisecond",0).valueOf()+r}})({editorType:w,event:t,invite:e}),T=!(e?.textDescription?.[0]?._content&&!e?.htmlDescription?.[0]?._content),_=e?.textDescription?.[0]?._content?(0,s.cd)(e?.textDescription?.[0]?._content)??"":"",C=e?.htmlDescription?.[0]?._content?(0,s.CX)(e?.htmlDescription?.[0]?._content)??"":"",O=(0,n.find)(r?.folders,["id",y])??(0,n.find)(r?.folders,["id",c.Ai.DEFAULT_CALENDAR_ID]),R=b(O),k=(0,n.omitBy)({calendar:R,id:a.id,ridZ:t?.resource?.ridZ,attach:e.attach,parts:e.parts,attachmentFiles:e.attachmentFiles,isInstance:m,isSeries:l,isException:E,exceptId:e?.exceptId,title:t?.title,location:t?.resource?.location,meetingRoom:p(e.attendees),equipment:f(e.attendees),room:u(e.xprop),attendees:g(e.attendees,d.GB.REQUIRED),optionalAttendees:g(e.attendees,d.GB.OPTIONAL),allDay:t?.allDay,freeBusy:e.freeBusy,class:e.class,originalStart:A,originalEnd:x,start:A,end:x,timezone:e?.start?.tz,inviteId:t?.resource?.inviteId,reminder:e?.alarmValue,recur:m?void 0:e.recurrenceRule,richText:C,plainText:_,isRichText:T,uid:e?.uid,ms:e?.ms,rev:e?.rev},n.isNil);return{...a,...k}}return a}},16990:(e,t,a)=>{"use strict";a.d(t,{F:()=>o,I:()=>l});var n=a(51235),r=a(56206),i=a(11783);const l=e=>({ciFolder:e?.inv?.[0]?.comp?.[0]?.ciFolder,allDay:e?.inv?.[0]?.comp?.[0]?.allDay??!1,apptId:e?.inv?.[0]?.comp?.[0]?.apptId,tz:(0,n.find)(e?.inv?.[0]?.tz,(e=>"UTC"!==e.id))?.id,id:e.id,attendees:e?.inv?.[0]?.comp?.[0]?.at??[],parent:e.l,flags:e.f,parts:e.mp?(0,r.Ik)(e.mp):[],alarmString:(0,r.Xb)(e?.inv?.[0]?.comp?.[0]?.alarm),alarmValue:(0,r.Ns)(e?.inv?.[0]?.comp?.[0]?.alarm?.[0]?.trigger?.[0]?.rel?.[0]),class:e?.inv?.[0]?.comp?.[0]?.class,compNum:e?.inv?.[0]?.comp?.[0]?.compNum,date:e.d,textDescription:e?.inv?.[0]?.comp?.[0]?.desc,htmlDescription:e?.inv?.[0]?.comp?.[0]?.descHtml,end:e?.inv?.[0]?.comp?.[0]?.e[0],freeBusy:e?.inv?.[0]?.comp?.[0]?.fb??"B",freeBusyActualStatus:e?.inv?.[0]?.comp?.[0]?.fba??"B",fragment:e?.inv?.[0]?.comp?.[0]?.fr,isOrganizer:e?.inv?.[0]?.comp?.[0]?.isOrg??!1,location:e?.inv?.[0]?.comp?.[0]?.loc??"",name:e?.inv?.[0]?.comp?.[0]?.name,noBlob:e?.inv?.[0]?.comp?.[0]?.noBlob,organizer:e?.inv?.[0]?.comp?.[0]?.or,recurrenceRule:e?.inv?.[0]?.comp?.[0]?.recur,isRespRequested:e?.inv?.[0]?.comp?.[0]?.rsvp,start:e?.inv?.[0]?.comp?.[0]?.s[0],sequenceNumber:e?.inv?.[0]?.comp?.[0]?.seq,status:e?.inv?.[0]?.comp?.[0]?.status,transparency:e?.inv?.[0]?.comp?.[0]?.transp,uid:e?.inv?.[0]?.comp?.[0]?.uid,url:e?.inv?.[0]?.comp?.[0]?.url,isException:e?.inv?.[0]?.comp?.[0]?.ex||!1,exceptId:e?.inv?.[0]?.comp?.[0]?.exceptId,tagNamesList:e.tn,tags:(0,n.isNil)(e.t)?[]:(0,n.filter)(e.t.split(","),(e=>""!==e)),attach:{mp:(0,r.jS)(e?.mp?.[0]??[],"attachment",e?.id)},attachmentFiles:(0,r.s1)(e.mp??[],[]),participants:(0,r.Rz)(e?.inv?.[0]?.comp?.[0]?.at??[]),alarm:!!e?.inv?.[0]?.comp?.[0]?.alarm,alarmData:e?.inv?.[0]?.comp?.[0]?.alarm,ms:e.ms||0,rev:e.rev||0,meta:e.meta,xprop:e?.inv?.[0]?.comp?.[0]?.xprop,neverSent:e?.inv?.[0]?.comp?.[0]?.neverSent??!1,locationUrl:(0,i.vK)(e?.inv?.[0]?.comp?.[0]?.loc??"")}),o=e=>({ciFolder:e?.comp?.[0]?.ciFolder,apptId:e?.comp?.[0]?.apptId,id:`${e?.comp?.[0]?.apptId}-${e.id}`,attendees:e.comp?.[0]?.at??[],parent:e?.comp?.[0]?.ciFolder,flags:e.f,parts:e.mp?(0,r.Ik)(e.mp):[],alarmString:(0,r.Xb)(e?.comp?.[0]?.alarm),alarmValue:(0,r.Ns)(e?.comp?.[0]?.alarm?.[0]?.trigger?.[0]?.rel?.[0]),class:e.comp?.[0]?.class,compNum:e.comp?.[0]?.compNum,date:e.d,textDescription:e.comp?.[0]?.desc,htmlDescription:e.comp?.[0]?.descHtml,end:e.comp?.[0]?.e[0],freeBusy:e.comp?.[0]?.fb,freeBusyActualStatus:e.comp?.[0]?.fba,fragment:e.comp?.[0]?.fr,isOrganizer:e.comp?.[0]?.isOrg,location:e.comp?.[0]?.loc??"",meta:e.meta,name:e.comp?.[0]?.name,noBlob:e.comp?.[0]?.noBlob,organizer:e.comp?.[0]?.or,recurrenceRule:e.comp?.[0]?.recur,isRespRequested:e.comp?.[0]?.rsvp,start:e.comp?.[0]?.s[0],sequenceNumber:e.comp?.[0]?.seq,status:e.comp?.[0]?.status,transparency:e.comp?.[0]?.transp,uid:e.comp?.[0]?.uid,url:e.comp?.[0]?.url,isException:e.comp?.[0]?.ex||!1,exceptId:e.comp?.[0]?.exceptId,tagNamesList:e.tn,tags:(0,n.isNil)(e.t)?[]:(0,n.filter)(e.t.split(","),(e=>""!==e)),participants:(0,r.Rz)(e.comp?.[0]?.at??[]),alarm:!!e.comp?.[0]?.alarm,alarmData:e.comp?.[0]?.alarm,ms:e.ms||0,rev:e.rev||0,xprop:e.comp?.[0]?.xprop,neverSent:e?.comp?.[0]?.neverSent??!1,locationUrl:(0,i.vK)(e?.comp?.[0]?.loc??"")})},80781:(e,t,a)=>{"use strict";a.d(t,{Mq:()=>x,ZD:()=>h});var n=a(6017),r=a(51235),i=a(750),l=a.n(i),o=a(50364),s=a(21850),c=a(29870),d=a(31457),m=a(97225);const u=(e,t)=>e===t.address,p=(e,t)=>e.identityName===t.identityName,f=(e,t)=>e===t.address,g=({time:e,allDay:t=!1,timezone:a})=>t?{d:l()(e).startOf("day").format("YYYYMMDD")}:a?{d:l()(e).format("YYYYMMDD[T]HHmmss"),tz:a}:{d:l()(e).utc().format("YYYYMMDD[T]HHmmss[Z]")},v=e=>{const t=parseFloat(e),a={related:"START",neg:"1"};return(0,m.S6)(t)?{w:(0,m.H_)(t),...a}:(0,m.xs)(t)?{d:(0,m.ST)(t),...a}:(0,m.xG)(t)?{h:(0,m.s9)(t),...a}:-1===t?{m:0,...a}:{m:t,related:"START",neg:"1"}},h=e=>{const t=(0,n.getUserAccount)(),a=u(t?.name??"",e.sender),i=p(e.organizer,e.sender),l=e.calendar?.owner,o=f(e.calendar?.owner??"",e.sender),s=(0,r.omitBy)({a:t?.name,p:e?.organizer?.fullName,t:"f"},r.isNil),c={a:e.calendar?.owner,t:"f"},d=(0,r.omitBy)({a:e?.sender?.address??e?.sender?.label,p:e?.sender?.fullName,t:"s"},r.isNil),m=l?c:s,g=a&&i&&!l||o?void 0:d,v=(0,r.compact)([m,g]);return e?.draft?v:(0,r.concat)((0,r.map)((0,r.concat)(e?.attendees,e?.optionalAttendees,e?.meetingRoom??[],e?.equipment??[]),(e=>({a:e?.email??e?.label,p:e?.firstName&&e?.lastname?`${e.firstName} ${e.lastname}`:e.label,t:"t"}))),v)},b=({calendar:e,sender:t,organizer:a})=>{const i=(0,n.getUserAccount)(),l=u(i?.name??"",t),o=p(a,t),s=f(i?.name??"",t),c=f(e?.owner??"",t);return e?.owner?c?{email:e.owner,name:t.fullName}:{email:e.owner,sentBy:t.address}:l&&o?(0,r.omitBy)({email:i?.name,name:a.fullName,sentBy:s?void 0:t.address},r.isNil):(0,r.omitBy)({email:i?.name,name:t.fullName,sentBy:s?void 0:t.address},r.isNil)};function E(e){const t=[...e.attendees,...e.optionalAttendees].map((e=>e.email)).join(", "),a=b({calendar:e?.calendar,sender:e.sender,organizer:e.organizer}),n=(0,d.u)(e.start,e.end,e.allDay,"allDay"),i=`${o.yE}<h3>${a.name} have invited you to a new meeting!</h3><p>Subject: ${e.title}</p><p>Organizer: ${a.name}</p><p>Location: ${e.location}</p><p>Time: ${n}</p><p>Invitees: ${t}</p><br/>${o.yE}`,l=e?.room?.label?`${o.yE}<h3>${a.name} invited you to a virtual meeting on Carbonio Chats system.</h3><p>Join the meeting now on <a href="${e.room.link}">${e.room.label}</a></p><p>You can join the meeting via Web or by using native applications:</p><a href="https://play.google.com/store/apps/details?id=com.zextras.team&hl=it&gl=US">https://play.google.com/store/apps/details?id=com.zextras.team&hl=it&gl=US</a><br/><a href="https://apps.apple.com/it/app/zextras-team/id1459844854">https://apps.apple.com/it/app/zextras-team/id1459844854</a><br/>${o.yE}`:"",s=e?.room&&!(0,r.includes)(e.richText,o.yE)?l:i;return t?.length?`${o.Ah}${s}${e.richText}${o.iJ}`:e.richText}function y(e){const t=[...e.attendees,...e.optionalAttendees].map((e=>e.email)).join(", "),a=b({calendar:e?.calendar,sender:e.sender,organizer:e.organizer}),n=(0,d.u)(e.start,e.end,e.allDay,"allDay"),r=e?.room?.label?`${o.yE}\n${a.name??""} have invited you to a virtual meeting on Carbonio Chats system!\n\nJoin the meeting now on ${e.room.label}\n\n${e.room.link} \n\nYou can join the meeting via Web or by using native applications:\n\nhttps://play.google.com/store/apps/details?id=com.zextras.team&hl=it&gl=US\n\nhttps://apps.apple.com/it/app/zextras-team/id1459844854\n\n${o.yE}\n`:"",i=`${o.yE}\n${a.name??""} have invited you to a new meeting!\n\nSubject: ${e.title} \nOrganizer: "${a.name} \n\nTime: ${n}\n \nInvitees: ${t} \n\n\n${o.yE}`,l=e?.room?.label?r:i;return t?.length?`${l}\n${e.plainText}`:e.plainText}const w=e=>({ct:"multipart/alternative",mp:e.isRichText?[{ct:"text/html",content:E(e)},{ct:"text/plain",content:y(e)}]:[{ct:"text/plain",content:y(e)}]}),A=e=>{const t=[],a=b({calendar:e?.calendar,sender:e.sender,organizer:e.organizer});return t.push(...e.attendees.map((e=>({a:e?.email??e?.label,d:e?.firstName&&e?.lastname?`${e.firstName} ${e.lastname}`:e.label,role:s.GB.REQUIRED,ptst:"NE",rsvp:"1"})))),e?.optionalAttendees&&t.push(...e.optionalAttendees.map((e=>({a:e?.email??e?.label,d:e.firstName&&e.lastname?`${e.firstName} ${e.lastname}`:e.label,role:s.GB.OPTIONAL,ptst:"NE",rsvp:"1"})))),e?.meetingRoom&&t.push(...e.meetingRoom.map((e=>({a:e?.email,d:e.label,role:s.GB.NON_PARTICIPANT,ptst:"NE",rsvp:!0,url:e?.email,cutype:o.jb.ROOM})))),e?.equipment&&t.push(...e.equipment.map((e=>({a:e?.email,d:e.label,role:s.GB.NON_PARTICIPANT,ptst:"NE",rsvp:!0,url:e?.email,cutype:o.jb.RESOURCE})))),{comp:[{alarm:e?.reminder&&"0"!==e?.reminder?[{action:"DISPLAY",trigger:{rel:v(e.reminder)}}]:void 0,xprop:e?.room?[{name:c.l.MEETING_ROOM,value:c.l.MEETING_ROOM,xparam:[{name:c.b.ROOM_LINK,value:e.room.link},{name:c.b.ROOM_NAME,value:e.room.label}]}]:void 0,at:t,allDay:e.allDay?"1":"0",fb:e.freeBusy,loc:e.location,name:e.title,or:(0,r.omitBy)({a:a.email,d:a.name,sentBy:a.sentBy},r.isNil),recur:e?.isInstance&&e?.isSeries||e?.isException?void 0:e?.recur,status:"CONF",s:g({time:e.start,allDay:e?.allDay,timezone:e?.timezone}),e:g({time:e.end,allDay:e?.allDay,timezone:e?.timezone}),exceptId:e.exceptId,class:e.class,draft:e.draft?1:0}],uid:e.uid}},x=e=>(0,r.omitBy)({echo:"1",id:e?.inviteId,comp:"0",m:(0,r.omitBy)({attach:e?.attach?{mp:e?.attach?.mp,aid:e?.attach?.aid?.length>0?e?.attach?.aid?.join(","):void 0}:void 0,e:h(e),inv:A(e),l:e?.calendar?.id,mp:w(e),su:e?.title},r.isNil),_jsns:"urn:zimbraMail"},r.isNil)},13963:(e,t,a)=>{"use strict";a.d(t,{A9:()=>s,Dq:()=>c,Ot:()=>o,VL:()=>r,j6:()=>l,t:()=>i});var n=a(6017);const r=()=>({label:(0,n.t)("label.general","General"),id:"general"}),i=()=>({label:(0,n.t)("label.work_week","Work week"),id:"work_week"}),l=()=>({label:(0,n.t)("label.create_appt_settings","Creating Appointments"),id:"create_appt_settings"}),o=()=>({label:(0,n.t)("label.apple_ical","Apple iCal"),id:"ical"}),s=()=>({label:(0,n.t)("label.permissions","Permissions"),id:"permissions"}),c=()=>[r(),i(),l(),o(),s()]},87466:(e,t,a)=>{"use strict";a.d(t,{ZP:()=>G,hU:()=>q});var n=a(92652),r=a.n(n),i=a(97363),l=a(6017),o=a(51235),s=a(750),c=a.n(s),d=a(93747),m=a(91750),u=a.n(m),p=(a(14824),a(80802)),f=a(50364),g=a(40232);const v=({event:e})=>{const[t]=(0,d.useTranslation)(),[a,o]=(0,n.useState)(!1),s=(0,n.useCallback)((()=>{(0,l.pushHistory)({route:f.jh,path:`${e.resource.calendar.id}/${g.x.EXPAND}/${e.resource.id}/${e.resource.ridZ}`})}),[e.resource.calendar.id,e.resource.id,e.resource.ridZ]),m=((e,t,a)=>{const[n]=(0,d.useTranslation)(),r=c()(e).day()===c()(t).day()&&a,i=c()(e).day()!==c()(t).day()&&a,l=c()(e).day()!==c()(t).day()&&!a;return r?n("label.all_day","All day"):l?`${c()(e).format("MMMM Do YYYY hh:mm A")} - ${c()(t).format("MMMM Do YYYY hh:mm A")}`:i?`${c()(e).format("MMMM Do YYYY")} - ${c()(t).format("MMMM Do YYYY")} - ${n("label.all_day","All day")}`:`${c()(e).format("hh:mm A")} - ${c()(t).format("hh:mm A")}`})(e.start,e.end,e.allDay),u=(0,n.useCallback)((()=>{o(!0)}),[]),v=(0,n.useCallback)((()=>{o(!1)}),[]);return r().createElement(i.Tooltip,{placement:"top",label:t("label.show_event","Double click to see more details on Calendars"),disabled:a},r().createElement(i.Container,{"data-testid":`cardContainer-${e.id}`,mainAlignment:"flex-start",orientation:"row",onDoubleClick:s,background:e.resource.calendar.color.background,borderColor:e.resource.calendar.color.color,padding:{all:"extrasmall"},height:"fit",style:{overflowY:"auto",cursor:"pointer"}},r().createElement(i.Tooltip,{placement:"top",label:e.resource.calendar.name},r().createElement(i.Row,{padding:{all:"extrasmall"}},r().createElement(i.Icon,{icon:"Calendar2",size:"large",color:e.resource.calendar.color.color,onMouseEnter:u,onMouseLeave:v,onFocus:u,onBlur:v}))),r().createElement(i.Container,{style:{overflowX:"auto"}},r().createElement(i.Row,{width:"fill",mainAlignment:"space-between",crossAlignment:"flex-start",wrap:"nowrap",style:{overflowX:"hidden"}},r().createElement(i.TextWithTooltip,{size:"medium",color:e.resource.calendar.color.color,overflow:"ellipsis"},m),r().createElement(i.Row,{mainAlignment:"flex-end",style:{overflowX:"visible"},wrap:"nowrap"},"PRI"===e.resource.class&&r().createElement(i.Tooltip,{label:t("label.private","Private"),placement:"top"},r().createElement(i.Padding,{left:"extrasmall"},r().createElement(i.Icon,{color:e.resource.calendar.color.color,icon:"Lock",size:"medium",onMouseEnter:u,onMouseLeave:v,onFocus:u,onBlur:v}))),e?.resource?.inviteNeverSent&&r().createElement(i.Tooltip,{label:t("label.invitation_not_sent","You haven't sent the invitation to the attendees yet"),placement:"top"},r().createElement(i.Padding,{left:"extrasmall"},r().createElement(i.Icon,{icon:"AlertCircleOutline",size:"medium",color:"#D74942",onMouseEnter:u,onMouseLeave:v,onFocus:u,onBlur:v}))),!e?.resource?.calendar?.owner&&!e?.resource?.iAmOrganizer&&"NE"===e.resource?.participationStatus&&r().createElement(i.Tooltip,{placement:"top",label:t("event.action.needs_action","Needs action")},r().createElement(i.Padding,{left:"extrasmall"},r().createElement(i.Icon,{icon:"CalendarWarning",color:"primary",size:"medium",onMouseEnter:u,onMouseLeave:v,onFocus:u,onBlur:v}))),r().createElement(p.q,{event:e,disableOuterTooltip:o}))),r().createElement(i.Row,{width:"fill",mainAlignment:"flex-start",crossAlignment:"flex-start",wrap:"nowrap",style:{overflowX:"hidden"}},r().createElement(i.TextWithTooltip,{size:"medium",weight:"bold",color:e.resource.calendar.color.color},e.title)))))};var h=a(93046),b=a(82163),E=a(55360),y=a(11783),w=a(89323),A=a(68242);const x=({start:e,end:t,rootId:a,uid:s})=>{const c=((e,t,a,r)=>{const[i,s]=(0,n.useState)(void 0),c=(0,A.T)(),d=(0,h.mv)(a),m=(0,n.useMemo)((()=>(0,o.filter)(d,(e=>!(/b/.test(e?.f??"")||e.broken||(0,b.rR)({id:e.id},l.FOLDERS.TRASH)||e.isLink)))),[d]),u=(0,n.useMemo)((()=>(0,o.map)(m,((e,t)=>0===t?`inid:"${e.id}"`:`OR inid:"${e.id}"`)).join(" ")),[m]);return(0,n.useEffect)((()=>{e&&t&&!i&&c((0,w.C)({spanEnd:t,spanStart:e,query:u})).then((e=>{if(e?.payload?.appt?.length){const t=(0,o.filter)(e.payload.appt,(e=>"F"!==e.fb&&e.uid!==r));if(t.length){const e=(0,o.values)((0,E.Wn)(t)),a=(0,y.F0)(e,d);s(a)}else s([])}}))}),[d,c,t,i,u,e,r]),i})(e,t,a,s);return c?r().createElement(i.Container,{"data-testid":"AppointmentCardContainer",width:"fill",padding:{top:"medium",right:"small"},maxHeight:"10rem",style:{overflowY:"auto"},mainAlignment:"flex-start",crossAlignment:"flex-start"},(0,o.map)(c,((e,t)=>r().createElement(i.Container,{key:`externalCardContainer-${e.id}`,"data-testid":`externalCardContainer-${e.id}`},r().createElement(v,{event:e}),t<c.length-1&&r().createElement(i.Padding,{bottom:"small"}))))):r().createElement(i.Container,{width:"fill",padding:{top:"medium"},"data-testid":"ShimmerContainer"},r().createElement(i.Row,{width:"fill",padding:{bottom:"small"}},r().createElement(i.Shimmer.ListItem,{width:"100%",type:3})),r().createElement(i.Row,{width:"fill",padding:{bottom:"small"}},r().createElement(i.Shimmer.ListItem,{width:"100%",type:3})),r().createElement(i.Row,{width:"fill"},r().createElement(i.Shimmer.ListItem,{width:"100%",type:3})))};var T=a(38828),_=a(84974);const C=({children:e})=>r().createElement(i.Row,{width:"fill",mainAlignment:"flex-start",padding:{vertical:"small"}},e),O=({email:e,start:t,end:a,allDay:l,rootId:o,uid:s})=>{const[c,m]=(0,n.useState)(!1),u=(0,T.z)(t,[{email:e}],s),[p]=(0,d.useTranslation)(),f=(0,n.useCallback)((()=>{m((e=>!e))}),[]);if(!u){const e=p("label.checking_availability","Checking your availability");return r().createElement(C,null,r().createElement(i.Row,{mainAlignment:"flex-start",padding:{right:"small"}},r().createElement(i.Shimmer.Icon,{size:"large"})),r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},r().createElement(i.Tooltip,{placement:"right",label:e},r().createElement(i.Text,{size:"medium",overflow:"break-word"},e))))}if((0,_._)(u[0],t,a,u,l)){const e=p("label.check_availability","Check your availability");return r().createElement(C,null,r().createElement(i.Row,{mainAlignment:"flex-start",padding:{right:"small"}},r().createElement(i.Icon,{size:"large",icon:"CalendarWarning",color:"warning"})),r().createElement(i.Row,{mainAlignment:"flex-start"},r().createElement(i.Tooltip,{placement:"right",label:e},r().createElement(i.Text,{size:"medium",overflow:"break-word"},e))),r().createElement(i.Row,{mainAlignment:"flex-start",padding:{horizontal:"extrasmall"}},r().createElement(i.IconButton,{customSize:{iconSize:"large",paddingSize:0},icon:c?"ChevronUpOutline":"ChevronDownOutline",onClick:f})),c&&r().createElement(x,{start:t,end:a,rootId:o,uid:s}))}const g=p("label.available","You are available");return r().createElement(C,null,r().createElement(i.Row,{mainAlignment:"flex-start",padding:{right:"small"}},r().createElement(i.Icon,{size:"large",icon:"Appointment",color:"success"})),r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},r().createElement(i.Tooltip,{placement:"right",label:g},r().createElement(i.Text,{size:"medium",overflow:"break-word"},g))))};var R=a(42128),k=a(83201),S=a(7183),D=a(95030),z=a(61004);const I=({inviteId:e,message:t})=>{const[a,o]=(0,n.useState)(!0),[s,m]=(0,n.useState)(null),u=(0,i.useSnackbar)(),[p]=(0,d.useTranslation)(),g=(0,A.T)(),v=(0,h.tc)(),b=(0,n.useCallback)((()=>{const a={isException:(r=t.invite[0].comp[0]).ex??!1,exceptId:r.exceptId,isSeries:!!r.recur,isInstance:!r.recur,isRichText:!0,isNew:!1,attachmentFiles:[],title:r.name,location:r.loc,allDay:r.allDay??!1,freeBusy:r.fb,class:r.class,timezone:r?.s[0]?.tz??c().tz.guess(!0),recur:r.recur,richText:r.descHtml[0]?._content??"",plainText:r.desc[0]?._content??"",meetingRoom:(0,k._G)(r.at),equipment:(0,k.O2)(r.at),room:(0,k.am)(r.xprop),uid:r.uid,originalStart:r.s[0].u??c()(r.s[0].d).valueOf(),originalEnd:r.e[0].u??c()(r.e[0].d).valueOf(),start:r.s[0].u??c()(r.s[0].d).valueOf(),end:r.e[0].u??c()(r.e[0].d).valueOf(),attendees:[{email:r.or.a??r.or.url,id:r.or.a??r.or.url}]},n=(0,R.kn)({context:{dispatch:g,folders:v,isProposeNewTime:!0,panel:!1,inviteId:e,disabled:{title:!0,location:!0,organizer:!0,virtualRoom:!0,richTextButton:!0,attachmentsButton:!0,saveButton:!0,attendees:!0,optionalAttendees:!0,freeBusy:!0,calendar:!0,private:!0,allDay:!0,reminder:!0,recurrence:!0,meetingRoom:!0,equipment:!0,timezone:!0},...a}});var r;n.id&&(0,l.addBoard)({url:`${f.jh}/`,title:n?.title??"",editor:n})}),[v,g,e,t.invite]),E=(0,n.useCallback)((n=>()=>{(({inviteId:e,notifyOrganizer:t,action:a,dispatch:n,activeCalendar:r,createSnackbar:i,parent:o})=>{n((0,z.k)({inviteId:e,updateOrganizer:t,action:a})).then((t=>{if(t.type.includes("fulfilled")){o&&(0,l.replaceHistory)(`/folder/${o}`);const t="ACCEPT"===a?(0,l.t)("message.snackbar.invite.accept","Youve replied as Accepted"):"TENTATIVE"===a?(0,l.t)("message.snackbar.invite.tentative","Youve replied as Tentative"):(0,l.t)("message.snackbar.invite.decline","Youve replied as Declined");if(i({key:`invite_${a}`,replace:!0,type:"info",label:t,autoHideTimeout:3e3}),"ACCEPT"===a||"TENTATIVE"===a){const t=r?.id??r?.zid;t&&t!==l.FOLDERS.CALENDAR&&n((0,D.Q)({id:e,l:t||l.FOLDERS.CALENDAR}))}}else i({key:`invite_${a}_error`,replace:!0,type:"error",label:(0,l.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3})}))})({action:n,createSnackbar:u,inviteId:e,notifyOrganizer:a,activeCalendar:s,dispatch:g,parent:t.parent})}),[u,e,a,s,g,t.parent]),y=(0,n.useMemo)((()=>t?.invite?.[0]?.replies?.[0].reply?.[0]?.ptst??""),[t?.invite]);return r().createElement(r().Fragment,null,r().createElement(i.Row,{width:"fill",mainAlignment:"space-between",padding:{vertical:"small"}},r().createElement(i.Container,{width:"35%",mainAlignment:"flex-start",crossAlignment:"baseline"},r().createElement(i.Checkbox,{value:a,onClick:()=>o(!a),label:p("label.notify_organizer","Notify Organizer")})),r().createElement(i.Container,{width:"65%",mainAlignment:"flex-start"},r().createElement(S.g,{calendarId:t.parent,onCalendarChange:e=>m(e),label:p("label.scheduled_in","Scheduled in"),excludeTrash:!0}))),r().createElement(i.Row,{width:"fill",height:"fit",style:{flexGrow:1,flexBasis:"fit-content",whiteSpace:"nowrap",overflow:"hidden"},padding:{vertical:"small"},mainAlignment:"flex-start"},r().createElement(i.Padding,{right:"small",vertical:"large"},r().createElement(i.Button,{type:"outlined",label:p("event.action.accept","Accept"),icon:"CheckmarkOutline",color:"success",onClick:E("ACCEPT"),disabled:"AC"===y})),r().createElement(i.Padding,{right:"small",vertical:"medium"},r().createElement(i.Button,{type:"outlined",label:p("label.tentative","Tentative"),icon:"QuestionMarkOutline",color:"warning",onClick:E("TENTATIVE"),disabled:"TE"===y})),r().createElement(i.Padding,{right:"small",vertical:"medium"},r().createElement(i.Button,{type:"outlined",label:p("event.action.decline","Decline"),icon:"CloseOutline",color:"error",onClick:E("DECLINE"),disabled:"DE"===y})),r().createElement(i.Padding,{right:"small",vertical:"large"},r().createElement(i.Button,{label:p("label.propose_new_time","Propose new time"),icon:"ClockOutline",color:"primary",type:"outlined",onClick:b}))),r().createElement(i.Divider,null))};var M=a(16990),N=a(46609),j=a(74713),F=a(89458);const L=({id:e,moveToTrash:t,title:a,fragment:s,start:m,end:u,msg:p,to:f})=>{const[g]=(0,d.useTranslation)(),v=(0,i.useSnackbar)(),b=(0,A.T)(),E=(0,h.tc)(),[w,x]=(0,l.useIntegratedFunction)("compose"),T=(0,n.useCallback)((()=>{(async e=>(0,l.soapFetch)("GetAppointment",{id:e,includeContent:"1",_jsns:"urn:zimbraMail"}))(e).then((e=>{if(e?.appt[0]){const a=(0,o.find)(e.appt[0]?.inv,(e=>e?.comp?.[0]?.ridZ===p?.invite?.[0]?.comp?.[0]?.ridZ))??e.appt[0]?.inv[0],n=`${a.comp[0].apptId}-${a.id}`,r=a?.comp?.[0]?.ridZ??p?.invite?.[0]?.comp?.[0]?.ridZ,i=a.comp[0].ciFolder,l={...e?.appt[0],inv:[a],inviteId:n};b((0,N.E)({inviteId:n,ridZ:r})).then((e=>{const a=(0,o.find)(E,["id",i]);if(a&&e?.payload?.m){const i=(0,M.I)(e?.payload.m[0]),s=(n=l,(0,o.omitBy)({id:n?.apptId,l:n.ciFolder,alarm:n?.inv?.[0]?.comp?.[0]?.alarm,alarmData:n?.inv?.[0]?.comp?.[0]?.alarmData,fb:n?.inv?.[0]?.comp?.[0]?.fb,fr:n?.inv?.[0]?.comp?.[0]?.fr,d:n?.d,fba:n?.inv?.[0]?.comp?.[0]?.fba,md:n.md,flags:n?.inv?.[0]?.comp?.[0]?.f,ms:n?.inv?.[0]?.comp?.[0]?.ms,ptst:n?.ptst,rev:n.rev,status:n?.inv?.[0]?.comp?.[0]?.status,transp:n?.inv?.[0]?.comp?.[0]?.transp,uid:n.uid,compNum:n?.inv?.[0]?.compNum,class:n?.inv?.[0]?.comp?.[0]?.class,dur:n?.inv?.[0]?.comp?.[0]?.e?.[0]?.u&&n?.inv?.[0]?.comp?.[0]?.s?.[0]?.u?n.inv[0].comp[0].e[0].u-n.inv[0].comp[0].s[0].u:void 0,allDay:n?.inv?.[0]?.comp?.[0]?.allDay??!1,draft:n?.inv?.[0]?.comp?.[0]?.draft,inviteId:n?.id&&n?.inv?.[0]?`${n.id}-${n.inv[0].id}`:void 0,isOrg:n?.inv?.[0]?.comp?.[0]?.isOrg,loc:n?.inv?.[0]?.comp?.[0]?.loc,otherAtt:n?.inv?.[0]?.comp?.[0]?.otherAtt,recur:!!n?.inv?.[0]?.comp?.[0]?.recur,name:n?.inv?.[0]?.comp?.[0]?.name,meta:n?.meta,neverSent:n?.inv?.[0]?.comp?.[0]?.neverSent,or:n?.inv?.[0]?.comp?.[0]?.or,s:n.s},o.isNil)),d=(0,y.Y4)({appointment:s,invite:i,calendar:a}),f=(0,R.kn)({event:d,invite:i,context:{attendees:(0,o.map)(i.attendees,(e=>({email:e.a}))),isInstance:!!r,originalStart:c()(l?.inv?.[0]?.comp?.[0].s?.[0]?.d).valueOf()??m,originalEnd:c()(l?.inv?.[0]?.comp?.[0].e?.[0]?.d).valueOf()??u,exceptId:p?.invite?.[0]?.comp?.[0]?.exceptId,start:m,end:u,folders:E,dispatch:b,panel:!1}});b((0,j.Q)({draft:!1,editor:f})).then((({payload:e})=>{const{response:a,error:n}=e;a&&!n&&b((0,F.C)({id:e.editor.id,editor:e.editor})),v({key:n?"proposedTimeDeclined":"proposedTimeAccepted",replace:!0,type:n?"error":"success",hideButton:!0,label:n?g("label.error_try_again","Something went wrong, please try again"):g("snackbar.proposed_time_accepted","You accepted the proposed time"),autoHideTimeout:3e3}),t?.()}))}var n}))}}))}),[E,v,b,u,e,t,p?.invite,m,g]),_=(0,n.useCallback)((()=>{x&&w(null,{text:["text",`${s}:`],subject:`${g("label.proposal_declined","Proposal declined")}${a}`,to:f})}),[x,w,s,g,a,f]);return r().createElement(r().Fragment,null,r().createElement(i.Container,{orientation:"horizontal",crossAlignment:"flex-start",mainAlignment:"flex-start",width:"fill",height:"fit",padding:{vertical:"small"}},r().createElement(i.Padding,{right:"small",vertical:"medium"},r().createElement(i.Button,{type:"outlined",label:g("event.action.accept","Accept"),icon:"CheckmarkOutline",color:"success",onClick:T})),r().createElement(i.Padding,{right:"small",vertical:"medium"},r().createElement(i.Button,{type:"outlined",label:g("event.action.decline","Decline"),icon:"Close",color:"error",onClick:_}))),r().createElement(i.Divider,null))};var P=a(78571),$=a(21850),B=a(29870),Y=a(31457),V=a(59379);function q(e){const[t,a]=(0,l.getAction)("contact-list","mail-to",[e]);return a?t:void 0}const U=u()(i.Container).withConfig({displayName:"invite-response__InviteContainer",componentId:"sc-1g6szk2-0"})(["border:0.0625rem solid ",";border-radius:0.875rem;margin:",";padding:",";"],(({theme:e})=>e.palette.gray2.regular),(({theme:e})=>e.sizes.padding.extrasmall),(({theme:e})=>e.sizes.padding.extralarge)),H=u()(i.Text).withConfig({displayName:"invite-response__LinkText",componentId:"sc-1g6szk2-1"})(["cursor:pointer;text-decoration:underline;&:hover{text-decoration:none;}"]),Z=({mailMsg:e,moveToTrash:t})=>{const a=(0,l.useUserAccount)(),s=(0,M.I)({...e,inv:e.invite}),[m]=(0,d.useTranslation)(),u=(0,h.px)(e.parent)??l.FOLDERS.USER_ROOT,p=(0,h.f8)(u),g=(0,n.useMemo)((()=>p?.name===l.ROOT_NAME?a.name:p?.name??a.name),[a.name,p?.name]),v=(0,n.useMemo)((()=>s?.organizer?.a!==a.name),[a.name,s?.organizer?.a]),b=(0,n.useMemo)((()=>(0,o.filter)(e.participants,{type:"f"})),[e?.participants]),E=e.invite[0]?.comp[0].method,y=(0,n.useMemo)((()=>(0,o.find)(s.xprop,["name",B.l.MEETING_ROOM])),[s]),w=(0,o.find)(y?.xparam,["name",B.b.ROOM_NAME])?.value,A=(0,o.find)(y?.xparam,["name",B.b.ROOM_LINK])?.value,x=(0,n.useMemo)((()=>(0,o.filter)(s.attendees,["cutype",f.jb.ROOM])),[s.attendees]),T=(0,n.useMemo)((()=>(0,o.filter)(s.attendees,["cutype",f.jb.RESOURCE])),[s.attendees]),_=(0,n.useMemo)((()=>(0,o.map)(T,(e=>e.d)).join(", ")),[T]),C=(0,n.useMemo)((()=>(0,o.map)(x,(e=>e.d)).join(", ")),[x]),[R,S]=(0,n.useState)(2),D=(0,n.useMemo)((()=>s.attendees.filter((e=>e.role===$.GB.REQUIRED))),[s]),[z,N]=(0,n.useState)(5),j=(0,n.useMemo)((()=>s.attendees.filter((e=>e.role===$.GB.OPTIONAL))),[s]),F=e=>{const t={email:{email:{mail:e.a}},firstName:e.d??e.a,middleName:""};q(t)?.onClick?.()},V=(0,n.useMemo)((()=>c().tz.guess()),[]),Z=(0,n.useMemo)((()=>(0,k.Li)(c()(s.start?.d??s.start.u).valueOf()??0,V,s.tz)),[s.start?.d,s.start.u,s.tz,V]),G=(0,n.useMemo)((()=>(0,k.Li)(c()(s.end?.d??s.end.u).valueOf()??0,V,s.tz)),[s.end?.d,s.end.u,s.tz,V]),{localTimeString:W,localTimezoneString:X,showTimezoneTooltip:K,localTimezoneTooltip:Q}=(0,Y.i)(Z,G,s.allDay,s.tz),J=(0,n.useMemo)((()=>{const e=(0,P.cd)(s?.textDescription?.[0]?._content);return e?.length>0&&'"'!==e}),[s?.textDescription]),ee=s.apptId&&!(0,o.includes)(s.id,":")?`${s.apptId}-${s.id}`:s.id,te=D.slice(0,R);return r().createElement(U,{"data-testid":"invite-response"},r().createElement(i.Container,{padding:{horizontal:"small",vertical:"large"},width:"100%"},r().createElement(i.Row,{width:"fill",mainAlignment:"flex-start",padding:{bottom:"extrasmall"}},"COUNTER"===E?r().createElement(i.Text,{weight:"light",size:"large"},e.subject):r().createElement(r().Fragment,null,r().createElement(i.Text,{weight:"regular",size:"large",style:{fontSize:"1.125rem"}},`${s.organizer?.d??s.organizer?.a} ${m("message.invited_you","invited you to an event")}`),"",r().createElement(i.Text,{weight:"bold",size:"large",style:{fontSize:"1.125rem"}},e.subject?e.subject:s?.name))),r().createElement(i.Row,{width:"100%",mainAlignment:"flex-start"},r().createElement(i.Text,{overflow:"ellipsis",color:"secondary",weight:"bold",size:"small"},W),K&&r().createElement(i.Tooltip,{label:Q},r().createElement(i.Padding,{left:"small"},r().createElement(i.Icon,{icon:"GlobeOutline",color:"gray1"})))),r().createElement(i.Row,{width:"100%",mainAlignment:"flex-start"},r().createElement(i.Text,{overflow:"ellipsis",color:"secondary",weight:"bold",size:"small"},X)," "),E===$.lm.REQUEST&&p&&r().createElement(O,{email:g,rootId:p.id,start:s?.start?.u??c()(e.invite[0].comp[0].s[0].d).valueOf(),end:s?.end?.u??c()(e.invite[0].comp[0].e[0].d).valueOf(),allDay:s.allDay??!1,uid:s.uid}),"COUNTER"===E?"5"!==e.parent&&r().createElement(L,{id:s?.apptId,start:s?.start?.u??c()(e.invite[0].comp[0].s[0].d).valueOf(),end:s?.end?.u??c()(e.invite[0].comp[0].e[0].d).valueOf(),moveToTrash:t,title:e.subject,to:b,msg:e,fragment:s?.fragment}):v&&r().createElement(I,{inviteId:ee,message:e}),s?.location&&r().createElement(i.Row,{width:"fill",mainAlignment:"flex-start",padding:{top:"large"}},r().createElement(i.Tooltip,{placement:"left",label:m("tooltip.location","Location")},r().createElement(i.Row,{mainAlignment:"flex-start",padding:{right:"small"}},r().createElement(i.Icon,{size:"large",icon:"PinOutline"}))),r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},r().createElement(i.Tooltip,{placement:"right",label:s?.organizer?.a},r().createElement(i.Text,{size:"medium",overflow:"break-word"},s?.location)))),w&&A&&r().createElement(i.Row,{width:"fill",mainAlignment:"flex-start",padding:{top:"large"}},r().createElement(i.Tooltip,{placement:"top",label:m("tooltip.virtual_room","Virtual room")},r().createElement(i.Row,{mainAlignment:"flex-start",padding:{right:"small"}},r().createElement(i.Icon,{size:"large",icon:"VideoOutline"}))),r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},r().createElement(i.Tooltip,{placement:"right",label:A},r().createElement(H,{color:"gray1",size:"medium",overflow:"break-word"},r().createElement("a",{href:A,target:"_blank",rel:"noreferrer"},w))))),x&&x?.length>0&&r().createElement(i.Row,{width:"fill",mainAlignment:"flex-start",padding:{top:"large",bottom:"small"}},r().createElement(i.Tooltip,{placement:"left",label:m("tooltip.meetingRooms","MeetingRooms")},r().createElement(i.Row,{mainAlignment:"flex-start",padding:{right:"small"}},r().createElement(i.Icon,{size:"large",icon:"BuildingOutline"}))),r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},r().createElement(i.Tooltip,{placement:"right",label:m("tooltip.meetingRooms","MeetingRooms")},r().createElement(i.Text,{size:"medium",overflow:"break-word"},C)))),T&&T.length>0&&r().createElement(i.Row,{width:"fill",mainAlignment:"flex-start",padding:{top:"large",bottom:"small"}},r().createElement(i.Tooltip,{placement:"left",label:m("tooltip.equipment","Equipment")},r().createElement(i.Row,{mainAlignment:"flex-start",padding:{right:"small"}},r().createElement(i.Icon,{size:"large",icon:"BriefcaseOutline"}))),r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},r().createElement(i.Tooltip,{placement:"right",label:m("tooltip.equipment","Equipment")},r().createElement(i.Text,{size:"medium",overflow:"break-word"},_)))),r().createElement(i.Row,{width:"100%",mainAlignment:"flex-start",crossAlignment:"flex-start",padding:{vertical:"medium"}},r().createElement(i.Row,{width:"50%",mainAlignment:"flex-start",crossAlignment:"flex-start"},r().createElement(i.Row,{mainAlignment:"flex-start",padding:{right:"small"}},r().createElement(i.Icon,{size:"large",icon:"PeopleOutline"})),r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start",crossAlignment:"flex-start"},r().createElement(i.Row,{mainAlignment:"flex-start",width:"100%",padding:{bottom:"extrasmall"}},r().createElement(i.Text,{overflow:"break-word"},m("message.required_participant",{count:D.length,defaultValue_one:"{{count}} Participant",defaultValue_other:"{{count}} Participants"}))),r().createElement(i.Row,{mainAlignment:"flex-start",width:"100%",padding:{top:"small"}},s?.organizer?.d?r().createElement(i.Tooltip,{placement:"top",label:s?.organizer?.a,maxWidth:"100%"},r().createElement("div",null,r().createElement(i.Chip,{avatarLabel:s?.organizer?.d,label:r().createElement(r().Fragment,null,r().createElement(i.Text,{size:"small"},s?.organizer?.d),"",r().createElement(i.Text,{size:"small",color:"secondary"},"(",m("message.organizer"),")")),background:"gray3",color:"secondary",actions:[{id:"action1",label:m("message.send_email"),type:"button",icon:"EmailOutline",onClick:()=>F(s?.organizer)}]}))):r().createElement(i.Chip,{avatarLabel:s?.organizer?.a,label:r().createElement(r().Fragment,null,r().createElement(i.Text,null,s?.organizer?.a),"",r().createElement(i.Text,{color:"secondary"},"(",m("message.organizer"),")")),background:"gray3",color:"text",actions:[{id:"action1",label:m("message.send_email"),type:"button",icon:"EmailOutline",onClick:()=>F(s?.organizer)}]})),te.map(((e,t)=>r().createElement(i.Row,{mainAlignment:"flex-start",width:"100%",padding:{top:"small"},key:`${e.d??e.a}-${t}-1`},r().createElement(i.Tooltip,{placement:"top",label:e.a??e.d??"",maxWidth:"100%"},r().createElement("div",null,r().createElement(i.Chip,{label:e.d??e.a})))))),R<D.length&&r().createElement(i.Row,{mainAlignment:"flex-start",width:"100%",padding:{top:"small"}},r().createElement(H,{color:"primary",size:"medium",onClick:()=>S(D.length),overflow:"break-word"},m("message.more","More..."))))),j.length>0&&r().createElement(i.Row,{width:"50%",mainAlignment:"flex-start",crossAlignment:"flex-start"},r().createElement(i.Row,{mainAlignment:"flex-start",padding:{right:"small"}},r().createElement(i.Icon,{size:"large",icon:"OptionalInviteeOutline"})),r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start",crossAlignment:"flex-start"},r().createElement(i.Row,{mainAlignment:"flex-start",width:"100%",padding:{bottom:"extrasmall"}},r().createElement(i.Text,{overflow:"break-word"},m("message.optional_participant",{count:j.length,defaultValue_one:"{{count}} Optional",defaultValue_other:"{{count}} Optionals"}))),j.slice(0,z).map(((e,t)=>r().createElement(i.Row,{mainAlignment:"flex-start",width:"100%",padding:{top:"small"},key:`${e.d??e.a}-${t}-2`},r().createElement(i.Tooltip,{placement:"top",label:e.d??e.a,maxWidth:"100%"},r().createElement("div",null,r().createElement(i.Chip,{label:e.d??e.a})))))),z<j.length&&r().createElement(i.Row,{mainAlignment:"flex-start",width:"100%",padding:{top:"small"}},r().createElement(H,{color:"primary",size:"medium",onClick:()=>N(j.length),overflow:"break-word"},m("message.more","More...")))))),s&&J&&r().createElement(i.Row,{width:"100%",crossAlignment:"flex-start",mainAlignment:"flex-start",padding:{bottom:"large"}},r().createElement(i.Row,{width:"100%",padding:{vertical:"medium"}},r().createElement(i.Divider,null)),r().createElement(i.Row,{padding:{right:"small"}},r().createElement(i.Icon,{size:"large",icon:"MessageSquareOutline"})),r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},r().createElement(P.ZP,{fullInvite:s,inviteId:ee,parts:s?.parts})))))},G=e=>r().createElement(V.g,null,r().createElement(Z,e))},99616:(e,t,a)=>{"use strict";a.d(t,{S:()=>r});var n=a(6017);const r=async e=>{const t=(0,n.soapFetch)("Batch",e);return t?.Fault?{...t.Fault,error:!0}:t}},5369:(e,t,a)=>{"use strict";a.d(t,{Y:()=>i});var n=a(6017),r=a(51235);const i=async({id:e,op:t,tagName:a,parent:i})=>{const l=await(0,n.soapFetch)("ItemAction",{_jsns:"urn:zimbraMail",action:(0,r.omitBy)({op:t,id:e,tn:a,l:i},r.isNil)});return l?.Fault?{...l.Fault,error:!0}:l}},84418:(e,t,a)=>{"use strict";a.d(t,{f:()=>l});var n=a(51235),r=a(99616),i=a(6017);const l=async e=>{if((0,n.isArray)(e)){const t={_jsns:"urn:zimbra",onerror:"continue",FolderActionRequest:(0,n.map)(e,((e,t)=>({action:e,requestId:t,_jsns:"urn:zimbraMail"})))};return(0,r.S)(t)}return(async e=>(0,i.soapFetch)("FolderAction",{action:e,_jsns:"urn:zimbraMail"}))(e)}},14883:(e,t,a)=>{"use strict";a.d(t,{c:()=>i});var n=a(85583),r=a(5369);const i=(0,n.createAsyncThunk)("appointments/deleteAppointmentPermanent",(async({id:e},{rejectWithValue:t})=>{const a=await(0,r.Y)({id:e,op:"delete"});return a?.error?t(a):{response:a,id:e}}))},83210:(e,t,a)=>{"use strict";a.d(t,{m:()=>i});var n=a(85583),r=a(6017);const i=(0,n.createAsyncThunk)("calendar/dismissAppointmentReminder",(async({dismissItems:e},{rejectWithValue:t})=>{const a=await(async({items:e})=>{const t=await(0,r.soapFetch)("DismissCalendarItemAlarm",{_jsns:"urn:zimbraMail",appt:e});return t?.Fault?{...t.Fault,error:!0}:t})({items:e});return a?.error?t(a):a}))},46609:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var n=a(85583),r=a(6017),i=a(51235);const l=(0,n.createAsyncThunk)("invites/get invite",(async({inviteId:e,ridZ:t},{rejectWithValue:a})=>{const n=await(async({inviteId:e,ridZ:t})=>{const a=await(0,r.soapFetch)("GetMsg",{_jsns:"urn:zimbraMail",m:(0,i.omitBy)({html:1,needExp:1,id:e,ridZ:t,header:[{n:"List-ID"},{n:"X-Zimbra-DL"},{n:"IN-REPLY-TO"}],max:25e4},i.isNil)});return a?.Fault?{...a.Fault,error:!0}:a})({inviteId:e,ridZ:t});return n?.error?a(n):n}))},9547:(e,t,a)=>{"use strict";a.d(t,{b:()=>s});var n=a(85583),r=a(51235),i=a(6017),l=a(88528);const o=({t:e,fullInvite:t,newMessage:a,deleteSingleInstance:n=!0,inst:i})=>{const o=a??`${e("message.meeting_canceled","The following meeting has been cancelled")}:`,s=e("label.all_day","All day"),c=e("message.original_invite","-----Original Invite-----"),d=t?.textDescription?.[0]?._content??"",m=t?.htmlDescription?.[0]?._content?.slice?.(6)??"",u=i?.d??t.start.d,p=i?.d??t.end.d,f=(0,l.AG)(u,i?.tz??t?.end?.tz).valueOf(),g=(0,l.AG)(p,i?.tz??t?.end?.tz).valueOf(),v=(t?.end?.u??g)-(t?.start?.u??f),h=u?f:t.start.u??0,b=p&&i?.d?g+v:g??t.end.u??0,E=(0,l.$)({start:h,end:b,allDay:t.allDay??!1,allDayLabel:s,timezone:i?.tz??t?.tz}),y=!t.recurrenceRule||n?e("label.instance","instance"):e("label.series","series"),w=`"${t?.name??""}" ${(0,r.lowerCase)(y)}, ${E}`,A=m?`<br/><br/>${c}<br/><br/>${m}`:"",x={ct:"text/plain",content:`${o}\n\n${w}${d?`\n\n${c}\n\n${d}`:""}`},T=t.htmlDescription?{ct:"text/html",content:`<html><h3>${o}</h3>${w}${A}</html>`}:void 0;return{ct:"multipart/alternative",mp:(0,r.compact)([x,T])}},s=(0,n.createAsyncThunk)("appointments/moveAppointmentToTrash",(async({inviteId:e,t,isOrganizer:a=!0,deleteSingleInstance:n=!1,inst:r,s:l,inv:s,newMessage:c},{getState:d,rejectWithValue:m})=>{const u=d(),p=function({invite:e,t,newMessage:a,deleteSingleInstance:n,inst:r}){const i=[{a:e?.organizer?.a,p:e?.organizer?.d,t:"f"}];return{e:e.neverSent?i:(l=Object.entries(e?.participants).flatMap((([e,t])=>t)),l.map((e=>({a:e.email,p:e.name,t:"t"})))).concat(i)??i,su:`${t("label.cancelled","Cancelled")}: ${e?.name??""}`,mp:o({t,fullInvite:e,newMessage:a,deleteSingleInstance:n,inst:r})};var l}({invite:s??u.invites.invites[e],t,newMessage:c,deleteSingleInstance:n,inst:r}),f=await(async({deleteSingleInstance:e,inst:t,id:a,isOrganizer:n,m:r,s:l})=>{const o=e?{_jsns:"urn:zimbraMail",inst:t,id:a,comp:"0",s:l,m:n?r:{...r,e:[]}}:{_jsns:"urn:zimbraMail",id:a,comp:"0",m:n?r:{...r,e:[]}},s=await(0,i.soapFetch)("CancelAppointment",o);return s?.Fault?{...s.Fault,error:!0}:s})({deleteSingleInstance:n,id:e,inst:r,s:l,m:p,isOrganizer:a});return f?.error?m(f):{response:f,inviteId:e}}))},95030:(e,t,a)=>{"use strict";a.d(t,{Q:()=>i});var n=a(85583),r=a(5369);const i=(0,n.createAsyncThunk)("appointments/moveAppointment",(async({id:e,l:t},{rejectWithValue:a})=>{const n=await(0,r.Y)({id:e,op:"move",parent:t});return n?.error?a(n):n}))},74713:(e,t,a)=>{"use strict";a.d(t,{Q:()=>c});var n=a(85583),r=a(6017),i=a(56206),l=a(80781),o=a(88528),s=a(36177);const c=(0,n.createAsyncThunk)("appointment/modify appointment",(async({draft:e,editor:t},{rejectWithValue:a})=>{if(t){if(t.isSeries&&t.isInstance&&!t.isException){const n=t?.exceptId??(0,s.w)({start:(0,o.CO)(new Date(t.originalStart),t.timezone),allDay:t.allDay,tz:t.timezone}),i=(0,l.Mq)({...t,draft:e,exceptId:n}),c=await(0,r.soapFetch)("CreateAppointmentException",i),d=c?.Fault?{...c.Fault,error:!0}:c;return d?.error?a(d):{response:d,editor:{...t,isSeries:!1,isInstance:!0,isException:!0,isNew:!1,inviteId:d.invId}}}const n=(0,l.Mq)({...t,draft:e}),c=await(0,r.soapFetch)("ModifyAppointment",n),d=c?.Fault?{...c.Fault,error:!0}:c;if(d?.error)return a(d);const m={mp:(0,i.jS)(c?.echo?.[0]?.m?.[0]?.mp?.[0]??[],"attachment",c?.echo?.[0]?.m?.[0]?.id)},u=(0,i.s1)(c?.echo?.[0]?.m?.[0]?.mp??[],[]);return{response:c,editor:{...t,isSeries:!!t.recur,isInstance:!t.recur,isNew:!1,attach:m,attachmentFiles:u}}}}))},98764:(e,t,a)=>{"use strict";a.d(t,{k:()=>c});var n=a(85583),r=a(6017),i=a(750),l=a.n(i),o=a(50364),s=a(80781);const c=(0,n.createAsyncThunk)("calendars/proposeNewTime",(async({id:e},{getState:t,rejectWithValue:a})=>{const n=t()?.editor?.editors?.[e],i=await(async({appt:e})=>{const t=await(0,r.soapFetch)("CounterAppointment",{_jsns:"urn:zimbraMail",comp:"0",id:e.inviteId?.includes("-")?e.inviteId:void 0,m:{e:(0,s.ZD)(e),inv:{comp:[{name:e.title,uid:e.uid,seq:1,allDay:e.allDay?"1":"0",e:{tz:e?.timezone,d:l()(l()(e.end)).format("YYYYMMDDTHHmm00")},exceptId:e.exceptId,or:{a:e.organizer?.address},s:{tz:e?.timezone,d:l()(l()(e.start)).format("YYYYMMDDTHHmm00")}}]},mp:{ct:"multipart/alternative",mp:[{ct:"text/html",content:`${o.Ah}\n\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t<tr height="1.5rem"><td>New Time Proposed</td></tr>\n\t\t\t\t\t\t\t\t<tr height="1.5rem"><td>Subject: ${e.title}</td></tr>\n\t\t\t\t\t\t\t\t<tr height="1.5rem" style="color:#2b73d2;font-weight:bold">\n\t\t\t\t\t\t\t\t\t<td>Time: ${l()(e.start).format("dddd, D MMMM, YYYY, HH:mm:ss")} - ${l()(e.end).format("HH:mm:ss")} GMT ${l()(e.start).tz(l().tz.guess()).format("Z")} ${l().tz.guess()} [MODIFIED]</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\n<div>*~*~*~*~*~*~*~*~*~*</div><br>\n\t\t\t\t\t\t\t${e?.richText}\n\t\t\t\t\t\t`},{content:`New Time Proposed\n\nSubject: ${e.title} \n\nTime: ${l()(e.start).format("dddd, D MMMM, YYYY, HH:mm:ss")} - ${l()(e.end).format("HH:mm:ss")} GMT\n\t\t\t\t\t\t\t${l()(e.start).tz(l().tz.guess()).format("Z")} ${l().tz.guess()} [MODIFIED]\n\n*~*~*~*~*~*~*~*~*~*\n\n${e.plainText}`,ct:"text/plain"}]},su:`New Time Proposed: ${e.title}`}});return t?.Fault?{...t.Fault,error:!0}:t})({appt:n});return i?.error?a(i):{response:i,editor:n}}))},89323:(e,t,a)=>{"use strict";a.d(t,{C:()=>l});var n=a(85583),r=a(51235),i=a(6017);const l=(0,n.createAsyncThunk)("calendars/search",(async({spanStart:e,spanEnd:t,query:a,offset:n,sortBy:l},{rejectWithValue:o})=>{const s=(0,r.omitBy)({start:e,end:t,content:a,sortBy:l,offset:n},r.isNil),c=await(async({start:e,end:t,offset:a,sortBy:n,content:r})=>{const l=await(0,i.soapFetch)("Search",{_jsns:"urn:zimbraMail",limit:"500",calExpandInstEnd:t,calExpandInstStart:e,offset:a??0,sortBy:n??"none",types:"appointment",query:{_content:r}});return l?.Fault?{...l.Fault,error:!0}:l})(s);return c?.error?o(c):c}))},61004:(e,t,a)=>{"use strict";a.d(t,{k:()=>i});var n=a(85583),r=a(6017);const i=(0,n.createAsyncThunk)("invites/sendInviteResponse",(async({inviteId:e,action:t,updateOrganizer:a,exceptId:n},{rejectWithValue:i})=>{const l=await(async({id:e,action:t,updateOrganizer:a,exceptId:n})=>{const i=await(0,r.soapFetch)("SendInviteReply",{_jsns:"urn:zimbraMail",id:e,compNum:0,exceptId:n,verb:t,rt:"r",updateOrganizer:a});return i?.Fault?{...i.Fault,error:!0}:i})({id:e,action:t,updateOrganizer:a,exceptId:n});return l?.error?i(l):l}))},10733:(e,t,a)=>{"use strict";a.d(t,{J:()=>i});var n=a(85583),r=a(6017);const i=(0,n.createAsyncThunk)("reminder/snoozeApptReminder",(async({id:e,until:t},{rejectWithValue:a})=>{const n=await(async({id:e,until:t})=>{const a=await(0,r.soapFetch)("SnoozeCalendarItemAlarm",{_jsns:"urn:zimbraMail",appt:[{id:e,until:t}]});return a?.Fault?{...a.Fault,error:!0}:a})({id:e,until:t});return n?.error?a(n):n}))},78936:(e,t,a)=>{"use strict";a.d(t,{MB:()=>r,XJ:()=>i,_q:()=>l});var n=a(51235);const r=(e,{meta:t})=>{const{ridZ:a,deleteSingleInstance:r,id:i}=t.arg;e.status="pending",e.appointments&&(t.arg.previousState=e.appointments,r?e.appointments[i].inst=(0,n.filter)(e.appointments[i].inst,(e=>e.ridZ!==a)):e.appointments[i].l="3")},i=(e,t)=>{e.status="fulFilled";const{inviteId:a,ridZ:r,deleteSingleInstance:i,isRecurrent:l,id:o}=t.meta.arg;e.invites&&(i||delete e?.invites?.[a]),e.appointments&&l&&(e.appointments[o].inst=(0,n.filter)(e.appointments[o].inst,(e=>e.ridZ!==r)))},l=(e,{meta:t})=>{t?.arg?.previousState&&(e.appointments=t.arg.previousState,e.status="error")}},68242:(e,t,a)=>{"use strict";a.d(t,{C:()=>i,T:()=>r});var n=a(41441);const r=n.useDispatch,i=n.useSelector},59379:(e,t,a)=>{"use strict";a.d(t,{g:()=>p});var n=a(92652),r=a.n(n),i=a(85583),l=a(41441),o=a(50364),s=a(33957),c=a(89458),d=a(20309);const m={appointments:s.ZP,editor:c.ZP,invites:d.ZP},u=(0,i.configureStore)({devTools:{name:o.XD},reducer:(0,i.combineReducers)(m)}),p=({children:e})=>r().createElement(l.Provider,{store:u},e)},53776:(e,t,a)=>{"use strict";a.d(t,{$N:()=>c,CW:()=>s,Lo:()=>m,i_:()=>d,sC:()=>o});var n=a(85583),r=a(51235),i=a(11783);const l=(0,n.createSelector)([e=>e.appointments],(e=>e.appointments)),o=(0,n.createSelector)([l],(e=>(0,r.values)(e))),s=e=>({appointments:t})=>e?t?.appointments?.[e]:void 0,c=(e,t)=>({appointments:a})=>e&&t?(0,r.find)(a?.appointments?.[e]?.inst,["ridZ",t]):void 0;function d({appointments:e}){return e?.status}function m({appointments:e},t,a){return(0,i.F0)((0,r.values)((0,r.reduce)(t,((t,a,n)=>{const i=(0,r.filter)(e?.appointments[n]?.inst,(e=>!!(0,r.find)(a,(t=>t===e.ridZ))));return[...t,{...e?.appointments[n],inst:i}]}),[])),a)}},11584:(e,t,a)=>{"use strict";a.d(t,{BG:()=>M,Dg:()=>k,EU:()=>v,JN:()=>I,KN:()=>d,L6:()=>y,Ox:()=>E,Q5:()=>T,Qt:()=>l,R:()=>O,Rf:()=>f,TH:()=>R,TJ:()=>u,UR:()=>m,Ur:()=>i,V5:()=>z,Xq:()=>p,Xt:()=>C,Z5:()=>D,a4:()=>h,dE:()=>c,dm:()=>b,f6:()=>A,gC:()=>r,jJ:()=>g,jg:()=>x,l9:()=>S,l_:()=>N,pW:()=>w,qn:()=>o,sw:()=>n,tl:()=>j,tu:()=>s,zB:()=>_});const n=e=>t=>t.editor.editors[e],r=e=>t=>t?.editor?.editors?.[e]?.isRichText,i=e=>t=>t?.editor?.editors?.[e]?.sender,l=e=>t=>t?.editor?.editors?.[e]?.title,o=e=>t=>t?.editor?.editors?.[e]?.location,s=e=>t=>t?.editor?.editors?.[e]?.room,c=e=>t=>t?.editor?.editors?.[e]?.attendees,d=e=>t=>t?.editor?.editors?.[e]?.uid,m=e=>t=>t?.editor?.editors?.[e]?.optionalAttendees,u=e=>t=>t?.editor?.editors?.[e]?.allDay,p=e=>t=>t?.editor?.editors?.[e]?.freeBusy,f=e=>t=>t?.editor?.editors?.[e]?.class,g=e=>t=>t?.editor?.editors?.[e]?.start,v=e=>t=>t?.editor?.editors?.[e]?.end,h=e=>t=>t?.editor?.editors?.[e]?.richText,b=e=>t=>t?.editor?.editors?.[e]?.plainText,E=e=>t=>t?.editor?.editors?.[e]?.timezone,y=e=>t=>t?.editor?.editors?.[e]?.reminder,w=e=>t=>t?.editor?.editors?.[e]?.recur,A=e=>t=>t?.editor?.editors?.[e]?.recur?.[0]?.add?.[0]?.rule?.[0]?.freq,x=e=>t=>t?.editor?.editors?.[e]?.recur?.[0]?.add?.[0]?.rule?.[0]?.interval?.[0]?.ival&&{ival:t?.editor?.editors?.[e]?.recur?.[0]?.add?.[0]?.rule?.[0]?.interval?.[0]?.ival},T=e=>t=>t?.editor?.editors?.[e]?.recur?.[0]?.add?.[0]?.rule?.[0]?.byday?.[0]?.wkday&&{wkday:t?.editor?.editors?.[e]?.recur?.[0]?.add?.[0]?.rule?.[0]?.byday?.[0]?.wkday},_=e=>t=>t?.editor?.editors?.[e]?.recur?.[0]?.add?.[0]?.rule?.[0]?.until?.[0]?.d,C=e=>t=>t?.editor?.editors?.[e]?.recur?.[0]?.add?.[0]?.rule?.[0]?.count?.[0]?.num,O=e=>t=>t?.editor?.editors?.[e]?.calendar,R=e=>t=>t?.editor?.editors?.[e]?.calendar?.id,k=e=>t=>t?.editor?.editors?.[e]?.isNew,S=e=>t=>t?.editor?.editors?.[e]?.inviteId,D=e=>t=>t?.editor?.editors?.[e]?.attachmentFiles,z=e=>t=>t?.editor?.editors?.[e]?.attach?.aid,I=e=>t=>t?.editor?.editors?.[e]?.attach?.mp,M=e=>t=>t?.editor?.editors?.[e]?.disabled,N=e=>t=>t?.editor?.editors?.[e]?.meetingRoom,j=e=>t=>t?.editor?.editors?.[e]?.equipment},33957:(e,t,a)=>{"use strict";a.d(t,{ZP:()=>S,gD:()=>k,fo:()=>R});var n=a(85583),r=a(12902),i=a(14883),l=a(83210),o=a(95030),s=a(9547),c=a(89323),d=a(10733);const m=(e,{meta:t})=>{const{id:a}=t.arg;t.arg.previousState=e.appointments,delete e.appointments[a]},u=e=>{e.status="completed"},p=(e,{meta:t})=>{t.arg.previousState&&(e.appointments=t.arg.previousState)};var f=a(51235);const g=(e,{meta:t})=>{t.arg.previousState=(0,f.cloneDeep)(e.appointments),(0,f.forEach)(t.arg.dismissItems,(t=>{e.appointments[t.id].alarmData=void 0}))},v=e=>{e.status="fulFilled"},h=(e,{meta:t})=>{t.arg.previousState&&(e.appointments=t.arg.previousState),e.status="error"};var b=a(55360);const E=e=>{e.status="completed"};var y=a(78936);const w=e=>{e.status="pending"},A=(e,{payload:t})=>{const a=(0,b.Wn)(t.appt);((e,t)=>{(0,f.forEach)(t,(t=>{t.id&&(e.appointments={...e.appointments,[t.id]:t})}))})(e,(0,f.values)(a)),e.status="idle"},x=e=>{e.status="error"},T=(e,{meta:t})=>{t.arg.previousState=(0,f.cloneDeep)(e.appointments);const a=e?.appointments?.[t.arg.id]?.alarmData;a&&a?.[0]?.nextAlarm&&(a[0].nextAlarm=t.arg.until)},_=e=>{e.status="fulFilled"},C=(e,{meta:t})=>{t.arg.previousState&&(e.appointments=t.arg.previousState),e.status="error"},O=(0,n.createSlice)({name:"appointments",initialState:{status:"init",appointments:{}},reducers:{handleModifiedAppointments:(0,r.ZP)(((e,{payload:t})=>{(0,f.forEach)(t,(t=>{const a=(0,f.find)(e.appointments,["id",t.id]);a&&(0,f.merge)(a,{l:t.l})}))})),handleCreatedAppointments:(0,r.ZP)(((e,{payload:t})=>{const a=(0,b.Yv)(t);(0,f.forEach)(a,(t=>{const a=(0,f.find)(e.appointments,["id",t.id]);a?(0,f.merge)(a,t):(0,f.merge)(e.appointments,{[t.id]:t})}))})),handleDeletedAppointments:(0,r.ZP)(((e,{payload:t})=>{(0,f.forEach)(t,(t=>{delete e.appointments[t]}))}))},extraReducers:e=>{e.addCase(s.b.pending,y.MB),e.addCase(s.b.rejected,y._q),e.addCase(s.b.fulfilled,y.XJ),e.addCase(o.Q.fulfilled,E),e.addCase(i.c.pending,m),e.addCase(i.c.fulfilled,u),e.addCase(i.c.rejected,p),e.addCase(l.m.pending,g),e.addCase(l.m.fulfilled,v),e.addCase(l.m.rejected,h),e.addCase(d.J.pending,T),e.addCase(d.J.fulfilled,_),e.addCase(d.J.rejected,C),e.addCase(c.C.pending,w),e.addCase(c.C.fulfilled,A),e.addCase(c.C.rejected,x)}}),{handleModifiedAppointments:R,handleDeletedAppointments:k}=O.actions,S=O.reducer},89458:(e,t,a)=>{"use strict";a.d(t,{RY:()=>l,ZP:()=>O,_b:()=>A,nX:()=>s,vR:()=>g,A5:()=>b,S6:()=>E,Fy:()=>y,lG:()=>h,cU:()=>f,jf:()=>m,xs:()=>p,Zl:()=>v,Of:()=>_,D7:()=>T,hU:()=>u,Yj:()=>w,ln:()=>x,Hg:()=>d,vF:()=>o,zz:()=>c,C:()=>C});var n=a(85583),r=a(51235);const i=(0,n.createSlice)({name:"editor",initialState:{status:"idle",editors:{}},reducers:{createNewEditor:(e,t)=>{t.payload&&(e.editors[t.payload.id]=t.payload)},editIsRichText:({editors:e},{payload:t})=>{t?.id&&!(0,r.isNil)(e?.[t?.id]?.isRichText)&&(e[t.id].isRichText=t.isRichText)},editEditorAttachments:({editors:e},{payload:t})=>{t?.id&&e?.[t?.id]&&(e[t.id].attachmentFiles=t.attachmentFiles,e[t.id].attach=t?.attach)},editSender:({editors:e},{payload:t})=>{t?.id&&e?.[t?.id]?.sender&&t?.sender&&(e[t.id].sender=t.sender)},editEditorTitle:({editors:e},{payload:t})=>{!t?.id||(0,r.isNil)(e?.[t?.id]?.title)||(0,r.isNil)(t?.title)||(e[t.id].title=t.title)},editEditorLocation:({editors:e},{payload:t})=>{!t?.id||(0,r.isNil)(e?.[t?.id]?.location)||(0,r.isNil)(t?.location)||(e[t.id].location=t.location)},editEditorRoom:({editors:e},{payload:t})=>{const{label:a,link:n,attendees:i}=t.room;t?.id&&(e[t.id].room=a&&n?{label:a,link:n}:void 0,i&&(e[t.id].attendees=(0,r.union)(e[t.id].attendees,i)))},editEditorAttendees:({editors:e},{payload:t})=>{e[t.id].attendees=t.attendees},editEditorOptionalAttendees:({editors:e},{payload:t})=>{e[t.id].optionalAttendees=t.optionalAttendees},editEditorDisplayStatus:({editors:e},{payload:t})=>{e?.[t?.id]&&(e[t.id].freeBusy=t.freeBusy)},editEditorCalendar:({editors:e},{payload:t})=>{t?.id&&e?.[t?.id]&&(e[t.id].calendar=t.calendar)},editEditorClass:({editors:e},{payload:t})=>{t?.id&&e?.[t?.id]&&(e[t.id].class=t.class)},editEditorDate:({editors:e},{payload:t})=>{t?.id&&e?.[t?.id]&&(e[t.id].start=t.start,e[t.id].end=t.end)},editEditorMeetingRoom:({editors:e},{payload:t})=>{t?.id&&!(0,r.isNil)(e?.[t?.id])&&(e[t.id].meetingRoom=t.meetingRoom)},editEditorEquipment:({editors:e},{payload:t})=>{t?.id&&!(0,r.isNil)(e?.[t?.id])&&(e[t.id].equipment=t.equipment)},editEditorText:({editors:e},{payload:t})=>{t?.id&&e?.[t?.id]&&(e[t.id].richText=t.richText,e[t.id].plainText=t.plainText)},editEditorAllDay:({editors:e},{payload:t})=>{t?.id&&e?.[t?.id]&&(e[t.id].allDay=t.allDay)},editEditorTimezone:({editors:e},{payload:t})=>{t?.id&&e?.[t?.id]&&(e[t.id].timezone=t.timezone)},editEditorReminder:({editors:e},{payload:t})=>{t?.id&&e?.[t?.id]&&(e[t.id].reminder=t.reminder)},editEditorRecurrence:({editors:e},{payload:t})=>{t?.id&&e?.[t?.id]&&(e[t.id].recur=t.recur)},updateEditor:(e,{payload:t})=>{t?.id&&e?.editors?.[t?.id]&&(e.editors[t.id]={...e.editors[t.id],...t.editor})}}}),{createNewEditor:l,editIsRichText:o,editEditorAttachments:s,editSender:c,editEditorTitle:d,editEditorLocation:m,editEditorRoom:u,editEditorMeetingRoom:p,editEditorEquipment:f,editEditorAttendees:g,editEditorOptionalAttendees:v,editEditorDisplayStatus:h,editEditorCalendar:b,editEditorClass:E,editEditorDate:y,editEditorText:w,editEditorAllDay:A,editEditorTimezone:x,editEditorReminder:T,editEditorRecurrence:_,updateEditor:C}=i.actions,O=i.reducer},20309:(e,t,a)=>{"use strict";a.d(t,{ZP:()=>w,TC:()=>y});var n=a(85583),r=a(46609),i=a(9547),l=a(74713),o=a(98764),s=a(61004),c=a(16990);function d(e,t){const{m:a}=t.payload;e.invites[t.meta.arg.inviteId]=(0,c.I)(a?.[0])}function m(e){e.status="error"}var u=a(51235);const p=(e,{payload:t})=>{t?.editor?.inviteId&&delete e.invites[t?.editor?.inviteId]};var f=a(78936);const g=(e,{payload:t})=>{t?.editor?.inviteId&&delete e.invites[t?.editor?.inviteId]},v=(e,t)=>{t.meta.arg.fromMail||(e.status="pending")},h=(e,t)=>{t.meta.arg.fromMail||(e.status="fulfilled"),t.payload&&delete e.invites[t.meta.arg.inviteId]},b=e=>{e.status="error"},E=(0,n.createSlice)({name:"invites",initialState:{status:"idle",invites:{}},reducers:{handleModifiedInvites:(e,t)=>{const a=(0,u.map)(t.payload,(e=>(0,u.omitBy)((0,c.F)(e),u.isNil)));(0,u.forEach)(a,(t=>{e?.invites?.[t.id]&&(e.invites[t.id]={...e.invites?.[t.id],...t})}))}},extraReducers:e=>{e.addCase(r.E.fulfilled,d),e.addCase(r.E.rejected,m),e.addCase(s.k.pending,v),e.addCase(s.k.fulfilled,h),e.addCase(s.k.rejected,b),e.addCase(i.b.fulfilled,f.XJ),e.addCase(l.Q.fulfilled,p),e.addCase(o.k.fulfilled,g)}}),{handleModifiedInvites:y}=E.actions,w=E.reducer},85492:(e,t,a)=>{"use strict";a.d(t,{$V:()=>o,NX:()=>s,XU:()=>r,Y4:()=>i,Zo:()=>c,fR:()=>l,p:()=>d});var n=a(58753);const r=()=>(0,n.n)((e=>e.calendarView)),i=()=>(0,n.n)((e=>e.date)),l=()=>(0,n.n)((e=>e.summaryViewId)),o=()=>(0,n.n)((e=>!!e.summaryViewId)),s=()=>(0,n.n)((e=>e.setRange)),c=()=>(0,n.n)((e=>e.range.start)),d=()=>(0,n.n)((e=>e.range.end))},58753:(e,t,a)=>{"use strict";a.d(t,{n:()=>i});var n=a(750),r=a.n(n);const i=(0,a(30270).Ue)((e=>({calendarView:"",date:new Date,summaryViewId:void 0,equipment:void 0,meetingRoom:void 0,range:{start:r()().subtract("7","days").valueOf(),end:r()().add("15","days").valueOf()},setRange:({start:t,end:a})=>{e((({range:e})=>t<e.start?r()(e.end).diff(r()(t),"days")>=400?{range:{end:r()(t).add("399","days").valueOf(),start:t}}:{range:{...e,start:t}}:e.end<a?r()(a).diff(r()(e.start),"days")>=400?{range:{start:r()(a).subtract("399","days").valueOf(),end:a}}:{range:{...e,end:a}}:{range:e}))}})))},40232:(e,t,a)=>{"use strict";a.d(t,{T:()=>r,x:()=>n});const n={EXPAND:"expand",TRASH:"trash",MOVE:"move",EDIT:"edit",EDIT_TAGS:"edit_tags",PRINT:"print",REPLY_ALL:"reply_all",FORWARD:"forward",SHOW_ORIGNAL:"show_orignal",CREATE_COPY:"create_copy",REINVITE_ATT:"reinvite_attendees",ACCEPT:"accept",TENTATIVE:"tentative",DECLINE:"decline",PROPOSE_NEW_TIME:"propose_new_time",REPLY:"reply",FIND_SHARES:"find_shares",EXPAND_SERIES:"expand_series",DELETE_PERMANENTLY:"deletePermanently",NEW_TAG:"new_tag",DELETE_TAG:"delete_tag",EDIT_TAG:"edit_tag",APPLY_TAG:"apply_tag",INSTANCE:"instance",SERIES:"series",SHOW_ORIGINAL:"show_original",DOWNLOAD_ICS:"download_ics",ANSWER:"answer"},r={CREATE_APPOINTMENT:"create_appointment"}},88528:(e,t,a)=>{"use strict";a.d(t,{$:()=>o,AG:()=>l,CO:()=>i});var n=a(6017),r=a(51235);const i=(e,t)=>{const a=((e,t)=>{if(!e)return 0;const a=Intl.DateTimeFormat("en",{timeZoneName:"shortOffset",timeZone:e}).formatToParts(t).find((e=>"timeZoneName"===e.type))?.value;if(!a)return 0;const n=a.slice(3);if(!n)return 0;const r=n.match(/([+-])(\d+)(?::(\d+))?/);if(r){const[,e,t,a]=r;let n=60*parseInt(t,10);return a&&(n+=parseInt(a,10)),"+"===e&&(n*=-1),n}return 0})(t,e),n=t?a-e.getTimezoneOffset():0;return new Date(e.getTime()+6e4*n)},l=(e,t)=>{const a=parseInt(e.substring(0,4),10),n=parseInt(e.substring(4,6),10)-1,l=parseInt(e.substring(6,8),10),o=parseInt(e.substring(9,11),10),s=parseInt(e.substring(11,13),10),c=parseInt(e.substring(13,15),10),d=(0,r.isNaN)(o)?0:o,m=(0,r.isNaN)(s)?0:s,u=(0,r.isNaN)(c)?0:c,p=new Date(a,n,l,d,m,u);return i(p,t)},o=({start:e,end:t,locale:a,allDay:r,allDayLabel:i,timezone:l,intlOptions:o})=>{const s=(({locale:e,timezone:t,allDay:a,intlOptions:r})=>{const i=e??(0,n.getUserSettings)().prefs.zimbraPrefLocale??Intl.NumberFormat().resolvedOptions().locale,l=Intl.DateTimeFormat().resolvedOptions().timeZone,o={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:a?void 0:"numeric",minute:a?void 0:"numeric",timeZone:t??l,timeZoneName:a?void 0:"short",...r};return new Intl.DateTimeFormat(i,o)})({locale:a,timezone:l,allDay:r,intlOptions:o}).formatRange(e,t);return r?`${s} - ${i}`:s}},36177:(e,t,a)=>{"use strict";a.d(t,{w:()=>l});var n=a(750),r=a.n(n),i=a(50364);const l=({start:e,tz:t,allDay:a})=>a?{d:r()(e).format(i.zT.ALL_DAY),tz:t}:{d:t?r()(e).tz(t).format(i.zT.LOCAL):r()(e).utc().format(i.zT.UTC),tz:t}},97225:(e,t,a)=>{"use strict";a.d(t,{Aq:()=>d,H_:()=>p,Q5:()=>o,S6:()=>f,ST:()=>u,s9:()=>m,wz:()=>s,xG:()=>v,xN:()=>c,xs:()=>g});var n=a(50364);function r(e){return t=>a=>e(a,t)}const i=r(((e,t)=>e*t)),l=r(((e,t)=>e/t)),o=i(n.rE),s=i(n.Fq),c=i(n.Go),d=l(n.Yt),m=l(n.Fq),u=l(n.rE),p=l(n.Go),f=e=>e%(n.Fq*n.ux*n.ee)==0,g=e=>e%(n.Fq*n.ux)==0,v=e=>e%n.Fq==0},7183:(e,t,a)=>{"use strict";a.d(t,{g:()=>g});var n=a(92652),r=a.n(n),i=a(97363),l=a(6017),o=a(51235),s=a(93747),c=a(60397),d=a(93046),m=a(53955),u=a(82163),p=a(50364),f=a(56206);const g=({calendarId:e,onCalendarChange:t,label:a,excludeTrash:g=!1,showCalWithWritePerm:v=!0,disabled:h})=>{const[b]=(0,s.useTranslation)(),E=(0,d.px)(e),y=(0,d.mv)(E??l.FOLDERS.USER_ROOT),w=(0,d.tc)(),A=(0,o.reject)(E?.includes(":")?y:w,(e=>e.name===l.ROOT_NAME||e.oname===l.ROOT_NAME)),{zimbraPrefDefaultCalendarId:x}=(0,l.useUserSettings)().prefs,T=(0,n.useMemo)((()=>v?(0,o.filter)(A,(e=>e.perm?/w/.test(e.perm):!e.owner)):A),[A,v]),_=(0,n.useMemo)((()=>g?(0,o.filter)(T,(e=>!(0,m.dK)(e))):T),[T,g]),C=(0,n.useMemo)((()=>(0,o.map)(_,(e=>{const t=(0,f.Kd)({color:e.color,rgb:e.rgb}),a=(0,u.rR)(e,l.FOLDERS.CALENDAR)?b("label.calendar","Calendar"):e.name;return{...e,label:a,value:e.id,color:t.color,customComponent:r().createElement(c.I4,{disabled:h??!1,absFolderPath:e.absFolderPath,color:t.color,isLink:e.isLink,label:a,acl:e.acl,id:e.id})}}))),[h,_,b]),O=(0,n.useMemo)((()=>{const t=(0,o.find)(_,["id",x??p.Ai?.DEFAULT_CALENDAR_ID]),a={id:_?.[0]?.id??t?.id,acl:_?.[0]?.acl??t?.acl,isLink:_?.[0]?.isLink??t?.isLink,absFolderPath:_?.[0]?.absFolderPath??t?.absFolderPath,value:_?.[0]?.id??t?.id,label:_?.[0]?.name??t?.name,color:_?.[0]?.color?(0,f.N2)(_?.[0]?.color).color:t?.color};return(0,o.find)(C,["value",e])??a}),[_,x,C,e]),R=(0,n.useCallback)((e=>{const a=(0,o.find)(A,["id",e])??_[0];return t(a)}),[A,t,_]);return A&&O?r().createElement(i.Select,{label:a||b("label.calendar","Calendar"),onChange:R,items:C,maxWidth:"fill",defaultSelection:O,disablePortal:!0,disabled:h,LabelFactory:c.ZP,background:"white",style:{border:"1px solid lightgray"}}):null}},84974:(e,t,a)=>{"use strict";a.d(t,{G:()=>u,_:()=>m});var n=a(92652),r=a.n(n),i=a(97363),l=a(51235),o=a(750),s=a.n(o),c=a(68242),d=a(11584);const m=(e,t,a,n,r)=>{if(t&&a&&n&&!(0,l.isNil)(r)){const n=s()(t),i=s()(a),o=n.format("DDMMYYYY"),c=i.format("DDMMYYYY"),d=i.diff(n,"days"),m=n.format("HHmm"),u=i.format("HHmm");if(r)return!(i.add(1,"day").startOf("day").diff(n.startOf("day"),"days")>1||!(0,l.find)((e.t??[]).concat(e.b??[]),(e=>s()(e.s).format("DD")===n.format("DD")||s()(e.e).format("DD")===n.format("DD"))));if(1===d&&m===u&&(0,l.startsWith)(m,"00")||o===c)return!!(0,l.find)((e.t??[]).concat(e.b??[]),(e=>t>e.s&&t<e.e||a>e.s&&a<e.e||t<e.s&&a>e.e||t===e.s||a===e.e))}return!1},u=({label:e,list:t,items:a,editorId:o})=>{const s=(0,c.C)((0,d.jJ)(o)),u=(0,c.C)((0,d.EU)(o)),p=(0,c.C)((0,d.TJ)(o)),f=(0,n.useMemo)((()=>(0,l.intersectionBy)(t,a??[],"email")),[a,t]);return(0,n.useMemo)((()=>!!(0,l.find)(f,(e=>m(e,s,u,t,p)))),[p,t,f,u,s])?r().createElement(i.Row,{height:"fit",width:"fill",mainAlignment:"flex-start",padding:{top:"small"}},r().createElement(i.Text,{size:"small",color:"error"},e)):null}},60397:(e,t,a)=>{"use strict";a.d(t,{I4:()=>b,ZP:()=>E,bK:()=>u});var n=a(92652),r=a.n(n),i=a(97363),l=a(93747),o=a(91750),s=a.n(o),c=a(93046),d=a(70656),m=a(2244);const u=s().div.withConfig({displayName:"select-label-factory__Square",componentId:"sc-1ogg0z3-0"})(["width:1rem;height:1rem;background:",";border-radius:0.25rem;opacity:",";"],(({color:e})=>e),(({disabled:e})=>e?.5:1)),p=s()(i.Container).withConfig({displayName:"select-label-factory__ColorContainer",componentId:"sc-1ogg0z3-1"})(["border-bottom:0.0625rem solid ",";"],(({theme:e})=>e.palette.gray2.regular)),f=s()(i.Text).withConfig({displayName:"select-label-factory__TextUpperCase",componentId:"sc-1ogg0z3-2"})(["text-transform:capitalize;text-overflow:ellipsis;white-space:nowrap;color:",";"],(({theme:e,disabled:t,color:a})=>a?t?e.palette.text.disabled:a:t?e.palette.text.disabled:e.palette.text.regular)),g=s()(i.Text).withConfig({displayName:"select-label-factory__LabelText",componentId:"sc-1ogg0z3-3"})(["color:","};"],(({theme:e,disabled:t,$showPrimary:a})=>t?e.palette.text.disabled:a?e.palette.primary.regular:e.palette.secondary.regular)),v=s()(i.Icon).withConfig({displayName:"select-label-factory__StyledIcon",componentId:"sc-1ogg0z3-4"})(["color:","};"],(({theme:e,disabled:t,$showPrimary:a})=>t?e.palette.text.disabled:a?e.palette.primary.regular:e.palette.secondary.regular)),h=({icon:e,color:t,tooltipText:a})=>r().createElement(i.Padding,{left:"small"},r().createElement(i.Tooltip,{placement:"right",label:a},r().createElement(i.Row,null,r().createElement(i.Icon,{icon:e,color:t,size:"medium"})))),b=({id:e,color:t,label:a,acl:o,isLink:s,absFolderPath:p,disabled:g})=>{const[v]=(0,l.useTranslation)(),b=(0,c.f8)(e??""),E=(0,n.useMemo)((()=>{if(s||(0,m.ZE)({absFolderPath:p})){const e=v("tooltip.folder_linked_status","Linked to me");return r().createElement(h,{icon:"Linked",color:"linked",tooltipText:e})}if(o?.grant){const e=v("tooltip.calendar_sharing_status",{count:o?.grant?.length,defaultValue_one:"Shared with 1 person",defaultValue_other:"Shared with {{count}} people"});return r().createElement(h,{icon:"Shared",color:"shared",tooltipText:e})}return null}),[p,o?.grant,s,v]);return r().createElement(i.Row,{wrap:"nowrap"},r().createElement(i.Padding,{right:"small"},r().createElement(u,{color:t,disabled:g})),r().createElement(f,{disabled:g},a),E,r().createElement(i.Row,{takeAvailableSpace:!0},b&&b.id!==d.el.USER_ROOT&&r().createElement(i.Padding,{left:"small",style:{overflow:"hidden"}},r().createElement(f,{color:"gray1"},`(${b.name})`))))},E=e=>{const{selected:t,label:a,open:n,focus:l,disabled:o}=e;return r().createElement(p,{orientation:"horizontal",width:"fill",crossAlignment:"center",mainAlignment:"space-between",borderRadius:"half",padding:{all:"small"},background:"gray5",style:{cursor:o?"no-drop":"pointer"}},r().createElement(i.Row,{width:"100%",takeAvailableSpace:!0,mainAlignment:"space-between"},r().createElement(i.Row,{orientation:"vertical",crossAlignment:"flex-start",mainAlignment:"flex-start",padding:{left:"small"}},r().createElement(g,{size:"small",disabled:o,$showPrimary:n||l},a),t?.[0]&&r().createElement(b,{label:t[0].label,color:t[0].color,isLink:t[0].isLink,absFolderPath:t[0].absFolderPath,acl:t[0].acl,id:t[0].id,disabled:o}))),r().createElement(v,{size:"large",icon:n?"ChevronUpOutline":"ChevronDownOutline",disabled:o,$showPrimary:n||l,style:{alignSelf:"center"}}))}},65107:(e,t,a)=>{"use strict";a.d(t,{Vm:()=>_,Ay:()=>w,ln:()=>y,qC:()=>C,ab:()=>O});var n=a(92652),r=a.n(n),i=a(97363),l=a(6017),o=a(51235),s=a(28081),c=a(4833),d=a(6062);const m=({selected:e,label:t,open:a,focus:n})=>r().createElement(d.Qk,{orientation:"horizontal",width:"fill",crossAlignment:"center",mainAlignment:"space-between",borderRadius:"half",background:"gray5",padding:{all:"small"}},r().createElement(i.Row,{width:"100%",takeAvailableSpace:!0,mainAlignment:"space-between"},r().createElement(i.Row,{orientation:"vertical",crossAlignment:"flex-start",mainAlignment:"flex-start",padding:{left:"small"}},r().createElement(i.Text,{size:"small",color:a||n?"primary":"secondary"},t),r().createElement(d.sd,null,e[0].label)),r().createElement(i.Padding,{right:"small"},r().createElement(d.bK,{color:l.ZIMBRA_STANDARD_COLORS[Number(e[0].value)].hex}))),r().createElement(i.Icon,{size:"large",icon:a?"ChevronUpOutline":"ChevronDownOutline",color:a||n?"primary":"secondary",style:{alignSelf:"center"}}));function u({t:e,onChange:t,defaultColor:a=0,label:o}){const s=(0,n.useMemo)((()=>(e=>l.ZIMBRA_STANDARD_COLORS.map(((t,a)=>({label:e(t.zLabel),value:a.toString(),customComponent:r().createElement(i.Container,{width:"100%",takeAvailableSpace:!0,mainAlignment:"space-between",orientation:"horizontal",height:"fit"},r().createElement(i.Padding,{left:"small"},r().createElement(d.sd,null,e(t.zLabel))),r().createElement(d.bK,{color:t.hex}))}))))(e)),[e]),c=(0,n.useMemo)((()=>s[a]),[s,a]);return r().createElement(i.Select,{label:o,onChange:t,items:s,defaultSelection:c,LabelFactory:m})}var p=a(5369);const f=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+/,g=({onClose:e,editMode:t=!1,tag:a,event:o})=>{const d=(0,i.useSnackbar)(),[m,g]=(0,n.useState)(a?.name||""),[v,h]=(0,n.useState)(a?.color||0),b=(0,n.useMemo)((()=>t?(0,l.t)("label.edit_tag_name",{name:a?.name,defaultValue:'Edit "{{name}}" tag'}):(0,l.t)("label.create_tag","Create a new Tag")),[t,a?.name]),E=(0,n.useMemo)((()=>(0,l.t)("label.tag_name","Tag name")),[]),y=(0,n.useCallback)((e=>h(e)),[]),w=(0,n.useCallback)((e=>g(e.target.value)),[]),A=(0,n.useMemo)((()=>m.length>=128),[m]),x=(0,n.useMemo)((()=>f.test(m)),[m]),T=(0,n.useMemo)((()=>A||x),[A,x]),_=(0,n.useMemo)((()=>""===m||T),[m,T]),C=(0,n.useCallback)((({inviteId:e,tagName:t})=>{(0,p.Y)({op:"tag",id:e,tagName:t}).then((()=>{d({key:"tag",replace:!0,hideButton:!0,type:"info",label:(0,l.t)("snackbar.tag_applied",{tag:t,defaultValue:'"{{tag}}" tag applied'}),autoHideTimeout:3e3})})).catch((()=>{d({key:"tag",replace:!0,type:"error",label:(0,l.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})}))}),[d]),O=(0,n.useCallback)((()=>(0,l.createTag)({name:m,color:v}).then((t=>{t.tag&&(o?C({inviteId:o.resource.id,tagName:t.tag?.[0]?.name}):d({key:"new-tag",replace:!0,type:"info",label:(0,l.t)("messages.snackbar.tag_created",{name:m,defaultValue:"Tag {{name}} successfully created"}),autoHideTimeout:3e3,hideButton:!0})),e()}))),[m,v,e,o,C,d]),R=(0,n.useCallback)((()=>{Promise.all([(0,l.renameTag)(`${a?.id}`,m),(0,l.changeTagColor)(`${a?.id}`,Number(v))]).then((()=>{e(),d({key:"update-tag",replace:!0,type:"info",label:(0,l.t)("messages.snackbar.tag_updated","Tag successfully updated"),autoHideTimeout:3e3,hideButton:!0})})).catch((()=>{e(),d({key:"update-tag-error",replace:!0,type:"error",label:(0,l.t)("messages.snackbar.tag_not_updated","Something went wrong, tag not updated. Please try again."),autoHideTimeout:3e3,hideButton:!0})}))}),[v,d,m,e,a]);return r().createElement(r().Fragment,null,r().createElement(c.Z,{onClose:e,title:b}),r().createElement(i.Input,{label:E,value:m,onChange:w,backgroundColor:"gray5",textColor:T?"error":"text",hasError:T}),T&&r().createElement(i.Padding,{all:"small"},A&&r().createElement(i.Text,{size:"extrasmall",color:"error",overflow:"break-word"},(0,l.t)("label.tag_max_length","Max 128 characters are allowed")),x&&r().createElement(i.Text,{size:"extrasmall",color:"error",overflow:"break-word"},(0,l.t)("label.no_special_char_allowed","Name should not contain any special character"))),r().createElement(i.Padding,{top:"small"}),r().createElement(u,{onChange:y,t:l.t,label:(0,l.t)("label.select_color","Select Color"),defaultColor:v}),r().createElement(s.Z,{onConfirm:t?R:O,label:t?(0,l.t)("label.edit","edit"):(0,l.t)("label.create","Create"),disabled:_}))},v=({onClose:e,tag:t})=>{const a=(0,i.useSnackbar)(),o=(0,n.useMemo)((()=>(0,l.t)("label.delete_tag_name",{name:t?.name,defaultValue:'Delete "{{name}}" tag'})),[t?.name]),d=(0,n.useCallback)((()=>{t&&(0,l.deleteTag)(t?.id).then((n=>{n.action&&a({key:"delete-tag",replace:!0,type:"success",label:(0,l.t)("messages.snackbar.tag_deleted",{name:t?.name,defaultValue:"{{name}} Tag deleted successfully"}),autoHideTimeout:3e3,hideButton:!0}),e()}))}),[a,e,t]);return r().createElement(r().Fragment,null,r().createElement(c.Z,{onClose:e,title:o}),r().createElement(i.Container,{padding:{horizontal:"large"}},r().createElement(i.Text,null,(0,l.t)("message.delete_tag_message1",{name:t?.name,defaultValue:'Are you sure to delete "{{name}}" Tag?'})),r().createElement(i.Text,{overflow:"break-word",style:{textAlign:"center"}},(0,l.t)("message.delete_tag_message2","Once deleted, it will be removed from every item marked with it."))),r().createElement(s.Z,{onConfirm:d,label:(0,l.t)("label.delete","Delete"),disabled:!1,color:"error"}))};var h=a(59379),b=a(40232);const E=(0,l.t)("label.tags","Tags"),y=({createModal:e})=>({id:b.x.NEW_TAG,icon:"TagOutline",label:(0,l.t)("label.create_tag","Create Tag"),onClick:t=>{t&&t.stopPropagation();const a=e?.({children:r().createElement(h.g,null,r().createElement(g,{onClose:()=>a?.()}))},!0)}}),w=({context:e,event:t})=>({id:b.x.NEW_TAG,icon:"TagOutline",label:(0,l.t)("label.create_tag","Create Tag"),onClick:a=>{a&&a.stopPropagation();const n=e.createModal({children:r().createElement(h.g,null,r().createElement(g,{onClose:()=>n(),event:t}))},!0)}}),A=({createModal:e,tag:t})=>({id:b.x.EDIT_TAGS,icon:"Edit2Outline",label:(0,l.t)("label.edit_tag","Edit Tag"),onClick:a=>{a&&a.stopPropagation();const n=e({children:r().createElement(h.g,null,r().createElement(g,{onClose:()=>n(),tag:t,editMode:!0}))},!0)}}),x=({createModal:e,tag:t})=>({id:b.x.DELETE_TAG,icon:"Untag",label:(0,l.t)("label.delete_tag","Delete Tag"),onClick:a=>{a&&a.stopPropagation();const n=e({children:r().createElement(h.g,null,r().createElement(v,{onClose:()=>n(),tag:t}))},!0)}}),T=({tag:e,event:t})=>{const a=(0,i.useSnackbar)(),[s,c]=(0,n.useState)((0,o.includes)(t.resource.tags,e.id)),[d,m]=(0,n.useState)(!1),u=(0,n.useCallback)((n=>{c((e=>!e)),(0,p.Y)({op:n?"!tag":"tag",id:t.resource.id,tagName:e.name}).then((()=>{a({key:"tag",replace:!0,hideButton:!0,type:"info",label:n?(0,l.t)("snackbar.tag_removed",{tag:e.name,defaultValue:'"{{tag}}" tag removed'}):(0,l.t)("snackbar.tag_applied",{tag:e.name,defaultValue:'"{{tag}}" tag applied'}),autoHideTimeout:3e3})})).catch((()=>{a({key:"tag",replace:!0,type:"error",label:(0,l.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})}))}),[t?.resource?.id,a,e.name]),f=(0,n.useMemo)((()=>l.ZIMBRA_STANDARD_COLORS[e.color||0].hex),[e.color]),g=(0,n.useMemo)((()=>s?"Tag":"TagOutline"),[s]),v=(0,n.useMemo)((()=>s?"Untag":"Tag"),[s]);return r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start",onClick:()=>u(s),onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1)},r().createElement(i.Padding,{right:"small"},r().createElement(i.Checkbox,{value:s})),r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"space-between"},r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},r().createElement(i.Text,null,e.name)),r().createElement(i.Row,{mainAlignment:"flex-end"},r().createElement(i.Icon,{icon:d?v:g,color:f}))))},_=({context:e,event:t})=>{const a=(0,o.reduce)(e.tags,((e,a)=>{const n={id:a.id,label:a.name,icon:"TagOutline",keepOpen:!0,customComponent:r().createElement(T,{tag:a,event:t})};return e.push(n),e}),[]);return a.push({id:"new_tag",keepOpen:!0,customComponent:r().createElement(i.Button,{label:(0,l.t)("label.new_tag","New Tag"),type:"outlined",width:"fill",size:"small",onClick:()=>e.createAndApplyTag({context:e,event:t}).onClick()})}),t.haveWriteAccess?{id:b.x.APPLY_TAG,items:a,onClick:o.noop,icon:"TagsMoreOutline",label:E,disabled:!1,tooltipLabel:(0,l.t)("label.no_rights","You do not have permission to perform this action"),customComponent:r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},r().createElement(i.Padding,{right:"small"},r().createElement(i.Icon,{icon:"TagsMoreOutline"})),r().createElement(i.Row,{takeAvailableSpace:!0,mainAlignment:"space-between"},r().createElement(i.Padding,{right:"small"},r().createElement(i.Text,null,E))))}:{id:b.x.APPLY_TAG,items:[],onClick:o.noop,tooltipLabel:(0,l.t)("label.no_rights","You do not have permission to perform this action"),label:E,icon:"TagsMoreOutline",disabled:!0}},C=({tag:e})=>{const t=(0,i.useModal)(),a=(0,i.useSnackbar)();return(0,n.useMemo)((()=>[y({createModal:t}),A({createModal:t,tag:e}),x({tag:e,createSnackbar:a,createModal:t})]),[t,a,e])},O=e=>{const t=(()=>{const e=(0,l.useTags)();return(0,n.useMemo)((()=>(0,o.reduce)(e,((e,t)=>(e.push(t),e)),[])),[e])})();return(0,n.useMemo)((()=>e?.length>0&&0===(0,o.differenceBy)(e,t,"id")?.length),[e,t])}},46700:(e,t,a)=>{var n={"./af":6678,"./af.js":6678,"./ar":25295,"./ar-dz":45476,"./ar-dz.js":45476,"./ar-kw":31348,"./ar-kw.js":31348,"./ar-ly":22025,"./ar-ly.js":22025,"./ar-ma":33478,"./ar-ma.js":33478,"./ar-ps":77430,"./ar-ps.js":77430,"./ar-sa":71018,"./ar-sa.js":71018,"./ar-tn":57371,"./ar-tn.js":57371,"./ar.js":25295,"./az":63895,"./az.js":63895,"./be":10796,"./be.js":10796,"./bg":99983,"./bg.js":99983,"./bm":3740,"./bm.js":3740,"./bn":67013,"./bn-bd":5046,"./bn-bd.js":5046,"./bn.js":67013,"./bo":30393,"./bo.js":30393,"./br":30965,"./br.js":30965,"./bs":5228,"./bs.js":5228,"./ca":49744,"./ca.js":49744,"./cs":73141,"./cs.js":73141,"./cv":79831,"./cv.js":79831,"./cy":38153,"./cy.js":38153,"./da":15477,"./da.js":15477,"./de":63062,"./de-at":84080,"./de-at.js":84080,"./de-ch":71626,"./de-ch.js":71626,"./de.js":63062,"./dv":72168,"./dv.js":72168,"./el":56800,"./el.js":56800,"./en-au":43047,"./en-au.js":43047,"./en-ca":10033,"./en-ca.js":10033,"./en-gb":25383,"./en-gb.js":25383,"./en-ie":90853,"./en-ie.js":90853,"./en-il":65665,"./en-il.js":65665,"./en-in":31886,"./en-in.js":31886,"./en-nz":36072,"./en-nz.js":36072,"./en-sg":86350,"./en-sg.js":86350,"./eo":88684,"./eo.js":88684,"./es":48898,"./es-do":78613,"./es-do.js":78613,"./es-mx":6587,"./es-mx.js":6587,"./es-us":4654,"./es-us.js":4654,"./es.js":48898,"./et":78351,"./et.js":78351,"./eu":71733,"./eu.js":71733,"./fa":12401,"./fa.js":12401,"./fi":47303,"./fi.js":47303,"./fil":98889,"./fil.js":98889,"./fo":86588,"./fo.js":86588,"./fr":10500,"./fr-ca":78579,"./fr-ca.js":78579,"./fr-ch":21445,"./fr-ch.js":21445,"./fr.js":10500,"./fy":20235,"./fy.js":20235,"./ga":98789,"./ga.js":98789,"./gd":93110,"./gd.js":93110,"./gl":22881,"./gl.js":22881,"./gom-deva":26778,"./gom-deva.js":26778,"./gom-latn":55522,"./gom-latn.js":55522,"./gu":59273,"./gu.js":59273,"./he":53979,"./he.js":53979,"./hi":29356,"./hi.js":29356,"./hr":72592,"./hr.js":72592,"./hu":52674,"./hu.js":52674,"./hy-am":76846,"./hy-am.js":76846,"./id":30029,"./id.js":30029,"./is":28255,"./is.js":28255,"./it":9085,"./it-ch":34451,"./it-ch.js":34451,"./it.js":9085,"./ja":5864,"./ja.js":5864,"./jv":95688,"./jv.js":95688,"./ka":31848,"./ka.js":31848,"./kk":8786,"./kk.js":8786,"./km":33226,"./km.js":33226,"./kn":51243,"./kn.js":51243,"./ko":98852,"./ko.js":98852,"./ku":77226,"./ku-kmr":74293,"./ku-kmr.js":74293,"./ku.js":77226,"./ky":10896,"./ky.js":10896,"./lb":37104,"./lb.js":37104,"./lo":86111,"./lo.js":86111,"./lt":91059,"./lt.js":91059,"./lv":7962,"./lv.js":7962,"./me":74899,"./me.js":74899,"./mi":26642,"./mi.js":26642,"./mk":68949,"./mk.js":68949,"./ml":49043,"./ml.js":49043,"./mn":12241,"./mn.js":12241,"./mr":23022,"./mr.js":23022,"./ms":29403,"./ms-my":4188,"./ms-my.js":4188,"./ms.js":29403,"./mt":27104,"./mt.js":27104,"./my":87673,"./my.js":87673,"./nb":74363,"./nb.js":74363,"./ne":49995,"./ne.js":49995,"./nl":25363,"./nl-be":62352,"./nl-be.js":62352,"./nl.js":25363,"./nn":89574,"./nn.js":89574,"./oc-lnc":41822,"./oc-lnc.js":41822,"./pa-in":40430,"./pa-in.js":40430,"./pl":56165,"./pl.js":56165,"./pt":51781,"./pt-br":66584,"./pt-br.js":66584,"./pt.js":51781,"./ro":83145,"./ro.js":83145,"./ru":23270,"./ru.js":23270,"./sd":22181,"./sd.js":22181,"./se":86638,"./se.js":86638,"./si":88434,"./si.js":88434,"./sk":28634,"./sk.js":28634,"./sl":38661,"./sl.js":38661,"./sq":75890,"./sq.js":75890,"./sr":41865,"./sr-cyrl":42155,"./sr-cyrl.js":42155,"./sr.js":41865,"./ss":12220,"./ss.js":12220,"./sv":34292,"./sv.js":34292,"./sw":56803,"./sw.js":56803,"./ta":65669,"./ta.js":65669,"./te":50774,"./te.js":50774,"./tet":28794,"./tet.js":28794,"./tg":50652,"./tg.js":50652,"./th":48819,"./th.js":48819,"./tk":19620,"./tk.js":19620,"./tl-ph":28767,"./tl-ph.js":28767,"./tlh":10812,"./tlh.js":10812,"./tr":23935,"./tr.js":23935,"./tzl":40080,"./tzl.js":40080,"./tzm":96112,"./tzm-latn":99882,"./tzm-latn.js":99882,"./tzm.js":96112,"./ug-cn":68037,"./ug-cn.js":68037,"./uk":8358,"./uk.js":8358,"./ur":73244,"./ur.js":73244,"./uz":4535,"./uz-latn":55334,"./uz-latn.js":55334,"./uz.js":4535,"./vi":45622,"./vi.js":45622,"./x-pseudo":21161,"./x-pseudo.js":21161,"./yo":11517,"./yo.js":11517,"./zh-cn":9902,"./zh-cn.js":9902,"./zh-hk":17658,"./zh-hk.js":17658,"./zh-mo":29702,"./zh-mo.js":29702,"./zh-tw":73465,"./zh-tw.js":73465};function r(e){var t=i(e);return a(t)}function i(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=i,e.exports=r,r.id=46700}}]);
//# sourceMappingURL=331.1d779d9a.chunk.js.map