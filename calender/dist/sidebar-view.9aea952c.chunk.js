"use strict";(self.webpackChunkcarbonio_calendars_ui=self.webpackChunkcarbonio_calendars_ui||[]).push([[421],{41080:(e,t,a)=>{a.d(t,{s:()=>n});var l=a(6017);const n=async()=>{const e=await(0,l.soapFetch)("NoOp",{_jsns:"urn:zimbraMail"});return e?.Fault?{...e.Fault,error:!0}:e}},52382:(e,t,a)=>{a.d(t,{R:()=>y});var l=a(92652),n=a.n(l),r=a(97363),o=a(6017),i=a(51235),s=a(93747),c=a(91750),d=a.n(c),m=a(93046),u=a(82163),p=a(37312),h=a(18671),g=a(23298);const C=d().div.withConfig({displayName:"new-calendar-modal__Square",componentId:"sc-wazbg4-0"})(["width:1.125rem;height:1.125rem;position:relative;top:-0.1875rem;border:0.0625rem solid ",";background:",";border-radius:0.25rem;"],(({theme:e})=>e.palette.gray2.regular),(({color:e})=>e)),b=d()(r.Container).withConfig({displayName:"new-calendar-modal__ColorContainer",componentId:"sc-wazbg4-1"})(["border-bottom:0.0625rem solid ",";"],(({theme:e})=>e.palette.gray2.regular)),f=d()(r.Text).withConfig({displayName:"new-calendar-modal__TextUpperCase",componentId:"sc-wazbg4-2"})(["text-transform:capitalize;"]),E=({selected:e,label:t,open:a,focus:l})=>n().createElement(b,{orientation:"horizontal",width:"fill",crossAlignment:"center",mainAlignment:"space-between",borderRadius:"half",background:"gray5",padding:{all:"small"}},n().createElement(r.Row,{width:"100%",takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(r.Row,{orientation:"vertical",crossAlignment:"flex-start",mainAlignment:"flex-start",padding:{left:"small"}},n().createElement(r.Text,{size:"small",color:a||l?"primary":"secondary"},t),n().createElement(f,null,e?.[0].label)),n().createElement(r.Padding,{right:"small"},n().createElement(C,{color:g.V[Number(e[0].value)].color}))),n().createElement(r.Icon,{size:"large",icon:a?"ChevronUpOutline":"ChevronDownOutline",color:a||l?"primary":"secondary",style:{alignSelf:"center"}})),y=({onClose:e,toggleModal:t,event:a,action:c,folderId:d})=>{const[b]=(0,s.useTranslation)(),[y,v]=(0,l.useState)(""),[_,A]=(0,l.useState)(!1),k=(0,l.useCallback)((()=>A((e=>!e))),[]),w=(0,l.useMemo)((()=>g.V.map(((e,t)=>({background:e.background,label:e.label??"",value:t.toString(),customComponent:n().createElement(r.Container,{width:"100%",mainAlignment:"space-between",orientation:"horizontal",height:"fit"},n().createElement(r.Padding,{left:"small"},n().createElement(f,null,e.label)),n().createElement(r.Padding,{right:"small"},n().createElement(C,{color:e.color})))})))),[]),[R,S]=(0,l.useState)(0),x=(0,r.useSnackbar)(),L=(0,m.f8)(d),M=(0,m.mv)(L?.id??"1"),T=(0,l.useMemo)((()=>(0,i.map)(M,(e=>e.name))),[M]),F=(0,l.useMemo)((()=>(0,i.includes)(T,y)),[y,T]),I=(0,l.useMemo)((()=>y.indexOf("/")>-1||0===y.length||"Calendar"===y||"calendar"===y||F),[y,F]),B=(0,l.useCallback)((()=>{v(""),S(0),A(!1),e()}),[e]),H=(0,l.useMemo)((()=>b("label.type_name_here","Calendar name")),[b]);return n().createElement(r.Container,{padding:{all:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(h.x,{title:b("folder.modal.new.title2","New calendar creation"),onClose:B}),n().createElement(r.Input,{label:H,backgroundColor:"gray5",value:y,onChange:e=>{v(e.target.value)}}),F&&n().createElement(r.Padding,{all:"small"},n().createElement(r.Text,{size:"small",color:"error"},b("folder.modal.new.duplicate_warning","Calendar with the same name already exists"))),n().createElement(r.Padding,{vertical:"medium"}),n().createElement(r.Select,{label:"Select color",onChange:e=>{e&&S(parseInt(e,10))},items:w,defaultSelection:w[0],LabelFactory:E}),n().createElement(r.Padding,{vertical:"medium"}),n().createElement(r.Checkbox,{value:_,onClick:k,label:b("label.exclude_free_busy","Exclude this calendar when reporting the free/busy times")}),n().createElement(p.Z,{onConfirm:()=>{y&&(async({name:e,parent:t,color:a,excludeFreeBusy:l})=>{const n=await(async({name:e,parent:t,color:a,excludeFreeBusy:l})=>(0,o.soapFetch)("CreateFolder",{_jsns:"urn:zimbraMail",folder:{color:a,f:l?"b#":"#",l:t,name:e,view:"appointment"}}))({name:e,parent:t,color:a,excludeFreeBusy:l});return n.folder?n.folder[0]:n})({parent:L?.id??"1",name:y,color:R,excludeFreeBusy:_}).then((t=>{t.Fault?(x({key:"move",replace:!0,type:"error",label:b("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0}),e()):(c&&a&&c({inviteId:a.resource.inviteId,l:t.id,destinationCalendarName:t.name,id:a.resource.id}),x({key:"new",replace:!0,type:"success",label:b("message.snackbar.new_calendar_created","New calendar created"),autoHideTimeout:3e3,hideButton:!0}),e())})),v(""),S(0),A(!1),e()},secondaryAction:t,secondaryLabel:b("folder.modal.footer.go_back","Go back"),label:a&&(0,u.rR)(a.resource.calendar,o.FOLDERS.TRASH)?b("folder.modal.restore.footer","Create and Restore"):b("label.create","Create"),disabled:I}))}},72653:(e,t,a)=>{a.r(t),a.d(t,{default:()=>it});var l=a(92652),n=a.n(l),r=a(99938),o=a(97363),i=a(6017),s=a(51235),c=a(2244),d=a(37255),m=a(56206),u=a(68242),p=a(85492);const h=({item:e})=>{const{name:t,checked:a=!1}=e,r=(0,u.T)(),i=(0,p.Zo)(),s=(0,p.p)(),h=(0,d.t)(),g=(0,l.useMemo)((()=>(0,c.UO)({checked:a,item:e})),[a,e]),C=(0,m.Kd)({color:e.color,rgb:e.rgb})?.color,b=(0,l.useCallback)((()=>{(0,c.ay)({folder:e,checked:a,dispatch:r,start:i,end:s,query:h})}),[a,r,s,e,h,i]);return n().createElement(o.Container,{width:"fill",height:"fit"},n().createElement(o.Row,{mainAlignment:"flex-start",takeAvailableSpace:!0},n().createElement(o.Tooltip,{label:t,placement:"right"},n().createElement(o.Padding,{all:"extrasmall"},n().createElement(o.IconButton,{customSize:{iconSize:"large",paddingSize:"small"},icon:g,iconColor:C,size:"large",onClick:b})))))};var g=a(91750),C=a.n(g),b=a(750),f=a.n(b),E=a(93046),y=a(53955),v=a(21850),_=a(84418),A=a(59379),k=a(52382),w=a(93747),R=a(28081),S=a(4833),x=a(82163);const L=({folder:e,onClose:t})=>{const a=(0,o.useSnackbar)(),[r]=(0,w.useTranslation)(),s=(0,l.useMemo)((()=>r("label.delete","Delete")),[r]);return e?n().createElement(o.Container,{padding:"0.5rem 0.5rem 1.5rem"},n().createElement(S.Z,{title:s,onClose:t}),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(o.Text,{overflow:"break-word"},(0,y.ek)(e)?n().createElement(w.Trans,{i18nKey:"message.you_sure_delete_calendar",defaults:'Are you sure you want to permanently delete the "{{name}}" calendar?',values:{name:e.name}}):n().createElement(w.Trans,{i18nKey:"message.you_sure_move_calendar_trash",defaults:'Are you sure you want to  delete the "{{name}}" calendar?',values:{name:e.name}}))),n().createElement(R.Z,{onConfirm:()=>{t(),(0,_.f)({id:e.id,op:(0,y.ek)(e)?v.w4.DELETE:v.w4.TRASH}).then((t=>{t.Fault?a({key:"send",replace:!0,type:"error",label:r("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0}):a({key:"send",replace:!0,type:"info",label:(0,y.ek)(e)?r("message.snackbar.calendar_permanently_deleted","Calendar permanently deleted"):r("message.snackbar.calendar_moved_to_trash","Calendar moved to trash"),autoHideTimeout:5e3,hideButton:!e||(0,x.rR)(e,i.FOLDERS.USER_ROOT),actionLabel:r("label.undo","Undo"),onActionClick:()=>{(0,_.f)({id:e.id,op:v.w4.MOVE,l:e.l}).then((e=>{e.Fault?a({key:"send",replace:!0,type:"error",label:r("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0}):a({key:"send",replace:!0,type:"success",label:r("message.snackbar.calendar_restored","Calendar restored successfully"),autoHideTimeout:3e3,hideButton:!0})}))}})}))},label:r("label.delete","Delete"),color:"error"})):null},M=n().createContext(null),T=()=>{const e=(0,l.useContext)(M);if(!e)throw new Error("useEditModalContext has to be used within <EditModalContext.Provider>");return e};var F=a(50364);const I=({grant:e})=>{const[t]=(0,w.useTranslation)(),{roleOptions:a}=T(),r=(0,l.useMemo)((()=>(0,s.find)(a,["value",e?.perm??""])),[a,e]),i=(0,l.useMemo)((()=>{const a=e.gt===F.Lv.PUBLIC?t("public","public"):"";return`${e.d??e.zid??a} - ${r?.label}`}),[e.d,e.gt,e.zid,r,t]);return n().createElement(o.Chip,{label:i,maxWidth:"fill"})};var B=a(37312),H=a(18671),D=a(75556),N=a(85583);const O=(0,N.createAsyncThunk)("calendar/sendShareCalendarNotification",(async e=>Promise.all((0,s.map)(e.contacts,(t=>fetch("/service/soap/SendShareNotificationRequest",{method:"POST",headers:{"content-type":"application/soap+xml"},body:`<?xml version="1.0" encoding="utf-8"?>\n                <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope">\n                    <soap:Header>\n                        <context xmlns="urn:zimbra">\n                            <account by="name">${e.accounts[0].name}</account>\n                            <format type="js"/>\n                        </context>\n                    </soap:Header>\n                    <soap:Body>\n                    <SendShareNotificationRequest xmlns="urn:zimbraMail">\n                           <item id="${e.folder}"/>\n                           <e a="${t.email}"/>\n                           ${e?.standardMessage?.length>0?`<notes>${e.standardMessage}</notes>`:""}\n                    </SendShareNotificationRequest>\t\t\t\t\n                    </soap:Body>\n                </soap:Envelope>\n            `}).then((e=>e.json()))))))),z=({folder:e,grant:t,onGoBack:a})=>{const[r]=(0,w.useTranslation)(),[s,c]=(0,l.useState)(!1),[d,m]=(0,l.useState)(""),{onClose:p,roleOptions:h}=T(),g=(0,i.useUserAccounts)(),C=(0,u.T)(),b=(0,o.useSnackbar)(),[f,E]=(0,l.useState)(""),[y,A]=(0,l.useState)(!1),k=(0,l.useCallback)((e=>{E(e)}),[]),R=(0,l.useMemo)((()=>r("label.edit_access","Edit access")),[r]);return n().createElement(o.Container,{"data-testid":"EditPermissionModal",padding:"0.5rem 0.5rem 1.5rem"},n().createElement(H.x,{title:R,onClose:p}),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(I,{grant:t})),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(o.Checkbox,{value:y,defaultChecked:y,onClick:()=>A((e=>!e)),label:r("share.label.allow_to_see_private_appt","Allow user(s) to see my private appointments")})),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(o.Select,{items:h,background:"gray5",label:r("label.role","Role"),onChange:k,disablePortal:!0,defaultSelection:{value:t.perm,label:(0,D.lH)(h,t.perm)}})),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(o.Checkbox,{value:s,defaultChecked:s,onClick:()=>c(!s),label:r("share.label.send_notification","Send notification about this share")})),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(o.Input,{label:r("share.placeholder.standard_message","Add a note to standard message"),value:d,onChange:e=>{m(e.target.value)},backgroundColor:"gray5",disabled:!s})),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit",orientation:"horizontal"},n().createElement(o.Row,{padding:{right:"small"}},n().createElement(o.Text,{weight:"bold",size:"small"},"Note:")),n().createElement(o.Row,null,n().createElement(o.Text,{overflow:"break-word",size:"small",color:"secondary"},r("share.note.share_note","The standard message displays your name, the name of the shared item, pemissions granted to the recipients, and sign in information.")))),n().createElement(B.Z,{onConfirm:()=>{const l=[{gt:F.Lv.USER,inh:"1",d:t.d||t.zid,perm:`${f}${y?"p":""}`,pw:""}];(0,_.f)({id:e.id,op:v.w4.GRANT,grant:l}).then((a=>{a?.Fault||(b({key:"folder-action-success",replace:!0,type:"success",hideButton:!0,label:r("label.calendar_shared","Calendar shared successfully"),autoHideTimeout:3e3}),s&&C(O({sendNotification:s,standardMessage:d,contacts:[{email:t.d||t.zid}],shareWithUserRole:f,folder:e.id,accounts:g})).then((e=>{e.type.includes("fulfilled")||b({key:"folder-action-failed",replace:!0,type:"error",hideButton:!0,label:r("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3})})))})),a()},secondaryAction:a,secondaryLabel:r("folder.modal.footer.go_back","Go back"),label:r("label.edit_share","Edit share")}))};var P=a(966),Z=a(23298);const V=C().div.withConfig({displayName:"main-edit-modal__Square",componentId:"sc-zlzyp3-0"})(["width:1.125rem;height:1.125rem;position:relative;top:-0.1875rem;border:0.0625rem solid ",";background:",";border-radius:0.25rem;"],(({theme:e})=>e.palette.gray2.regular),(({color:e})=>e)),$=C()(o.Container).withConfig({displayName:"main-edit-modal__ColorContainer",componentId:"sc-zlzyp3-1"})(["border-bottom:0.0625rem solid ",";"],(({theme:e})=>e.palette.gray2.regular)),U=C()(o.Container).withConfig({displayName:"main-edit-modal__StyledContainer",componentId:"sc-zlzyp3-2"})(["min-width:0;flex-basis:0;flex-grow:1;"]),W=C()(o.Text).withConfig({displayName:"main-edit-modal__TextUpperCase",componentId:"sc-zlzyp3-3"})(["text-transform:capitalize;"]),G=({selected:e,label:t,open:a,focus:r})=>{const i=(0,l.useMemo)((()=>e?.[0]?.label),[e]),s=(0,l.useMemo)((()=>("custom"===i?e?.[0]?.value:Z.V[parseInt(e[0].value,10)]?.color)||""),[i,e]);return n().createElement($,{orientation:"horizontal",width:"fill",crossAlignment:"center",mainAlignment:"space-between",borderRadius:"half",background:"gray5",padding:{all:"small"}},n().createElement(o.Row,{width:"100%",takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Row,{orientation:"vertical",crossAlignment:"flex-start",mainAlignment:"flex-start",padding:{left:"small"}},n().createElement(o.Text,{size:"small",color:a||r?"primary":"secondary"},t),n().createElement(W,null,i)),n().createElement(o.Padding,{right:"small"},n().createElement(V,{color:s??"0"}))),n().createElement(o.Icon,{size:"large",icon:a?"ChevronUpOutline":"ChevronDownOutline",color:a||r?"primary":"secondary",style:{alignSelf:"center"}}))},K=({folder:e,totalAppointments:t,grant:a})=>{const r=(0,E.tc)(),[c]=(0,w.useTranslation)(),d=(0,i.useUserAccounts)(),p=(0,o.useSnackbar)(),h=(0,u.T)(),{setModal:g,onClose:C,setActiveGrant:b}=T(),f=(0,l.useMemo)((()=>(e=>Z.V.map(((t,a)=>({label:e(t.label??""),value:a.toString(),customComponent:n().createElement(o.Container,{width:"100%",mainAlignment:"space-between",orientation:"horizontal",height:"fit"},n().createElement(o.Padding,{left:"small"},n().createElement(W,null,e(t.label??""))),n().createElement(V,{color:t.color}))}))))(c)),[c]),y=/b/.test(e.f??""),A=e.name||"",k=(0,l.useMemo)((()=>(0,s.find)(f,{label:(0,m.Kd)({color:e.color,rgb:e.rgb}).label})??{label:"",value:""}),[f,e?.color,e?.rgb]),[R,S]=(0,l.useState)(A),[L,M]=(0,l.useState)(y),B=(0,l.useCallback)((()=>M((e=>!e))),[]),H=(0,l.useCallback)((e=>e.view!==P.X1.appointment&&parseInt(e.id,10)>16),[]),D=(0,l.useMemo)((()=>(0,s.map)(r,(e=>e.name===A||H(e)?null:e.name))),[r,A,H]),N=(0,l.useMemo)((()=>(0,s.includes)(D,R)),[R,D]),z=(0,l.useMemo)((()=>!(0,x.rR)(e,i.FOLDERS.CALENDAR)&&(R.indexOf("/")>-1||0===R.length||"calendar"===R.toLowerCase()||N)),[R,e,N]),[$,K]=(0,l.useState)(k),q=(0,l.useCallback)((e=>{const t=(0,s.find)(f,{label:(0,m.Kd)({color:e}).label});t&&K(t)}),[f]),j=(0,l.useCallback)((()=>{const t=R?.length&&R!==A?{op:v.w4.RENAME,name:R,id:e.id}:void 0,a=$&&$?.value!==k?.value?{op:v.w4.COLOR,color:$.value,id:e.id}:void 0,l=L!==y?{op:v.w4.FREE_BUSY,excludeFreeBusy:!y,id:e.id}:void 0,n=(0,s.compact)([t,a,l]);if(n.length){const e=n.length>1?n:n[0];(0,_.f)(e).then((e=>{e.Fault?p({key:"folder-action-success",replace:!0,type:"error",hideButton:!0,label:c("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3}):p({key:"folder-action-success",replace:!0,type:"success",hideButton:!0,label:c("label.changes_saved","Changes saved"),autoHideTimeout:3e3}),C()}))}else C()}),[R,A,e.id,$,k?.value,L,y,C,p,c]),X=(0,l.useCallback)((()=>{g&&g("share")}),[g]),Y=(0,l.useCallback)((e=>{b&&b(e),g("revoke")}),[b,g]),J=(0,l.useCallback)((t=>{h(O({contacts:[{email:t.d}],folder:e.id,accounts:d})).then((e=>{e.type.includes("fulfilled")?p({key:"folder-action-success",replace:!0,type:"info",hideButton:!0,label:c("share_invite_resent","Share invite resent"),autoHideTimeout:3e3}):p({key:"folder-action-success",replace:!0,type:"error",hideButton:!0,label:c("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3})}))}),[d,p,h,e,c]),Q=(0,l.useCallback)((e=>{b&&b(e),g("edit")}),[g,b]),ee=(0,l.useMemo)((()=>c("action.edit_calendar_properties","Edit calendar properties")),[c]),te=(0,l.useMemo)((()=>c("label.type_name_here","Calendar name")),[c]);return n().createElement(o.Container,{"data-testid":"MainEditModal",padding:"0.5rem 0.5rem 1.5rem",style:{overflowY:"auto"}},n().createElement(o.ModalHeader,{onClose:C,title:ee,showCloseIcon:!0}),n().createElement(o.Divider,null),n().createElement(o.ModalBody,{style:{padding:"0.5rem"}},n().createElement(o.Container,{mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},(0,x.rR)(e,i.FOLDERS.CALENDAR)?n().createElement(o.Tooltip,{label:c("cannot_edit_name","You cannot edit the name of a system calendar"),placement:"top",maxWidth:"fit"},n().createElement(o.Input,{label:te,backgroundColor:"gray5",defaultValue:R,onChange:e=>{S(e.target.value)},disabled:!0})):n().createElement(o.Input,{label:te,backgroundColor:"gray5",defaultValue:R,onChange:e=>{S(e.target.value)}})),N&&n().createElement(o.Padding,{all:"small"},n().createElement(o.Text,{size:"small",color:"error"},c("folder.modal.new.duplicate_warning","Calendar with the same name already exists"))),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",orientation:"horizontal",height:"fit"},n().createElement(o.Row,{orientation:"vertical",width:"50%",crossAlignment:"flex-start"},n().createElement(o.Text,{size:"small",color:"secondary"},c("type","Type")),n().createElement(o.Text,null,c("label.calendar","Calendar"))),n().createElement(o.Row,{orientation:"vertical",width:"50%",crossAlignment:"flex-start"},n().createElement(o.Text,{size:"small",color:"secondary"},c("appointments","Appointments")),n().createElement(o.Text,null,t))),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",orientation:"horizontal",height:"fit"},n().createElement(o.Select,{label:c("label.calendar_color","Calendar color"),onChange:q,items:f,defaultSelection:$,LabelFactory:G})),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"flex-start",crossAlignment:"flex-start",orientation:"horizontal",height:"fit"},n().createElement(o.Checkbox,{value:L,defaultChecked:y,onClick:B,label:c("label.exclude_free_busy","Exclude this calendar when reporting the free/busy times")})),!(0,s.isEmpty)(e?.acl)&&!(e.isLink&&e.owner)&&n().createElement(n().Fragment,null,n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",orientation:"horizontal"},n().createElement(o.Divider,null)),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"flex-start",crossAlignment:"flex-start",orientation:"horizontal"},n().createElement(o.Text,{weight:"bold"},c("label.sharing_of_this_folder","Sharing of this folder"))),n().createElement(n().Fragment,null,a&&a.length>0&&n().createElement(o.Container,{style:{overflowY:"auto"},mainAlignment:"flex-start",minHeight:1===a.length?"2rem":"4rem",maxHeight:"4rem",padding:{right:"small"}},(0,s.map)(a,((e,t)=>n().createElement(o.Container,{orientation:"horizontal",mainAlignment:"flex-end",padding:{bottom:"small"},key:t},n().createElement(U,{crossAlignment:"flex-start"},n().createElement(I,{grant:e})),n().createElement(o.Container,{orientation:"horizontal",mainAlignment:"flex-end",width:"fit"},e.gt!==F.Lv.PUBLIC&&n().createElement(n().Fragment,null,n().createElement(o.Tooltip,{label:c("tooltip.edit","Edit share properties"),placement:"top"},n().createElement(o.Button,{type:"outlined",label:c("label.edit","Edit"),onClick:()=>{Q(e)},size:"small"})),n().createElement(o.Padding,{horizontal:"extrasmall"})),n().createElement(o.Tooltip,{label:c("revoke_access","Revoke access"),placement:"top"},n().createElement(o.Button,{type:"outlined",label:c("label.revoke","Revoke"),color:"error",onClick:()=>{Y(e)},size:"small"})),e.gt!==F.Lv.PUBLIC&&n().createElement(n().Fragment,null,n().createElement(o.Padding,{horizontal:"extrasmall"}),n().createElement(o.Tooltip,{label:c("tooltip.resend","Send mail notification about this share"),placement:"top",maxWidth:"18.75rem"},n().createElement(o.Button,{type:"outlined",label:c("label.resend","Resend"),onClick:()=>{J(e)},size:"small"}))))))))))),n().createElement(o.Divider,null),n().createElement(o.ModalFooter,{onConfirm:j,confirmLabel:c("label.ok","OK"),confirmDisabled:z,onSecondaryAction:X,secondaryActionLabel:c("label.add_share","Add share")}))},q=({folder:e,grant:t,onGoBack:a})=>{const[r]=(0,w.useTranslation)(),[s,c]=(0,l.useState)(!1),[d,m]=(0,l.useState)(""),{onClose:p}=T(),h=(0,i.useUserAccounts)(),g=(0,u.T)(),C=(0,o.useSnackbar)(),b=(0,l.useMemo)((()=>s&&""!==d?r("revoke_with_custom_message","Revoke access sending a custom notification"):s&&""===d?r("revoke_without_custom_message","Revoke access sending a standard notification"):r("revoke_without_notification","Revoke access without sending a notification")),[s,d,r]),f=(0,l.useCallback)((()=>{(0,_.f)({id:e.id,zid:t.gt===F.Lv.PUBLIC?F.cp:t.zid,op:v.w4.REVOKE_GRANT}).then((l=>{l.Fault?C({key:"folder-action-success",replace:!0,type:"error",hideButton:!0,label:r("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3}):(s&&g(O({sendNotification:s,standardMessage:d,contacts:[{email:t.d}],folder:e.id,accounts:h})),C({key:"folder-action-success",replace:!0,type:"info",hideButton:!0,label:r("label.access_revoked","Access revoked"),autoHideTimeout:3e3})),a()}))}),[h,C,g,e.id,t.d,t.gt,t.zid,a,s,d,r]);return n().createElement(o.Container,{"data-testid":"RevokeModal",padding:"0.5rem 0.5rem 1.5rem"},n().createElement(H.x,{title:r("label.revoke_share",{title:e.name,defaultValue:"Revoke share of {{title}}"}),onClose:p}),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(I,{grant:t})),t.gt!==F.Lv.PUBLIC&&n().createElement(n().Fragment,null,n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(o.Checkbox,{iconSize:"medium",value:s,defaultChecked:s,onClick:()=>c(!s),label:r("share.label.send_notification","Send notification about this share")})),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(o.Input,{label:r("share.placeholder.standard_message","Add a note to standard message"),value:d,onChange:e=>{m(e.target.value)},disabled:!s,backgroundColor:"gray5"})),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit",orientation:"horizontal"},n().createElement(o.Row,{padding:{right:"small"}},n().createElement(o.Text,{weight:"bold",size:"small"},"Note:")),n().createElement(o.Row,null,n().createElement(o.Text,{overflow:"break-word",size:"small",color:"secondary"},r("share.note.share_note","The standard message displays your name, the name of the shared item, pemissions granted to the recipients, and sign in information."))))),n().createElement(B.Z,{color:"error",onConfirm:f,secondaryAction:a,secondaryLabel:r("folder.modal.footer.go_back","Go back"),label:r("label.revoke","Revoke"),tooltip:b}))};var j=a(91666);const X=({allowToSeePrvtAppt:e,setAllowToSeePrvtAppt:t})=>{const[a]=(0,w.useTranslation)(),r=(0,l.useMemo)((()=>a("private_info_tooltip","When sharing a calendar, other users can see your appointment details (title, description, and attendees) except for the ones marked as private. In this case, other users will see your free/busy time but not the appointment details. Would you like other users to display also your private appointments' detail?")),[a]);return n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"flex-start",crossAlignment:"center",height:"fit","data-testid":"privateCheckboxContainer",orientation:"horizontal"},n().createElement(o.Checkbox,{value:e,defaultChecked:e,onClick:()=>t((e=>!e)),label:a("share.label.allow_to_see_private_appt","Allow user(s) to see private appointments’ detail")}),n().createElement(o.Tooltip,{label:r},n().createElement(o.Padding,{left:"small"},n().createElement(o.Icon,{icon:"InfoOutline"}))))},Y=({shareWithUserType:e,grant:t,folderId:a,onGoBack:r,secondaryLabel:c,closeFn:d})=>{const m=(0,i.useUserAccounts)(),[p]=(0,w.useTranslation)(),h=(0,u.T)(),g=(0,o.useSnackbar)(),[C,b]=(0,i.useIntegratedComponent)("contact-input"),[f,E]=(0,l.useState)("r"),[y,A]=(0,l.useState)(!0),[k,S]=(0,l.useState)(""),[x,L]=(0,l.useState)([]),[M,T]=(0,l.useState)(!1),I=(0,l.useMemo)((()=>!x.length||(0,s.some)(x,"error")),[x]),B=(0,l.useMemo)((()=>(0,D.eY)(t?.[0]?.perm?.includes("p"))),[t]),H=(0,l.useCallback)((e=>{L(e)}),[L]),N=(0,l.useCallback)((e=>{E(e)}),[E]),z=(0,l.useCallback)((()=>{const t=(0,s.map)(x,(e=>({gt:F.Lv.USER,inh:"1",d:e.email,perm:`${f}${M?"p":""}`,pw:""})));(0,_.f)({id:a,op:v.w4.GRANT,grant:t}).then((t=>{t.Fault||(g({key:"folder-action-success",replace:!0,type:"success",hideButton:!0,label:p("snackbar.share_folder_success","Calendar shared successfully"),autoHideTimeout:3e3}),y&&h(O({sendNotification:y,standardMessage:k,contacts:x,shareWithUserType:e,shareWithUserRole:f,folder:a,accounts:m})).then((e=>{e.type.includes("fulfilled")||g({key:"folder-action-failed",replace:!0,type:"error",hideButton:!0,label:p("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3})})))})),d&&d()}),[m,M,d,x,g,h,a,y,f,e,k,p]);return n().createElement(n().Fragment,null,n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},b?n().createElement(C,{placeholder:p("share.placeholder.recipients_address","Recipients e-mail addresses"),onChange:H,background:"gray5",defaultValue:x}):n().createElement(o.ChipInput,{placeholder:p("share.placeholder.recipients_address","Recipients e-mail addresses"),hasError:!0,background:"gray4",onChange:e=>{L((0,s.map)(e,(e=>({email:e.address}))))}})),n().createElement(X,{allowToSeePrvtAppt:M,setAllowToSeePrvtAppt:T}),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(o.Select,{items:B,background:"gray5",label:p("label.role","Role"),onChange:N,disablePortal:!0,dropdownWidth:"auto",dropdownMaxWidth:"unset",placement:"bottom-start",defaultSelection:{value:"r",label:(0,D.lH)(B,"r")}})),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit","data-testid":"sendNotificationCheckboxContainer"},n().createElement(o.Checkbox,{value:y,defaultChecked:y,onClick:()=>A(!y),label:p("share.label.send_notification","Send notification about this share")})),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(o.Input,{label:p("share.placeholder.standard_message","Add a note to standard message"),value:k,onChange:e=>{S(e.target.value)},disabled:!y})),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit",orientation:"horizontal"},n().createElement(o.Row,{padding:{right:"small"}},n().createElement(o.Text,{weight:"bold",size:"small"},"Note:")),n().createElement(o.Row,null,n().createElement(o.Text,{overflow:"break-word",size:"small",color:"secondary"},p("share.note.share_note","The standard message displays your name, the name of the shared item, permissions granted to the recipients, and sign in information.")))),n().createElement(R.Z,{onConfirm:z,label:p("action.share_calendar","Share Calendar"),disabled:I,secondaryAction:r,secondaryLabel:c}))},J=({onGoBack:e,secondaryLabel:t,folderId:a,closeFn:r})=>{const i=(0,o.useSnackbar)(),[s]=(0,w.useTranslation)(),c=(0,l.useCallback)((()=>{const e={gt:F.Lv.PUBLIC,inh:"1",perm:"r",pw:""};(0,_.f)({id:a,op:v.w4.GRANT,grant:e}).then((e=>{e.Fault||i({key:"folder-action-success",replace:!0,type:"success",hideButton:!0,label:s("snackbar.share_folder_success","Calendar shared successfully"),autoHideTimeout:3e3})})),r&&r()}),[r,i,a,s]);return n().createElement(R.Z,{onConfirm:c,label:s("action.share_calendar","Share Calendar"),secondaryAction:e,secondaryLabel:t})},Q=({folderName:e,folderId:t,closeFn:a,onGoBack:r,secondaryLabel:i,grant:s})=>{const[c]=(0,w.useTranslation)(),d=(0,l.useMemo)((()=>(0,D.Zy)()),[]),[m,u]=(0,l.useState)(F.Lv.USER),p=(0,l.useMemo)((()=>`${c("label.share","Share")} ${e}`),[e,c]),h=(0,l.useCallback)((e=>{u(e)}),[]);return n().createElement(o.Container,{"data-testid":"ShareCalendarModal",padding:"0.5rem 0.5rem 1.5rem",style:{overflowY:"auto"}},n().createElement(S.Z,{onClose:a,title:p}),n().createElement(o.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(o.Select,{items:d,background:"gray5",label:c("label.share_with","Share with"),disablePortal:!0,onChange:h,defaultSelection:{value:F.Lv.USER,label:(0,D.lH)(d,F.Lv.USER)}})),m===F.Lv.USER?n().createElement(Y,{shareWithUserType:m,grant:s,folderId:t,onGoBack:r,secondaryLabel:i,closeFn:a}):n().createElement(J,{onGoBack:r,secondaryLabel:i,folderId:t,closeFn:a}))},ee=({onClose:e,folderId:t})=>{const[a,r]=(0,l.useState)({}),[o,i]=(0,l.useState)("main"),[s]=(0,w.useTranslation)(),c=(0,E.WR)(t),d=c?.acl?.grant,m=(0,l.useMemo)((()=>(({t:e,canViewPrivateAppointment:t})=>[{label:e("share.options.share_calendar_role.none","None"),value:""},{label:e("share.options.share_calendar_role.viewer","Viewer"),value:t?"rp":"r"},{label:e("share.options.share_calendar_role.admin","Admin"),value:t?"rwidxap":"rwidxa"},{label:e("share.options.share_calendar_role.manager","Manager"),value:t?"rwidxp":"rwidx"}])({t:s,canViewPrivateAppointment:d?.[0]?.perm?.includes("p")??!1})),[d,s]),u=(0,l.useCallback)((()=>{i("main")}),[i]);return(0,l.useEffect)((()=>{const e=(0,E.vR)();(0,j.J)({id:t}).then((a=>{a?.[0]?.acl?.grant&&e(t,{acl:{grant:a?.[0]?.acl?.grant}})}))}),[t]),n().createElement(n().Fragment,null,n().createElement(M.Provider,{value:{setModal:i,onClose:e,roleOptions:m,setActiveGrant:r}},"main"===o&&c&&n().createElement(K,{folder:c,totalAppointments:c?.n??0,grant:d??[]}),"share"===o&&c&&n().createElement(Q,{folderName:c.name,folderId:t,closeFn:e,onGoBack:u,secondaryLabel:s("folder.modal.footer.go_back","Go back"),grant:d})||"revoke"===o&&c&&n().createElement(q,{folder:c,grant:Object.keys(a).length>0?a:c?.acl?.grant[0],onGoBack:u}),"edit"===o&&c&&n().createElement(z,{folder:c,grant:Object.keys(a).length>0?a:c?.acl?.grant[0],onGoBack:u})))},te=({type:e,isHovered:t})=>"ics"===e?n().createElement("svg",{width:"100",height:"100",viewBox:"0 0 63 70",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n().createElement("path",{d:"M26.7432 41.8235H29.92V52.0824H26.7432V41.8235ZM39.0253 47.8905L41.8032 48.7312C41.6169 49.5099 41.3231 50.1596 40.9218 50.6827C40.5206 51.2058 40.0213 51.5999 39.4266 51.865C38.8318 52.1325 38.0746 52.2639 37.1574 52.2639C36.042 52.2639 35.1295 52.1015 34.4249 51.7791C33.7179 51.4542 33.1064 50.8833 32.5929 50.0665C32.0817 49.2496 31.8237 48.2057 31.8237 46.9326C31.8237 45.2343 32.2752 43.9278 33.1781 43.0178C34.0809 42.1053 35.3588 41.6491 37.0093 41.6491C38.3015 41.6491 39.3167 41.9095 40.0571 42.4325C40.7976 42.9557 41.347 43.7582 41.7053 44.8402L38.9058 45.4636C38.8079 45.1507 38.7052 44.9214 38.5977 44.7757C38.421 44.5345 38.2036 44.3482 37.9481 44.2168C37.6901 44.0855 37.4034 44.0209 37.0857 44.0209C36.3692 44.0209 35.8174 44.31 35.4352 44.888C35.1462 45.3179 35.0005 45.9915 35.0005 46.9111C35.0005 48.0505 35.1749 48.8292 35.5189 49.252C35.8652 49.6747 36.3501 49.8849 36.9735 49.8849C37.5802 49.8849 38.0388 49.7153 38.3493 49.3738C38.6598 49.0346 38.8844 48.5402 39.0253 47.8905L39.0253 47.8905ZM42.7897 48.6882L45.8065 48.4995C45.871 48.9892 46.0047 49.3618 46.2054 49.6198C46.5302 50.0354 46.9984 50.2408 47.6051 50.2408C48.0565 50.2408 48.4052 50.1357 48.6513 49.9231C48.8949 49.7105 49.0167 49.4645 49.0167 49.185C49.0167 48.9199 48.9021 48.681 48.668 48.4709C48.4339 48.2607 47.8941 48.0624 47.0437 47.8761C45.6536 47.5632 44.6623 47.15 44.07 46.6317C43.4728 46.1133 43.1743 45.4541 43.1743 44.6515C43.1743 44.1237 43.3271 43.6244 43.6329 43.1563C43.9386 42.6881 44.3972 42.3203 45.0111 42.0504C45.6249 41.7828 46.4657 41.6491 47.5334 41.6491C48.8447 41.6491 49.8455 41.8927 50.5334 42.38C51.2214 42.8673 51.6298 43.6436 51.7612 44.7065L48.7731 44.8809C48.6942 44.4198 48.5271 44.0831 48.2715 43.8729C48.0183 43.6651 47.6672 43.56 47.2205 43.56C46.8502 43.56 46.5732 43.6364 46.3869 43.794C46.2006 43.9493 46.1074 44.1404 46.1074 44.3649C46.1074 44.5273 46.1839 44.673 46.3367 44.8044C46.4872 44.9406 46.8407 45.0648 47.402 45.1818C48.7874 45.4804 49.7787 45.7837 50.3782 46.0894C50.9777 46.3952 51.4148 46.7726 51.6871 47.2264C51.9595 47.6779 52.098 48.1842 52.098 48.7456C52.098 49.4024 51.9141 50.0091 51.551 50.5633C51.1879 51.1198 50.6791 51.5402 50.0247 51.8268C49.3726 52.1135 48.5485 52.2568 47.5549 52.2568C45.8112 52.2568 44.6026 51.9224 43.9314 51.2488C43.2579 50.5776 42.878 49.7249 42.7897 48.6882L42.7897 48.6882Z",fill:t?"#2B73D2":"#AAC8EE"}),n().createElement("path",{d:"M22.6371 36.3885H55.029C57.026 36.3885 58.8404 37.2045 60.155 38.5191C61.4696 39.8337 62.2856 41.6482 62.2856 43.6451V50.2676C62.2856 52.2645 61.4696 54.079 60.155 55.3936C58.8404 56.7082 57.026 57.5242 55.029 57.5242H22.6371C20.6401 57.5242 18.8257 56.7082 17.5111 55.3936C16.1965 54.079 15.3805 52.2645 15.3805 50.2676V43.6451C15.3805 41.6482 16.1965 39.8337 17.5111 38.5191C18.8257 37.2045 20.6401 36.3885 22.6371 36.3885ZM55.029 39.051H22.6371C21.3751 39.051 20.2268 39.5683 19.3935 40.4016C18.5603 41.2348 18.043 42.3832 18.043 43.6451V50.2676C18.043 51.5296 18.5603 52.6779 19.3935 53.5111C20.2268 54.3444 21.3751 54.8617 22.6371 54.8617H55.029C56.291 54.8617 57.4393 54.3444 58.2725 53.5111C59.1058 52.6779 59.6231 51.5296 59.6231 50.2676V43.6451C59.6231 42.3832 59.1058 41.2348 58.2725 40.4016C57.4393 39.5683 56.291 39.051 55.029 39.051Z",fill:t?"#2B73D2":"#AAC8EE"}),n().createElement("path",{d:"M49.1578 56.1922V59.3379C49.1578 61.1788 48.4056 62.8515 47.1939 64.0632C45.9821 65.2749 44.3094 66.0272 42.4686 66.0272H11.057C9.21618 66.0272 7.54353 65.275 6.3318 64.0632C5.12007 62.8515 4.36786 61.1788 4.36786 59.3379V10.886C4.36786 9.04519 5.12006 7.37249 6.3318 6.16072C7.54353 4.94899 9.21618 4.19678 11.057 4.19678H42.4686C44.3095 4.19678 45.9821 4.94898 47.1939 6.16072C48.4056 7.37249 49.1578 9.04519 49.1578 10.886V37.719H46.4953V10.886C46.4953 9.7801 46.0418 8.77365 45.3114 8.0432C44.581 7.31278 43.5745 6.85933 42.4686 6.85933H11.057C9.95114 6.85933 8.94468 7.31278 8.21428 8.0432C7.48382 8.77365 7.03041 9.7801 7.03041 10.886V59.3379C7.03041 60.4438 7.48382 61.4503 8.21428 62.1807C8.94469 62.9112 9.95114 63.3646 11.057 63.3646H42.4686C43.5745 63.3646 44.5809 62.9112 45.3114 62.1807C46.0418 61.4503 46.4953 60.4438 46.4953 59.3379V56.1922H49.1578Z",fill:t?"#2B73D2":"#AAC8EE"}),n().createElement("path",{d:"M49.1578 56.1922V59.3379C49.1578 61.1788 48.4056 62.8515 47.1939 64.0632C45.9821 65.2749 44.3094 66.0272 42.4686 66.0272H11.057C9.21618 66.0272 7.54353 65.275 6.3318 64.0632C5.12007 62.8515 4.36786 61.1788 4.36786 59.3379V10.886C4.36786 9.04519 5.12006 7.37249 6.3318 6.16072C7.54353 4.94899 9.21618 4.19678 11.057 4.19678H42.4686C44.3095 4.19678 45.9821 4.94898 47.1939 6.16072C48.4056 7.37249 49.1578 9.04519 49.1578 10.886V37.719H46.4953V10.886C46.4953 9.7801 46.0418 8.77365 45.3114 8.0432C44.581 7.31278 43.5745 6.85933 42.4686 6.85933H11.057C9.95114 6.85933 8.94468 7.31278 8.21428 8.0432C7.48382 8.77365 7.03041 9.7801 7.03041 10.886V59.3379C7.03041 60.4438 7.48382 61.4503 8.21428 62.1807C8.94469 62.9112 9.95114 63.3646 11.057 63.3646H42.4686C43.5745 63.3646 44.5809 62.9112 45.3114 62.1807C46.0418 61.4503 46.4953 60.4438 46.4953 59.3379V56.1922H49.1578Z",fill:t?"#2B73D2":"#AAC8EE"}),n().createElement("path",{d:"M14.4115 12.6282C13.6763 12.6282 13.0803 13.2243 13.0803 13.9595C13.0803 14.6947 13.6763 15.2908 14.4115 15.2908H39.1141C39.8493 15.2908 40.4454 14.6947 40.4454 13.9595C40.4454 13.2243 39.8493 12.6282 39.1141 12.6282H14.4115Z",fill:t?"#2B73D2":"#AAC8EE"}),n().createElement("path",{d:"M43.3096 65.3133C39.2159 72.1233 34.4424 70.1874 28.3963 67.7353C26.9419 67.1454 25.4054 66.5222 23.8523 66.0248L24.6636 63.4974C26.3757 64.0458 27.9267 64.6749 29.3948 65.2703C34.2667 67.2462 38.1131 68.8062 41.0319 63.9509L43.3097 65.3133H43.3096ZM5.8035 62.5388L5.4664 62.4735C3.65669 62.1228 2.15664 61.0663 1.19802 59.6468C0.239835 58.2281 -0.179993 56.4447 0.169864 54.6392L4.37544 32.9355L6.98601 33.4347L2.78044 55.1385C2.5697 56.226 2.82381 57.3021 3.40292 58.1595C3.98147 59.0162 4.88235 59.653 5.96563 59.8629L6.30273 59.9282L5.8035 62.5388ZM10.3149 4.75417C14.7107 -2.11757 19.0595 -0.242739 25.0719 2.34922C26.5124 2.97022 28.0609 3.63783 29.7252 4.21003L28.862 6.72696C27.1067 6.12348 25.5084 5.43438 24.0215 4.79339C19.2074 2.71798 15.7253 1.21689 12.551 6.17909L10.3149 4.75417H10.3149ZM48.0593 7.75111C49.869 8.10175 51.369 9.15826 52.3276 10.5778C53.2857 11.9965 53.7056 13.7799 53.3558 15.5854L49.1317 37.3848L46.5211 36.8855L50.7452 15.0861C50.9559 13.9986 50.7018 12.9225 50.1227 12.065C49.5442 11.2084 48.6433 10.5716 47.56 10.3617L48.0593 7.75111Z",fill:t?"#2B73D2":"#AAC8EE"}),n().createElement("path",{d:"M14.4115 20.1776C13.6763 20.1776 13.0803 20.7736 13.0803 21.5088C13.0803 22.244 13.6763 22.8401 14.4115 22.8401H39.1141C39.8493 22.8401 40.4454 22.244 40.4454 21.5088C40.4454 20.7736 39.8493 20.1776 39.1141 20.1776H14.4115Z",fill:t?"#2B73D2":"#AAC8EE"}),n().createElement("path",{d:"M14.4115 27.7261C13.6763 27.7261 13.0803 28.3221 13.0803 29.0574C13.0803 29.7926 13.6763 30.3886 14.4115 30.3886H39.1141C39.8493 30.3886 40.4454 29.7926 40.4454 29.0574C40.4454 28.3221 39.8493 27.7261 39.1141 27.7261H14.4115Z",fill:t?"#2B73D2":"#AAC8EE"})):"html"===e?n().createElement("svg",{width:"100",height:"100",viewBox:"0 0 71 70",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n().createElement("path",{d:"M11.4375 4.5859e-05C7.79167 -0.00943331 6.33333 1.44905 6.33333 5.83338C1.95833 5.8239 0.5 7.28238 0.5 10.9375V64.8731C0.5 67.6782 2.8 70 5.60417 70H59.5625C62.3667 70 64.6667 67.6782 64.6667 64.8731V64.1667H65.3958C68.1962 64.1667 70.5 61.8676 70.5 59.0625V5.12695C70.5 2.32192 68.2072 4.5859e-05 65.3958 4.5859e-05H11.4375ZM11.4375 2.91671H65.3958C66.6242 2.91671 67.5833 3.88387 67.5833 5.12695V59.0625C67.5833 60.5115 66.2132 61.25 64.6667 61.25V10.9603V10.9377C64.6667 7.28237 63.2083 5.82402 59.5626 5.83445H9.25007C9.25 3.63652 9.97917 2.90738 11.4375 2.91671ZM5.60417 8.75005C23.5903 8.75005 41.5764 8.75005 59.5625 8.75005C61.0208 8.74057 61.75 9.46987 61.75 10.9603V20.4167H3.41667V10.9375C3.41667 9.69439 4.36867 8.75005 5.60417 8.75005ZM9.25 11.6667C7.63917 11.6667 6.33333 12.9726 6.33333 14.5834C6.33333 16.1942 7.63917 17.5 9.25 17.5C10.8608 17.5 12.1667 16.1942 12.1667 14.5834C12.1667 12.9726 10.8608 11.6667 9.25 11.6667ZM18 11.6667C16.3892 11.6667 15.0833 12.9726 15.0833 14.5834C15.0833 16.1942 16.3892 17.5 18 17.5C19.6108 17.5 20.9167 16.1942 20.9167 14.5834C20.9167 12.9726 19.6108 11.6667 18 11.6667ZM3.41667 23.3334H61.75C61.7499 37.1744 61.75 51.0428 61.75 64.8731C61.75 66.1161 60.798 67.0833 59.5625 67.0833H5.60417C4.36867 67.0833 3.41667 66.1161 3.41667 64.8731V23.3334ZM6.33333 26.25C6.33333 31.5673 6.33333 36.0528 6.33333 40.8333C24.2967 40.8333 41.7999 40.8333 57.375 40.8333C57.375 35.516 57.375 31.0305 57.375 26.25C39.6702 26.25 21.5152 26.25 6.33333 26.25ZM9.25 29.1667H54.4583V37.9167H9.25V29.1667ZM6.33333 43.75C6.33333 50.7911 6.33333 58.1093 6.33333 64.1667C15.912 64.1667 25.8132 64.1667 34.0417 64.1667C34.0417 56.8118 34.0417 50.2699 34.0417 43.75C24.463 43.75 14.5618 43.75 6.33333 43.75ZM36.9583 43.75C36.9583 51.1049 36.9583 57.6468 36.9583 64.1667C44.3132 64.1667 50.8551 64.1667 57.375 64.1667C57.375 57.1255 57.375 49.8074 57.375 43.75C50.0201 43.75 43.4782 43.75 36.9583 43.75ZM9.25 46.6667H31.125V61.25H9.25V46.6667ZM39.875 46.6667H54.4583V61.25H39.875V46.6667Z",fill:t?"#2B73D2":"#AAC8EE"})):n().createElement("svg",{width:"100",height:"100",viewBox:"0 0 77 70",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n().createElement("path",{d:"M17.8509 35.0005C17.8509 32.0652 19.8146 29.7985 21.7287 29.5592C22.5061 29.462 23.3157 29.7997 24.0134 30.7309C24.7228 31.6778 25.2344 33.167 25.2344 35.0005C25.2344 36.8341 24.7228 38.3233 24.0134 39.2702C23.3157 40.2014 22.5061 40.5391 21.7287 40.4419C19.8146 40.2026 17.8509 37.9359 17.8509 35.0005Z",stroke:t?"#2B73D2":"#AAC8EE",strokeWidth:"3"}),n().createElement("path",{d:"M2.4447 12.3305C2.4447 10.6541 3.63338 9.2131 5.27919 8.89434L37.648 2.62517C39.8079 2.20685 41.8136 3.86133 41.8136 6.06131V64.0323C41.8136 66.2105 39.8452 67.8596 37.7007 67.4782L5.33183 61.7212C3.66147 61.4241 2.4447 59.9719 2.4447 58.2753V12.3305ZM11.6696 35.0005C11.6696 41.1271 15.7788 46.9676 21.3565 47.6656C24.3253 48.0371 26.907 46.5822 28.664 44.2368C30.4092 41.9071 31.4158 38.6354 31.4158 35.0005C31.4158 31.3656 30.4092 28.0938 28.664 25.7642C26.907 23.4187 24.3253 21.9639 21.3565 22.3354C15.7788 23.0333 11.6696 28.8739 11.6696 35.0005Z",stroke:t?"#2B73D2":"#AAC8EE",strokeWidth:"3"}),n().createElement("path",{d:"M74.7626 16.1536L53.7462 33.5789C53.5631 33.7307 53.2984 33.7325 53.1132 33.5833L48.7675 30.0807C48.6498 29.9858 48.5813 29.8427 48.5813 29.6914V16.6536C48.5813 16.3775 48.8052 16.1536 49.0813 16.1536H74.7626Z",stroke:t?"#2B73D2":"#AAC8EE",strokeWidth:"3"}),n().createElement("path",{d:"M74.4028 24.0443C74.7287 23.7741 75.2219 24.0059 75.2219 24.4292V54.1849C75.2219 54.461 74.9981 54.6849 74.7219 54.6849H49.0813C48.8052 54.6849 48.5813 54.461 48.5813 54.1849V38.5242C48.5813 38.1041 49.068 37.8713 49.3951 38.1349L51.2307 39.6144C52.5268 40.6591 54.3794 40.6462 55.661 39.5837L74.4028 24.0443Z",stroke:t?"#2B73D2":"#AAC8EE",strokeWidth:"3"})),ae=({label:e,tooltip:t,onUrlCopied:a,type:r})=>{const[i,s]=(0,l.useState)(!1);return n().createElement(o.Container,null,n().createElement(te,{type:r,isHovered:i}),n().createElement(o.Padding,{top:"medium"}),n().createElement(o.Tooltip,{label:t,placement:"top"},n().createElement(o.Container,{padding:{horizontal:"small"}},n().createElement(o.Button,{label:e,icon:"Copy",width:"fill",type:"outlined",onClick:a(e,r),onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1)}))))},le=({folderName:e,onClose:t,isFromEditModal:a})=>{const l=(0,o.useSnackbar)(),r=(0,i.useUserAccounts)(),[s]=(0,w.useTranslation)(),c=(t,a)=>()=>{const n=((e,t,a)=>{const l=window.location.hostname;return"ics"===e?`https://${l}/home/${t}/${a}.ics`:`webcals://${l}/home/${t}/${a}`})(a,r[0].name,e);navigator.clipboard.writeText(n).then((()=>{l({key:"folder-action-success",replace:!0,type:"success",hideButton:!0,label:s("snackbar.url_copied",{title:t,defaultValue:"{{title}} copied"}),autoHideTimeout:3e3})}))};return n().createElement(o.Container,{padding:"0.5rem 0.5rem 1.5rem"},n().createElement(H.x,{title:s("label.share_calendar_url",{title:e,defaultValue:"{{title}} access share"}),onClose:t}),n().createElement(o.Container,{padding:{vertical:"medium"}},n().createElement(o.Container,{crossAlignment:"baseline"},n().createElement(o.Text,{overflow:"break-word"},s("message.share_calendar_url_msg",{title:e,defaultValue:"You can quickly share {{title}} with your collaborators using one of these URLs:"}))),n().createElement(o.Padding,{top:"large"}),n().createElement(o.Container,{orientation:"horizontal",padding:{horizontal:"medium",vertical:"large"}},n().createElement(ae,{label:s("label.ics_url","ICS URL"),onUrlCopied:c,tooltip:s("tooltip.copy_ics_url","Copy ICS url"),type:"ics"}),n().createElement(ae,{label:s("label.outlook_url","Outlook URL"),tooltip:s("tooltip.copy_outlook_url","Copy Outlook url"),onUrlCopied:c,type:"outlook"})),n().createElement(o.Container,{crossAlignment:"center",mainAlignment:"center"},n().createElement(o.Text,{overflow:"break-word",color:"secondary"},a?n().createElement(w.Trans,{i18nKey:"message.share_calendar_url_note2",defaults:"Only your collaborators can access your data using these URLs.<br/> You can find these links also right-clicking your calendars list."}):s("message.share_calendar_url_note","Only your collaborators can access your data using these URLs.")))))},ne=({onClose:e,folderId:t})=>{const a=(0,o.useSnackbar)(),[l]=(0,w.useTranslation)();return n().createElement(o.Container,{padding:{all:"large"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(H.x,{onClose:e,title:l("action.empty_trash","Empty Trash")}),n().createElement(o.Padding,{all:"small"},n().createElement(o.Text,{overflow:"break-word"},l("action.empty_trash_deleting_confirmation","You are deleting all items in the Calendar trash folder. The deletion is permanent. Are you sure you want to delete all the items?"))),n().createElement(B.Z,{onConfirm:()=>{(0,_.f)({id:t,op:v.w4.EMPTY,recursive:!0,type:"appointments"}).then((t=>{e(),t.Fault?a({key:"folder-action-success",replace:!0,type:"error",hideButton:!0,label:l("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3}):a({key:"folder-action-success",replace:!0,type:"info",hideButton:!0,label:l("label.trash_emptied","Trash emptied successfully"),autoHideTimeout:3e3})}))},secondaryAction:e,label:l("label.empty","Empty"),color:"error"}))},re=({icon:e,label:t,text:a})=>n().createElement(o.Row,{width:"fill",mainAlignment:"flex-start",padding:{all:"small"}},n().createElement(o.Row,{padding:{right:"small"}},n().createElement(o.Icon,{icon:e}),n().createElement(o.Row,{padding:{right:"small",left:"small"}},n().createElement(o.Text,{weight:"bold"},`${t}: `)),n().createElement(o.Row,{takeAvailableSpace:!0},n().createElement(o.Text,null,a)))),oe=({onClose:e,folder:t})=>{const[a]=(0,w.useTranslation)(),l=(/r/.test(t.perm||"")?`${a("read","Read")}`:"").concat(/w/.test(t.perm||"")?`, ${a("write","Write")}`:"").concat(/i/.test(t.perm||"")?`, ${a("insert","Insert")}`:"").concat(/d/.test(t.perm||"")?`, ${a("label.delete","Delete")}`:"").concat(/a/.test(t.perm||"")?`, ${a("administer","Administer")}`:"").concat(/p/.test(t.perm||"")?`, ${a("label.private","Private")}`:"").concat(/f/.test(t.perm||"")?`, ${a("freebusy","FreeBusy")}`:"").concat(/c/.test(t.perm||"")?`, ${a("label.create","Create")}`:"").concat(/x/.test(t.perm||"")?`, ${a("workflow","WorkFlow")}`:"");return n().createElement(o.Container,{padding:{all:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(S.Z,{title:`${a("folder.share_info","Share Info")} `,onClose:e}),n().createElement(re,{icon:"InfoOutline",label:`${a("shared_items","Shared items")}`,text:t.name}),n().createElement(re,{icon:"PersonOutline",label:`${a("owner","Owner")}`,text:t.owner}),n().createElement(re,{icon:"CalendarModOutline",label:`${a("type","Type")}`,text:a("shared_folders","Shared Calendars")}),n().createElement(re,{icon:"UnlockOutline",label:`${a("allowed_actions","Allowed actions")}`,text:l}),n().createElement(re,{icon:"AppointmentOutline",label:`${a("appointments","Appointments")}`,text:t.n}))};var ie=a(99616);const se=(0,N.createAsyncThunk)("folders/get folder",(async e=>{const t={CreateMountpointRequest:(0,s.map)(e,(e=>({link:{l:1,name:`${e.name} ${e.of} ${e.ownerName}`,rid:e.folderId,view:"appointment",zid:e.ownerId},_jsns:"urn:zimbraMail"}))),_jsns:"urn:zimbra"};return(0,ie.S)(t)})),ce=C()(o.Container).withConfig({displayName:"shares-modal__ContainerEl",componentId:"sc-1imqk65-0"})(["overflow-y:auto;display:block;"]),de=({item:e})=>{const[t,a]=(0,l.useState)(!1),r=(0,l.useCallback)((()=>{t?e.setLinks((0,s.filter)(e.links,(t=>t.id!==e.id))):e.setLinks((0,s.uniqWith)([...e.links,{id:e.id,name:e.label,folderId:e.folderId,ownerId:e.ownerId,ownerName:e.ownerName,of:(0,i.t)("label.of","of")}],s.isEqual)),a(!t)}),[t,e]);return n().createElement(n().Fragment,null,n().createElement(o.Checkbox,{value:t,onClick:r,iconColor:"primary"}),n().createElement(o.AccordionItem,{item:e}))},me=({calendars:e,onClose:t})=>{const[a,r]=(0,l.useState)([]),[d,m]=(0,l.useState)(),p=(0,u.T)(),h=(0,o.useSnackbar)(),g=(0,l.useCallback)((()=>{p(se(a)).then((({payload:e})=>{if(e.CreateMountpointResponse&&!e.Fault&&h({key:"mountpoint",replace:!0,type:"success",label:(0,i.t)("mountpoint_success","The share has been added successfully to the Shared Calendars section"),autoHideTimeout:3e3}),e.CreateMountpointResponse&&e.Fault){const t=e?.Fault?.length,a=t+e.CreateMountpointResponse.length;h({key:"mountpoint",replace:!0,type:"warning",label:(0,i.t)("mountpoint_warning",{failed:t,total:a,defaultValue:"{{failed}} out of {{total}} shared calendars couldn't be added to the Shared Calendars"}),autoHideTimeout:3e3})}!e.CreateMountpointResponse&&e.Fault&&h({key:"mountpoint",replace:!0,type:"error",label:(0,i.t)("mountpoint_error","The share couldn't be added to the Shared Calendars section"),autoHideTimeout:3e3})})),t()}),[h,p,a,t]),C=(0,s.map)(e,(e=>({id:`${e?.ownerName} - ${e.folderId} - ${e.granteeType} - ${e.granteeName}`,label:(0,c.qd)({folderId:e.folderId??"",folderName:(0,s.last)((0,s.split)(e.folderPath,"/"))??""}),open:!0,items:[],ownerName:e.ownerName,ownerId:e.ownerId,checked:!1,folderId:e.folderId,setLinks:r,links:a,CustomComponent:de}))),b=(0,l.useMemo)((()=>(0,s.groupBy)(C,"ownerName")),[C]),f=(0,l.useMemo)((()=>[{id:i.FOLDERS.USER_ROOT,label:(0,c.qd)({folderId:i.FOLDERS.USER_ROOT,folderName:"Root"}),level:0,open:!0,items:(0,s.map)((0,s.values)(d??b),(e=>({id:e[0].ownerId,label:n().createElement(w.Trans,{i18nKey:"label.shares_items",defaults:"<bold>{{user}}</bold>'s shared calendars",values:{user:e[0].ownerName},components:{bold:n().createElement("span",{style:{fontWeight:"bold",fontFamily:"sans-serif",fontSize:"0.875rem"}})}}),open:!0,items:e,background:void 0}))),background:void 0,onClick:()=>null}]),[d,b]),E=(0,l.useCallback)((e=>{m((0,s.pickBy)(b,((t,a)=>(0,s.startsWith)((0,s.toLower)(a),(0,s.toLower)(e?.target?.value)))))}),[b]);return(0,s.isEmpty)(f)?n().createElement(n().Fragment,null,"No shared folders to show at the moment"):n().createElement(n().Fragment,null,n().createElement(S.Z,{title:(0,i.t)("find_calendar_shares","Find Calendar Shares"),onClose:t}),n().createElement(o.Row,{padding:{top:"large",bottom:"small"},width:"fill",mainAlignment:"flex-start"},n().createElement(o.Text,null,(0,i.t)("label.find_shares","Select which calendars you want to see in calendars tree"))),n().createElement(o.Row,{padding:{top:"small",bottom:"large"},width:"fill"},n().createElement(o.Input,{label:(0,i.t)("label.filter_sharer_user","Foder owner"),backgroundColor:"gray5",CustomIcon:({hasFocus:e})=>n().createElement(o.Icon,{icon:"FunnelOutline",size:"large",color:e?"primary":"text"}),onChange:E})),n().createElement(ce,{orientation:"vertical",mainAlignment:"flex-start",maxHeight:"40vh"},n().createElement(o.Accordion,{items:f,background:"gray6"})),n().createElement(o.Row,{padding:"small",width:"fill",mainAlignment:"flex-end"},n().createElement(R.Z,{onConfirm:g,label:(0,i.t)("add","Add"),disabled:a?.length<=0})))},ue=({createModal:e,item:t})=>a=>{a&&a.stopPropagation();const l=e({children:n().createElement(A.g,null,n().createElement(k.R,{onClose:()=>l(),folderId:t.id}))},!0)},pe=({createSnackbar:e,item:t})=>a=>{a&&a.stopPropagation();const l=(0,E.yj)(t.id);(0,_.f)({id:t.id,op:v.w4.MOVE,l:l?.id??"1"}).then((a=>{a.Fault?e({key:"calendar-moved-root-error",replace:!0,type:"error",hideButton:!0,label:(0,i.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3}):e({key:"calendar-moved-root",replace:!0,type:(0,y.dK)(t)?"success":"info",hideButton:!0,label:(0,y.dK)(t)?(0,i.t)("message.snackbar.calendar_restored","Calendar restored successfully"):(0,i.t)("message.snackbar.calendar_moved_to_root_folder","Calendar moved to Root folder"),autoHideTimeout:3e3})}))},he=({createModal:e,item:t})=>a=>{a&&a.stopPropagation();const l=e({children:n().createElement(A.g,null,n().createElement(ne,{onClose:()=>l(),folderId:t.id})),onClose:()=>{l()}},!0)},ge=({createModal:e,item:t})=>a=>{a&&a.stopPropagation();const l=e({children:n().createElement(A.g,null,n().createElement(ee,{folderId:t.id,onClose:()=>l()})),maxHeight:"70vh",size:"medium"},!0)},Ce=({createModal:e,item:t})=>a=>{a&&a.stopPropagation();const l=e({children:n().createElement(A.g,null,n().createElement(L,{folder:t,onClose:()=>l()}))},!0)},be=({item:e,createSnackbar:t})=>a=>{a&&a.stopPropagation(),(0,_.f)({id:e.id,op:v.w4.DELETE}).then((e=>{e.Fault?t({key:"shared-calendar-removed-error",replace:!0,type:"error",hideButton:!0,label:(0,i.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3}):t({key:"shared-calendar-removed",replace:!0,type:"info",hideButton:!0,label:(0,i.t)("message.snackbar.shared_calendar_removed","Calendar removed successfully"),autoHideTimeout:3e3})}))},fe=({item:e,createModal:t})=>a=>{a&&a.stopPropagation(),(async({id:e})=>(0,i.soapFetch)("GetFolder",{_jsns:"urn:zimbraMail",folder:{l:e}}))({id:e.id}).then((e=>{if(!e.Fault&&e.link){const a=t({children:n().createElement(A.g,null,n().createElement(oe,{onClose:()=>a(),folder:e.link[0]}))},!0)}}))},Ee=({item:e,createModal:t})=>()=>{const a=t({children:n().createElement(A.g,null,n().createElement(le,{folderName:e.name,onClose:()=>a()})),maxHeight:"70vh",size:"medium"},!0)},ye=({createModal:e})=>()=>{(async()=>{const e=await(0,i.soapFetch)("GetShareInfo",{_jsns:"urn:zimbraAccount",includeSelf:0});return Promise.resolve({isFulfilled:!(0,s.isEmpty)(e),calendars:e?.share??[]})})().then((t=>{const a=(0,s.uniqWith)((0,s.filter)(t.calendars,["view","appointment"]),s.isEqual);if(t.isFulfilled){const t=e({children:n().createElement(A.g,null,n().createElement(me,{calendars:a,onClose:()=>t()}))},!0)}}))},ve=({item:e})=>()=>{const t=f()().format("YYYY-MM-DD");((e,t)=>{const a=document.createElement("a");a.download=e,a.href=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)})(`${(0,s.lowerCase)(e?.name)}-${t}.ics`,`/service/home/~/?auth=co&id=${e.id}&mime=text/plain&noAttach=1&icalAttach=none`)};var _e=a(97207),Ae=a(70656);const ke=(0,i.t)("label.no_rights","You do not have permission to perform this action"),we=({createModal:e,item:t})=>({id:_e.n.NEW,icon:"CalendarOutline",label:(0,i.t)("label.new_calendar","New calendar"),disabled:(0,y.dK)(t)||!!t.perm&&!/w/.test(t.perm)||(0,x.rR)(t,_e.X.ALL_CALENDAR),tooltipLabel:ke,onClick:ue({createModal:e,item:t})}),Re=({createSnackbar:e,item:t})=>({id:_e.n.MOVE_TO_ROOT,icon:"MoveOutline",label:(0,y.ek)(t)?(0,i.t)("label.restore_calendar","Restore calendar"):(0,i.t)("action.move_to_root","Move to root"),disabled:(0,x.rR)(t,Ae.el.TRASH)||(0,x.rR)(t,_e.X.ALL_CALENDAR)||(0,x.rR)(t,Ae.el.CALENDAR)||t.depth<2||(0,c.ZE)(t)||!!t?.owner,tooltipLabel:ke,onClick:pe({createSnackbar:e,item:t})}),Se=({createModal:e,item:t})=>({id:_e.n.EMPTY_TRASH,icon:"DeletePermanentlyOutline",label:(0,i.t)("action.empty_trash","Empty Trash"),tooltipLabel:(0,x.rR)(t,Ae.el.TRASH)&&!(0,s.isNil)(t?.n)&&t?.n<1&&!(0,s.isNil)(t?.children)&&t.children.length<1?(0,i.t)("action.Trash_already_empty","trash is already empty"):ke,onClick:he({createModal:e,item:t}),disabled:!(0,x.rR)(t,Ae.el.TRASH)||(0,x.rR)(t,Ae.el.TRASH)&&!(0,s.isNil)(t?.n)&&t?.n<1&&!(0,s.isNil)(t?.children)&&t.children.length<1}),xe=({createModal:e,item:t})=>({id:_e.n.EDIT,icon:"Edit2Outline",label:(0,i.t)("action.edit_calendar_properties","Edit calendar properties"),tooltipLabel:ke,onClick:ge({createModal:e,item:t}),disabled:(0,x.rR)(t,_e.X.ALL_CALENDAR)||(0,y.dK)(t)}),Le=({createModal:e,item:t})=>({id:_e.n.DELETE,icon:"Trash2Outline",label:(0,y.ek)(t)?(0,i.t)("label.delete_permanently","Delete permanently"):(0,i.t)("action.delete_calendar","Delete calendar"),tooltipLabel:ke,onClick:Ce({createModal:e,item:t}),disabled:(0,x.rR)(t,_e.X.ALL_CALENDAR)||(0,x.rR)(t,Ae.el.CALENDAR)||(0,x.rR)(t,Ae.el.TRASH)||!!t.perm&&!/w/.test(t.perm)}),Me=({item:e,createSnackbar:t})=>({id:_e.n.REMOVE_FROM_LIST,icon:"CloseOutline",label:(0,i.t)("remove_from_this_list","Remove shared calendar"),tooltipLabel:ke,onClick:be({item:e,createSnackbar:t}),disabled:!e.isLink||(0,c.ZE)(e)||(0,x.rR)(e,_e.X.ALL_CALENDAR)||(0,x.rR)(e,Ae.el.CALENDAR)||(0,y.dK)(e)}),Te=({createModal:e,item:t})=>({id:_e.n.SHARES_INFO,icon:"InfoOutline",label:(0,i.t)("shares_info","Shares Info"),tooltipLabel:ke,onClick:fe({createModal:e,item:t}),disabled:!t.isLink||(0,c.ZE)(t)||(0,x.rR)(t,_e.X.ALL_CALENDAR)||(0,x.rR)(t,Ae.el.CALENDAR)||(0,y.dK)(t)}),Fe=({createModal:e,item:t})=>({id:_e.n.SHARE_URL,icon:"Copy",label:(0,i.t)("action.calendar_access_share","Calendar access share"),tooltipLabel:ke,onClick:Ee({createModal:e,item:t}),disabled:t.isLink||(0,y.dK)(t)||(0,x.rR)(t,_e.X.ALL_CALENDAR)}),Ie=({createModal:e,item:t})=>({id:_e.n.FIND_SHARES,icon:"PlusOutline",label:(0,i.t)("find_shares","Find shares"),tooltipLabel:ke,onClick:ye({createModal:e}),disabled:(0,y.dK)(t)||(0,x.rR)(t,_e.X.ALL_CALENDAR)||!(0,c.N4)(t)}),Be=({item:e})=>({id:_e.n.EXPORT_ICS,icon:"Download",label:(0,i.t)("action.export_calendar_ics","Export ICS file"),tooltipLabel:ke,onClick:ve({item:e}),disabled:(0,x.rR)(e,_e.X.ALL_CALENDAR)||(0,y.dK)(e)||e.isLink||(0,c.ZE)(e)}),He=(e,t)=>({id:_e.n.UPLOAD,icon:"Upload",label:(0,i.t)("action.calendar_upload","Import ICS file"),tooltipLabel:ke,onClick:()=>{t?.current&&t.current.click()},disabled:(0,x.rR)(e,_e.X.ALL_CALENDAR)||(0,y.dK)(e)||e.isLink||(0,c.ZE)(e)});var De=a(41080);const Ne=C()(o.Row).withConfig({displayName:"folders-component__FittedRow",componentId:"sc-zf2mvw-0"})(["max-width:calc(100% - (2 * ","));height:3rem;"],(({theme:e})=>e.sizes.padding.small)),Oe=C().input.withConfig({displayName:"folders-component__FileInput",componentId:"sc-zf2mvw-1"})(["display:none;"]),ze=({children:e,inputRef:t,item:a})=>{const r=(0,l.useMemo)((()=>(0,x.rR)(a,_e.X.ALL_CALENDAR)),[a]),i=((e,t)=>{const a=(0,o.useModal)(),l=(0,o.useSnackbar)();if(!e)return[];const n=[we({createModal:a,item:e}),Re({createSnackbar:l,item:e}),Se({createModal:a,item:e}),xe({createModal:a,item:e}),Le({createModal:a,item:e}),Me({item:e,createSnackbar:l}),Fe({createModal:a,item:e}),Ie({createModal:a,item:e}),Te({item:e,createModal:a}),Be({item:e}),He(e,t)];return(0,s.filter)(n,["disabled",!1])})(a,t);return r?e:n().createElement(o.Dropdown,{items:i,contextMenu:!0,width:"100%",display:"block"},e)},Pe=(e,t,a)=>n().createElement(o.Padding,{left:"small"},n().createElement(o.Tooltip,{placement:"right",label:a},n().createElement(o.Row,null,n().createElement(o.Icon,{icon:e,color:t,size:"medium"})))),Ze=({accordionItem:e,item:t})=>{const a=(0,u.T)(),r=(0,p.Zo)(),m=(0,p.p)(),h=(0,d.t)(),g=(0,l.useRef)(null),C=(0,o.useSnackbar)(),b=(0,o.useModal)(),f=(0,i.useUserAccount)(),y=(0,E.px)(t.id),v=(0,E.f8)(y??i.FOLDERS.USER_ROOT),_=(0,l.useCallback)((()=>(0,c.ay)({folder:t,checked:!!t.checked,dispatch:a,start:r,end:m,query:h})),[a,m,t,h,r]),A=(0,l.useMemo)((()=>{if(t.isLink||(0,c.ZE)(t)){const e=(0,i.t)("tooltip.folder_linked_status","Linked to me");return Pe("Linked","linked",e)}if(t.acl?.grant){const e=(0,i.t)("tooltip.calendar_sharing_status",{count:t?.acl?.grant?.length,defaultValue_one:"Shared with 1 person",defaultValue:"Shared with {{count}} people"});return Pe("Shared","shared",e)}return""}),[t]),k=(0,l.useMemo)((()=>v?.name===i.ROOT_NAME?f.name:v?.name??f.name),[v,f.name]),w=(0,l.useCallback)((()=>{g?.current?.files&&(C({key:"import ongoing",replace:!0,type:"info",label:(0,i.t)("label.import_calendar_ongoing","Import into the selected calendar in progress."),hideButton:!0}),(async(e,t,a)=>Promise.all((0,s.map)(e,(e=>fetch(`/home/${t}/${a}?fmt=ics&charset=UTF-8`,{headers:{"Content-Type":"text/calendar","Access-Control-Allow-Origin":"same origin"},method:"POST",body:e})))))(g?.current?.files,k,t.name).then((e=>{200===e[0].status?(0,De.s)().then((()=>{C({key:"import success",replace:!0,type:"success",label:(0,i.t)("label.import_calendar_success","Import successful"),autoHideTimeout:3e3,hideButton:!0})})):C({key:"import failed",replace:!0,type:"error",label:(0,i.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})})))}),[C,t.name,k]),R=(0,l.useCallback)((()=>{if(g?.current?.files){const e=b({size:"small",children:n().createElement(n().Fragment,null,n().createElement(o.ModalHeader,{title:(0,i.t)("import_appointments","Import appointments"),showCloseIcon:!0,onClose:()=>{e()}}),n().createElement(o.Divider,null),n().createElement(o.ModalBody,null,n().createElement(o.Text,{overflow:"break-word"},(0,i.t)("message.import_appointment_modal",{fileName:g?.current?.files[0].name,calendarName:t.name,defaultValue:'The appointments contained within {{fileName}} will be imported into the "{{calendarName}}" calendar.'}))),n().createElement(o.Divider,null),n().createElement(o.ModalFooter,{onConfirm:()=>{e(),w()},onClose:()=>{e()},confirmLabel:(0,i.t)("import","Import")})),onClose:()=>{e()}},!0)}}),[w,b,t.name]);return n().createElement(n().Fragment,null,n().createElement(ze,{item:t,inputRef:g},n().createElement(o.Row,{onClick:_},n().createElement(o.Padding,{left:"small"}),n().createElement(o.Tooltip,{label:e.label,placement:"right",maxWidth:"100%"},n().createElement(o.AccordionItem,{item:e})),A)),n().createElement(Oe,{type:"file",ref:g,onChange:R,accept:".ics"}))},Ve=({accordionItem:e})=>n().createElement(Ne,null,n().createElement(o.Padding,{left:"small"},n().createElement(o.Avatar,{label:e.label??"",colorLabel:e.iconColor,size:"medium"})),n().createElement(o.Tooltip,{label:e.label,placement:"right",maxWidth:"100%"},n().createElement(o.AccordionItem,{item:e}))),$e=({item:e})=>{const{displayName:t}=(0,i.useUserAccount)(),a=(0,l.useMemo)((()=>(0,y.C_)(e)),[e]),r=(0,l.useMemo)((()=>({...e,label:e.id===i.FOLDERS.USER_ROOT?t:(0,c.qd)({folderId:e.id,folderName:e.name})??"",icon:(0,c.UO)({item:e,checked:!!e.checked}),iconColor:(0,m.Kd)({color:e.color,rgb:e.rgb}).color,textProps:{size:"small"}})),[e,t]);return e.isLink&&e.broken?n().createElement(n().Fragment,null):a?n().createElement(Ve,{accordionItem:r}):n().createElement(Ze,{accordionItem:r,item:e})};var Ue=a(2979),We=a.n(Ue),Ge=a(16880),Ke=a(87324),qe=a(58058),je=a(91156),Xe=a(99950);const Ye=(0,Xe.Z)({palette:{currentColor:{regular:"currentColor",hover:"currentColor",active:"currentColor",focus:"currentColor",disabled:"currentColor"},transparent:{regular:"rgba(0, 0, 0, 0)",hover:"rgba(0, 0, 0, 0.05)",active:"rgba(0, 0, 0, 0.1)",focus:"rgba(0, 0, 0, 0.05)",disabled:"rgba(0, 0, 0, 0)"},primary:{regular:"#2b73d2",hover:"#225ca8",active:"#1e5092",focus:"#225ca8",disabled:"#aac8ee",main:"#2b73d2"},secondary:{regular:"#828282",hover:"#696969",active:"#5c5c5c",focus:"#696969",disabled:"#cccccc",main:"#828282"},header:{regular:"#cfd5dc",hover:"#b1bbc6",active:"#a3aebc",focus:"#b1bbc6",disabled:"#cfd5dc"},highlight:{regular:"#d5e3f6",hover:"#abc7ed",active:"#96b8e8",focus:"#abc7ed",disabled:"#d5e3f6"},gray0:{regular:"#414141",hover:"#282828",active:"#1b1b1b",focus:"#282828",disabled:"#cccccc"},gray1:{regular:"#828282",hover:"#696969",active:"#5c5c5c",focus:"#696969",disabled:"#cccccc"},gray2:{regular:"#cfd5dc",hover:"#b1bbc6",active:"#a3aebc",focus:"#b1bbc6",disabled:"#cfd5dc"},gray3:{regular:"#e6e9ed",hover:"#c8cfd8",active:"#bac2cd",focus:"#c8cfd8",disabled:"#e6e9ed"},gray4:{regular:"#eeeff3",hover:"#d0d3de",active:"#c1c5d3",focus:"#d0d3de",disabled:"#eeeff3"},gray5:{regular:"#f5f6f8",hover:"#d7dbe3",active:"#c8ced9",focus:"#d7dbe3",disabled:"#f5f6f8"},gray6:{regular:"#ffffff",hover:"#e6e6e6",active:"#d9d9d9",focus:"#e6e6e6",disabled:"#ffffff"},warning:{regular:"#ffc107",hover:"#d39e00",active:"#ba8b00",focus:"#d39e00",disabled:"#ffe699",main:"#ffc107"},error:{regular:"#d74942",hover:"#be3028",active:"#a92a24",focus:"#be3028",disabled:"#edaeab",main:"#d74942"},success:{regular:"#8bc34a",hover:"#71a436",active:"#639030",focus:"#71a436",disabled:"#cee6b2",main:"#8bc34a"},info:{regular:"#2196d3",hover:"#1a75a7",active:"#176691",focus:"#1a75a7",disabled:"#a7d7f1",main:"#2196d3"},text:{regular:"#333333",hover:"#1a1a1a",active:"#0d0d0d",focus:"#1a1a1a",disabled:"#cccccc",main:"#333333"}},avatarColors:{avatar_1:"#EF9A9A",avatar_2:"#F48FB1",avatar_3:"#CE93D8",avatar_4:"#B39DDB",avatar_5:"#9FA8DA",avatar_6:"#90CAF9",avatar_7:"#81D4FA",avatar_8:"#80DEEA",avatar_9:"#80CBC4",avatar_10:"#A5D6A7",avatar_11:"#C5E1A5",avatar_12:"#E6EE9C",avatar_13:"#FFE082",avatar_14:"#FFCC80",avatar_15:"#FFAB91",avatar_16:"#BCAAA4",avatar_17:"#E57373",avatar_18:"#F06292",avatar_19:"#BA68C8",avatar_20:"#9575CD",avatar_21:"#7986CB",avatar_22:"#64B5F6",avatar_23:"#4FC3F7",avatar_24:"#4DD0E1",avatar_25:"#4DB6AC",avatar_26:"#81C784",avatar_27:"#AED581",avatar_28:"#DCE775",avatar_29:"#FFD54F",avatar_30:"#FFB74D",avatar_31:"#FF8A65",avatar_32:"#A1887F",avatar_33:"#0097A7",avatar_34:"#EF5350",avatar_35:"#EC407A",avatar_36:"#AB47BC",avatar_37:"#7E57C2",avatar_38:"#5C6BC0",avatar_39:"#42A5F5",avatar_40:"#29B6F6",avatar_41:"#26C6DA",avatar_42:"#26A69A",avatar_43:"#66BB6A",avatar_44:"#9CCC65",avatar_45:"#D4E157",avatar_46:"#FFCA28",avatar_47:"#FFA726",avatar_48:"#FF7043",avatar_49:"#8D6E63",avatar_50:"#0288D1"}}),Je=(0,Xe.Z)({components:{MuiSvgIcon:{styleOverrides:{root:{color:Ye.palette.text.regular,"&:hover":{background:Ye.palette.gray3.hover},fontSize:"1.25rem",fontWeight:400}}},MuiAccordionSummary:{styleOverrides:{root:{padding:"0 1rem 0 0",margin:"0",minHeight:"0",justifyContent:"left"},content:{margin:"0",maxWidth:"calc(100% - 1.25rem)"}}},MuiAccordionDetails:{styleOverrides:{root:{background:Ye.palette.gray5.regular,padding:"0 0 0 0.5rem",margin:"0"}}},MuiButtonBase:{styleOverrides:{root:{padding:"0"}}},MuiPaper:{styleOverrides:{root:{borderBottomLeftRadius:"0",borderTopLeftRadius:"0",borderBottomRightRadius:"0",borderTopRightRadius:"0"}}},MuiAccordion:{styleOverrides:{root:{":last-of-type":{borderBottomLeftRadius:"0",borderTopLeftRadius:"0",borderBottomRightRadius:"0",borderTopRightRadius:"0"},":first-of-type":{borderBottomLeftRadius:"0",borderTopLeftRadius:"0",borderBottomRightRadius:"0",borderTopRightRadius:"0"},boxShadow:"none",background:Ye.palette.gray5.highlight,"&.MuiAccordion-root:before":{top:"0"}}}}}});var Qe=a(58542);const et=({accordions:e,folderId:t,localStorageName:a,AccordionCustomComponent:r,setSelectedFolder:o,buttonFindShares:s,initialExpanded:c})=>{const[d,m]=(0,i.useLocalStorage)(a,c??[]),u=(0,l.useRef)(null),p=(0,l.useCallback)((({accordion:e,expanded:t})=>{m(t?t=>t.includes(e.id)?t:[...t,e.id]:t=>t.filter((t=>t!==e.id)))}),[m]);return n().createElement(Ge.Z,{ref:u,disableGutters:!0},e.map((e=>"find_shares"===e.id?s:n().createElement(Ke.Z,{disableGutters:!0,TransitionProps:{unmountOnExit:!0},expanded:d.includes(e.id),key:e.id},n().createElement(qe.Z,{onClick:()=>{o&&o(e.id)},expandIcon:e?.children?.length>0&&!(0,x.rR)(e,"all")&&n().createElement(We(),{color:"primary",onClick:t=>{t.preventDefault(),p({accordion:e,expanded:!d.includes(e.id)})}}),"aria-controls":"panel1a-content",id:e.id,sx:{backgroundColor:e.id===t?Qe.Ou:"transparent","&:hover":{backgroundColor:e.id===t?Qe.Ou:Ye.palette.gray5.hover},borderRadius:"16px"}},n().createElement(r,{item:e})),e?.children?.length>0&&n().createElement(je.Z,null,n().createElement(et,{accordions:e.children,folderId:t,key:e.id,localStorageName:a,AccordionCustomComponent:r,setSelectedFolder:o,buttonFindShares:s,initialExpanded:c}))))))};var tt=a(62835),at=a(65107);const lt=e=>{const t=(0,at.qC)({tag:e?.item}),a=(0,l.useCallback)((()=>(0,i.runSearch)([{avatarBackground:i.ZIMBRA_STANDARD_COLORS[e?.item?.color||0].hex,avatarIcon:"Tag",background:"gray2",hasAvatar:!0,label:`tag:${e?.item?.name}`,value:`tag:"${e?.item?.name}"`}],"mails")),[e?.item?.color,e?.item?.name]);return n().createElement(o.Dropdown,{contextMenu:!0,items:t,display:"block",width:"fit",onClick:a},n().createElement(o.Row,{mainAlignment:"flex-start",height:"fit",padding:{left:"large"},takeAvailableSpace:!0},n().createElement(o.Icon,{size:"large",icon:"Tag",color:i.ZIMBRA_STANDARD_COLORS[e?.item?.color??0].hex}),n().createElement(o.Padding,{right:"large"}),n().createElement(o.Tooltip,{label:e?.item?.name,placement:"right",maxWidth:"100%"},n().createElement(o.AccordionItem,(0,tt.Z)({},e,{height:"2.5rem"})))))},nt=e=>{const t=(0,o.useModal)();return n().createElement(o.Dropdown,{contextMenu:!0,display:"block",width:"fit",items:[(0,at.ln)({createModal:t})]},n().createElement(o.Row,{mainAlignment:"flex-start",padding:{horizontal:"large"},takeAvailableSpace:!0},n().createElement(o.Icon,{size:"large",icon:"TagsMoreOutline"})," ",n().createElement(o.Padding,{right:"large"}),n().createElement(o.AccordionItem,(0,tt.Z)({},e,{color:`${e.color}`,height:"2.5rem"}))))},rt=({foldersAccordionItems:e,tagsAccordionItems:t})=>{const[a,r]=(0,l.useState)("");return n().createElement(o.Container,{orientation:"vertical",height:"fit",width:"fill"},n().createElement(et,{accordions:e,folderId:a,localStorageName:"open_calendars_folders",AccordionCustomComponent:$e,buttonFindShares:n().createElement(n().Fragment,null),setSelectedFolder:r}),n().createElement(o.Divider,null),n().createElement(o.Accordion,{background:"transparent",items:[t]}))},ot=n().memo(rt),it=({expanded:e})=>{const t=(0,E.mj)(),a=(0,l.useMemo)((()=>function(e){return e.map((e=>{const t=(0,s.reject)(e.children,(e=>(0,y.dK)(e))),a={name:(0,i.t)("label.all_calendars","All calendars"),id:`${e.id}:${_e.X.ALL_CALENDAR}`,children:t,checked:(0,s.every)(t,["checked",!0]),uuid:"",activesyncdisabled:!1,recursive:!0,deletable:!1,isLink:!1,depth:0,reminder:!1,broken:!1};return e?.children?.length>0?{...e,children:[a,...e.children]}:e}))}(t)),[t]),c=(0,l.useMemo)((()=>(e=>e?.length>0?[{...e?.[0]??{},children:[...e?.[0]?.children??[],{id:"find_shares",disableHover:!0}]},...(0,s.reject)(e,["id","1"])??[]]:[])(a)),[a]),d=(()=>{const e=(0,i.useTags)();return(0,l.useMemo)((()=>({id:"Tags",label:(0,i.t)("label.tags","Tags"),active:!1,open:!1,onClick:e=>{e.stopPropagation()},CustomComponent:nt,items:(0,s.reduce)(e,((e,t)=>{const a={id:t.id,item:t,active:!1,color:t.color||0,label:t.name,name:t.name,open:!1,CustomComponent:lt};return e.push(a),e}),[])})),[e])})(),m=(e=>(0,l.useMemo)((()=>(0,s.map)(e,(e=>{const t=(0,s.find)(e.children,(e=>(0,x.rR)(e,_e.X.ALL_CALENDAR))),a=(0,s.find)(e.children,(e=>(0,x.rR)(e,i.FOLDERS.CALENDAR))),l=(0,s.find)(e.children,(e=>(0,x.rR)(e,i.FOLDERS.TRASH))),n=(0,s.reject)(e.children,(e=>(0,x.rR)(e,_e.X.ALL_CALENDAR)||(0,x.rR)(e,i.FOLDERS.CALENDAR)||(0,x.rR)(e,i.FOLDERS.TRASH)||!0===e?.broken));return t&&a&&l?{...e,children:[t,a,l,...n]}:e}))),[e]))(c);return n().createElement(o.ModalManager,null,n().createElement(o.SnackbarManager,null,n().createElement(r.Z,{theme:Je},e?n().createElement(ot,{foldersAccordionItems:m,tagsAccordionItems:d}):a[0].children.map((e=>n().createElement(h,{key:e.id,item:e}))))))}}}]);
//# sourceMappingURL=sidebar-view.9aea952c.chunk.js.map