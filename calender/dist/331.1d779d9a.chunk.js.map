{"version":3,"file":"331.1d779d9a.chunk.js","mappings":"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","sources":["webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/hooks/use-folders-controller.ts","webpack://carbonio-calendars-ui/./src/shared/create-apppointment-integration/create-appointment.tsx","webpack://carbonio-calendars-ui/./src/view/notifications/index.tsx","webpack://carbonio-calendars-ui/./src/view/reminder/appointment-reminder-item.tsx","webpack://carbonio-calendars-ui/./src/view/reminder/reminder-time-options.ts","webpack://carbonio-calendars-ui/./src/view/reminder/set-new-appointment-time-modal.tsx","webpack://carbonio-calendars-ui/./src/view/reminder/reminder-modal.tsx","webpack://carbonio-calendars-ui/./src/view/reminder/appointment-reminder.tsx","webpack://carbonio-calendars-ui/./src/normalizations/normalize-reminder.ts","webpack://carbonio-calendars-ui/./src/view/sidebar/sync-data-handler.jsx","webpack://carbonio-calendars-ui/./src/app.tsx","webpack://carbonio-calendars-ui/./src/hooks/on-click-new-button.ts","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/components/modals/modal-footer.tsx","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/components/modals/modal-header.tsx","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/constants/utils/index.ts","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/soap/get-folder.ts","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/soap/get-share-info.ts","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/store/zustand/folder/store.ts","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/store/zustand/folder/hooks.ts","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/store/zustand/folder/utils.ts","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/test/mocks/carbonio-shell-ui-constants.ts","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/utils/get-prefs.ts","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/worker/handle-message.ts","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/worker/index.ts","webpack://carbonio-calendars-ui/./src/commons/body-message-renderer.jsx","webpack://carbonio-calendars-ui/./src/commons/editor-generator.ts","webpack://carbonio-calendars-ui/./src/commons/get-identity-items.ts","webpack://carbonio-calendars-ui/./src/commons/modal-footer.tsx","webpack://carbonio-calendars-ui/./src/commons/modal-header.jsx","webpack://carbonio-calendars-ui/./src/commons/styled-components.tsx","webpack://carbonio-calendars-ui/./src/commons/tag-icon-component.tsx","webpack://carbonio-calendars-ui/./src/soap/get-mini-cal-request.ts","webpack://carbonio-calendars-ui/./src/store/actions/get-mini-cal.ts","webpack://carbonio-calendars-ui/./src/commons/utilities.tsx","webpack://carbonio-calendars-ui/./src/constants/api.ts","webpack://carbonio-calendars-ui/./src/constants/calendar.ts","webpack://carbonio-calendars-ui/./src/constants/index.ts","webpack://carbonio-calendars-ui/./src/constants/sidebar.ts","webpack://carbonio-calendars-ui/./src/constants/xprops.ts","webpack://carbonio-calendars-ui/./src/soap/get-free-busy-request.ts","webpack://carbonio-calendars-ui/./src/hooks/use-attendees-availability.ts","webpack://carbonio-calendars-ui/./src/hooks/use-checked-calendars-query.ts","webpack://carbonio-calendars-ui/./src/hooks/use-checked-folders.ts","webpack://carbonio-calendars-ui/./src/hooks/use-get-event-timezone.tsx","webpack://carbonio-calendars-ui/./src/normalizations/normalizations-utils.ts","webpack://carbonio-calendars-ui/./src/normalizations/normalize-appointments.ts","webpack://carbonio-calendars-ui/./src/normalizations/normalize-calendar-events.ts","webpack://carbonio-calendars-ui/./src/normalizations/normalize-editor.ts","webpack://carbonio-calendars-ui/./src/normalizations/normalize-invite.ts","webpack://carbonio-calendars-ui/./src/normalizations/normalize-soap-message-from-editor.ts","webpack://carbonio-calendars-ui/./src/settings/sub-sections/index.ts","webpack://carbonio-calendars-ui/./src/shared/invite-response/parts/appointment-card.tsx","webpack://carbonio-calendars-ui/./src/shared/invite-response/parts/appointment-card-container.tsx","webpack://carbonio-calendars-ui/./src/shared/invite-response/parts/availability-checker.tsx","webpack://carbonio-calendars-ui/./src/shared/invite-response/invite-reply-actions.ts","webpack://carbonio-calendars-ui/./src/shared/invite-response/parts/invite-reply-part.tsx","webpack://carbonio-calendars-ui/./src/shared/invite-response/parts/proposed-time-reply.tsx","webpack://carbonio-calendars-ui/./src/commons/get-appointment.ts","webpack://carbonio-calendars-ui/./src/shared/invite-response/invite-response.tsx","webpack://carbonio-calendars-ui/./src/soap/batch-request.ts","webpack://carbonio-calendars-ui/./src/soap/item-action-request.ts","webpack://carbonio-calendars-ui/./src/soap/folder-action-request.ts","webpack://carbonio-calendars-ui/./src/store/actions/calendar-actions.ts","webpack://carbonio-calendars-ui/./src/store/actions/delete-appointment-permanent.ts","webpack://carbonio-calendars-ui/./src/soap/dismiss-calendar-item-alarm-request.ts","webpack://carbonio-calendars-ui/./src/store/actions/dismiss-appointment-reminder.ts","webpack://carbonio-calendars-ui/./src/soap/get-message-request.ts","webpack://carbonio-calendars-ui/./src/store/actions/get-invite.ts","webpack://carbonio-calendars-ui/./src/store/actions/move-appointment-to-trash.ts","webpack://carbonio-calendars-ui/./src/soap/cancel-appointment-request.ts","webpack://carbonio-calendars-ui/./src/store/actions/move-appointment.ts","webpack://carbonio-calendars-ui/./src/store/actions/new-modify-appointment.ts","webpack://carbonio-calendars-ui/./src/soap/counter-appointment-request.ts","webpack://carbonio-calendars-ui/./src/store/actions/propose-new-time.ts","webpack://carbonio-calendars-ui/./src/soap/search-request.ts","webpack://carbonio-calendars-ui/./src/store/actions/search-appointments.ts","webpack://carbonio-calendars-ui/./src/soap/send-invite-reply-request.ts","webpack://carbonio-calendars-ui/./src/store/actions/send-invite-response.ts","webpack://carbonio-calendars-ui/./src/soap/snooze-calendar-item-alarm-request.ts","webpack://carbonio-calendars-ui/./src/store/actions/snooze-appointment-reminder.ts","webpack://carbonio-calendars-ui/./src/store/reducers/move-appointment-to-trash.ts","webpack://carbonio-calendars-ui/./src/store/redux/hooks.ts","webpack://carbonio-calendars-ui/./src/store/redux/index.tsx","webpack://carbonio-calendars-ui/./src/store/selectors/appointments.ts","webpack://carbonio-calendars-ui/./src/store/selectors/editor.ts","webpack://carbonio-calendars-ui/./src/store/reducers/delete-appointment-permanently.ts","webpack://carbonio-calendars-ui/./src/store/reducers/dismiss-appointment.ts","webpack://carbonio-calendars-ui/./src/store/reducers/handle-created-appointments.ts","webpack://carbonio-calendars-ui/./src/store/reducers/move-appointment.ts","webpack://carbonio-calendars-ui/./src/utils/store/appointments.ts","webpack://carbonio-calendars-ui/./src/store/reducers/search-appointments.ts","webpack://carbonio-calendars-ui/./src/store/reducers/snooze-appointment.ts","webpack://carbonio-calendars-ui/./src/store/slices/appointments-slice.ts","webpack://carbonio-calendars-ui/./src/store/reducers/handle-modified-appointments.ts","webpack://carbonio-calendars-ui/./src/store/reducers/handle-deleted-appointments.ts","webpack://carbonio-calendars-ui/./src/store/reducers/editor-reducers.ts","webpack://carbonio-calendars-ui/./src/store/slices/editor-slice.ts","webpack://carbonio-calendars-ui/./src/store/reducers/get-invite.ts","webpack://carbonio-calendars-ui/./src/store/reducers/handle-modified-invites.ts","webpack://carbonio-calendars-ui/./src/store/reducers/modify-appointment-response.ts","webpack://carbonio-calendars-ui/./src/store/reducers/propose-new-time.ts","webpack://carbonio-calendars-ui/./src/store/reducers/send-invite-response.ts","webpack://carbonio-calendars-ui/./src/store/slices/invites-slice.ts","webpack://carbonio-calendars-ui/./src/store/zustand/hooks.ts","webpack://carbonio-calendars-ui/./src/store/zustand/store.ts","webpack://carbonio-calendars-ui/./src/types/enums/event-actions-enum.ts","webpack://carbonio-calendars-ui/./src/utils/dates.ts","webpack://carbonio-calendars-ui/./src/utils/event.ts","webpack://carbonio-calendars-ui/./src/utils/times.ts","webpack://carbonio-calendars-ui/./src/view/editor/parts/calendar-selector.tsx","webpack://carbonio-calendars-ui/./src/view/editor/parts/editor-availability-warning-row.tsx","webpack://carbonio-calendars-ui/./src/view/editor/parts/select-label-factory.tsx","webpack://carbonio-calendars-ui/./src/commons/color-select.jsx","webpack://carbonio-calendars-ui/./src/view/tags/create-update-tag-modal.tsx","webpack://carbonio-calendars-ui/./src/carbonio-ui-commons/components/tags/delete-tag-modal.tsx","webpack://carbonio-calendars-ui/./src/view/tags/tag-actions.tsx","webpack://carbonio-calendars-ui/./node_modules/moment/locale/ sync ^\\.\\/.*$"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { useEffect, useState } from 'react';\n\nimport { useNotify } from '@zextras/carbonio-shell-ui';\nimport { filter, forEach, isEmpty, map, reject, sortBy } from 'lodash';\n\nimport { getFolderRequest } from '../soap/get-folder';\nimport { getShareInfoRequest } from '../soap/get-share-info';\nimport { useFolderStore } from '../store/zustand/folder';\nimport { FolderView } from '../types/folder';\nimport { folderWorker } from '../worker';\n\nconst getFoldersByAccounts = async (sharedAccounts: unknown[], view: FolderView): Promise<any> =>\n\tPromise.all(\n\t\tmap(sharedAccounts, async ({ ownerEmail }: { ownerEmail: string }) => {\n\t\t\tconst response = await getFolderRequest({ view }, ownerEmail);\n\t\t\tif (response?.folder?.length) {\n\t\t\t\treturn {\n\t\t\t\t\t...response.folder[0],\n\t\t\t\t\toname: response.folder[0].name,\n\t\t\t\t\towner: ownerEmail,\n\t\t\t\t\tname: ownerEmail\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn response;\n\t\t})\n\t);\n\nexport const useFoldersController = (view: FolderView): null => {\n\tconst [initializing, setInitializing] = useState(true);\n\tconst [seq, setSeq] = useState(-1);\n\n\tconst notify = useNotify();\n\n\tuseEffect(() => {\n\t\tif (initializing && view) {\n\t\t\tsetInitializing((previous) => !previous);\n\t\t\tgetFolderRequest({ view })\n\t\t\t\t.then((rootFolders: { folder: any }) => {\n\t\t\t\t\tgetShareInfoRequest().then((sharedFolders) => {\n\t\t\t\t\t\tif (sharedFolders?.folders) {\n\t\t\t\t\t\t\tconst sharedAccounts = filter(sharedFolders.folders, ['folderId', 1]);\n\t\t\t\t\t\t\tif (sharedAccounts.length) {\n\t\t\t\t\t\t\t\tconst filteredLinks = reject(rootFolders.folder[0].link, ['rid', 1]);\n\t\t\t\t\t\t\t\tgetFoldersByAccounts(sharedAccounts, view).then((response) => {\n\t\t\t\t\t\t\t\t\tif (!response.Fault) {\n\t\t\t\t\t\t\t\t\t\tconst folders = [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t...rootFolders.folder[0],\n\t\t\t\t\t\t\t\t\t\t\t\tlink: filteredLinks\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t...response\n\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\tfolderWorker.postMessage({\n\t\t\t\t\t\t\t\t\t\t\top: 'refresh',\n\t\t\t\t\t\t\t\t\t\t\tcurrentView: view,\n\t\t\t\t\t\t\t\t\t\t\tfolder: folders ?? []\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tconst folders = [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t...rootFolders.folder[0],\n\t\t\t\t\t\t\t\t\t\t\t\tlink: filteredLinks\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\tfolderWorker.postMessage({\n\t\t\t\t\t\t\t\t\t\t\top: 'refresh',\n\t\t\t\t\t\t\t\t\t\t\tcurrentView: view,\n\t\t\t\t\t\t\t\t\t\t\tfolder: folders ?? []\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfolderWorker.postMessage({\n\t\t\t\t\t\t\t\t\top: 'refresh',\n\t\t\t\t\t\t\t\t\tcurrentView: view,\n\t\t\t\t\t\t\t\t\tfolder: rootFolders?.folder ?? []\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tsetInitializing(true);\n\t\t\t\t});\n\t\t}\n\t}, [initializing, view]);\n\n\tuseEffect(() => {\n\t\tif (!initializing && notify.length > 0) {\n\t\t\tforEach(sortBy(notify, 'seq'), (item) => {\n\t\t\t\tif (!isEmpty(notify) && (item.seq > seq || (seq > 1 && item.seq === 1))) {\n\t\t\t\t\tconst isNotifyRelatedToFolders =\n\t\t\t\t\t\t!isEmpty(notify) &&\n\t\t\t\t\t\t(item?.created?.folder ||\n\t\t\t\t\t\t\titem?.modified?.folder ||\n\t\t\t\t\t\t\titem.deleted ||\n\t\t\t\t\t\t\titem?.created?.link ||\n\t\t\t\t\t\t\titem?.modified?.link);\n\n\t\t\t\t\tif (isNotifyRelatedToFolders) {\n\t\t\t\t\t\tfolderWorker.postMessage({\n\t\t\t\t\t\t\top: 'notify',\n\t\t\t\t\t\t\tnotify: item,\n\t\t\t\t\t\t\tstate: useFolderStore.getState().folders\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tsetSeq(item.seq);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}, [initializing, notify, seq, view]);\n\treturn null;\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { addBoard } from '@zextras/carbonio-shell-ui';\nimport { pick } from 'lodash';\nimport { Dispatch } from 'redux';\n\nimport { Folders } from '../../carbonio-ui-commons/types/folder';\nimport { generateEditor } from '../../commons/editor-generator';\nimport { CALENDAR_ROUTE } from '../../constants';\nimport { Editor } from '../../types/editor';\n\n// todo: enable the possibility to include attachments\n\ntype CreateAppointmentContextType = {\n\tcalendar?: Editor['calendar'];\n\tisRichText?: Editor['isRichText'];\n\torganizer?: Editor['organizer'];\n\tsender?: Editor['sender'];\n\ttitle?: Editor['title'];\n\tlocation?: Editor['location'];\n\troom?: Editor['room'];\n\tmeetingRoom?: Editor['meetingRoom'];\n\tequipment?: Editor['equipment'];\n\tattendees?: Array<{ email: string }>;\n\toptionalAttendees?: Array<{ email: string }>;\n\tallDay?: Editor['allDay'];\n\tfreeBusy?: Editor['freeBusy'];\n\tclass?: Editor['class'];\n\tstart?: Editor['start'];\n\tend?: Editor['end'];\n\ttimezone?: Editor['timezone'];\n\treminder?: Editor['reminder'];\n\trecur?: Editor['recur'];\n\trichText?: Editor['richText'];\n\tplainText?: Editor['plainText'];\n\tdisabled?: Editor['disabled'];\n};\n\nconst createAppointmentIntegration =\n\t(dispatch: Dispatch, folders: Folders) =>\n\t(context: CreateAppointmentContextType): void => {\n\t\tconst contextToApply = pick(context, [\n\t\t\t'calendar',\n\t\t\t'isRichText',\n\t\t\t'organizer',\n\t\t\t'sender',\n\t\t\t'title',\n\t\t\t'location',\n\t\t\t'room',\n\t\t\t'meetingRoom',\n\t\t\t'equipment',\n\t\t\t'attendees',\n\t\t\t'optionalAttendees',\n\t\t\t'allDay',\n\t\t\t'freeBusy',\n\t\t\t'class',\n\t\t\t'start',\n\t\t\t'end',\n\t\t\t'timezone',\n\t\t\t'reminder',\n\t\t\t'recur',\n\t\t\t'richText',\n\t\t\t'plainText',\n\t\t\t'disabled'\n\t\t]);\n\t\tconst editor = generateEditor({\n\t\t\tcontext: {\n\t\t\t\tdispatch,\n\t\t\t\tfolders,\n\t\t\t\tpanel: false,\n\t\t\t\t...contextToApply\n\t\t\t}\n\t\t});\n\t\taddBoard({\n\t\t\turl: `${CALENDAR_ROUTE}/`,\n\t\t\ttitle: editor?.title ?? '',\n\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t// @ts-ignore\n\t\t\teditor\n\t\t});\n\t};\n\nexport default createAppointmentIntegration;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { ReactElement, FC, useEffect } from 'react';\n\nexport const showNotification = (title: string, body: string): void => {\n\t// eslint-disable-next-line no-new\n\tnew Notification(title, {\n\t\tbody,\n\t\tvibrate: [200, 100, 200],\n\t\tdir: 'ltr'\n\t});\n};\n\nconst Notifications: FC = (): ReactElement => {\n\tuseEffect(() => {\n\t\tif (!('Notification' in window)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn('This browser does not support desktop notifications');\n\t\t} else {\n\t\t\tNotification.requestPermission();\n\t\t}\n\t}, []);\n\n\treturn <></>;\n};\nexport default Notifications;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useCallback, useEffect, useMemo, useState } from 'react';\n\nimport {\n\tContainer,\n\tDropdown,\n\tIcon,\n\tIconButton,\n\tPadding,\n\tRow,\n\tText,\n\tTooltip\n} from '@zextras/carbonio-design-system';\nimport { noop } from 'lodash';\nimport moment from 'moment';\nimport { useTranslation } from 'react-i18next';\n\nimport { useGetReminderItems } from './reminder-time-options';\nimport { getTimeToDisplayData } from '../../commons/utilities';\nimport { getLocationUrl } from '../../normalizations/normalize-calendar-events';\nimport { dismissApptReminder } from '../../store/actions/dismiss-appointment-reminder';\nimport { snoozeApptReminder } from '../../store/actions/snooze-appointment-reminder';\nimport { useAppDispatch } from '../../store/redux/hooks';\nimport { ApptReminderCardProps } from '../../types/appointment-reminder';\n\nexport const AppointmentReminderItem: FC<ApptReminderCardProps> = ({\n\treminderItem,\n\ttoggleModal,\n\tremoveReminder,\n\tsetActiveReminder\n}): ReactElement => {\n\tconst { start, id, isRecurrent, end, alarmData, location, name, isOrg, key } = reminderItem;\n\tconst dispatch = useAppDispatch();\n\tconst [t] = useTranslation();\n\tconst [now, setNow] = useState(moment().valueOf());\n\n\tconst locationUrl = useMemo(() => getLocationUrl(location), [location]);\n\n\tconst dismissReminder = useCallback(() => {\n\t\tdispatch(\n\t\t\tdismissApptReminder({\n\t\t\t\tdismissItems: [{ id, dismissedAt: moment().valueOf() }]\n\t\t\t})\n\t\t);\n\t\tremoveReminder(key);\n\t}, [dispatch, id, key, removeReminder]);\n\n\tconst snoozeReminder = useCallback(\n\t\t(time, isBefore = true) => {\n\t\t\tconst untilForBefore = isRecurrent\n\t\t\t\t? moment()\n\t\t\t\t\t\t.set({\n\t\t\t\t\t\t\thour: moment(start).hour(),\n\t\t\t\t\t\t\tminute: moment(start).minute()\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.subtract(time, 'minutes')\n\t\t\t\t\t\t.valueOf()\n\t\t\t\t: moment(start).subtract(time, 'minutes').valueOf();\n\t\t\tdispatch(\n\t\t\t\tsnoozeApptReminder({\n\t\t\t\t\tid,\n\t\t\t\t\tuntil: isBefore ? untilForBefore : moment().add(time, 'minutes').valueOf()\n\t\t\t\t})\n\t\t\t);\n\t\t\tremoveReminder(key);\n\t\t},\n\t\t[isRecurrent, start, dispatch, id, removeReminder, key]\n\t);\n\n\tconst reminderItems = useGetReminderItems(snoozeReminder, alarmData);\n\n\tconst timeToDisplay = useMemo(() => {\n\t\tconst { color, size, text } = getTimeToDisplayData(reminderItem, now);\n\t\treturn (\n\t\t\t<Text color={color} size={size}>\n\t\t\t\t{text}\n\t\t\t</Text>\n\t\t);\n\t}, [now, reminderItem]);\n\n\tuseEffect(() => {\n\t\tconst interval = setInterval(() => setNow(moment().valueOf()), 30000);\n\t\treturn () => clearInterval(interval);\n\t}, []);\n\n\treturn (\n\t\t<Container\n\t\t\tpadding={{ vertical: 'small' }}\n\t\t\tmainAlignment=\"space-between\"\n\t\t\tcrossAlignment=\"center\"\n\t\t\torientation=\"horizontal\"\n\t\t>\n\t\t\t<Row\n\t\t\t\tmainAlignment=\"space-evenly\"\n\t\t\t\tcrossAlignment=\"center\"\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\twidth=\"65%\"\n\t\t\t>\n\t\t\t\t<Row width=\"20%\" mainAlignment=\"flex-start\">\n\t\t\t\t\t<Icon icon=\"PhoneCallOutline\" size=\"large\" />\n\t\t\t\t</Row>\n\t\t\t\t<Row width=\"80%\" mainAlignment=\"center\" crossAlignment=\"baseline\" orientation=\"vertical\">\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Text size=\"large\">{name}</Text>\n\t\t\t\t\t</Row>\n\t\t\t\t\t{locationUrl && (\n\t\t\t\t\t\t<Row>\n\t\t\t\t\t\t\t<Text>\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\thref={locationUrl}\n\t\t\t\t\t\t\t\t\trel=\"noreferrer\"\n\t\t\t\t\t\t\t\t\tonClick={(e): void => e.stopPropagation()}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{locationUrl}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t)}\n\t\t\t\t\t<Row padding={{ top: 'extrasmall' }} wrap=\"nowrap\">\n\t\t\t\t\t\t<Text size=\"large\">\n\t\t\t\t\t\t\t{moment(start).format('HH:mm')} - {moment(end).format('HH:mm')}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t<Padding left=\"small\">{timeToDisplay}</Padding>\n\t\t\t\t\t</Row>\n\t\t\t\t</Row>\n\t\t\t</Row>\n\t\t\t<Row\n\t\t\t\twidth=\"35%\"\n\t\t\t\tmainAlignment=\"flex-end\"\n\t\t\t\tcrossAlignment=\"center\"\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\tpadding={{ horizontal: 'large' }}\n\t\t\t>\n\t\t\t\t<Row>\n\t\t\t\t\t{(moment(start).valueOf() < moment().valueOf() ||\n\t\t\t\t\t\tmoment(alarmData[0].alarmInstStart).valueOf() < moment().valueOf()) &&\n\t\t\t\t\tisOrg ? (\n\t\t\t\t\t\t<Tooltip placement=\"top\" label={t('label.set_new_time', 'Set new time')}>\n\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\ticon=\"ClockOutline\"\n\t\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\t\tonClick={(): void => {\n\t\t\t\t\t\t\t\t\tsetActiveReminder(reminderItem);\n\t\t\t\t\t\t\t\t\ttoggleModal();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<Tooltip placement=\"top\" label={t('label.snooze', 'Snooze')}>\n\t\t\t\t\t\t\t<Dropdown items={reminderItems} placement=\"bottom-end\">\n\t\t\t\t\t\t\t\t<IconButton icon=\"Flip2Outline\" size=\"large\" onClick={noop} />\n\t\t\t\t\t\t\t</Dropdown>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t)}\n\t\t\t\t\t<Tooltip placement=\"top\" label={t('label.dismiss', 'Dismiss').toUpperCase()}>\n\t\t\t\t\t\t<IconButton icon=\"BellOffOutline\" size=\"large\" onClick={dismissReminder} />\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</Row>\n\t\t\t</Row>\n\t\t</Container>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { useMemo } from 'react';\n\nimport { DropdownItem } from '@zextras/carbonio-design-system';\nimport { filter } from 'lodash';\nimport moment from 'moment';\nimport { useTranslation } from 'react-i18next';\n\nimport { AlarmType } from '../../types/event';\n\n// interface DropdownItem {\n// \ttype?: 'divider';\n// \tid: string;\n// \tlabel: string;\n// \ticon?: string;\n// \tonClick?: (e: React.SyntheticEvent<HTMLElement> | KeyboardEvent) => void;\n// \tselected?: boolean;\n// \tcustomComponent?: React.ReactNode;\n// \tdisabled?: boolean;\n// \titems?: Array<DropdownItem>;\n// \tkeepOpen?: boolean;\n// }\n//\n// type ReturnType = Array<{\n// \tid: string;\n// \tlabel?: string;\n// \tonClick?: () => void;\n// \tvalue: number;\n// \ttype?: 'divider';\n// }>;\ntype Option = {\n\tid: string;\n\tlabel: string;\n\tvalue: number;\n\tbeforeEvent?: boolean;\n};\nexport const useGetReminderItems = (\n\tsetSnooze: (arg1: number, arg2?: boolean) => void,\n\talarmData: Array<AlarmType>\n): DropdownItem[] => {\n\tconst [t] = useTranslation();\n\n\tconst diff = useMemo(\n\t\t() => moment(alarmData?.[0]?.alarmInstStart).diff(moment(), 'seconds'),\n\t\t[alarmData]\n\t);\n\tconst beforeList = useMemo(\n\t\t() =>\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tid: t('reminder.at_time_of_event', 'At the time of the event'),\n\t\t\t\t\tlabel: t('reminder.at_time_of_event', 'At the time of the event'),\n\t\t\t\t\tvalue: 0\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: t('reminder.minute_before', {\n\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute before',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes before'\n\t\t\t\t\t}),\n\t\t\t\t\tlabel: t('reminder.minute_before', {\n\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute before',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes before'\n\t\t\t\t\t}),\n\t\t\t\t\tvalue: 60\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: t('reminder.minute_before', {\n\t\t\t\t\t\tcount: 5,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute before',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes before'\n\t\t\t\t\t}),\n\t\t\t\t\tlabel: t('reminder.minute_before', {\n\t\t\t\t\t\tcount: 5,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute before',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes before'\n\t\t\t\t\t}),\n\t\t\t\t\tvalue: 5 * 60\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: t('reminder.minute_before', {\n\t\t\t\t\t\tcount: 10,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute before',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes before'\n\t\t\t\t\t}),\n\t\t\t\t\tlabel: t('reminder.minute_before', {\n\t\t\t\t\t\tcount: 10,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute before',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes before'\n\t\t\t\t\t}),\n\t\t\t\t\tvalue: 10 * 60\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: t('reminder.minute_before', {\n\t\t\t\t\t\tcount: 15,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute before',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes before'\n\t\t\t\t\t}),\n\t\t\t\t\tlabel: t('reminder.minute_before', {\n\t\t\t\t\t\tcount: 15,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute before',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes before'\n\t\t\t\t\t}),\n\t\t\t\t\tvalue: 15 * 60\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: t('reminder.minute_before', {\n\t\t\t\t\t\tcount: 30,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute before',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes before'\n\t\t\t\t\t}),\n\t\t\t\t\tlabel: t('reminder.minute_before', {\n\t\t\t\t\t\tcount: 30,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute before',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes before'\n\t\t\t\t\t}),\n\t\t\t\t\tvalue: 15 * 60\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: t('reminder.hour_before', {\n\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} hour before',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} hours before'\n\t\t\t\t\t}),\n\t\t\t\t\tlabel: t('reminder.hour_before', {\n\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} hour before',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} hours before'\n\t\t\t\t\t}),\n\t\t\t\t\tvalue: 60 * 60\n\t\t\t\t}\n\t\t\t] as Option[],\n\t\t[t]\n\t);\n\n\tconst afterList = useMemo(\n\t\t() =>\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tid: 'reminder_after_1',\n\t\t\t\t\tlabel: t('reminder.minutes', {\n\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute ',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes'\n\t\t\t\t\t}),\n\t\t\t\t\tbeforeEvent: false,\n\t\t\t\t\tvalue: 60\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'reminder_after_5',\n\t\t\t\t\tlabel: t('reminder.minutes', {\n\t\t\t\t\t\tcount: 5,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes'\n\t\t\t\t\t}),\n\t\t\t\t\tbeforeEvent: false,\n\t\t\t\t\tvalue: 5 * 60\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'reminder_after_10',\n\t\t\t\t\tlabel: t('reminder.minutes', {\n\t\t\t\t\t\tcount: 10,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes'\n\t\t\t\t\t}),\n\t\t\t\t\tbeforeEvent: false,\n\t\t\t\t\tvalue: 10 * 60\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'reminder_after_15',\n\t\t\t\t\tlabel: t('reminder.minutes', {\n\t\t\t\t\t\tcount: 15,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes'\n\t\t\t\t\t}),\n\t\t\t\t\tbeforeEvent: false,\n\t\t\t\t\tvalue: 15 * 60\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'reminder_after_30',\n\t\t\t\t\tlabel: t('reminder.minutes', {\n\t\t\t\t\t\tcount: 30,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} minute',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} minutes '\n\t\t\t\t\t}),\n\t\t\t\t\tbeforeEvent: false,\n\t\t\t\t\tvalue: 30 * 60\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'reminder_after_60',\n\t\t\t\t\tlabel: t('reminder.hours', {\n\t\t\t\t\t\tcount: 1,\n\t\t\t\t\t\tdefaultValue_one: '{{count}} hour',\n\t\t\t\t\t\tdefaultValue_other: '{{count}} hours'\n\t\t\t\t\t}),\n\t\t\t\t\tbeforeEvent: false,\n\t\t\t\t\tvalue: 60 * 60\n\t\t\t\t}\n\t\t\t] as Option[],\n\t\t[t]\n\t);\n\n\treturn useMemo(() => {\n\t\tconst createDropDownItem = (option: Option): DropdownItem => ({\n\t\t\tid: option.id,\n\t\t\tlabel: option.label,\n\t\t\tonClick: (): void => setSnooze(option.value / 60, option.beforeEvent ?? true)\n\t\t});\n\n\t\treturn [\n\t\t\t...filter(beforeList, (item) => item.value <= diff).map((option) =>\n\t\t\t\tcreateDropDownItem(option)\n\t\t\t),\n\t\t\t{\n\t\t\t\tid: 'reminder_divider',\n\t\t\t\tlabel: '',\n\t\t\t\ttype: 'divider'\n\t\t\t},\n\t\t\t...afterList.map((option) => createDropDownItem(option))\n\t\t];\n\t}, [afterList, beforeList, diff, setSnooze]);\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement } from 'react';\n\nimport { Container, Padding, Text } from '@zextras/carbonio-design-system';\nimport { useTranslation } from 'react-i18next';\n\nimport ModalFooter from '../../commons/modal-footer';\nimport { ModalHeader } from '../../commons/modal-header';\nimport { SetNewTimeModalProps } from '../../types/appointment-reminder';\n\nexport const SetNewAppointmentTimeModal: FC<SetNewTimeModalProps> = ({\n\ttoggleModal,\n\tsetNewTime\n}): ReactElement => {\n\tconst [t] = useTranslation();\n\n\treturn (\n\t\t<Container mainAlignment=\"center\" crossAlignment=\"flex-start\" height=\"fit\">\n\t\t\t<ModalHeader title={t('label.set_new_time', 'Set new time')} />\n\t\t\t<Padding vertical=\"extrasmall\" />\n\t\t\t<Container padding={{ vertical: 'medium' }}>\n\t\t\t\t<Text overflow=\"break-word\">{t('reminder.modal.set_new_time_message')}</Text>\n\t\t\t</Container>\n\t\t\t<ModalFooter\n\t\t\t\tonConfirm={setNewTime}\n\t\t\t\tsecondaryAction={toggleModal}\n\t\t\t\tsecondaryLabel={t('folder.modal.footer.go_back', 'Go back')}\n\t\t\t\tlabel={t('label.ok', 'OK')}\n\t\t\t/>\n\t\t</Container>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { ReactElement, useCallback, useMemo, useState } from 'react';\n\nimport { Container, CustomModal } from '@zextras/carbonio-design-system';\nimport { addBoard, Board, t } from '@zextras/carbonio-shell-ui';\nimport { isEmpty, map, omit } from 'lodash';\nimport moment from 'moment';\n\nimport { AppointmentReminderItem } from './appointment-reminder-item';\nimport { SetNewAppointmentTimeModal } from './set-new-appointment-time-modal';\nimport { useFoldersMap } from '../../carbonio-ui-commons/store/zustand/folder';\nimport { generateEditor } from '../../commons/editor-generator';\nimport ModalFooter from '../../commons/modal-footer';\nimport { ModalHeader } from '../../commons/modal-header';\nimport { CALENDAR_ROUTE } from '../../constants';\nimport { normalizeInvite } from '../../normalizations/normalize-invite';\nimport { dismissApptReminder } from '../../store/actions/dismiss-appointment-reminder';\nimport { getInvite } from '../../store/actions/get-invite';\nimport { useAppDispatch } from '../../store/redux/hooks';\nimport { ReminderItem, Reminders } from '../../types/appointment-reminder';\n\nexport const ReminderModal = ({\n\treminders,\n\tsetReminders\n}: {\n\treminders: Reminders;\n\tsetReminders: (arg: Reminders) => void;\n}): ReactElement => {\n\tconst [showNewTimeModal, setShowNewTimeModal] = useState(false);\n\tconst [activeReminder, setActiveReminder] = useState<ReminderItem | undefined>(undefined);\n\tconst toggleModal = useCallback(() => setShowNewTimeModal(!showNewTimeModal), [showNewTimeModal]);\n\tconst dispatch = useAppDispatch();\n\tconst calendarFolders = useFoldersMap();\n\tconst openModal = useMemo(() => !isEmpty(reminders), [reminders]);\n\n\tconst dismissAll = useCallback(() => {\n\t\tconst dismissItems = map(reminders, (a) => ({\n\t\t\tid: a.id,\n\t\t\tdismissedAt: moment().valueOf()\n\t\t}));\n\t\tsetShowNewTimeModal(false);\n\t\tif (dismissItems.length > 0) {\n\t\t\tdispatch(dismissApptReminder({ dismissItems }));\n\t\t\tsetReminders({});\n\t\t}\n\t}, [dispatch, reminders, setReminders]);\n\n\tconst removeFromAppList = useCallback(\n\t\t(key: string) => {\n\t\t\tconst tmp = omit(reminders, key);\n\t\t\tsetReminders(tmp);\n\t\t},\n\t\t[reminders, setReminders]\n\t);\n\n\tconst setNewTime = useCallback(() => {\n\t\tif (activeReminder) {\n\t\t\tdispatch(getInvite({ inviteId: activeReminder.inviteId })).then(({ payload }) => {\n\t\t\t\tif (payload) {\n\t\t\t\t\tconst invite = normalizeInvite(payload.m?.[0]);\n\t\t\t\t\tconst event = {\n\t\t\t\t\t\tresource: {\n\t\t\t\t\t\t\tcalendar: activeReminder.calendar,\n\t\t\t\t\t\t\tisRecurrent: activeReminder.isRecurrent,\n\t\t\t\t\t\t\tisException: !!activeReminder.isException,\n\t\t\t\t\t\t\tlocation: activeReminder.location,\n\t\t\t\t\t\t\tinviteId: activeReminder.inviteId,\n\t\t\t\t\t\t\tid: activeReminder.id\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttitle: activeReminder.name,\n\t\t\t\t\t\tallDay: activeReminder.allDay,\n\t\t\t\t\t\tstart: activeReminder.start,\n\t\t\t\t\t\tend: activeReminder.end\n\t\t\t\t\t};\n\t\t\t\t\tconst editor = generateEditor({\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\tinvite,\n\t\t\t\t\t\tcontext: {\n\t\t\t\t\t\t\tdispatch,\n\t\t\t\t\t\t\tfolders: calendarFolders,\n\t\t\t\t\t\t\tpanel: false\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\taddBoard({\n\t\t\t\t\t\turl: `${CALENDAR_ROUTE}/`,\n\t\t\t\t\t\ttitle: editor?.title ?? '',\n\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\teditor\n\t\t\t\t\t} as unknown as Board);\n\t\t\t\t\tdismissAll();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}, [activeReminder, calendarFolders, dismissAll, dispatch]);\n\n\tconst headerLabel = useMemo(\n\t\t() =>\n\t\t\tt(`label.appt_reminder`, {\n\t\t\t\tcount: Object.keys(reminders)?.length ?? 1,\n\t\t\t\tdefaultValue_one: 'Appointment Reminder',\n\t\t\t\tdefaultValue_other: 'Appointment Reminders'\n\t\t\t}),\n\t\t[reminders]\n\t);\n\n\tconst footerLabel = useMemo(\n\t\t() =>\n\t\t\tt('label.dismiss', {\n\t\t\t\tcount: Object.keys(reminders)?.length ?? 1,\n\t\t\t\tdefaultValue_one: 'Dismiss',\n\t\t\t\tdefaultValue_other: 'Dismiss all'\n\t\t\t}),\n\t\t[reminders]\n\t);\n\n\treturn (\n\t\t<CustomModal\n\t\t\topen={openModal}\n\t\t\tonClose={(): null => null}\n\t\t\tmaxHeight=\"90vh\"\n\t\t\tdata-testid=\"reminder-modal\"\n\t\t>\n\t\t\t{showNewTimeModal ? (\n\t\t\t\t<SetNewAppointmentTimeModal toggleModal={toggleModal} setNewTime={setNewTime} />\n\t\t\t) : (\n\t\t\t\t<Container\n\t\t\t\t\tpadding={{ all: 'small' }}\n\t\t\t\t\tmainAlignment=\"center\"\n\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\theight=\"fit\"\n\t\t\t\t\twidth=\"100%\"\n\t\t\t\t>\n\t\t\t\t\t<ModalHeader title={headerLabel} />\n\t\t\t\t\t<Container maxHeight=\"20rem\" style={{ overflow: 'auto', display: 'block' }}>\n\t\t\t\t\t\t{map(reminders, (reminder) => (\n\t\t\t\t\t\t\t<AppointmentReminderItem\n\t\t\t\t\t\t\t\treminderItem={reminder}\n\t\t\t\t\t\t\t\tkey={reminder.key}\n\t\t\t\t\t\t\t\tremoveReminder={removeFromAppList}\n\t\t\t\t\t\t\t\ttoggleModal={toggleModal}\n\t\t\t\t\t\t\t\tsetActiveReminder={setActiveReminder}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</Container>\n\t\t\t\t\t<ModalFooter label={footerLabel} onConfirm={dismissAll} />\n\t\t\t\t</Container>\n\t\t\t)}\n\t\t</CustomModal>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { ReactElement, useState, useEffect, useMemo } from 'react';\n\nimport { FOLDERS } from '@zextras/carbonio-shell-ui';\nimport { compact, filter, find, forEach, includes, isEmpty, map, reduce } from 'lodash';\nimport moment from 'moment';\n\nimport { ReminderModal } from './reminder-modal';\nimport sound from '../../assets/notification.mp3';\nimport { useFoldersMap } from '../../carbonio-ui-commons/store/zustand/folder';\nimport { LinkFolder } from '../../carbonio-ui-commons/types/folder';\nimport { getTimeToDisplayData } from '../../commons/utilities';\nimport { useCheckedCalendarsQuery } from '../../hooks/use-checked-calendars-query';\nimport { normalizeReminderItem } from '../../normalizations/normalize-reminder';\nimport { searchAppointments } from '../../store/actions/search-appointments';\nimport { useAppDispatch, useAppSelector } from '../../store/redux/hooks';\nimport { selectAppointmentsArray, selectApptStatus } from '../../store/selectors/appointments';\nimport { useRangeEnd, useRangeStart } from '../../store/zustand/hooks';\nimport { ReminderItem, Reminders } from '../../types/appointment-reminder';\nimport { showNotification } from '../notifications';\n\nexport const AppointmentReminder = (): ReactElement | null => {\n\tconst [reminders, setReminders] = useState<Reminders>({});\n\tconst appointments = useAppSelector(selectAppointmentsArray);\n\tconst status = useAppSelector(selectApptStatus);\n\tconst dispatch = useAppDispatch();\n\tconst start = useRangeStart();\n\tconst end = useRangeEnd();\n\tconst query = useCheckedCalendarsQuery();\n\n\tconst calendars = useFoldersMap();\n\n\tconst alarms = useMemo(() => {\n\t\tconst appts = filter(appointments, 'alarmData');\n\t\treturn compact(\n\t\t\tmap(appts, (appt) => {\n\t\t\t\tconst isShared = appt?.l?.includes(':');\n\t\t\t\tconst defaultCalendar = calendars?.['10'];\n\t\t\t\tconst cal = isShared\n\t\t\t\t\t? find(calendars, (f) => `${(f as LinkFolder).zid}:${(f as LinkFolder).rid}` === appt.l)\n\t\t\t\t\t: find(calendars, (f) => f.id === appt.l);\n\t\t\t\treturn normalizeReminderItem({ calendar: cal ?? defaultCalendar, appointment: appt });\n\t\t\t})\n\t\t);\n\t}, [appointments, calendars]);\n\n\tconst notificationAudio = useMemo(() => new Audio(sound), []);\n\n\tconst reminderRange = useMemo(\n\t\t() => ({\n\t\t\tstart: moment().subtract('7', 'days').valueOf(),\n\t\t\tend: moment().add('15', 'days').valueOf()\n\t\t}),\n\t\t[]\n\t);\n\n\tconst appointmentsToRemind = useMemo(\n\t\t() =>\n\t\t\tfilter(\n\t\t\t\talarms ?? [],\n\t\t\t\t(appt) =>\n\t\t\t\t\tappt?.alarmData?.length &&\n\t\t\t\t\tappt?.alarmData?.[0]?.nextAlarm &&\n\t\t\t\t\tappt?.alarmData?.[0]?.nextAlarm > reminderRange?.start &&\n\t\t\t\t\tmoment(appt?.alarmData?.[0]?.nextAlarm).isSameOrAfter(moment(reminderRange?.start)) &&\n\t\t\t\t\tmoment(appt?.alarmData?.[0]?.nextAlarm).isSameOrBefore(moment(reminderRange?.end)) &&\n\t\t\t\t\t!includes(appt?.inviteId, ':') &&\n\t\t\t\t\tappt?.calendar?.id !== FOLDERS.TRASH\n\t\t\t) as ReminderItem[],\n\t\t[alarms, reminderRange?.end, reminderRange?.start]\n\t);\n\n\tuseEffect(() => {\n\t\tif (status === 'init' && !isEmpty(calendars)) {\n\t\t\tdispatch(searchAppointments({ spanEnd: end, spanStart: start, query }));\n\t\t}\n\t}, [calendars, dispatch, end, query, start, status]);\n\n\tuseEffect(() => {\n\t\tconst interval = setInterval(() => {\n\t\t\tconst remindersToNotify = [] as Array<ReminderItem>;\n\t\t\tconst newValue = reduce(\n\t\t\t\tappointmentsToRemind,\n\t\t\t\t(acc, reminder) => {\n\t\t\t\t\tconst difference = moment(reminder?.alarmData?.[0]?.nextAlarm).diff(\n\t\t\t\t\t\tmoment(),\n\t\t\t\t\t\t'seconds',\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t\tif (difference <= 0) {\n\t\t\t\t\t\tconst isAlreadyAdded = find(reminders, {\n\t\t\t\t\t\t\tstart: reminder.start,\n\t\t\t\t\t\t\tkey: reminder.key,\n\t\t\t\t\t\t\tend: reminder.end\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (!isAlreadyAdded) {\n\t\t\t\t\t\t\tremindersToNotify.push(reminder);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn { ...acc, [reminder.key]: reminder };\n\t\t\t\t\t}\n\t\t\t\t\treturn acc;\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t);\n\t\t\tsetReminders(newValue);\n\t\t\tif (remindersToNotify?.length > 0) {\n\t\t\t\tnotificationAudio.play();\n\t\t\t\tforEach(remindersToNotify, (rem) => {\n\t\t\t\t\tconst { text } = getTimeToDisplayData(rem, moment().valueOf());\n\t\t\t\t\tshowNotification(rem?.name, text);\n\t\t\t\t});\n\t\t\t}\n\t\t}, 1000);\n\t\treturn () => clearInterval(interval);\n\t}, [appointmentsToRemind, notificationAudio, reminders]);\n\n\treturn !isEmpty(reminders) ? (\n\t\t<ReminderModal reminders={reminders} setReminders={setReminders} />\n\t) : null;\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { getUserAccount } from '@zextras/carbonio-shell-ui';\n\nimport { Folder } from '../carbonio-ui-commons/types/folder';\nimport { ReminderItem } from '../types/appointment-reminder';\nimport { Appointment } from '../types/store/appointments';\n\nexport const normalizeReminderItem = ({\n\tappointment,\n\tcalendar\n}: {\n\tappointment: Appointment;\n\tcalendar: Folder;\n}): ReminderItem | undefined => {\n\tif (appointment.alarmData) {\n\t\tconst user = getUserAccount();\n\t\tconst iAmOrganizer =\n\t\t\tappointment?.or?.a && user?.name ? appointment?.or?.a === user?.name : false;\n\t\treturn {\n\t\t\tstart: new Date(appointment?.alarmData?.[0]?.alarmInstStart),\n\t\t\tkey: `${appointment?.id}-${appointment?.alarmData?.[0]?.alarmInstStart}`,\n\t\t\tisRecurrent: appointment.recur,\n\t\t\tend: new Date(appointment.alarmData[0].alarmInstStart + appointment.dur),\n\t\t\talarmData: appointment.alarmData,\n\t\t\tlocation: appointment.loc,\n\t\t\tname: appointment.name,\n\t\t\tisOrg: iAmOrganizer,\n\t\t\tid: appointment.id,\n\t\t\tinviteId: appointment.inviteId,\n\t\t\tcalendar,\n\t\t\tisException: appointment.hasEx,\n\t\t\tallDay: appointment.allDay\n\t\t};\n\t}\n\treturn undefined;\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { useEffect, useState } from 'react';\n\nimport { useNotify, useRefresh } from '@zextras/carbonio-shell-ui';\nimport { isEmpty, reduce, forEach, sortBy } from 'lodash';\n\nimport { useCheckedCalendarsQuery } from '../../hooks/use-checked-calendars-query';\nimport { searchAppointments } from '../../store/actions/search-appointments';\nimport { useAppDispatch } from '../../store/redux/hooks';\nimport {\n\thandleDeletedAppointments,\n\thandleModifiedAppointments\n} from '../../store/slices/appointments-slice';\nimport { handleModifiedInvites } from '../../store/slices/invites-slice';\nimport { useRangeEnd, useRangeStart } from '../../store/zustand/hooks';\n\nexport const SyncDataHandler = () => {\n\tconst refresh = useRefresh();\n\tconst notifyList = useNotify();\n\tconst [seq, setSeq] = useState(-1);\n\tconst dispatch = useAppDispatch();\n\tconst start = useRangeStart();\n\tconst end = useRangeEnd();\n\tconst [initialized, setInitialized] = useState(false);\n\tconst query = useCheckedCalendarsQuery();\n\n\tuseEffect(() => {\n\t\tif (!isEmpty(refresh) && !initialized) {\n\t\t\tsetInitialized(true);\n\t\t}\n\t}, [dispatch, initialized, refresh]);\n\n\tuseEffect(() => {\n\t\tif (notifyList.length > 0) {\n\t\t\tforEach(sortBy(notifyList, 'seq'), (notify) => {\n\t\t\t\tif (!isEmpty(notify) && (notify.seq > seq || (seq > 1 && notify.seq === 1))) {\n\t\t\t\t\tif (notify.created && notify.created.appt) {\n\t\t\t\t\t\tdispatch(searchAppointments({ spanEnd: end, spanStart: start, query }));\n\t\t\t\t\t}\n\t\t\t\t\tif (notify.modified && notify.modified.appt) {\n\t\t\t\t\t\t// probably unnecessary\n\t\t\t\t\t\tconst apptToUpdate = reduce(\n\t\t\t\t\t\t\tnotify.modified.appt,\n\t\t\t\t\t\t\t(acc, v) => {\n\t\t\t\t\t\t\t\tif (v.l) {\n\t\t\t\t\t\t\t\t\treturn [...acc, v];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn acc;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t[]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (apptToUpdate?.length > 0) {\n\t\t\t\t\t\t\tdispatch(handleModifiedAppointments(apptToUpdate));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdispatch(searchAppointments({ spanEnd: end, spanStart: start, query }));\n\n\t\t\t\t\t\tconst invites = reduce(\n\t\t\t\t\t\t\tnotify.modified.appt,\n\t\t\t\t\t\t\t(acc, v) => {\n\t\t\t\t\t\t\t\tif (v?.inv?.length > 0) {\n\t\t\t\t\t\t\t\t\treturn [...acc, ...v.inv];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn acc;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t[]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (invites?.length > 0) {\n\t\t\t\t\t\t\tdispatch(handleModifiedInvites(invites));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (notify.deleted) {\n\t\t\t\t\t\tdispatch(handleDeletedAppointments(notify.deleted));\n\t\t\t\t\t}\n\t\t\t\t\tsetSeq(notify.seq);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}, [dispatch, end, notifyList, query, seq, start]);\n\n\treturn null;\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React, { lazy, useEffect, Suspense } from 'react';\n\nimport { ModalManager } from '@zextras/carbonio-design-system';\nimport {\n\tSpinner,\n\taddRoute,\n\taddSettingsView,\n\taddSearchView,\n\taddBoardView,\n\tregisterActions,\n\tregisterComponents,\n\tACTION_TYPES,\n\tregisterFunctions,\n\tSearchViewProps,\n\tSecondaryBarComponentProps\n} from '@zextras/carbonio-shell-ui';\nimport { AnyFunction } from '@zextras/carbonio-shell-ui/lib/utils/typeUtils';\nimport { useTranslation } from 'react-i18next';\n\nimport { FOLDER_VIEW } from './carbonio-ui-commons/constants';\nimport { useFoldersController } from './carbonio-ui-commons/hooks/use-folders-controller';\nimport { useFoldersMap } from './carbonio-ui-commons/store/zustand/folder';\nimport { CALENDAR_APP_ID, CALENDAR_ROUTE } from './constants';\nimport { useOnClickNewButton } from './hooks/on-click-new-button';\nimport { getSettingsSubSections } from './settings/sub-sections';\nimport { createAppointmentIntegration } from './shared/create-apppointment-integration';\nimport InviteResponseComp from './shared/invite-response/invite-response';\nimport { StoreProvider } from './store/redux';\nimport { useAppDispatch } from './store/redux/hooks';\nimport { CalendarIntegrations } from './types/enums/event-actions-enum';\nimport Notifications from './view/notifications';\nimport { AppointmentReminder } from './view/reminder/appointment-reminder';\nimport { SyncDataHandler } from './view/sidebar/sync-data-handler';\n\nconst LazyCalendarView = lazy(\n\t() => import(/* webpackChunkName: \"calendar-view\" */ './view/calendar/calendar-view')\n);\n\nconst LazyEditorView = lazy(\n\t() => import(/* webpackChunkName: \"calendar-edit\" */ './view/editor/editor-board-wrapper')\n);\nconst LazySettingsView = lazy(\n\t() => import(/* webpackChunkName: \"settings-view\" */ './settings/settings-view')\n);\nconst LazySidebarView = lazy(\n\t() => import(/* webpackChunkName: \"sidebar-view\" */ './view/sidebar/sidebar')\n);\nconst LazySearchView = lazy(\n\t() => import(/* webpackChunkName: \"search-view\" */ './view/search/search-view')\n);\n\nconst CalendarView = (): React.JSX.Element => (\n\t<Suspense fallback={<Spinner />}>\n\t\t<StoreProvider>\n\t\t\t<ModalManager>\n\t\t\t\t<LazyCalendarView />\n\t\t\t</ModalManager>\n\t\t</StoreProvider>\n\t</Suspense>\n);\n\nconst EditorView = (): React.JSX.Element => (\n\t<Suspense fallback={<Spinner />}>\n\t\t<StoreProvider>\n\t\t\t<ModalManager>\n\t\t\t\t<LazyEditorView />\n\t\t\t</ModalManager>\n\t\t</StoreProvider>\n\t</Suspense>\n);\nconst SettingsView = (): React.JSX.Element => (\n\t<Suspense fallback={<Spinner />}>\n\t\t<StoreProvider>\n\t\t\t<ModalManager>\n\t\t\t\t<LazySettingsView />\n\t\t\t</ModalManager>\n\t\t</StoreProvider>\n\t</Suspense>\n);\n\nconst SidebarView = (props: SecondaryBarComponentProps): React.JSX.Element => (\n\t<Suspense fallback={<Spinner />}>\n\t\t<StoreProvider>\n\t\t\t<ModalManager>\n\t\t\t\t<LazySidebarView {...props} />{' '}\n\t\t\t</ModalManager>\n\t\t</StoreProvider>\n\t</Suspense>\n);\n\nconst SearchView = (props: SearchViewProps): React.JSX.Element => (\n\t<Suspense fallback={<Spinner />}>\n\t\t<StoreProvider>\n\t\t\t<ModalManager>\n\t\t\t\t<LazySearchView {...props} />{' '}\n\t\t\t</ModalManager>\n\t\t</StoreProvider>\n\t</Suspense>\n);\n\nconst AppRegistrations = (): null => {\n\tconst onClickNewButton = useOnClickNewButton();\n\tconst calendars = useFoldersMap();\n\tconst dispatch = useAppDispatch();\n\tconst [t] = useTranslation();\n\n\tuseEffect(() => {\n\t\tconst appLabel = t('label.app_name', 'Calendars');\n\t\taddRoute({\n\t\t\troute: CALENDAR_ROUTE,\n\t\t\tposition: 200,\n\t\t\tvisible: true,\n\t\t\tlabel: appLabel,\n\t\t\tprimaryBar: 'CalendarModOutline',\n\t\t\tsecondaryBar: SidebarView,\n\t\t\tappView: CalendarView\n\t\t});\n\t\taddSettingsView({\n\t\t\troute: CALENDAR_ROUTE,\n\t\t\tlabel: appLabel,\n\t\t\tcomponent: SettingsView,\n\t\t\tsubSections: getSettingsSubSections()\n\t\t});\n\t\taddSearchView({\n\t\t\troute: CALENDAR_ROUTE,\n\t\t\tlabel: appLabel,\n\t\t\tcomponent: SearchView\n\t\t});\n\t\taddBoardView({\n\t\t\troute: CALENDAR_ROUTE,\n\t\t\tcomponent: EditorView\n\t\t});\n\t}, [t]);\n\n\tuseEffect(() => {\n\t\tregisterFunctions({\n\t\t\tid: CalendarIntegrations.CREATE_APPOINTMENT,\n\t\t\tfn: createAppointmentIntegration(dispatch, calendars) as AnyFunction\n\t\t});\n\t\tregisterActions({\n\t\t\taction: () => ({\n\t\t\t\tid: 'new-appointment',\n\t\t\t\tlabel: t('label.new_appointment', 'New Appointment'),\n\t\t\t\ticon: 'CalendarModOutline',\n\t\t\t\tonClick: onClickNewButton,\n\t\t\t\tdisabled: false,\n\t\t\t\tgroup: CALENDAR_APP_ID,\n\t\t\t\tprimary: true\n\t\t\t}),\n\t\t\tid: 'new-appointment',\n\t\t\ttype: ACTION_TYPES.NEW\n\t\t});\n\t\tregisterComponents({\n\t\t\tid: 'invites-reply',\n\t\t\tcomponent: InviteResponseComp\n\t\t});\n\t}, [calendars, dispatch, onClickNewButton, t]);\n\n\treturn null;\n};\n\nexport default function App(): React.JSX.Element {\n\tuseFoldersController(FOLDER_VIEW.appointment);\n\treturn (\n\t\t<StoreProvider>\n\t\t\t<AppRegistrations />\n\t\t\t<AppointmentReminder />\n\t\t\t<SyncDataHandler />\n\t\t\t<Notifications />\n\t\t</StoreProvider>\n\t);\n}\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { SyntheticEvent, useCallback } from 'react';\n\nimport { addBoard } from '@zextras/carbonio-shell-ui';\n\nimport { useFoldersMap } from '../carbonio-ui-commons/store/zustand/folder';\nimport { generateEditor } from '../commons/editor-generator';\nimport { CALENDAR_ROUTE } from '../constants';\nimport { useAppDispatch } from '../store/redux/hooks';\n\nexport const useOnClickNewButton = (): ((\n\tev?: SyntheticEvent<HTMLElement, Event> | KeyboardEvent\n) => void) => {\n\tconst calendarFolders = useFoldersMap();\n\tconst dispatch = useAppDispatch();\n\n\treturn useCallback(\n\t\t(ev) => {\n\t\t\tev?.preventDefault?.();\n\t\t\tconst editor = generateEditor({\n\t\t\t\tcontext: {\n\t\t\t\t\tpanel: false,\n\t\t\t\t\tdispatch,\n\t\t\t\t\tfolders: calendarFolders\n\t\t\t\t}\n\t\t\t});\n\n\t\t\taddBoard({\n\t\t\t\turl: `${CALENDAR_ROUTE}/`,\n\t\t\t\ttitle: editor.title ?? '',\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\teditor\n\t\t\t});\n\t\t},\n\t\t[calendarFolders, dispatch]\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n/* eslint-disable @typescript-eslint/ban-ts-comment */\n/* eslint-disable import/extensions */\n\nimport React, { FC, ReactElement, useMemo } from 'react';\n\nimport { Container, Button, Padding, Divider, Tooltip } from '@zextras/carbonio-design-system';\nimport { useTranslation } from 'react-i18next';\n\nimport type { ModalFooterProps } from '../../types';\n\nconst ModalFooter: FC<ModalFooterProps> = ({\n\tmainAlignment = 'center',\n\tcrossAlignment = 'center',\n\tonConfirm,\n\tlabel,\n\tsecondaryAction,\n\tsecondaryLabel,\n\tprimaryBtnType = 'default',\n\tsecondaryBtnType = 'default',\n\tdisabled,\n\tsecondaryDisabled,\n\tbackground = 'primary',\n\tsecondarybackground,\n\tcolor = 'primary',\n\tsecondaryColor = 'secondary',\n\tsize = 'medium',\n\tshowDivider = true,\n\ttooltip,\n\tsecondaryTooltip,\n\tpaddingTop = 'medium',\n\tadditionalAction,\n\tadditionalBtnType = 'outlined',\n\tadditionalColor = 'secondary',\n\tadditionalLabel,\n\tprimaryButtonIcon\n}): ReactElement => {\n\tconst [t] = useTranslation();\n\n\tconst cancelLabel = useMemo(() => t('label.cancel', 'cancel'), [t]);\n\n\treturn (\n\t\t<Container\n\t\t\tmainAlignment={mainAlignment}\n\t\t\tcrossAlignment={crossAlignment}\n\t\t\tpadding={{\n\t\t\t\ttop: paddingTop\n\t\t\t}}\n\t\t>\n\t\t\t{showDivider && (\n\t\t\t\t<Container\n\t\t\t\t\tpadding={{ top: 'small', bottom: 'small' }}\n\t\t\t\t\tmainAlignment=\"center\"\n\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t\theight=\"fit\"\n\t\t\t\t>\n\t\t\t\t\t<Divider />\n\t\t\t\t</Container>\n\t\t\t)}\n\t\t\t<Container orientation=\"horizontal\" mainAlignment=\"space-between\">\n\t\t\t\t{additionalAction && (\n\t\t\t\t\t<Container orientation=\"horizontal\" width=\"fit\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tcolor={additionalColor}\n\t\t\t\t\t\t\ttype={additionalBtnType}\n\t\t\t\t\t\t\tonClick={additionalAction}\n\t\t\t\t\t\t\tlabel={additionalLabel ?? cancelLabel}\n\t\t\t\t\t\t\tsize={size}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Padding horizontal=\"extrasmall\" />\n\t\t\t\t\t</Container>\n\t\t\t\t)}\n\t\t\t\t<Container\n\t\t\t\t\tpadding={{ top: 'small', bottom: 'small' }}\n\t\t\t\t\tmainAlignment=\"flex-end\"\n\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t\theight=\"fit\"\n\t\t\t\t>\n\t\t\t\t\t{secondaryAction && (\n\t\t\t\t\t\t<Padding right=\"small\" vertical=\"small\">\n\t\t\t\t\t\t\t{secondaryTooltip ? (\n\t\t\t\t\t\t\t\t<Tooltip label={secondaryTooltip} placement=\"top\" maxWidth=\"fit\">\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\tbackgroundColor={secondarybackground}\n\t\t\t\t\t\t\t\t\t\tcolor={secondaryColor}\n\t\t\t\t\t\t\t\t\t\ttype={secondaryBtnType}\n\t\t\t\t\t\t\t\t\t\tonClick={secondaryAction}\n\t\t\t\t\t\t\t\t\t\tlabel={secondaryLabel ?? cancelLabel}\n\t\t\t\t\t\t\t\t\t\tdisabled={secondaryDisabled}\n\t\t\t\t\t\t\t\t\t\tsize={size}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tbackgroundColor={secondarybackground}\n\t\t\t\t\t\t\t\t\tcolor={secondaryColor}\n\t\t\t\t\t\t\t\t\ttype={secondaryBtnType}\n\t\t\t\t\t\t\t\t\tonClick={secondaryAction}\n\t\t\t\t\t\t\t\t\tlabel={secondaryLabel ?? cancelLabel}\n\t\t\t\t\t\t\t\t\tdisabled={secondaryDisabled}\n\t\t\t\t\t\t\t\t\tsize={size}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Padding>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<Padding vertical=\"small\">\n\t\t\t\t\t\t{tooltip ? (\n\t\t\t\t\t\t\t<Tooltip label={tooltip} placement=\"top\" maxWidth=\"fit\">\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tsize={size}\n\t\t\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\t\t\tonClick={onConfirm}\n\t\t\t\t\t\t\t\t\tlabel={label}\n\t\t\t\t\t\t\t\t\ttype={primaryBtnType}\n\t\t\t\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\t\t\t\tbackgroundColor={color || background}\n\t\t\t\t\t\t\t\t\ticon={primaryButtonIcon}\n\t\t\t\t\t\t\t\t\ticonPlacement=\"left\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tsize={size}\n\t\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\t\tonClick={onConfirm}\n\t\t\t\t\t\t\t\tlabel={label}\n\t\t\t\t\t\t\t\ttype={primaryBtnType}\n\t\t\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\t\t\tbackgroundColor={color || background}\n\t\t\t\t\t\t\t\ticon={primaryButtonIcon}\n\t\t\t\t\t\t\t\ticonPlacement=\"left\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Padding>\n\t\t\t\t</Container>\n\t\t\t</Container>\n\t\t</Container>\n\t);\n};\nexport default ModalFooter;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC } from 'react';\n\nimport {\n\tDivider,\n\tText,\n\tRow,\n\tIconButton,\n\tPadding,\n\tContainer\n} from '@zextras/carbonio-design-system';\n\nconst ModalHeader: FC<{ title: string; onClose?: () => void; showCloseIcon?: boolean }> = ({\n\ttitle,\n\tonClose,\n\tshowCloseIcon = true\n}) => (\n\t<Container mainAlignment=\"space-between\" width=\"100%\">\n\t\t<Row takeAvailableSpace mainAlignment=\"space-between\" width=\"100%\">\n\t\t\t<Row width=\"calc(100% - 1.5rem)\" takeAvailableSpace mainAlignment=\"flex-start\">\n\t\t\t\t<Text weight=\"bold\" size=\"large\">\n\t\t\t\t\t{title}\n\t\t\t\t</Text>\n\t\t\t</Row>\n\t\t\t{onClose && showCloseIcon && (\n\t\t\t\t<Row mainAlignment=\"flex-start\">\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\tsize=\"medium\"\n\t\t\t\t\t\tstyle={{ padding: 0, margin: 0 }}\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\ticon=\"CloseOutline\"\n\t\t\t\t\t/>\n\t\t\t\t</Row>\n\t\t\t)}\n\t\t</Row>\n\t\t<Padding top=\"medium\" />\n\t\t<Divider />\n\t\t<Padding bottom=\"medium\" />\n\t</Container>\n);\n\nexport default ModalHeader;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nexport const FOLDER_VIEW = {\n\tsearch_folder: 'search folder',\n\ttag: 'tag',\n\tconversation: 'conversation',\n\tmessage: 'message',\n\tcontact: 'contact',\n\tdocument: 'document',\n\tappointment: 'appointment',\n\tvirtual_conversation: 'virtual conversation',\n\tremote_folder: 'remote folder',\n\twiki: 'wiki',\n\ttask: 'task',\n\tchat: 'chat'\n} as const;\n\n// eslint-disable-next-line no-shadow\nexport enum TagsActionsType {\n\tNEW = 'new',\n\tDELETE = 'delete',\n\tEDIT = 'edit',\n\tApply = 'apply'\n}\n\nexport const DRAG_DATA_TYPE = {\n\tMESSAGE: 'message',\n\tCONVERSATION: 'conversation',\n\tFOLDER: 'folder',\n\tCONTACT: 'contact'\n} as const;\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\nimport { isNil, omitBy } from 'lodash';\n\nimport { FolderView } from '../types/folder';\n\nexport const getFolderRequest = async (\n\t{ id, view }: { id?: string; view?: FolderView },\n\taccount?: string\n): Promise<any> => {\n\tconst body = omitBy(\n\t\t{\n\t\t\t_jsns: 'urn:zimbraMail',\n\t\t\tfolder: id\n\t\t\t\t? {\n\t\t\t\t\t\tl: id\n\t\t\t\t\t}\n\t\t\t\t: undefined,\n\t\t\tview,\n\t\t\ttr: 1\n\t\t},\n\t\tisNil\n\t);\n\treturn soapFetch('GetFolder', body, account);\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { ErrorSoapBodyResponse, soapFetch } from '@zextras/carbonio-shell-ui';\nimport { isEmpty } from 'lodash';\n\nimport { ResFolder } from '../utils';\n\ntype GetShareInfoRequest = {\n\t_jsns: string;\n\tincludeSelf: number;\n};\n\ntype GetShareInfoResponse = {\n\t_jsns: string;\n\tshare: Array<ResFolder>;\n};\n\nexport const getShareInfoRequest = async (): Promise<{\n\tisFulfilled: boolean;\n\tfolders: Array<ResFolder>;\n}> => {\n\tconst result = await soapFetch<GetShareInfoRequest, GetShareInfoResponse | ErrorSoapBodyResponse>(\n\t\t'GetShareInfo',\n\t\t{\n\t\t\t_jsns: 'urn:zimbraAccount',\n\t\t\tincludeSelf: 0\n\t\t}\n\t);\n\n\tif ('Fault' in result) {\n\t\treturn Promise.reject(result.Fault);\n\t}\n\n\treturn Promise.resolve({ isFulfilled: !isEmpty(result), folders: result?.share ?? [] });\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport produce from 'immer';\nimport { create } from 'zustand';\n\nimport { Folder, FolderState } from '../../../types/folder';\nimport { folderWorker } from '../../../worker';\n\n// extra currying as suggested in https://github.com/pmndrs/zustand/blob/main/docs/guides/typescript.md#basic-usage\nexport const useFolderStore = create<FolderState>()((set) => ({\n\tfolders: {},\n\tlinksIdMap: {},\n\tsearches: {},\n\tupdateFolder: (id: string, opt: Partial<Folder>): void => {\n\t\tset(\n\t\t\tproduce((state) => {\n\t\t\t\tif (state?.folders?.[id]) {\n\t\t\t\t\tstate.folders[id] = {\n\t\t\t\t\t\t...state.folders[id],\n\t\t\t\t\t\t...opt\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n}));\n\nfolderWorker.onmessage = ({ data }): void => {\n\tuseFolderStore.setState(data);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { useMemo } from 'react';\n\nimport { FOLDERS, ROOT_NAME } from '@zextras/carbonio-shell-ui';\nimport { filter, find, keyBy, some, values } from 'lodash';\n\nimport { useFolderStore } from './store';\nimport { getFlatChildrenFolders } from './utils';\nimport type { Folder, Folders, LinkFolder, SearchFolder, Searches } from '../../../types';\n\n/**\n * Returns the folder with given ID or undefined\n * @params id */\nexport const useFolder = (id: string): Folder | undefined => useFolderStore((s) => s.folders?.[id]);\n\n/**\n * Returns the folder with given ID or undefined\n * @params id */\nexport const getFolder = (id: string): Folder | undefined =>\n\tuseFolderStore.getState()?.folders?.[id];\n\n/**\n * Returns a folders' map including roots and links. Each folder has its own tree structure included inside its children\n */\nexport const useFoldersMap = (): Folders => useFolderStore((s) => s.folders);\n\n/**\n * Returns a folders' map including roots and links. Each folder has its own tree structure included inside its children\n */\nexport const getFoldersMap = (): Folders => useFolderStore.getState().folders;\n\n/**\n * Returns a folders' array including only links. Each folder has its own tree structure included inside its children\n */\nexport const getLinksArray = (view?: string): Array<LinkFolder> =>\n\tfilter(values(useFolderStore.getState().folders), (folder: Folder) => {\n\t\tif (view && folder.view !== view) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn folder.isLink;\n\t}) as Array<LinkFolder>;\n\n/**\n * Returns the root folder id for a given folder\n * @param folder a Folder or LinkFolder\n * @returns the root folder id or null if the folder is not a link or the root folder\n */\nfunction getRootFolderId(folder: Folder | LinkFolder): string {\n\tconst parent = folder?.parent && getFolder(folder.parent);\n\tif ('oname' in folder && folder?.oname === ROOT_NAME) {\n\t\treturn folder.id;\n\t}\n\tif (parent) {\n\t\treturn getRootFolderId(parent);\n\t}\n\treturn folder.id;\n}\n\n/**\n * Returns the root folder of the provided folderId or undefined\n * @params id\n * @returns the root folder or undefined\n * */\nexport const useRoot = (id: string): Folder | undefined =>\n\tuseFolderStore((s) => {\n\t\tconst folder = s.folders?.[id];\n\t\tif (folder) {\n\t\t\tconst rootFolderId = getRootFolderId(folder);\n\t\t\treturn s.folders?.[rootFolderId];\n\t\t}\n\t\treturn undefined;\n\t});\n\n/**\n * Returns the root folder of the provided folderId or undefined\n * @params id\n * @returns the root folder or undefined\n * */\nexport const getRoot = (id: string): Folder | undefined => {\n\tconst folder = useFolderStore.getState().folders?.[id];\n\tif (folder) {\n\t\tconst rootFolderId = getRootFolderId(folder);\n\t\treturn useFolderStore.getState().folders?.[rootFolderId];\n\t}\n\treturn undefined;\n};\n\n/**\n * Returns a roots' array. Each root has its own tree structure included inside its children\n */\nexport const useRootsArray = (): Array<Folder> =>\n\tuseFolderStore((s) => filter(s.folders, (f) => f.id?.split(':')?.includes(FOLDERS.USER_ROOT)));\n\n/**\n * Returns a roots' array. Each root has its own tree structure included inside its children\n */\nexport const getRootsArray = (): Array<Folder> =>\n\tfilter(useFolderStore.getState().folders, (f) => f.id?.split(':')?.includes(FOLDERS.USER_ROOT));\n\n/**\n * Returns a roots' map. Each root has its own tree structure included inside its children\n */\nexport const useRootsMap = (): Record<string, Folder> =>\n\tuseFolderStore((s) =>\n\t\tkeyBy(\n\t\t\tfilter(s.folders, (f) => f.id?.split(':')?.includes(FOLDERS.USER_ROOT)),\n\t\t\t'id'\n\t\t)\n\t);\n\n/**\n * Returns a roots' map. Each root has its own tree structure included inside its children\n */\nexport const getRootsMap = (): Record<string, Folder> =>\n\tkeyBy(\n\t\tfilter(useFolderStore.getState().folders, (f) => f.id?.split(':')?.includes(FOLDERS.USER_ROOT)),\n\t\t'id'\n\t);\n\n// ROOTS BY VIEW\n/**\n * Returns a root with given user ID.\n * @params userId\n */\nexport const useRootByUser = (\n\tuserId: string\n): Folder | SearchFolder | Record<string, never> | undefined =>\n\tuseFolderStore((s) => find(s.folders, (f) => f.name === userId));\n\n/**\n * Returns a root with given user ID.\n * @params userId\n */\nexport const getRootByUser = (\n\tuserId: string\n): Folder | SearchFolder | Record<string, never> | undefined => {\n\tconst { folders } = useFolderStore.getState();\n\treturn find(folders, (f) => f.name === userId);\n};\n\n/**\n * Returns the root account id for a given folder\n * @param folder a Folder or LinkFolder\n * @returns the root account id or null if the folder is not a link or the root folder\n */\nexport function getRootAccountId(id: string): string | undefined {\n\tconst roots = getRootsArray();\n\tconst root = find(roots, (r) => some(r.id?.split(':'), (v) => id?.split(':')?.includes(v)));\n\n\treturn root?.id;\n}\n\n/**\n * Return a flat array of folder that are children of the given root\n * @param rootId\n */\nexport const useFoldersMapByRoot = (rootId: string): Folders => {\n\tconst root = useRoot(rootId);\n\n\treturn useMemo(() => getFlatChildrenFolders(root?.children ?? []), [root?.children]);\n};\n\n/**\n * Return a flat array of folder that are children of the given root\n * @param rootId\n */\nexport const getFoldersArrayByRoot = (rootId: string): Array<Folder> => {\n\tconst root = getRoot(rootId);\n\tif (!root) {\n\t\treturn [];\n\t}\n\n\treturn Object.values(getFlatChildrenFolders(root.children));\n};\n\n// SEARCHES\nexport const useSearchFolder = (id: string): SearchFolder | undefined =>\n\tuseFolderStore((s) => s.searches?.[id]);\nexport const getSearchFolder = (id: string): SearchFolder | undefined =>\n\tuseFolderStore.getState().searches[id];\nexport const useSearchFolders = (): Searches => useFolderStore((s) => s.searches);\nexport const getSearchFolders = (): Searches => useFolderStore.getState().searches;\n\n// useful hooks to update the value of a folder. Created because we don't receive acl data from notify when we modify folder grants.\n\n/**\n * Returns a callback function to update a specific folder.\n *\n * @returns callback function to update a specific folder\n */\nexport const useUpdateFolder = (): ((id: string, opt: Partial<Folder>) => void) =>\n\tuseFolderStore((s) => s.updateFolder);\n\n/**\n * Returns a callback function to update a specific folder.\n *\n * @returns callback function to update a specific folder\n */\nexport const getUpdateFolder = (): ((id: string, opt: Partial<Folder>) => void) =>\n\tuseFolderStore.getState().updateFolder;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { FOLDERS, ROOT_NAME } from '@zextras/carbonio-shell-ui';\nimport { sortBy } from 'lodash';\n\nimport { Folders } from '../../../types/folder';\nimport type { Folder, FolderView, LinkFolder, TreeNode } from '../../../types/folder';\n\nconst hasId = (f: { id: string }, id: string): boolean => f.id.split(':').includes(id);\nconst getOriginalId = (f: { id: string }): string => {\n\tconst parts = f.id.split(':');\n\treturn parts[1] ?? parts[0];\n};\n\n// TODO check if is still used by Calendars or Contacts\nexport const sortFolders = (f: Folder): string => {\n\tconst id = getOriginalId(f);\n\tif (id === FOLDERS.TRASH) {\n\t\treturn FOLDERS.LAST_SYSTEM_FOLDER_POSITION;\n\t}\n\treturn parseInt(id, 10) < 17 ? `   ${id}` : f.name.toLowerCase();\n};\n\nexport const isRoot = (f: Folder): boolean =>\n\tf.id === FOLDERS.USER_ROOT || (f as LinkFolder).oname === ROOT_NAME;\n\nexport const isTrash = (f: { id: string }): boolean => hasId(f, FOLDERS.TRASH);\n\nexport const isNestedInTrash = (item: { absFolderPath?: string }): boolean =>\n\t!!item?.absFolderPath?.includes(`/Trash/`);\n\nexport const isTrashOrNestedInIt = (item: { id: string; absFolderPath?: string }): boolean =>\n\tisTrash(item) || isNestedInTrash(item);\n\nexport const folderViewFilter =\n\t(v: FolderView) =>\n\t(deep?: boolean) =>\n\t(f: Folder): boolean =>\n\t\tf.view === v || !deep || (typeof f.view === 'undefined' && !isRoot(f));\n\nexport const filterNodes = <T>(\n\tchildren: TreeNode<T>[],\n\tf: (deep?: boolean) => (i: TreeNode<T>) => boolean,\n\tsortFunction?: (i: TreeNode<T>) => number | string,\n\tdeep?: boolean\n): TreeNode<T>[] => {\n\tconst childrenSorted = sortFunction ? sortBy(children, sortFunction) : children;\n\treturn childrenSorted\n\t\t.filter(f(deep))\n\t\t.map((i) => ({ ...i, children: filterNodes<TreeNode<T>>(i.children, f, sortFunction, true) }));\n};\n\ntype MapNodesOptions<T, U> = {\n\tmapFunction: (i: TreeNode<T>) => U;\n\tfilterFunction: (deep?: boolean) => (i: TreeNode<T>) => boolean;\n\trecursionKey: keyof U;\n\tsortFunction: (i: TreeNode<T>) => number | string;\n\tdeep: boolean;\n};\nexport const mapNodes = <T, U>(\n\tchildren: TreeNode<T>[],\n\t{ mapFunction, filterFunction, recursionKey, sortFunction, deep }: MapNodesOptions<T, U>\n): U[] =>\n\tsortBy(children, sortFunction).reduce((acc, folder) => {\n\t\tif (filterFunction(deep)(folder)) {\n\t\t\tacc.push({\n\t\t\t\t...mapFunction(folder),\n\t\t\t\t[recursionKey]: mapNodes<TreeNode<T>, U>(folder.children, {\n\t\t\t\t\tmapFunction,\n\t\t\t\t\tfilterFunction,\n\t\t\t\t\trecursionKey,\n\t\t\t\t\tsortFunction,\n\t\t\t\t\tdeep: true\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\t\treturn acc;\n\t}, [] as U[]);\n\n/**\n * Recursive function that returns a flat map of the children folders\n * @param children\n */\nexport const getFlatChildrenFolders = (children: Array<Folder>): Folders => {\n\tlet destination: Folders = {};\n\tchildren.forEach((child) => {\n\t\tdestination[child.id] = child;\n\t\tif (child.children) {\n\t\t\tdestination = { ...destination, ...getFlatChildrenFolders(child.children) };\n\t\t}\n\t});\n\n\treturn destination;\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nexport const FOLDERS = {\n\tUSER_ROOT: '1',\n\tINBOX: '2',\n\tTRASH: '3',\n\tSPAM: '4',\n\tSENT: '5',\n\tDRAFTS: '6',\n\tCONTACTS: '7',\n\tTAGS: '8',\n\tCONVERSATIONS: '9',\n\tCALENDAR: '10',\n\tROOT: '11',\n\tNOTEBOOK: '12', // no longer created in new mailboxes since Helix (bug 39647).  old mailboxes may still contain a system folder with id 12\n\tAUTO_CONTACTS: '13',\n\tIM_LOGS: '14',\n\tTASKS: '15',\n\tBRIEFCASE: '16'\n};\n\nexport const ZIMBRA_STANDARD_COLORS = [\n\t{ zValue: 0, hex: '#000000', zLabel: 'black' },\n\t{ zValue: 1, hex: '#2b73d2', zLabel: 'blue' },\n\t{ zValue: 2, hex: '#2196d3', zLabel: 'cyan' },\n\t{ zValue: 3, hex: '#639030', zLabel: 'green' },\n\t{ zValue: 4, hex: '#1a75a7', zLabel: 'purple' },\n\t{ zValue: 5, hex: '#d74942', zLabel: 'red' },\n\t{ zValue: 6, hex: '#ffc107', zLabel: 'yellow' },\n\t{ zValue: 7, hex: '#edaeab', zLabel: 'pink' },\n\t{ zValue: 8, hex: '#828282', zLabel: 'gray' },\n\t{ zValue: 9, hex: '#ba8b00', zLabel: 'orange' }\n];\n\nexport enum JSNS {\n\tACCOUNT = 'urn:zimbraAccount',\n\tADMIN = 'urn:zimbraAdmin',\n\tMAIL = 'urn:zimbraMail',\n\tALL = 'urn:zimbra',\n\tSYNC = 'urn:zimbraSync'\n}\n\nexport const ROOT_NAME = 'USER_ROOT';\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { getUserSettings } from '@zextras/carbonio-shell-ui';\n\nimport type { UserPrefs } from '../types';\n\nexport const getPrefs = (): UserPrefs => {\n\tconst { prefs } = getUserSettings();\n\treturn <UserPrefs>prefs;\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport type { FolderMessage, SoapNotify } from '@zextras/carbonio-shell-ui';\n\nimport { getLinkIdMapKey } from './utils';\nimport type {\n\tBaseFolder,\n\tFolder,\n\tFolders,\n\tLinkFolder,\n\tLinkFolderFields,\n\tSearches,\n\tSearchFolderFields,\n\tSoapFolder,\n\tSoapLink,\n\tSoapSearchFolder,\n\tUserFolder\n} from '../types/folder';\nimport { FolderView, LinksIdMap } from '../types/folder';\n\nconst IM_LOGS = '14';\nconst USER_ROOT = '1';\n\nlet folders: Folders = {};\nconst searches: Searches = {};\nconst linksIdMap: LinksIdMap = {};\n// used to check if a newly created folder is being added to the correct store\nlet view: string | undefined;\n\nexport const testUtils = {\n\tgetFolders: (): Folders => folders,\n\tresetFolders: (): void => {\n\t\tfolders = {};\n\t},\n\tsetFolders: (data: Folders): void => {\n\t\tfolders = data;\n\t},\n\tsetCurrentView: (current: FolderView): void => {\n\t\tview = current;\n\t},\n\tgetCurrentView: (): string | undefined => view\n};\n\nconst sortFoldersByName = (obj: Array<Folder>): Array<Folder> =>\n\tobj.sort((a, b) => {\n\t\tconst aLowerName = a.name.toLowerCase();\n\t\tconst bLowerName = b.name.toLowerCase();\n\t\tif (aLowerName < bLowerName) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (aLowerName > bLowerName) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t});\n\nconst updateChildren = (folder: Folder, changes: any): any => {\n\tif (changes.absFolderPath && folder.children.length) {\n\t\tfolder.children.forEach((child) => {\n\t\t\tconst childFolder = folders[child.id];\n\t\t\tif (changes.absFolderPath && childFolder.absFolderPath) {\n\t\t\t\tconst paths = childFolder.absFolderPath.split('/').slice(2);\n\t\t\t\tchildFolder.absFolderPath = `${changes.absFolderPath}/${paths.join('/')}`;\n\t\t\t}\n\t\t\tif (childFolder.children.length) {\n\t\t\t\tupdateChildren(childFolder, changes);\n\t\t\t}\n\t\t});\n\t}\n};\n\nexport const testFolderIsChecked = ({ string }: { string: string | undefined }): boolean =>\n\t/#/.test(string || '');\n\nconst omit = ({\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tlink: _1,\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tfolder: _2,\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tsearch: _3,\n\t...obj\n}: Partial<SoapFolder>): Partial<SoapFolder> => obj;\n\nexport const hasId = (f: { id: string }, id: string): boolean => f.id.split(':').includes(id);\nexport const normalize = (f: SoapFolder, p?: Folder): BaseFolder => ({\n\tid: f.id,\n\tuuid: f.uuid,\n\tname: f.name,\n\tabsFolderPath: f.absFolderPath,\n\tl: f.l,\n\tluuid: f.luuid,\n\tchecked: testFolderIsChecked({ string: f.f }),\n\tf: f.f,\n\t// the type defined in shell is not correct refs: SHELL-118\n\t// FIXME: remove the cast when the type will be fixed\n\tcolor: (f.color as unknown as number) || p?.color,\n\trgb: f.rgb,\n\tu: f.u,\n\ti4u: f.i4u,\n\tview: f.view,\n\trev: f.rev,\n\tms: f.ms,\n\tmd: f.md,\n\tn: f.n,\n\ti4n: f.i4n,\n\ts: f.s,\n\ti4ms: f.i4ms,\n\ti4next: f.i4next,\n\turl: f.url,\n\tactivesyncdisabled: !!f.activesyncdisabled,\n\twebOfflineSyncDays: f.webOfflineSyncDays,\n\tperm: f.perm,\n\trecursive: !!f.recursive,\n\trest: f.rest,\n\tdeletable: !!f.deletable,\n\tmeta: f.meta,\n\tacl: f.acl,\n\tretentionPolicy: f.retentionPolicy\n});\n\nexport const normalizeSearch = (s: SoapSearchFolder): BaseFolder & SearchFolderFields => ({\n\t...normalize(s),\n\tquery: s.query,\n\tsortBy: s.sortBy,\n\ttypes: s.types\n});\n\nexport const normalizeLink = (l: SoapLink, p?: Folder): BaseFolder & LinkFolderFields => ({\n\t...normalize(l, p),\n\towner: l.owner,\n\tzid: l.zid,\n\trid: l.rid,\n\truuid: l.ruuid,\n\toname: l.oname,\n\treminder: !!l.reminder,\n\tbroken: !!l.broken\n});\n\nexport const processSearch = (soapSearch: SoapSearchFolder, parent: Folder): void => {\n\tconst search = {\n\t\t...normalizeSearch(soapSearch),\n\t\tparent: parent?.id,\n\t\tisLink: parent?.isLink\n\t};\n\tsearches[search.id] = search;\n};\n\nexport const processLink = (soapLink: SoapLink, depth: number, parent?: Folder): LinkFolder => {\n\tconst link = {\n\t\t...normalizeLink(soapLink, parent),\n\t\tisLink: true,\n\t\tchildren: [],\n\t\tparent: parent?.id,\n\t\tdepth\n\t} as LinkFolder;\n\t// eslint-disable-next-line no-param-reassign\n\tfolders[soapLink.id] = link;\n\n\t// Get the zid:rid key of the link and add it to the links id map\n\tconst linkIdMapKey = getLinkIdMapKey(soapLink);\n\tlinkIdMapKey && (linksIdMap[linkIdMapKey] = soapLink.id);\n\n\tsoapLink?.folder?.forEach((f) => {\n\t\tif (!hasId(f, IM_LOGS)) {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-use-before-define\n\t\t\tconst child = processFolder(f, depth + 1, link);\n\t\t\tlink.children.push(child);\n\t\t}\n\t});\n\tsoapLink?.link?.forEach((l) => {\n\t\tif (!hasId(l, IM_LOGS)) {\n\t\t\tconst child = processLink(l, depth + 1, link);\n\t\t\tlink.children.push(child);\n\t\t}\n\t});\n\tsoapLink?.search?.forEach((s) => {\n\t\tprocessSearch(s, link);\n\t});\n\n\treturn link;\n};\n\nexport const processFolder = (\n\tsoapFolder: SoapFolder,\n\tdepth: number,\n\tparent?: Folder\n): UserFolder => {\n\tconst folder: UserFolder = {\n\t\t...normalize(soapFolder, parent),\n\t\tisLink: false,\n\t\tchildren: [],\n\t\tparent: parent?.id,\n\t\tdepth\n\t};\n\tfolders[soapFolder.id] = folder;\n\tsoapFolder?.folder?.forEach((f) => {\n\t\tif (!hasId(f, IM_LOGS)) {\n\t\t\tconst child = processFolder(f, depth + 1, folder);\n\t\t\tif (!hasId(f, USER_ROOT)) {\n\t\t\t\tfolder.children.push(child);\n\t\t\t}\n\t\t}\n\t});\n\tsoapFolder?.link?.forEach((l) => {\n\t\tif (!hasId(l, IM_LOGS)) {\n\t\t\tconst child = processLink(l, depth + 1, folder);\n\t\t\tif (!hasId(l, USER_ROOT)) {\n\t\t\t\tfolder.children.push(child);\n\t\t\t}\n\t\t}\n\t});\n\tsoapFolder?.search?.forEach((s) => {\n\t\tprocessSearch(s, folder);\n\t});\n\treturn folder;\n};\n\nexport const handleFolderRefresh = (\n\tsoapFolders: Array<SoapFolder>,\n\tcurrentView: FolderView\n): UserFolder | Array<UserFolder> => {\n\tview = currentView;\n\tif (soapFolders.length > 1) {\n\t\tconst sharedAccounts = soapFolders.slice(1);\n\t\treturn [\n\t\t\tprocessFolder(soapFolders[0], 0),\n\t\t\t...sharedAccounts.map((folder) => processLink(folder as SoapLink, 0))\n\t\t] as Array<UserFolder>;\n\t}\n\treturn processFolder(soapFolders[0], 0);\n};\n\nexport const handleFolderCreated = (created: Array<SoapFolder>): void =>\n\tcreated.forEach((val: SoapFolder) => {\n\t\tif (val.id && val.l && view && val.view === view) {\n\t\t\tconst parent = folders[val.l];\n\t\t\tconst folder: UserFolder = {\n\t\t\t\t...normalize(val, parent),\n\t\t\t\tisLink: false,\n\t\t\t\tchildren: [],\n\t\t\t\tparent: parent?.id,\n\t\t\t\tdepth: parent && parent.depth !== undefined ? parent.depth + 1 : 0\n\t\t\t};\n\t\t\tfolders[val.id] = folder;\n\t\t\tparent.children.push(folder);\n\t\t\tsortFoldersByName(parent.children);\n\t\t}\n\t});\nexport const handleLinkCreated = (created: Array<SoapLink>): void =>\n\tcreated.forEach((val: SoapLink) => {\n\t\tif (val.id && val.l && view && val.view === view) {\n\t\t\tconst parent = folders[val.l];\n\t\t\tconst folder: LinkFolder = {\n\t\t\t\t...normalizeLink(val, parent),\n\t\t\t\tisLink: true,\n\t\t\t\tchildren: [],\n\t\t\t\tparent: parent?.id,\n\t\t\t\tdepth: parent && parent.depth !== undefined ? parent.depth + 1 : 0\n\t\t\t};\n\t\t\tfolders[val.id] = folder;\n\t\t\tparent.children.push(folder);\n\t\t\tsortFoldersByName(parent.children);\n\t\t}\n\t});\n\nfunction getKeyByValue(map: Folders, searchValue: Partial<UserFolder>): string | undefined {\n\treturn Object.keys(map).find(\n\t\t(key) => searchValue.id === `${(map[key] as LinkFolder).zid}:${(map[key] as LinkFolder).rid}`\n\t);\n}\n\nfunction folderIsSharedWithMe(folderId: string | undefined): boolean {\n\tif (!folderId) return false;\n\tconst folder = folders[folderId];\n\tif (folder?.parent) {\n\t\treturn folderIsSharedWithMe(folder?.parent);\n\t}\n\treturn folder?.name === 'USER_ROOT';\n}\n\nexport const handleFolderModified = (modified: Array<Partial<UserFolder>>): void =>\n\t// the type defined in shell is not correct refs: SHELL-118\n\t// FIXME: remove the ts-ignore when the type will be fixed\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\tmodified.forEach((val: Partial<SoapFolder>): void => {\n\t\tif (!val.id) return;\n\t\tconst mountPointId = val.id.includes(':') ? val.id : getKeyByValue(folders, val);\n\t\tconst parentMountPointId = getKeyByValue(folders, { id: val.l });\n\t\tconst isSharedWithMe = folderIsSharedWithMe(mountPointId);\n\t\tconst parentIsSharedWithMe = folderIsSharedWithMe(parentMountPointId);\n\t\tconst parentFolderId = parentIsSharedWithMe && parentMountPointId ? parentMountPointId : val.l;\n\t\tconst folderId = isSharedWithMe && mountPointId ? mountPointId : val.id;\n\t\tconst folder = folderId ? folders[folderId] : null;\n\n\t\tif (folder) {\n\t\t\tObject.assign(folder, omit({ ...val, id: folderId }));\n\t\t\tupdateChildren(folder, val);\n\t\t\tif (typeof val.f !== 'undefined') {\n\t\t\t\tfolder.checked = testFolderIsChecked({ string: val.f });\n\t\t\t}\n\n\t\t\tconst oldParentId = folder.parent;\n\n\t\t\tif (oldParentId) {\n\t\t\t\tconst oldParent = folders[oldParentId];\n\t\t\t\tif (oldParent) {\n\t\t\t\t\tif (!val.l) {\n\t\t\t\t\t\toldParent.children = oldParent.children.map((f) => (f.id !== val.id ? f : folder));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst newParent = parentFolderId ? folders[parentFolderId] : null;\n\t\t\t\t\t\tif (newParent) {\n\t\t\t\t\t\t\toldParent.children = oldParent.children.filter((f) => f.id !== folderId);\n\t\t\t\t\t\t\tnewParent.children.push(folder);\n\t\t\t\t\t\t\tsortFoldersByName(newParent.children);\n\t\t\t\t\t\t\tfolder.parent = newParent.id;\n\t\t\t\t\t\t\tfolder.depth = newParent?.depth !== undefined ? newParent.depth + 1 : 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfolders[folderId] = folder;\n\t\t\t}\n\t\t}\n\t});\nexport const handleFolderDeleted = (deleted: string[]): void =>\n\tdeleted.forEach((val) => {\n\t\tconst folder = folders[val];\n\t\tif (folder) {\n\t\t\tif (folder.parent) {\n\t\t\t\tconst parent = folders[folder.parent];\n\t\t\t\tparent.children = parent.children.filter((obj) => obj.id !== val);\n\t\t\t}\n\t\t\tdelete folders[val];\n\t\t\tdelete searches[val];\n\t\t}\n\t});\nexport const handleFolderNotify = (notify: SoapNotify): void => {\n\thandleFolderCreated(notify.created?.folder ?? []);\n\thandleLinkCreated(notify.created?.link ?? []);\n\t// the type defined in shell is not correct refs: SHELL-118\n\t// FIXME: remove the ts-ignore when the type will be fixed\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\thandleFolderModified([...(notify.modified?.folder ?? []), ...(notify.modified?.link ?? [])]);\n\thandleFolderDeleted(notify.deleted ?? []);\n};\n\nexport const handleFoldersMessages = ({ data }: FolderMessage): void => {\n\tif (data.op === 'refresh' && data.folder) {\n\t\thandleFolderRefresh(data.folder, data.currentView);\n\t}\n\tif (data.op === 'notify') {\n\t\thandleFolderNotify(data.notify);\n\t}\n};\n\nexport const handleMessage = ({ data }: FolderMessage): void => {\n\thandleFoldersMessages({ data });\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\tpostMessage({ folders, linksIdMap, searches });\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nexport const folderWorker = new Worker(new URL('./folder', import.meta.url));\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { useCallback, useLayoutEffect, useMemo, useRef } from 'react';\n\nimport { Container, Text } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\nimport { isNull, replace } from 'lodash';\n\nimport { ROOM_DIVIDER } from '../constants';\n\nexport const roomValidationRegEx = new RegExp(`${ROOM_DIVIDER}(.*)${ROOM_DIVIDER}`, 's');\n\nconst replaceLinkToAnchor = (content) => {\n\tif (content === '' || content === undefined) {\n\t\treturn '';\n\t}\n\treturn content.replace(\n\t\t/(?:https?:\\/\\/|www\\.)+(?![^\\s]*?\")([\\w.,@?!^=%&amp;:()/~+#-]*[\\w@?!^=%&amp;()/~+#-])?/gi,\n\t\t(url) => {\n\t\t\tconst wrap = document.createElement('div');\n\t\t\tconst anchor = document.createElement('a');\n\t\t\tlet href = url.replace(/&amp;/g, '&');\n\t\t\tif (!url.startsWith('http') && !url.startsWith('https')) {\n\t\t\t\thref = `http://${url}`;\n\t\t\t}\n\t\t\tanchor.href = href.replace(/&#64;/g, '@').replace(/&#61;/g, '=');\n\t\t\tanchor.target = '_blank';\n\t\t\tanchor.innerHTML = url;\n\n\t\t\twrap.appendChild(anchor);\n\t\t\treturn wrap.innerHTML.trim();\n\t\t}\n\t);\n};\n\nconst plainTextToHTML = (str) => {\n\tif (str !== undefined && str !== null) {\n\t\treturn str.replace(/(?:\\r\\n|\\r|\\n)/g, '<br/>');\n\t}\n\treturn '';\n};\nfunction TextMessageRenderer({ text }) {\n\tconst convertedHTML = useMemo(() => replaceLinkToAnchor(plainTextToHTML(text)), [text]);\n\treturn (\n\t\t<Text\n\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t__html: convertedHTML\n\t\t\t}}\n\t\t\toverflow=\"break-word\"\n\t\t/>\n\t);\n}\n\nfunction HtmlMessageRenderer({ msgId, body, parts }) {\n\tconst iframeRef = useRef();\n\tconst divRef = useRef();\n\n\tconst convertInRem = useCallback((px, base = 16) => {\n\t\tlet tempPx = px;\n\t\tif (typeof px === 'string' || px instanceof String) tempPx = tempPx.replace('px', '');\n\n\t\ttempPx = parseInt(tempPx, 10);\n\t\treturn `${(1 / base) * tempPx}rem`;\n\t}, []);\n\n\tconst calculateHeight = useCallback(() => {\n\t\tif (!isNull(iframeRef.current)) {\n\t\t\tconst scrollHeight = iframeRef.current.contentDocument.querySelector('html')?.scrollHeight;\n\t\t\tiframeRef.current.style.height = '0';\n\t\t\tiframeRef.current.style.height = convertInRem(scrollHeight ?? '0');\n\t\t}\n\t}, [convertInRem]);\n\n\tconst updatedBody = useMemo(() => replaceLinkToAnchor(body), [body]);\n\n\tuseLayoutEffect(() => {\n\t\tif (!isNull(iframeRef.current) && !isNull(iframeRef.current.contentDocument)) {\n\t\t\tiframeRef.current.contentDocument.open();\n\t\t\tiframeRef.current.contentDocument.write(`<div>${updatedBody}</div>`);\n\t\t\tiframeRef.current.contentDocument.close();\n\t\t}\n\t\tconst styleTag = document.createElement('style');\n\t\tstyleTag.textContent = `\n\t\t\tmax-width: 100% !important;\n\t\t\tbody {\n\t\t\t\tmax-width: 100% !important;\n\t\t\t\tmargin: 0;\n\t\t\t\toverflow-y: hidden;\n\t\t\t\tfont-family: Roboto, sans-serif;\n\t\t\t\tfont-size: 0.875rem;\n\t\t\t\tbackground-color: #ffffff;\n\t\t\t}\n\t\t\tbody pre, body pre * {\n\t\t\t\twhite-space: pre-wrap;\n\t\t\t\tword-wrap: anywhere !important;\n\t\t\t\ttext-wrap: suppress !important;\n\t\t\t}\n\t\t\timg {\n\t\t\t\tmax-width: 100%\n\t\t\t}\n\t\t\ttbody{position:relative !important}\n\t\t\ttd{\n\t\t\t\tmax-width: 100% !important;\n\t\t\t\toverflow-wrap: anywhere !important;\n\t\t\t}\n\t\t\t#bodyTable {\n\t\t\t\theight: fit-content\n\t\t\t}\n\t\t`;\n\t\tif (!isNull(iframeRef.current) && !isNull(iframeRef.current.contentDocument))\n\t\t\tiframeRef.current.contentDocument.head.append(styleTag);\n\n\t\tcalculateHeight();\n\n\t\tconst resizeObserver = new ResizeObserver(calculateHeight);\n\t\tdivRef.current && resizeObserver.observe(divRef.current);\n\n\t\treturn () => resizeObserver.disconnect();\n\t}, [calculateHeight, msgId, parts, updatedBody]);\n\n\treturn (\n\t\t<div ref={divRef} className=\"force-white-bg\" style={{ width: '100%' }}>\n\t\t\t<iframe\n\t\t\t\ttitle={msgId}\n\t\t\t\tref={iframeRef}\n\t\t\t\tonLoad={calculateHeight}\n\t\t\t\tstyle={{ border: 'none', width: '100%' }}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\nconst EmptyBody = () => (\n\t<Container padding={{ bottom: 'medium' }}>\n\t\t<Text>{`(${t('message.invite_has_no_message', 'This invite has no text message')}.)`}</Text>\n\t</Container>\n);\n\nexport function extractBody(body) {\n\tif (body) {\n\t\tconst defaultMessage = roomValidationRegEx.exec(body)?.[0];\n\t\tconst stripDefaultRoomMessage = defaultMessage ? replace(body, defaultMessage, '') : body;\n\t\treturn stripDefaultRoomMessage.trim();\n\t}\n\treturn '';\n}\n\nexport function extractHtmlBody(body) {\n\tlet htmlBody = extractBody(body);\n\tif (htmlBody.startsWith('</div>')) {\n\t\thtmlBody = `<html>${htmlBody.slice(12)}`;\n\t}\n\n\treturn htmlBody;\n}\n\nexport default function BodyMessageRenderer({ fullInvite, inviteId, parts }) {\n\tif (!fullInvite) return null;\n\tif (typeof fullInvite.fragment === 'undefined' || fullInvite.fragment === '') {\n\t\treturn <EmptyBody />;\n\t}\n\n\tif (fullInvite?.htmlDescription?.[0]?._content) {\n\t\tconst originalHtml = fullInvite?.htmlDescription?.[0]?._content ?? '';\n\t\tconst roomHtmlDesc = roomValidationRegEx?.exec(originalHtml)?.[0];\n\t\tconst htmlContent = roomHtmlDesc ? replace(originalHtml, roomHtmlDesc, '') : originalHtml;\n\t\treturn (\n\t\t\t<HtmlMessageRenderer msgId={inviteId} body={extractHtmlBody(htmlContent)} parts={parts} />\n\t\t);\n\t}\n\tconst originalText = fullInvite?.textDescription?.[0]?._content ?? '';\n\tconst roomTextDesc = roomValidationRegEx?.exec(originalText)?.[0];\n\tconst textContent = roomTextDesc ? replace(originalText, roomTextDesc, '') : originalText;\n\treturn <TextMessageRenderer text={extractBody(textContent)} />;\n}\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { find, isEmpty, isNaN, omit, startsWith } from 'lodash';\nimport moment from 'moment';\nimport momentLocalizer from 'react-widgets-moment';\nimport { Dispatch } from 'redux';\n\nimport { getIdentityItems } from './get-identity-items';\nimport { Folder, Folders, LinkFolder } from '../carbonio-ui-commons/types/folder';\nimport { getPrefs } from '../carbonio-ui-commons/utils/get-prefs';\nimport { PREFS_DEFAULTS } from '../constants';\nimport { EventPropType, normalizeEditor } from '../normalizations/normalize-editor';\nimport { createNewEditor } from '../store/slices/editor-slice';\nimport { Editor } from '../types/editor';\nimport { Invite } from '../types/store/invite';\n\nmomentLocalizer(moment);\n\nlet counter = 0;\n\nexport const getNewEditId = (id?: string): string => {\n\tcounter += 1;\n\treturn `${id ?? 'new'}-${counter}`;\n};\n\nexport const getEndTime = ({ start, duration }: { start: number; duration: string }): number => {\n\tconst now = moment(start);\n\tif (duration?.includes('m')) {\n\t\tconst interval = parseInt(duration, 10) * 60;\n\t\tconst value = now.add(interval, 's').valueOf();\n\t\treturn isNaN(value) ? now.valueOf() + 3600 : value;\n\t}\n\tconst interval = parseInt(duration, 10);\n\tconst value = now.add(interval, 's').valueOf();\n\treturn isNaN(value) ? now.valueOf() + 3600 : value;\n};\n\nexport const disabledFields = {\n\trichTextButton: false,\n\tattachmentsButton: false,\n\tsaveButton: false,\n\tsendButton: false,\n\torganizer: false,\n\ttitle: false,\n\tlocation: false,\n\tmeetingRoom: false,\n\tvirtualRoom: false,\n\tequipment: false,\n\tattendees: false,\n\toptionalAttendees: false,\n\tfreeBusySelector: false,\n\tcalendarSelector: false,\n\tprivate: false,\n\tdatePicker: false,\n\ttimezone: false,\n\tallDay: false,\n\treminder: false,\n\trecurrence: false,\n\tattachments: false,\n\tcomposer: false\n};\n\nexport const createEmptyEditor = (id: string, folders: Folders): Editor => {\n\tconst identities = getIdentityItems();\n\tconst {\n\t\tzimbraPrefCalendarDefaultApptDuration,\n\t\tzimbraPrefCalendarApptReminderWarningTime,\n\t\tzimbraPrefDefaultCalendarId\n\t} = getPrefs();\n\tconst defaultOrganizer = find(identities, ['identityName', 'DEFAULT']);\n\tconst defaultCalendar = find(folders, [\n\t\t'id',\n\t\tzimbraPrefDefaultCalendarId ?? PREFS_DEFAULTS.DEFAULT_CALENDAR_ID\n\t]);\n\tconst defaultTimezone = moment.tz.guess(true);\n\n\treturn {\n\t\tattach: undefined,\n\t\tcalendar: defaultCalendar\n\t\t\t? {\n\t\t\t\t\tid: defaultCalendar.id,\n\t\t\t\t\tname: defaultCalendar.name,\n\t\t\t\t\trgb: defaultCalendar.rgb,\n\t\t\t\t\tcolor: defaultCalendar.color,\n\t\t\t\t\towner: (defaultCalendar as LinkFolder)?.owner\n\t\t\t\t}\n\t\t\t: undefined,\n\t\tpanel: false,\n\t\tisException: false,\n\t\texceptId: undefined,\n\t\tisSeries: false,\n\t\tisInstance: true,\n\t\tisRichText: true,\n\t\tisNew: startsWith(id, 'new'),\n\t\tattachmentFiles: [],\n\t\torganizer: defaultOrganizer,\n\t\tsender: defaultOrganizer,\n\t\ttitle: '',\n\t\tlocation: '',\n\t\tmeetingRoom: undefined,\n\t\tequipment: undefined,\n\t\troom: undefined,\n\t\tattendees: [],\n\t\toptionalAttendees: [],\n\t\tallDay: false,\n\t\tfreeBusy: 'B',\n\t\tclass: 'PUB',\n\t\toriginalStart: moment().set('second', 0).set('millisecond', 0).valueOf(),\n\t\toriginalEnd: getEndTime({\n\t\t\tstart: moment().set('second', 0).set('millisecond', 0).valueOf(),\n\t\t\tduration: zimbraPrefCalendarDefaultApptDuration as string\n\t\t}),\n\t\tstart: moment().set('second', 0).set('millisecond', 0).valueOf(),\n\t\tend: getEndTime({\n\t\t\tstart: moment().set('second', 0).set('millisecond', 0).valueOf(),\n\t\t\tduration: zimbraPrefCalendarDefaultApptDuration as string\n\t\t}),\n\t\tinviteId: undefined,\n\t\ttimezone: defaultTimezone,\n\t\treminder: zimbraPrefCalendarApptReminderWarningTime as string,\n\t\trecur: undefined,\n\t\trichText: '',\n\t\tplainText: '',\n\t\tdisabled: disabledFields,\n\t\tid\n\t};\n};\n\nexport const applyContextToEditor = ({\n\teditor,\n\tcontext\n}: {\n\teditor: Editor;\n\tcontext: any;\n}): Editor => {\n\tconst contextObj = omit(context, ['disabled', 'folders', 'dispatch']);\n\tlet editorWithContext = { ...editor };\n\tif (!isEmpty(context)) {\n\t\teditorWithContext = { ...editorWithContext, ...contextObj };\n\t}\n\tif (!isEmpty(context?.disabled)) {\n\t\teditorWithContext = {\n\t\t\t...editorWithContext,\n\t\t\tdisabled: {\n\t\t\t\t...editorWithContext.disabled,\n\t\t\t\t...context.disabled\n\t\t\t}\n\t\t};\n\t}\n\treturn editorWithContext;\n};\n\nexport type EditorContext = {\n\tisInstance?: boolean;\n\tdispatch: Dispatch;\n\tfolders: Folders;\n\tisProposeNewTime?: boolean;\n\tpanel?: boolean;\n\tsearchPanel?: boolean;\n} & Partial<Editor>;\n\nexport const generateEditor = ({\n\tevent,\n\tinvite,\n\tcontext\n}: {\n\tevent?: EventPropType;\n\tinvite?: Invite;\n\tcontext: EditorContext;\n}): Editor => {\n\tconst id = getNewEditId(event?.resource?.id);\n\tconst emptyEditor = createEmptyEditor(id, context.folders);\n\n\tconst compiledEditor = normalizeEditor({\n\t\tinvite,\n\t\tevent,\n\t\temptyEditor,\n\t\tcontext\n\t});\n\n\tconst editor = applyContextToEditor({\n\t\teditor: compiledEditor,\n\t\tcontext\n\t});\n\n\tcontext.dispatch(createNewEditor(editor));\n\n\treturn editor;\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { getUserAccount } from '@zextras/carbonio-shell-ui';\nimport { compact, map, sortBy } from 'lodash';\n\nimport { IdentityItem } from '../types/editor';\n\nexport const getIdentityItems = (): Array<IdentityItem> => {\n\tconst account = getUserAccount();\n\n\tconst sortedList = sortBy(account?.identities.identity, ({ name }) =>\n\t\tname === 'DEFAULT' ? 0 : 1\n\t);\n\n\treturn map(sortedList, (item, idx) => {\n\t\tconst name = item.name ? `${item.name}` : undefined;\n\t\tconst display = item._attrs?.zimbraPrefFromDisplay\n\t\t\t? `${item._attrs?.zimbraPrefFromDisplay} `\n\t\t\t: undefined;\n\t\tconst fromAddress = item._attrs?.zimbraPrefFromAddress\n\t\t\t? `(<${item._attrs?.zimbraPrefFromAddress}>) `\n\t\t\t: undefined;\n\t\tconst label = compact([name, display, fromAddress]).join(' ');\n\t\treturn {\n\t\t\tvalue: `${idx}`,\n\t\t\tlabel,\n\t\t\taddress: item._attrs?.zimbraPrefFromAddress,\n\t\t\tfullName: item._attrs?.zimbraPrefFromDisplay,\n\t\t\ttype: item._attrs?.zimbraPrefFromAddressType,\n\t\t\tidentityName: item.name\n\t\t};\n\t});\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n/* eslint-disable @typescript-eslint/ban-ts-comment */\n/* eslint-disable import/extensions */\nimport React, { FC, ReactElement } from 'react';\n\nimport { Button, Container, Divider, Padding, Tooltip } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\n\nimport { ModalFooterProps } from '../carbonio-ui-commons/types';\n\nconst ModalFooter: FC<ModalFooterProps> = ({\n\tmainAlignment = 'center',\n\tcrossAlignment = 'center',\n\tonConfirm,\n\tcolor = 'primary',\n\tlabel,\n\tsecondaryAction,\n\tsecondaryLabel = t('label.cancel', 'cancel'),\n\tprimaryBtnType = 'default',\n\tsecondaryBtnType = 'default',\n\tdisabled,\n\tsecondaryDisabled,\n\tbackground = 'primary',\n\tsecondarybackground,\n\tsecondaryColor = 'secondary',\n\tshowDivider = true,\n\ttooltip,\n\tadditionalAction,\n\tadditionalBtnType = 'outlined',\n\tadditionalColor = 'secondary',\n\tadditionalLabel = t('label.cancel', 'cancel')\n}): ReactElement => (\n\t<Container mainAlignment={mainAlignment} crossAlignment={crossAlignment}>\n\t\t{showDivider && (\n\t\t\t<Container\n\t\t\t\tpadding={{ top: 'small', bottom: 'small' }}\n\t\t\t\tmainAlignment=\"center\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\theight=\"fit\"\n\t\t\t>\n\t\t\t\t<Divider />\n\t\t\t</Container>\n\t\t)}\n\t\t<Container orientation=\"horizontal\" mainAlignment=\"space-between\">\n\t\t\t{additionalAction && (\n\t\t\t\t<Container orientation=\"horizontal\" width=\"fit\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tcolor={additionalColor}\n\t\t\t\t\t\ttype={additionalBtnType}\n\t\t\t\t\t\tonClick={additionalAction}\n\t\t\t\t\t\tlabel={additionalLabel}\n\t\t\t\t\t\twidth=\"fit\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Padding horizontal=\"extrasmall\" />\n\t\t\t\t</Container>\n\t\t\t)}\n\t\t\t<Container\n\t\t\t\tpadding={{ top: 'small', bottom: 'small' }}\n\t\t\t\tmainAlignment=\"flex-end\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\theight=\"fit\"\n\t\t\t>\n\t\t\t\t{secondaryAction && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tbackgroundColor={secondarybackground}\n\t\t\t\t\t\t\tcolor={secondaryColor}\n\t\t\t\t\t\t\ttype={secondaryBtnType}\n\t\t\t\t\t\t\tonClick={secondaryAction}\n\t\t\t\t\t\t\tlabel={secondaryLabel}\n\t\t\t\t\t\t\tdisabled={secondaryDisabled}\n\t\t\t\t\t\t\twidth=\"fit\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Padding horizontal=\"extrasmall\" />\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t\t{tooltip ? (\n\t\t\t\t\t<Tooltip label={tooltip} placement=\"top\" maxWidth=\"fit\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\twidth=\"fit\"\n\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\tonClick={onConfirm}\n\t\t\t\t\t\t\tlabel={label}\n\t\t\t\t\t\t\ttype={primaryBtnType}\n\t\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\t\tbackgroundColor={color || background}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t) : (\n\t\t\t\t\t<Button\n\t\t\t\t\t\twidth=\"fit\"\n\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\tonClick={onConfirm}\n\t\t\t\t\t\tlabel={label}\n\t\t\t\t\t\ttype={primaryBtnType}\n\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\tbackgroundColor={color || background}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</Container>\n\t\t</Container>\n\t</Container>\n);\nexport default ModalFooter;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React from 'react';\n\nimport { Container, Divider, Text, Row, IconButton } from '@zextras/carbonio-design-system';\n\nexport const ModalHeader = ({ title, onClose }) => (\n\t<>\n\t\t<Row\n\t\t\torientation=\"horizontal\"\n\t\t\tmainAlignment=\"space-between\"\n\t\t\ttakeAvailableSpace\n\t\t\twrap=\"nowrap\"\n\t\t\twidth=\"100%\"\n\t\t>\n\t\t\t<Text weight=\"bold\" size=\"large\">\n\t\t\t\t{title}\n\t\t\t</Text>\n\t\t\t{onClose && (\n\t\t\t\t<IconButton\n\t\t\t\t\tsize=\"medium\"\n\t\t\t\t\tstyle={{ padding: { all: 'small' }, margin: 0 }}\n\t\t\t\t\tonClick={onClose}\n\t\t\t\t\ticon=\"CloseOutline\"\n\t\t\t\t/>\n\t\t\t)}\n\t\t</Row>\n\t\t<Container padding={{ top: 'small', bottom: 'small' }}>\n\t\t\t<Divider />\n\t\t</Container>\n\t</>\n);\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { Container, Text } from '@zextras/carbonio-design-system';\nimport styled from 'styled-components';\n\nexport const Square = styled.div`\n\twidth: 1.125rem;\n\theight: 1.125rem;\n\tposition: relative;\n\ttop: -0.1875rem;\n\tborder: 0.0625rem solid ${({ theme }): string => theme.palette.gray2.regular};\n\tbackground: ${({ color }): string | undefined => color};\n\tborder-radius: 0.25rem;\n`;\nexport const ColorContainer = styled(Container)`\n\tborder-bottom: 0.0625rem solid ${({ theme }): string => theme.palette.gray2.regular};\n`;\n\nexport const TextUpperCase = styled(Text)`\n\ttext-transform: capitalize;\n`;\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tDispatch,\n\tReactElement,\n\tSetStateAction,\n\tuseCallback,\n\tuseMemo,\n\tuseState\n} from 'react';\n\nimport { Dropdown, Icon, Padding, Row, Text, Tooltip } from '@zextras/carbonio-design-system';\nimport { Tag, useTags, ZIMBRA_STANDARD_COLORS } from '@zextras/carbonio-shell-ui';\nimport { includes, reduce } from 'lodash';\n\nimport { EventType } from '../types/event';\nimport { useTagExist } from '../view/tags/tag-actions';\n\nexport type TagItems = Tag & {\n\tcustomComponent: ReactElement;\n\tlabel: string;\n};\n\nexport const TagIconComponent = ({\n\tevent,\n\tdisableOuterTooltip\n}: {\n\tevent: EventType;\n\tdisableOuterTooltip: Dispatch<SetStateAction<boolean>>;\n}): React.JSX.Element => {\n\tconst [showDropdown, setShowDropdown] = useState(false);\n\tconst onIconClick = useCallback((ev) => {\n\t\tev.stopPropagation();\n\t\tsetShowDropdown((o) => !o);\n\t}, []);\n\n\tconst onDropdownClose = useCallback(() => {\n\t\tsetShowDropdown(false);\n\t}, []);\n\n\tconst tags = useTags();\n\n\tconst tagItems = useMemo(\n\t\t() =>\n\t\t\treduce(\n\t\t\t\ttags,\n\t\t\t\t(acc: Array<Tag>, v) => {\n\t\t\t\t\tif (includes(event?.resource?.tags, v.id)) {\n\t\t\t\t\t\treturn [...acc, v];\n\t\t\t\t\t}\n\t\t\t\t\treturn acc;\n\t\t\t\t},\n\t\t\t\t[]\n\t\t\t),\n\t\t[event?.resource?.tags, tags]\n\t);\n\tconst tagIcon = useMemo(() => (tagItems?.length > 1 ? 'TagsMoreOutline' : 'Tag'), [tagItems]);\n\tconst tagIconColor = useMemo(\n\t\t() =>\n\t\t\ttagItems?.length === 1 && tagItems?.[0]?.color\n\t\t\t\t? ZIMBRA_STANDARD_COLORS[tagItems?.[0]?.color]?.hex\n\t\t\t\t: undefined,\n\t\t[tagItems]\n\t);\n\tconst tagName = useMemo(() => (tagItems?.length === 1 ? tagItems?.[0]?.name : ''), [tagItems]);\n\tconst isTagInStore = useTagExist(tagItems);\n\n\tconst showMultiTagIcon = useMemo(\n\t\t() => event?.resource?.tags?.length > 1,\n\t\t[event?.resource?.tags]\n\t);\n\n\tconst showTagIcon = useMemo(\n\t\t() =>\n\t\t\tevent?.resource?.tags &&\n\t\t\tevent?.resource?.tags?.length !== 0 &&\n\t\t\tevent?.resource?.tags?.[0] !== '' &&\n\t\t\t!showMultiTagIcon &&\n\t\t\tisTagInStore,\n\t\t[event?.resource?.tags, showMultiTagIcon, isTagInStore]\n\t);\n\n\tconst tagsDropdownItems = useMemo(\n\t\t() =>\n\t\t\treduce(\n\t\t\t\ttags,\n\t\t\t\t(acc: Array<TagItems>, v) => {\n\t\t\t\t\tif (includes(event?.resource?.tags, v.id))\n\t\t\t\t\t\tacc.push({\n\t\t\t\t\t\t\t...v,\n\t\t\t\t\t\t\tcolor: parseInt(ZIMBRA_STANDARD_COLORS[v.color ?? 0].hex, 10),\n\t\t\t\t\t\t\tlabel: v.name,\n\t\t\t\t\t\t\tcustomComponent: (\n\t\t\t\t\t\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\">\n\t\t\t\t\t\t\t\t\t<Row takeAvailableSpace mainAlignment=\"space-between\">\n\t\t\t\t\t\t\t\t\t\t<Row mainAlignment=\"flex-end\">\n\t\t\t\t\t\t\t\t\t\t\t<Padding right=\"small\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Icon icon=\"Tag\" color={ZIMBRA_STANDARD_COLORS[v.color ?? 0].hex} />\n\t\t\t\t\t\t\t\t\t\t\t</Padding>\n\t\t\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\">\n\t\t\t\t\t\t\t\t\t\t\t<Text>{v.name}</Text>\n\t\t\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\treturn acc;\n\t\t\t\t},\n\t\t\t\t[]\n\t\t\t),\n\t\t[event?.resource?.tags, tags]\n\t);\n\treturn (\n\t\t<>\n\t\t\t{showTagIcon && (\n\t\t\t\t<Tooltip placement=\"top\" label={tagName}>\n\t\t\t\t\t<Padding left=\"extrasmall\">\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\tsize=\"medium\"\n\t\t\t\t\t\t\tdata-testid=\"TagSingleIcon\"\n\t\t\t\t\t\t\ticon={tagIcon}\n\t\t\t\t\t\t\tcolor={tagIconColor}\n\t\t\t\t\t\t\tonMouseEnter={(): void => disableOuterTooltip(true)}\n\t\t\t\t\t\t\tonMouseLeave={(): void => disableOuterTooltip(false)}\n\t\t\t\t\t\t\tonFocus={(): void => disableOuterTooltip(true)}\n\t\t\t\t\t\t\tonBlur={(): void => disableOuterTooltip(false)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Padding>\n\t\t\t\t</Tooltip>\n\t\t\t)}\n\t\t\t{showMultiTagIcon && (\n\t\t\t\t<Dropdown items={tagsDropdownItems} forceOpen={showDropdown} onClose={onDropdownClose}>\n\t\t\t\t\t<Padding left=\"extrasmall\">\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\tsize=\"medium\"\n\t\t\t\t\t\t\tdata-testid=\"TagMultiIcon\"\n\t\t\t\t\t\t\ticon={tagIcon}\n\t\t\t\t\t\t\tonClick={onIconClick}\n\t\t\t\t\t\t\tcolor={tagIconColor}\n\t\t\t\t\t\t\tonMouseEnter={(): void => disableOuterTooltip(true)}\n\t\t\t\t\t\t\tonMouseLeave={(): void => disableOuterTooltip(false)}\n\t\t\t\t\t\t\tonFocus={(): void => disableOuterTooltip(true)}\n\t\t\t\t\t\t\tonBlur={(): void => disableOuterTooltip(false)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Padding>\n\t\t\t\t</Dropdown>\n\t\t\t)}\n\t\t</>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\n\ntype GetMiniCalRequestProps = {\n\tstart: number;\n\tend: number;\n\tfolder: Array<{ id: string }>;\n};\n\nexport const getMiniCalRequest = async ({\n\tstart,\n\tend,\n\tfolder\n}: GetMiniCalRequestProps): Promise<any> =>\n\tsoapFetch('GetMiniCal', {\n\t\t_jsns: 'urn:zimbraMail',\n\t\te: end,\n\t\ts: start,\n\t\tfolder\n\t});\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\nimport { filter, map, values } from 'lodash';\n\nimport { getMiniCalRequest } from '../../soap/get-mini-cal-request';\nimport { Calendar } from '../../types/store/calendars';\n\nexport const getMiniCal = createAsyncThunk(\n\t'calendars/getMiniCalRequest',\n\tasync (\n\t\t{\n\t\t\tstart,\n\t\t\tend\n\t\t}: {\n\t\t\tstart: number;\n\t\t\tend: number;\n\t\t},\n\t\t{ getState }: any\n\t): Promise<unknown> => {\n\t\tconst calendars = filter(\n\t\t\tvalues<Calendar>(getState()?.calendars?.calendars),\n\t\t\t(f) => f.checked && !f.broken\n\t\t);\n\t\tconst folder = map(calendars, (c) => ({ id: c.id }));\n\t\treturn getMiniCalRequest({ start, end, folder });\n\t}\n);\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { TextProps } from '@zextras/carbonio-design-system';\nimport { FOLDERS, ROOT_NAME, t } from '@zextras/carbonio-shell-ui';\nimport { find, forEach, isNil, map, reduce, some } from 'lodash';\nimport moment from 'moment';\n\nimport {\n\tgetFoldersMap,\n\tgetRoot,\n\tgetUpdateFolder\n} from '../carbonio-ui-commons/store/zustand/folder';\nimport type { Folder } from '../carbonio-ui-commons/types/folder';\nimport { hasId } from '../carbonio-ui-commons/worker/handle-message';\nimport { FOLDER_OPERATIONS } from '../constants/api';\nimport { CALENDARS_STANDARD_COLORS } from '../constants/calendar';\nimport { SIDEBAR_ITEMS } from '../constants/sidebar';\nimport { folderAction } from '../store/actions/calendar-actions';\nimport { getMiniCal } from '../store/actions/get-mini-cal';\nimport { searchAppointments } from '../store/actions/search-appointments';\nimport { AppDispatch } from '../store/redux';\nimport { ReminderItem } from '../types/appointment-reminder';\n\nconst FileExtensionRegex = /^.+\\.([^.]+)$/;\n\nexport const isLinkChild = (item: { absFolderPath?: string }): boolean => {\n\tconst folders = getFoldersMap();\n\tconst parentFoldersNames = item?.absFolderPath?.split('/');\n\tparentFoldersNames?.pop(); // removing itself from results\n\tconst parentFolders =\n\t\tmap(parentFoldersNames, (f) => find(folders, (ff) => ff.name === f) ?? '') ?? [];\n\treturn some(parentFolders, ['isLink', true]) ?? false;\n};\n\nexport const isMainRootChild = (item: { id: string }): boolean => {\n\tconst root = getRoot(item.id);\n\treturn root?.id === FOLDERS.USER_ROOT ?? false;\n};\n\nexport const calcColor = (label: string, theme: unknown): string => {\n\tlet sum = 0;\n\tfor (let i = 0; i < label?.length; i += 1) {\n\t\tsum += label.charCodeAt(i);\n\t}\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\treturn theme.avatarColors[`avatar_${(sum % 50) + 1}`];\n};\ntype FileType = {\n\tfilename: string;\n\tcontentType: string;\n};\nexport const getFileExtension = (file: FileType): string => {\n\tconst match = FileExtensionRegex.exec(file.filename);\n\tif (isNil(match)) {\n\t\tswitch (file.contentType) {\n\t\t\tcase 'text/html':\n\t\t\t\treturn 'html';\n\n\t\t\tcase 'text/css':\n\t\t\t\treturn 'css';\n\n\t\t\tcase 'text/xml':\n\t\t\t\treturn 'xml';\n\n\t\t\tcase 'image/gif':\n\t\t\t\treturn 'gif';\n\n\t\t\tcase 'image/jpeg':\n\t\t\t\treturn 'jpg';\n\n\t\t\tcase 'application/x-javascript':\n\t\t\t\treturn 'js';\n\n\t\t\tcase 'application/atom+xml':\n\t\t\t\treturn 'atom';\n\n\t\t\tcase 'application/rss+xml':\n\t\t\t\treturn 'rss';\n\n\t\t\tcase 'text/mathml':\n\t\t\t\treturn 'mml';\n\n\t\t\tcase 'text/plain':\n\t\t\t\treturn 'txt';\n\n\t\t\tcase 'text/vnd.sun.jme.app-descriptor':\n\t\t\t\treturn 'jad';\n\n\t\t\tcase 'text/vnd.wap.wml':\n\t\t\t\treturn 'wml';\n\n\t\t\tcase 'text/x-component':\n\t\t\t\treturn 'htc';\n\n\t\t\tcase 'image/png':\n\t\t\t\treturn 'png';\n\n\t\t\tcase 'image/tiff':\n\t\t\t\treturn 'tif,tiff';\n\n\t\t\tcase 'image/vnd.wap.wbmp':\n\t\t\t\treturn 'wbmp';\n\n\t\t\tcase 'image/x-icon':\n\t\t\t\treturn 'ico';\n\n\t\t\tcase 'image/x-jng':\n\t\t\t\treturn 'jng';\n\n\t\t\tcase 'image/x-ms-bmp':\n\t\t\t\treturn 'bmp';\n\n\t\t\tcase 'image/svg+xml':\n\t\t\t\treturn 'svg';\n\n\t\t\tcase 'image/webp':\n\t\t\t\treturn 'webp';\n\n\t\t\tcase 'application/java-archive':\n\t\t\t\treturn 'jar,war,ear';\n\n\t\t\tcase 'application/mac-binhex':\n\t\t\t\treturn 'hqx';\n\n\t\t\tcase 'application/msword':\n\t\t\t\treturn 'doc';\n\n\t\t\tcase 'application/pdf':\n\t\t\t\treturn 'pdf';\n\n\t\t\tcase 'application/postscript':\n\t\t\t\treturn 'ps,eps,ai';\n\n\t\t\tcase 'application/rtf':\n\t\t\t\treturn 'rtf';\n\n\t\t\tcase 'application/vnd.ms-excel':\n\t\t\t\treturn 'xls';\n\n\t\t\tcase 'application/vnd.ms-powerpoint':\n\t\t\t\treturn 'ppt';\n\n\t\t\tcase 'application/vnd.wap.wmlc':\n\t\t\t\treturn 'wmlc';\n\n\t\t\tcase 'application/vnd.google-earth.kml+xml':\n\t\t\t\treturn 'kml';\n\n\t\t\tcase 'application/vnd.google-earth.kmz':\n\t\t\t\treturn 'kmz';\n\n\t\t\tcase 'application/x-z-compressed':\n\t\t\t\treturn 'z';\n\n\t\t\tcase 'application/x-cocoa':\n\t\t\t\treturn 'cco';\n\n\t\t\tcase 'application/x-java-archive-diff':\n\t\t\t\treturn 'jardiff';\n\n\t\t\tcase 'application/x-java-jnlp-file':\n\t\t\t\treturn 'jnlp';\n\n\t\t\tcase 'application/x-makeself':\n\t\t\t\treturn 'run';\n\n\t\t\tcase 'application/x-perl':\n\t\t\t\treturn 'pl,pm';\n\n\t\t\tcase 'application/x-pilot':\n\t\t\t\treturn 'prc,pdb';\n\n\t\t\tcase 'application/x-rar-compressed':\n\t\t\t\treturn 'rar';\n\n\t\t\tcase 'application/x-redhat-package-manager':\n\t\t\t\treturn 'rpm';\n\n\t\t\tcase 'application/x-sea':\n\t\t\t\treturn 'sea';\n\n\t\t\tcase 'application/x-shockwave-flash':\n\t\t\t\treturn 'swf';\n\n\t\t\tcase 'application/x-stuffit':\n\t\t\t\treturn 'sit';\n\n\t\t\tcase 'application/x-tcl':\n\t\t\t\treturn 'tcl';\n\n\t\t\tcase 'application/x-x-ca-cert':\n\t\t\t\treturn 'der';\n\n\t\t\tcase 'application/x-xpinstall':\n\t\t\t\treturn 'xpi';\n\n\t\t\tcase 'application/xhtml+xml':\n\t\t\t\treturn 'xhtml';\n\n\t\t\tcase 'application/zip':\n\t\t\t\treturn 'zip';\n\n\t\t\tcase 'audio/midi':\n\t\t\t\treturn 'midi';\n\n\t\t\tcase 'audio/mpeg':\n\t\t\t\treturn 'mp';\n\n\t\t\tcase 'audio/ogg':\n\t\t\t\treturn 'ogg';\n\n\t\t\tcase 'audio/x-realaudio':\n\t\t\t\treturn 'ra';\n\n\t\t\tcase 'video/gpp':\n\t\t\t\treturn 'gp';\n\n\t\t\tcase 'video/mpeg':\n\t\t\t\treturn 'mpeg';\n\n\t\t\tcase 'video/quicktime':\n\t\t\t\treturn 'mov';\n\n\t\t\tcase 'video/x-flv':\n\t\t\t\treturn 'flv';\n\n\t\t\tcase 'video/x-mng':\n\t\t\t\treturn 'mng';\n\n\t\t\tcase 'video/x-ms-asf':\n\t\t\t\treturn 'asf';\n\n\t\t\tcase 'video/x-ms-wmv':\n\t\t\t\treturn 'wmv';\n\n\t\t\tcase 'video/x-msvideo':\n\t\t\t\treturn 'avi';\n\n\t\t\tcase 'video/mp':\n\t\t\t\treturn 'mp';\n\n\t\t\tdefault:\n\t\t\t\treturn '?';\n\t\t}\n\t}\n\n\treturn match[1];\n};\n\nexport const convertToDecimal = (source: string): string => {\n\tlet result = '';\n\tfor (let i = 0; i < source.length; i += 1) {\n\t\tconst charCode = source.charCodeAt(i);\n\t\t// Encode non-ascii or double quotes\n\t\tif (charCode > 127 || charCode === 34) {\n\t\t\tlet temp = charCode.toString(10);\n\t\t\twhile (temp.length < 4) {\n\t\t\t\ttemp = `0${temp}`;\n\t\t\t}\n\t\t\tresult += `&#${temp};`;\n\t\t} else {\n\t\t\tresult += source.charAt(i);\n\t\t}\n\t}\n\treturn result;\n};\n\nexport const getTimeToDisplayData = (\n\treminder: ReminderItem,\n\tcurrentTime: number\n): {\n\tcolor: TextProps['color'];\n\tsize: TextProps['size'];\n\ttext: string;\n} => {\n\tconst { start, end, alarmData } = reminder;\n\tconst difference = moment(end).diff(moment(start), 'seconds');\n\tif (start.valueOf() < currentTime && end.valueOf() > currentTime) {\n\t\treturn {\n\t\t\tcolor: 'info',\n\t\t\tsize: 'large',\n\t\t\ttext: t('label.ongoing', 'Ongoing')\n\t\t};\n\t}\n\tif (start.valueOf() === currentTime) {\n\t\treturn {\n\t\t\tcolor: 'info',\n\t\t\tsize: 'large',\n\t\t\ttext: t('label.now', 'Now')\n\t\t};\n\t}\n\tif (start.valueOf() < currentTime) {\n\t\treturn {\n\t\t\tcolor: 'error',\n\t\t\tsize: 'large',\n\t\t\ttext: moment(start).from(moment())\n\t\t};\n\t}\n\tif (alarmData && alarmData?.[0] && alarmData?.[0]?.alarmInstStart) {\n\t\tif (\n\t\t\talarmData[0].alarmInstStart < currentTime &&\n\t\t\tmoment(alarmData[0].alarmInstStart).add(difference, 'seconds').valueOf() > currentTime\n\t\t) {\n\t\t\treturn {\n\t\t\t\tcolor: 'info',\n\t\t\t\tsize: 'large',\n\t\t\t\ttext: t('label.ongoing', 'Ongoing')\n\t\t\t};\n\t\t}\n\t\tif (alarmData[0].alarmInstStart < currentTime) {\n\t\t\treturn {\n\t\t\t\tcolor: 'error',\n\t\t\t\tsize: 'large',\n\t\t\t\ttext: moment(alarmData[0].alarmInstStart).fromNow()\n\t\t\t};\n\t\t}\n\t}\n\treturn {\n\t\tcolor: 'info',\n\t\tsize: 'large',\n\t\ttext: moment(alarmData[0].alarmInstStart).fromNow()\n\t};\n};\n\ntype GetFolderTranslatedName = {\n\tfolderId: string;\n\tfolderName: string;\n};\n\nexport const getFolderTranslatedName = ({\n\tfolderId,\n\tfolderName\n}: GetFolderTranslatedName): string => {\n\tswitch (folderId) {\n\t\tcase FOLDERS.USER_ROOT:\n\t\t\treturn t(`label.root`, folderName);\n\t\tcase 'all':\n\t\t\treturn t('label.all_calendars', 'All calendars');\n\t\tcase FOLDERS.CALENDAR:\n\t\t\treturn t(`label.calendar`, folderName);\n\t\tcase FOLDERS.TRASH:\n\t\t\treturn t(`label.trash`, folderName);\n\t\tdefault:\n\t\t\treturn folderName;\n\t}\n};\n\nexport const getFolderIconColor = (f: Folder): string => {\n\tif (f?.color) {\n\t\treturn Number(f.color) < 10\n\t\t\t? CALENDARS_STANDARD_COLORS[Number(f.color)].color\n\t\t\t: f?.rgb ?? CALENDARS_STANDARD_COLORS[0].color;\n\t}\n\treturn CALENDARS_STANDARD_COLORS[0].color;\n};\n\nexport type RecursiveToggleCheckProps = {\n\tfolder: Folder;\n\tchecked: boolean;\n\tstart: number;\n\tend: number;\n\tdispatch: AppDispatch;\n\tquery: string;\n};\n\nconst checkAllChildren = (_folder: Array<Folder>, checked: boolean): Array<string> =>\n\treduce(\n\t\t_folder,\n\t\t(acc, itemToCheck) => {\n\t\t\tif (itemToCheck.children.length > 0) {\n\t\t\t\treturn hasId(itemToCheck, SIDEBAR_ITEMS.ALL_CALENDAR) || itemToCheck.checked !== checked\n\t\t\t\t\t? [...acc, ...checkAllChildren(itemToCheck.children, checked)]\n\t\t\t\t\t: [...acc, itemToCheck.id, ...checkAllChildren(itemToCheck.children, checked)];\n\t\t\t}\n\t\t\treturn hasId(itemToCheck, SIDEBAR_ITEMS.ALL_CALENDAR) || itemToCheck.checked !== checked\n\t\t\t\t? acc\n\t\t\t\t: [...acc, itemToCheck.id];\n\t\t},\n\t\t[] as Array<string>\n\t);\n\nexport function recursiveToggleCheck({\n\tfolder,\n\tchecked,\n\tdispatch,\n\tstart,\n\tend,\n\tquery\n}: RecursiveToggleCheckProps): void {\n\tconst foldersToToggleIds: Array<string> = checkAllChildren([folder], checked);\n\n\tconst op = checked ? FOLDER_OPERATIONS.UNCHECK : FOLDER_OPERATIONS.CHECK;\n\tconst actions = map(foldersToToggleIds, (id) => ({\n\t\tid,\n\t\top\n\t}));\n\tfolderAction(actions).then((res) => {\n\t\tif (op === FOLDER_OPERATIONS.CHECK && !res.Fault) {\n\t\t\tdispatch(searchAppointments({ spanEnd: end, spanStart: start, query }));\n\t\t\tdispatch(getMiniCal({ start, end })).then((response) => {\n\t\t\t\tconst updateFolder = getUpdateFolder();\n\t\t\t\t// todo: remove ts ignore once getMiniCal is typed\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tif (response?.payload?.Fault) {\n\t\t\t\t\t// todo: remove ts ignore once getMiniCal is typed\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tforEach(response?.payload?.Fault, ({ id }) => {\n\t\t\t\t\t\tupdateFolder(id, { broken: true });\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n}\n\nexport const getFolderIcon = ({ item, checked }: { item: Folder; checked: boolean }): string => {\n\tif (item.id === FOLDERS.USER_ROOT || (item.isLink && item.oname === ROOT_NAME)) return '';\n\tif (hasId(item, FOLDERS.TRASH)) return checked ? 'Trash2' : 'Trash2Outline';\n\tif (hasId(item, SIDEBAR_ITEMS.ALL_CALENDAR)) return checked ? 'Calendar2' : 'CalendarOutline';\n\tif (item.isLink || isLinkChild(item)) return checked ? 'SharedCalendar' : 'SharedCalendarOutline';\n\treturn checked ? 'Calendar2' : 'CalendarOutline';\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nexport const FOLDER_OPERATIONS = {\n\tCOLOR: 'color',\n\tRENAME: 'rename',\n\tMOVE: 'move',\n\tDELETE: 'delete',\n\tGRANT: 'grant',\n\tREVOKE_GRANT: '!grant',\n\tCHECK: 'check',\n\tUNCHECK: '!check',\n\tTRASH: 'trash',\n\tEMPTY: 'empty',\n\tFREE_BUSY: 'fb'\n} as const;\n\nexport const PARTICIPANT_ROLE = {\n\tREQUIRED: 'REQ',\n\tOPTIONAL: 'OPT',\n\tNON_PARTICIPANT: 'NON'\n} as const;\n\nexport const MESSAGE_METHOD = {\n\tCOUNTER: 'COUNTER',\n\tREQUEST: 'REQUEST'\n} as const;\n\nexport const SEARCH_RESOURCES_ATTRS = {\n\tEMAIL: 'email',\n\tCAL_RES_TYPE: 'zimbraCalResType',\n\tFULL_NAME: 'fullName'\n} as const;\n\nexport const SEARCH_RESOURCE_OP = {\n\tEQUAL: 'eq'\n} as const;\n\ntype ObjectValues<T> = T[keyof T];\n\nexport type ParticipantRoleType = ObjectValues<typeof PARTICIPANT_ROLE>;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { CalendarsColorType } from '../types/store/calendars';\n\nexport const WEEK_SCHEDULE = [\n\t{ value: '1', label: 'SUNDAY' },\n\t{ value: '2', label: 'MONDAY' },\n\t{ value: '3', label: 'TUESDAY' },\n\t{ value: '4', label: 'WEDNESDAY' },\n\t{ value: '5', label: 'THURSDAY' },\n\t{ value: '6', label: 'FRIDAY' },\n\t{ value: '7', label: 'SATURDAY' }\n];\n\nexport const CALENDARS_STANDARD_COLORS: Array<CalendarsColorType> = [\n\t{ color: '#000000', background: '#E6E9ED', label: 'black' },\n\t{ color: '#007AFF', background: '#F4FBFF', label: 'blue' },\n\t{ color: '#5AC8FA', background: '#E9F8FE', label: 'cyan' },\n\t{ color: '#34C759', background: '#EFF8F0', label: 'green' },\n\t{ color: '#AF52DE', background: '#F2EEF9', label: 'purple' },\n\t{ color: '#FF3B30', background: '#FDEDED', label: 'red' },\n\t{ color: '#FFCC00', background: '#FFF7DE', label: 'yellow' },\n\t{ color: '#FF2D55', background: '#FDECF1', label: 'pink' },\n\t{ color: '#8E8E93', background: '#F5F6F8', label: 'grey' },\n\t{ color: '#FF9500', background: '#FFF0EC', label: 'orange' }\n];\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nexport const CALENDAR_APP_ID = 'carbonio-calendars-ui';\n\nexport const CALENDAR_ROUTE = 'calendars';\n\nexport const PANEL_VIEW = {\n\tAPP: 'app',\n\tBOARD: 'board',\n\tSEARCH: 'search'\n} as const;\n\nexport const PREFS_DEFAULTS = {\n\tDEFAULT_CALENDAR_ID: '10'\n};\n\nexport const ROOM_DIVIDER =\n\t'-:::_::_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_::_:_::-';\n\nexport const MESSAGE_DIVIDER =\n\t'-::::_::_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_:_::_:_:::-';\n\nexport const HTML_OPENING_TAG = \"<html><body id='htmlmode'>\";\nexport const HTML_CLOSING_TAG = '</body></html>';\n\nexport const CALENDAR_RESOURCES = {\n\tROOM: 'ROO',\n\tRESOURCE: 'RES'\n} as const;\n\nexport const SHARE_USER_TYPE = {\n\tUSER: 'usr',\n\tPUBLIC: 'pub'\n} as const;\n\nexport const PUBLIC_SHARE_ZID = '99999999-9999-9999-9999-999999999999';\n\nexport const DATE_FORMAT = {\n\tALL_DAY: 'YYYYMMDD',\n\tLOCAL: 'YYYYMMDD[T]HHmmss',\n\tUTC: 'YYYYMMDD[T]HHmmss[Z]'\n};\n\nexport const UPDATE_VIEW_EVENT = 'updateView';\n\nexport const DAYS_PER_WEEK = 7;\nexport const HOURS_PER_DAY = 24;\nexport const MINUTES_PER_HOUR = 60;\nexport const SECONDS_PER_MINUTE = 60;\nexport const MINUTES_PER_WEEK = MINUTES_PER_HOUR * HOURS_PER_DAY * DAYS_PER_WEEK;\nexport const MINUTES_PER_DAY = HOURS_PER_DAY * MINUTES_PER_HOUR;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\n// eslint-disable-next-line no-shadow\nexport enum FOLDER_ACTIONS {\n\tMOVE_TO_ROOT = 'moveToRoot',\n\tEMPTY_TRASH = 'emptyTrash',\n\tREMOVE_FROM_LIST = 'removeFromList',\n\tSHARES_INFO = 'sharesInfo',\n\tEDIT = 'edit',\n\tNEW = 'new',\n\tDELETE = 'delete',\n\tSHARE = 'share',\n\tSHARE_URL = 'share_url',\n\tFIND_SHARES = 'find_shares',\n\tEXPORT_ICS = 'export_ics',\n\tUPLOAD = 'upload'\n}\n\n// eslint-disable-next-line no-shadow\nexport enum SIDEBAR_ITEMS {\n\tALL_CALENDAR = 'all',\n\tSHARES = 'shares'\n}\n\nexport type ObjectValues<T> = T[keyof T];\n\nexport type CalendarActionsId = ObjectValues<typeof FOLDER_ACTIONS>;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n// eslint-disable-next-line no-shadow\nexport enum CRB_XPROPS {\n\tMEETING_ROOM = 'X-CRB-MEETING-ROOM'\n}\n// eslint-disable-next-line no-shadow\nexport enum CRB_XPARAMS {\n\tROOM_NAME = 'ROOM-NAME',\n\tROOM_LINK = 'ROOM-LINK'\n}\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\nimport { isNil, omitBy } from 'lodash';\n\nexport const getFreeBusyRequest = async ({\n\ts,\n\te,\n\tuid,\n\texcludeUid\n}: {\n\ts: number;\n\te: number;\n\tuid: string;\n\texcludeUid?: string;\n}): Promise<any> =>\n\tsoapFetch(\n\t\t'GetFreeBusy',\n\t\tomitBy(\n\t\t\t{\n\t\t\t\t_jsns: 'urn:zimbraMail',\n\t\t\t\ts,\n\t\t\t\te,\n\t\t\t\tuid,\n\t\t\t\texcludeUid\n\t\t\t},\n\t\t\tisNil\n\t\t)\n\t);\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { useEffect, useMemo, useState } from 'react';\n\nimport { map, differenceBy, filter, includes, find } from 'lodash';\nimport moment from 'moment';\n\nimport { getFreeBusyRequest } from '../soap/get-free-busy-request';\nimport { Editor } from '../types/editor';\n\nexport type AttendeesAvailabilityType = {\n\tid: string;\n\temail: string;\n\tt: Array<{ s: number; e: number }>;\n\tf: Array<{ s: number; e: number }>;\n\tb: Array<{ s: number; e: number }>;\n\trequestedDays: Array<string>;\n};\n\nexport type AttendeesAvailabilityListType = Array<AttendeesAvailabilityType> | undefined;\n\nexport const useAttendeesAvailability = (\n\tstart: Editor['start'],\n\tattendees: Editor['attendees'] | undefined,\n\texcludeUid?: string | undefined\n): AttendeesAvailabilityListType => {\n\tconst [previousStart, setPreviousStart] = useState<Editor['start']>(start);\n\tconst attendeesWithEmail = useMemo(\n\t\t() => filter(attendees, (attendee) => !!attendee.email),\n\t\t[attendees]\n\t);\n\tconst [attendeesAvailabilityList, setAttendeesAvailabilityList] =\n\t\tuseState<AttendeesAvailabilityListType>(undefined);\n\n\tuseEffect(() => {\n\t\tif (start && attendeesWithEmail && attendeesWithEmail.length > 0) {\n\t\t\tconst currentStartDay = moment(start).format('YYYY/MM/DD');\n\n\t\t\tconst newRangeStart = moment(start).startOf('day').valueOf();\n\t\t\tconst newRangeEnd = moment(start).endOf('day').valueOf();\n\n\t\t\tif (!attendeesAvailabilityList) {\n\t\t\t\tconst uid = map(attendeesWithEmail, (attendee) => attendee.email).join(',');\n\n\t\t\t\tgetFreeBusyRequest({ s: newRangeStart, e: newRangeEnd, uid, excludeUid }).then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst newAttendeesInRangeRetrievedList = map(response.usr, (item) => ({\n\t\t\t\t\t\t\t...item,\n\t\t\t\t\t\t\temail: item.id,\n\t\t\t\t\t\t\tt: item.t ?? [],\n\t\t\t\t\t\t\tf: item.f ?? [],\n\t\t\t\t\t\t\tb: item.b ?? [],\n\t\t\t\t\t\t\trequestedDays: [currentStartDay]\n\t\t\t\t\t\t}));\n\t\t\t\t\t\tif (newAttendeesInRangeRetrievedList.length) {\n\t\t\t\t\t\t\tsetAttendeesAvailabilityList(newAttendeesInRangeRetrievedList);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (attendeesAvailabilityList) {\n\t\t\t\tconst newAttendees = differenceBy(attendeesWithEmail, attendeesAvailabilityList, 'email');\n\t\t\t\tif (newAttendees.length) {\n\t\t\t\t\tconst uid = map(newAttendees, (attendee) => attendee.email).join(',');\n\n\t\t\t\t\tgetFreeBusyRequest({ s: newRangeStart, e: newRangeEnd, uid, excludeUid }).then(\n\t\t\t\t\t\t(response) => {\n\t\t\t\t\t\t\tconst newAttendee = map(response.usr, (item) => ({\n\t\t\t\t\t\t\t\t...item,\n\t\t\t\t\t\t\t\temail: item.id,\n\t\t\t\t\t\t\t\tt: item.t ?? [],\n\t\t\t\t\t\t\t\tf: item.f ?? [],\n\t\t\t\t\t\t\t\tb: item.b ?? [],\n\t\t\t\t\t\t\t\trequestedDays: [currentStartDay]\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\tconst newList = attendeesAvailabilityList.concat(newAttendee);\n\t\t\t\t\t\t\tsetAttendeesAvailabilityList(newList);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tconst previousStartDay = moment(previousStart).format('YYYY/MM/DD');\n\n\t\t\t\tif (currentStartDay !== previousStartDay) {\n\t\t\t\t\tsetPreviousStart(start);\n\t\t\t\t\tconst AttendeesToRetrieve = filter(\n\t\t\t\t\t\tattendeesAvailabilityList,\n\t\t\t\t\t\t(attendee) => !includes(attendee.requestedDays, currentStartDay)\n\t\t\t\t\t);\n\t\t\t\t\tif (AttendeesToRetrieve.length > 0) {\n\t\t\t\t\t\tconst uid = map(AttendeesToRetrieve, (attendee) => attendee.email).join(',');\n\n\t\t\t\t\t\tgetFreeBusyRequest({ s: newRangeStart, e: newRangeEnd, uid, excludeUid }).then(\n\t\t\t\t\t\t\t(response) => {\n\t\t\t\t\t\t\t\tconst newAttendeesInRangeRetrievedList = map(response.usr, (item) => {\n\t\t\t\t\t\t\t\t\tconst oldItem = find(attendeesAvailabilityList, ['id', item.id]);\n\t\t\t\t\t\t\t\t\tif (oldItem) {\n\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t\t...oldItem,\n\t\t\t\t\t\t\t\t\t\t\temail: oldItem.email,\n\t\t\t\t\t\t\t\t\t\t\tt: (oldItem?.t ?? []).concat(item.t ?? []),\n\t\t\t\t\t\t\t\t\t\t\tf: (oldItem?.f ?? []).concat(item.f ?? []),\n\t\t\t\t\t\t\t\t\t\t\tb: (oldItem?.b ?? []).concat(item.b ?? []),\n\t\t\t\t\t\t\t\t\t\t\trequestedDays: (oldItem?.requestedDays ?? []).concat([currentStartDay])\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t...item,\n\t\t\t\t\t\t\t\t\t\temail: item.id,\n\t\t\t\t\t\t\t\t\t\tt: item.t ?? [],\n\t\t\t\t\t\t\t\t\t\tf: item.f ?? [],\n\t\t\t\t\t\t\t\t\t\tb: item.b ?? [],\n\t\t\t\t\t\t\t\t\t\trequestedDays: [currentStartDay]\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tconst oldAttendeesInRangeRetrievedList = differenceBy(\n\t\t\t\t\t\t\t\t\tattendeesAvailabilityList,\n\t\t\t\t\t\t\t\t\tresponse.usr,\n\t\t\t\t\t\t\t\t\t'id'\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tsetAttendeesAvailabilityList(\n\t\t\t\t\t\t\t\t\toldAttendeesInRangeRetrievedList.concat(newAttendeesInRangeRetrievedList)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}, [attendeesWithEmail, attendeesAvailabilityList, excludeUid, previousStart, start]);\n\n\treturn useMemo(() => attendeesAvailabilityList, [attendeesAvailabilityList]);\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { filter, map } from 'lodash';\n\nimport { useCheckedFolders } from './use-checked-folders';\nimport { LinkFolder } from '../carbonio-ui-commons/types/folder';\n\nexport const useCheckedCalendarsQuery = (): string => {\n\tconst calendars = useCheckedFolders();\n\treturn map(\n\t\tfilter(calendars, (calendar) => calendar.checked === true && !(calendar as LinkFolder).broken),\n\t\t(result, id) => (id === 0 ? `inid:\"${result.id}\"` : `OR inid:\"${result.id}\"`)\n\t).join(' ');\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { useMemo } from 'react';\n\nimport { filter } from 'lodash';\n\nimport { useFoldersMap } from '../carbonio-ui-commons/store/zustand/folder';\nimport { Folder } from '../carbonio-ui-commons/types/folder';\n\nexport const useCheckedFolders = (): Array<Folder> => {\n\tconst calendars = useFoldersMap();\n\n\treturn useMemo(() => filter(calendars, ['checked', true]), [calendars]);\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { useCallback, useMemo } from 'react';\n\nimport moment from 'moment';\nimport { useTranslation } from 'react-i18next';\n\nimport { getLocalTime, isTimezoneDifferentFromLocal } from '../normalizations/normalize-editor';\nimport { DateType } from '../types/event';\n\nexport const getTimeString = (\n\t_start: number | undefined,\n\t_end: number | undefined,\n\tallDay: boolean | undefined,\n\tallDayLabel: string\n): string => {\n\tconst startEvent = moment(_start);\n\tconst endEvent = moment(_end);\n\tconst dayFormat = 'dddd, DD MMMM, YYYY';\n\tconst timeFormat = 'HH:mm';\n\tconst completeFormat = `${dayFormat} ${timeFormat}`;\n\tconst diff = endEvent.diff(startEvent, 'days');\n\tconst allDayString =\n\t\tdiff > 0\n\t\t\t? `${startEvent.format(dayFormat)} -\n\t           ${endEvent.format(dayFormat)} - ${allDayLabel}`\n\t\t\t: `${startEvent.format(dayFormat)} - ${allDayLabel}`;\n\n\tconst notAllDayString =\n\t\tdiff > 0\n\t\t\t? `${startEvent.format(completeFormat)} - ${endEvent.format(completeFormat)}`\n\t\t\t: `${startEvent.format(completeFormat)} - ${endEvent.format(timeFormat)}`;\n\n\treturn allDay ? allDayString : notAllDayString;\n};\n\nexport const useGetEventTimezoneString = (\n\tstart: number | DateType,\n\tend: number | DateType,\n\tallDay: boolean | undefined,\n\ttimezone: string | undefined\n): {\n\tlocalTimeString: string;\n\tlocalTimezoneString: string;\n\teventTimeString: string;\n\teventTimezoneString: string;\n\tshowTimezoneTooltip: boolean;\n\tlocalTimezoneTooltip: JSX.Element;\n\teventTimezoneTooltip: JSX.Element;\n} => {\n\tconst [t] = useTranslation();\n\tconst allDayLabel = t('label.all_day', 'All day');\n\n\tconst localTimezone = useMemo(() => moment.tz.guess(), []);\n\tconst localStart = getLocalTime(start, localTimezone);\n\tconst localEnd = getLocalTime(end, localTimezone);\n\n\tconst eventStart = useMemo(() => getLocalTime(start, timezone), [start, timezone]);\n\tconst eventEnd = useMemo(() => getLocalTime(end, timezone), [end, timezone]);\n\n\tconst getTimeZoneString = useCallback(\n\t\t(_start, _timezone) => {\n\t\t\tif (_timezone && !allDay) {\n\t\t\t\treturn `GMT ${moment(_start).startOf('year').tz(_timezone).format('Z')} ${_timezone}`;\n\t\t\t}\n\t\t\treturn `GMT ${moment(_start).startOf('year').tz(localTimezone).format('Z')} ${localTimezone}`;\n\t\t},\n\t\t[allDay, localTimezone]\n\t);\n\n\tconst getTimezoneTooltip = useCallback(\n\t\t(label, timeString, timezoneString) => (\n\t\t\t<>\n\t\t\t\t{label}\n\t\t\t\t<br />\n\t\t\t\t{timeString}\n\t\t\t\t<br />\n\t\t\t\t{timezoneString}\n\t\t\t</>\n\t\t),\n\t\t[]\n\t);\n\tconst localTimeString = useMemo(\n\t\t() => getTimeString(localStart, localEnd, allDay, allDayLabel),\n\t\t[localStart, localEnd, allDay, allDayLabel]\n\t);\n\n\tconst eventTimeString = useMemo(\n\t\t() => getTimeString(eventStart, eventEnd, allDay, allDayLabel),\n\t\t[eventStart, eventEnd, allDay, allDayLabel]\n\t);\n\n\tconst localTimezoneString = useMemo(\n\t\t() => getTimeZoneString(localStart, localTimezone),\n\t\t[getTimeZoneString, localStart, localTimezone]\n\t);\n\n\tconst eventTimezoneString = useMemo(\n\t\t() => getTimeZoneString(eventStart, timezone),\n\t\t[getTimeZoneString, eventStart, timezone]\n\t);\n\n\tconst showTimezoneTooltip = useMemo(() => {\n\t\tif (timezone && start) {\n\t\t\treturn isTimezoneDifferentFromLocal(start, timezone);\n\t\t}\n\t\treturn isTimezoneDifferentFromLocal(start, localTimezone);\n\t}, [localTimezone, start, timezone]);\n\n\tconst localTimezoneTooltip = useMemo(\n\t\t() =>\n\t\t\tgetTimezoneTooltip(\n\t\t\t\tt('creation_timezone_tooltip', 'Date and time on creation timezone:'),\n\t\t\t\teventTimeString,\n\t\t\t\teventTimezoneString\n\t\t\t),\n\t\t[eventTimeString, eventTimezoneString, getTimezoneTooltip, t]\n\t);\n\n\tconst eventTimezoneTooltip = useMemo(\n\t\t() =>\n\t\t\tgetTimezoneTooltip(\n\t\t\t\tt('local_timezone_tooltip', 'Date and time on local timezone:'),\n\t\t\t\tlocalTimeString,\n\t\t\t\tlocalTimezoneString\n\t\t\t),\n\t\t[getTimezoneTooltip, t, localTimeString, localTimezoneString]\n\t);\n\n\treturn {\n\t\tlocalTimeString,\n\t\tlocalTimezoneString,\n\t\teventTimeString,\n\t\teventTimezoneString,\n\t\tshowTimezoneTooltip,\n\t\tlocalTimezoneTooltip,\n\t\teventTimezoneTooltip\n\t};\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { t } from '@zextras/carbonio-shell-ui';\nimport { groupBy, isNil, map, reduce, uniqBy } from 'lodash';\nimport { setLightness } from 'polished';\n\nimport { DAYS_PER_WEEK, HOURS_PER_DAY, MINUTES_PER_HOUR, SECONDS_PER_MINUTE } from '../constants';\nimport { CALENDARS_STANDARD_COLORS } from '../constants/calendar';\nimport { CalendarsColorType } from '../types/store/calendars';\nimport { AlarmData } from '../types/store/invite';\nimport { daysToMinutes, hoursToMinutes, secondsToMinutes, weeksToMinutes } from '../utils/times';\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const retrieveAttachmentsType = (original: any, disposition: any, dataID: any): any =>\n\treduce(\n\t\toriginal.mp ?? [],\n\t\t(acc, part) =>\n\t\t\tpart.cd && part.cd === disposition ? [...acc, { part: part.part, mid: dataID }] : acc,\n\t\t[] as any\n\t);\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const normalizeInviteParticipants = (participants: any): any =>\n\tgroupBy(\n\t\tuniqBy(\n\t\t\tmap(participants, (p) => ({\n\t\t\t\tname: p.d,\n\t\t\t\temail: p.a,\n\t\t\t\tisOptional: p.role === 'OPT' || false,\n\t\t\t\tresponse: p.ptst,\n\t\t\t\tcutype: p.cutype\n\t\t\t})),\n\t\t\t'email'\n\t\t),\n\t\t(p) => p.response\n\t);\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const normalizeMailPartMapFn = (v: any): any => {\n\tconst ret: any = {\n\t\tcontentType: v.ct,\n\t\tsize: v.s || 0,\n\t\tname: v.part\n\t};\n\tif (v.mp) {\n\t\tret.parts = map(v.mp || [], normalizeMailPartMapFn);\n\t}\n\tif (v.filename) ret.filename = v.filename;\n\tif (v.content) ret.content = v.content;\n\tif (v.ci) ret.ci = v.ci;\n\tif (v.cd) ret.disposition = v.cd;\n\treturn ret;\n};\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const findAttachments = (parts: any, acc: any): any =>\n\treduce(\n\t\tparts,\n\t\t(found, part) => {\n\t\t\tif (part && part.cd === 'attachment') {\n\t\t\t\tfound.push(normalizeMailPartMapFn(part));\n\t\t\t}\n\t\t\tif (part.mp) return findAttachments(part.mp, found);\n\t\t\treturn acc;\n\t\t},\n\t\tacc\n\t);\n\nexport type Rel = {\n\ts?: number;\n\tm?: number;\n\th?: number;\n\td?: number;\n\tw?: number;\n};\n\nconst isAtTheTimeOfTheEvent = (relativeTrigger: Rel): boolean =>\n\trelativeTrigger?.s === 0 ||\n\trelativeTrigger?.m === 0 ||\n\trelativeTrigger?.h === 0 ||\n\trelativeTrigger?.d === 0 ||\n\trelativeTrigger?.w === 0;\n\nexport const getAlarmValueInMinutes = (relativeTrigger?: Rel): string => {\n\tconst AT_THE_TIME_OF_THE_EVENT = '-1';\n\tconst NO_TRIGGER = '0';\n\tconst MINIMUM_TRIGGER_VALUE = '1';\n\n\tif (!relativeTrigger) {\n\t\treturn NO_TRIGGER;\n\t}\n\tif (isAtTheTimeOfTheEvent(relativeTrigger)) {\n\t\treturn AT_THE_TIME_OF_THE_EVENT;\n\t}\n\tif (!isNil(relativeTrigger.s)) {\n\t\tif (relativeTrigger.s % SECONDS_PER_MINUTE === 0) {\n\t\t\treturn secondsToMinutes(relativeTrigger.s).toString();\n\t\t}\n\t\treturn MINIMUM_TRIGGER_VALUE;\n\t}\n\tif (!isNil(relativeTrigger.m)) {\n\t\treturn relativeTrigger.m.toString();\n\t}\n\tif (!isNil(relativeTrigger.h)) {\n\t\treturn hoursToMinutes(relativeTrigger.h).toString();\n\t}\n\tif (!isNil(relativeTrigger.d)) {\n\t\treturn daysToMinutes(relativeTrigger.d).toString();\n\t}\n\tif (!isNil(relativeTrigger.w)) {\n\t\treturn weeksToMinutes(relativeTrigger.w).toString();\n\t}\n\treturn AT_THE_TIME_OF_THE_EVENT;\n};\n\nexport const getAlarmToString = (alarm?: AlarmData): string => {\n\tif (alarm && alarm[0] && alarm[0].action === 'DISPLAY') {\n\t\tconst rel = alarm[0].trigger[0].rel[0];\n\n\t\tif (rel) {\n\t\t\tconst seconds =\n\t\t\t\t(rel.s || 0) +\n\t\t\t\t(rel.m || 0) * SECONDS_PER_MINUTE +\n\t\t\t\t(rel.h || 0) * SECONDS_PER_MINUTE * MINUTES_PER_HOUR +\n\t\t\t\t(rel.d || 0) * SECONDS_PER_MINUTE * MINUTES_PER_HOUR * HOURS_PER_DAY +\n\t\t\t\t(rel.w || 0) * SECONDS_PER_MINUTE * MINUTES_PER_HOUR * HOURS_PER_DAY * DAYS_PER_WEEK;\n\n\t\t\tif ((rel.s || 0) + (rel.m || 0) + (rel.h || 0) + (rel.d || 0) + (rel.w || 0) === 0) {\n\t\t\t\treturn t('reminder.at_time_of_event', 'At the time of the event');\n\t\t\t}\n\t\t\tif (seconds % (SECONDS_PER_MINUTE * MINUTES_PER_HOUR * HOURS_PER_DAY * DAYS_PER_WEEK) === 0) {\n\t\t\t\tconst weeks =\n\t\t\t\t\tseconds / (SECONDS_PER_MINUTE * MINUTES_PER_HOUR * HOURS_PER_DAY * DAYS_PER_WEEK);\n\t\t\t\treturn t('reminder.week_before', {\n\t\t\t\t\tcount: weeks,\n\t\t\t\t\tdefaultValue_one: '{{count}} week before',\n\t\t\t\t\tdefaultValue_other: '{{count}} weeks before'\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (seconds % (SECONDS_PER_MINUTE * MINUTES_PER_HOUR * HOURS_PER_DAY) === 0) {\n\t\t\t\tconst days = seconds / (SECONDS_PER_MINUTE * MINUTES_PER_HOUR * HOURS_PER_DAY);\n\t\t\t\treturn t('reminder.day_before', {\n\t\t\t\t\tcount: days,\n\t\t\t\t\tdefaultValue_one: '{{count}} day before',\n\t\t\t\t\tdefaultValue_other: '{{count}} days before'\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (seconds % (SECONDS_PER_MINUTE * MINUTES_PER_HOUR) === 0) {\n\t\t\t\tconst hours = seconds / (SECONDS_PER_MINUTE * MINUTES_PER_HOUR);\n\t\t\t\treturn t('reminder.hour_before', {\n\t\t\t\t\tcount: hours,\n\t\t\t\t\tdefaultValue_one: '{{count}} hour before',\n\t\t\t\t\tdefaultValue_other: '{{count}} hours before'\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (seconds % SECONDS_PER_MINUTE === 0) {\n\t\t\t\tconst minutes = seconds / SECONDS_PER_MINUTE;\n\t\t\t\treturn t('reminder.minute_before', {\n\t\t\t\t\tcount: minutes,\n\t\t\t\t\tdefaultValue_one: '{{count}} minute before',\n\t\t\t\t\tdefaultValue_other: '{{count}} minutes before'\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn t('reminder.second_before', {\n\t\t\t\tcount: seconds,\n\t\t\t\tdefaultValue_one: '{{count}} second before',\n\t\t\t\tdefaultValue_other: '{{count}} seconds before'\n\t\t\t});\n\t\t}\n\t}\n\treturn 'never';\n};\n\nexport const setCalendarColorFromRGB = (color: string | undefined): CalendarsColorType =>\n\tcolor\n\t\t? {\n\t\t\t\tcolor,\n\t\t\t\tlabel: 'custom',\n\t\t\t\tbackground: setLightness(0.9, color)\n\t\t\t}\n\t\t: CALENDARS_STANDARD_COLORS[0];\n\nexport const setCalendarColorFromNumber = (color: number | undefined): CalendarsColorType =>\n\tCALENDARS_STANDARD_COLORS?.[color ?? 0] ?? CALENDARS_STANDARD_COLORS[0];\n\nexport const setCalendarColor = ({\n\trgb,\n\tcolor\n}: {\n\trgb?: string;\n\tcolor?: number;\n}): CalendarsColorType => {\n\tif (rgb) {\n\t\treturn setCalendarColorFromRGB(rgb);\n\t}\n\tif (color) {\n\t\treturn setCalendarColorFromNumber(color);\n\t}\n\treturn CALENDARS_STANDARD_COLORS[0];\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { filter, isNil, map, omitBy, reduce } from 'lodash';\nimport moment from 'moment';\n\nimport { Appointment, ExceptionReference, InstanceReference } from '../types/store/appointments';\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nconst normalizeApptInstanceRef = (instRef: any): ExceptionReference => ({\n\talarm: instRef.alarm,\n\tallDay: instRef.allDay,\n\tdraft: instRef.draft,\n\tinviteId: instRef.invId,\n\tisOrg: instRef.isOrg,\n\tdur: instRef.dur,\n\tloc: instRef?.loc,\n\tname: instRef.name,\n\tptst: instRef.ptst,\n\tneverSent: instRef.neverSent,\n\tor: instRef.or,\n\totherAtt: instRef.otherAtt,\n\tex: instRef.ex,\n\tfr: instRef.fr,\n\trecur: instRef.recur,\n\tridZ: instRef.ridZ,\n\ts: instRef.s,\n\ttzo: instRef.tzo\n});\n\nconst normalizeApptInstancesRefs = (\n\tinstRefs: Array<InstanceReference>,\n\trecur = false\n): Array<InstanceReference> =>\n\tmap(instRefs ?? [], (instRef) =>\n\t\tObject?.keys(instRef)?.length > 2\n\t\t\t? normalizeApptInstanceRef(instRef as ExceptionReference)\n\t\t\t: { ...instRef, recur }\n\t);\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const normalizeAppointment = (appt: any): Appointment => ({\n\tid: appt.id,\n\talarm: appt.alarm,\n\talarmData: appt.alarmData,\n\thasEx: appt?.hasEx,\n\tfb: appt.fb,\n\tfr: appt.fr ?? '',\n\td: appt.d,\n\tfba: appt.fba,\n\tmd: appt.md,\n\tflags: appt.f ?? '',\n\tms: appt.ms,\n\tptst: appt.ptst,\n\trev: appt.rev,\n\tstatus: appt.status,\n\ttransp: appt.transp,\n\tuid: appt.uid,\n\tcompNum: appt.compNum,\n\tclass: appt.class,\n\tdur: appt.dur,\n\tallDay: appt.allDay,\n\tinst: normalizeApptInstancesRefs(appt.inst, appt.recur),\n\tdraft: appt.draft,\n\tinviteId: appt.invId,\n\tisOrg: appt.isOrg,\n\tloc: appt.loc,\n\totherAtt: appt.otherAtt,\n\trecur: appt.recur ?? false,\n\tl: appt.l,\n\tname: appt.name,\n\tneverSent: appt.neverSent,\n\tor: appt.or,\n\ts: appt.s,\n\ttags: !isNil(appt.t) ? filter(appt.t.split(','), (t) => t !== '') : []\n});\n\nexport const normalizeAppointments = (\n\tappts: Array<Appointment>\n): Record<string, Appointment> | undefined =>\n\tappts\n\t\t? reduce(appts, (acc, appt) => ({ ...acc, [appt.id]: normalizeAppointment(appt) }), {})\n\t\t: undefined;\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const normalizeAppointmentFromCreation = (appt: any, editor: any, id?: string): any => ({\n\tid: id ?? appt.inv[0].id,\n\talarmData: appt.inv[0].comp[0].alarmData,\n\tfb: appt.inv[0].comp[0].fb,\n\tfr: appt.inv[0].comp[0].fr ?? '',\n\td: appt.inv[0].comp[0].d,\n\tfba: appt.inv[0].comp[0].fba,\n\tmd: appt.md,\n\tflags: appt.f ?? '',\n\tms: appt.ms,\n\tptst: appt.ptst,\n\tdur: editor.end - editor.start,\n\trev: appt.rev,\n\tstatus: appt.inv[0].comp[0].status,\n\ttransp: appt.inv[0].comp[0].transp,\n\tuid: appt.inv[0].comp[0].uid,\n\tcompNum: appt.inv[0].comp[0].compNum,\n\tclass: appt.inv[0].comp[0].class,\n\tallDay: editor.allDay,\n\tinst: [\n\t\t{\n\t\t\trecur: appt.recur ?? false,\n\t\t\tridZ: moment(editor.start).format('YYYYMMDD[T]HHmmss[Z]'),\n\t\t\ts: editor.start\n\t\t}\n\t],\n\talarm: appt.inv[0].comp[0].alarm,\n\tdraft: editor.resource?.draft || false,\n\tinviteId: appt.id,\n\tisOrg: appt.inv[0].comp[0].isOrg,\n\tloc: appt.inv[0].comp[0].loc,\n\totherAtt: appt.inv[0].comp[0].otherAtt ?? false,\n\trecur: appt.recur ?? false,\n\tl: appt.l,\n\tname: appt.inv[0].comp[0].name,\n\tneverSent: editor.resource?.neverSent || false,\n\tor: appt.inv[0].comp[0].or,\n\ts: appt.inv[0].comp[0].s\n});\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const normalizeAppointmentFromNotify = (appt: any): Appointment => <Appointment>omitBy(\n\t\t{\n\t\t\tid: appt?.id,\n\t\t\talarm: appt?.inv?.[0]?.comp?.[0]?.alarm,\n\t\t\talarmData: appt?.inv?.[0]?.comp?.[0]?.alarmData,\n\t\t\tfb: appt?.inv?.[0]?.comp?.[0]?.fb,\n\t\t\tfr: appt?.inv?.[0]?.comp?.[0]?.fr,\n\t\t\td: appt?.d,\n\t\t\tfba: appt?.inv?.[0]?.comp?.[0]?.fba,\n\t\t\tmd: appt.md,\n\t\t\tflags: appt?.inv?.[0]?.comp?.[0]?.f,\n\t\t\tms: appt?.inv?.[0]?.comp?.[0]?.ms,\n\t\t\tptst: appt?.ptst,\n\t\t\trev: appt.rev,\n\t\t\tstatus: appt?.inv?.[0]?.comp?.[0]?.status,\n\t\t\ttransp: appt?.inv?.[0]?.comp?.[0]?.transp,\n\t\t\tuid: appt.uid,\n\t\t\tcompNum: appt?.inv?.[0]?.compNum,\n\t\t\tclass: appt?.inv?.[0]?.comp?.[0]?.class,\n\t\t\tdur:\n\t\t\t\tappt?.inv?.[0]?.comp?.[0]?.e?.[0]?.u && appt?.inv?.[0]?.comp?.[0]?.s?.[0]?.u\n\t\t\t\t\t? appt.inv[0].comp[0].e[0].u - appt.inv[0].comp[0].s[0].u\n\t\t\t\t\t: undefined,\n\t\t\tallDay: appt?.inv?.[0]?.comp?.[0]?.allDay,\n\t\t\tinst:\n\t\t\t\tappt?.id && appt?.inv?.[0]?.comp?.[0] && appt?.inv?.length === 1\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\trecur: false,\n\t\t\t\t\t\t\t\tridZ: appt?.inv?.[0]?.comp?.[0]?.s?.[0]?.d,\n\t\t\t\t\t\t\t\ts: appt?.inv?.[0]?.comp?.[0]?.s?.[0]?.u,\n\t\t\t\t\t\t\t\ttitle: appt?.inv?.[0]?.comp?.[0]?.name\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t: undefined,\n\t\t\tdraft: appt?.inv?.[0]?.comp?.[0]?.draft,\n\t\t\tinviteId: appt?.id && appt?.inv?.[0] ? `${appt.id}-${appt.inv[0].id}` : undefined,\n\t\t\tisOrg: appt?.inv?.[0]?.comp?.[0]?.isOrg,\n\t\t\tloc: appt?.inv?.[0]?.comp?.[0]?.loc,\n\t\t\totherAtt: appt?.inv?.[0]?.comp?.[0]?.otherAtt,\n\t\t\trecur: appt?.inv?.[0]?.comp?.[0]?.recur,\n\t\t\tl: appt.l,\n\t\t\tname: appt?.inv?.[0]?.comp?.[0]?.name,\n\t\t\tmeta: appt?.meta,\n\t\t\tneverSent: appt?.inv?.[0]?.comp?.[0]?.neverSent,\n\t\t\tor: appt?.inv?.[0]?.comp?.[0]?.or,\n\t\t\ts: appt.s\n\t\t},\n\t\tisNil\n\t);\n\nexport const normalizeAppointmentsFromNotify = (\n\tappts: Array<Appointment>\n): Record<string, Appointment> | undefined =>\n\tappts\n\t\t? reduce(\n\t\t\t\tappts,\n\t\t\t\t(acc, appt) => ({ ...acc, [appt.id]: normalizeAppointmentFromNotify(appt) }),\n\t\t\t\t{}\n\t\t\t)\n\t\t: undefined;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { getUserAccount } from '@zextras/carbonio-shell-ui';\nimport { find, reduce, map, isEmpty } from 'lodash';\nimport moment from 'moment';\n\nimport { setCalendarColor } from './normalizations-utils';\nimport { getRoot } from '../carbonio-ui-commons/store/zustand/folder';\nimport { Folder, Folders, LinkFolder } from '../carbonio-ui-commons/types/folder';\nimport { EventResource, EventType } from '../types/event';\nimport { Appointment, ExceptionReference, InstanceReference } from '../types/store/appointments';\nimport { CalendarsColorType } from '../types/store/calendars';\nimport { Invite } from '../types/store/invite';\n\nexport const getLocationUrl = (location: string): string | undefined => {\n\tconst regex = /\\bhttps?:\\/\\/\\S+/g;\n\tconst found = location?.match(regex);\n\n\treturn found?.length ? found[0] : undefined;\n};\n\nexport const getDaysFromMillis = (milliseconds: number): number => milliseconds / 3600 / 1000 / 24;\n\nconst getCalendarResource = (calendar: {\n\tid: string;\n\tname: string;\n\tcolor?: number;\n\trgb?: string;\n\tperm?: string;\n}): {\n\towner: string | undefined;\n\tcolor: CalendarsColorType;\n\tperm: string | undefined;\n\tname: string;\n\tid: string;\n} => {\n\tconst root = getRoot(calendar.id);\n\n\treturn {\n\t\tid: calendar.id,\n\t\tname: calendar.name,\n\t\tcolor: setCalendarColor({ color: calendar.color, rgb: calendar?.rgb }),\n\t\towner: (calendar as LinkFolder)?.owner ?? (root as LinkFolder)?.owner,\n\t\tperm: calendar?.perm\n\t};\n};\nconst normalizeEventResource = ({\n\tappt,\n\tcalendar,\n\tinst,\n\tinvite,\n\tiAmOrganizer\n}: {\n\tappt: Appointment;\n\tcalendar: Folder;\n\tinst?: ExceptionReference;\n\tinvite?: Invite;\n\tiAmOrganizer: boolean;\n}): EventResource => ({\n\tid: appt.id,\n\tinviteId: inst?.inviteId ?? appt.inviteId,\n\tridZ: inst?.ridZ,\n\tname: inst?.name ?? appt.name,\n\tcalendar: getCalendarResource(calendar),\n\tflags: appt.flags,\n\tdur: inst?.dur ?? appt.dur,\n\tiAmOrganizer,\n\tiAmVisitor: !!(!iAmOrganizer && (calendar as LinkFolder)?.owner) ?? false, // todo: unused, can be removed\n\tiAmAttendee: (!iAmOrganizer && !(calendar as LinkFolder)?.owner) ?? false,\n\tstatus: inst?.status ?? appt.status,\n\tlocation: inst?.loc ?? appt.loc,\n\tlocationUrl: getLocationUrl(inst?.loc ?? appt.loc ?? ''),\n\tfragment: (inst as ExceptionReference)?.fr ?? appt.fr,\n\tclass: inst?.class ?? appt.class,\n\tfreeBusy: inst?.fb ?? appt.fb,\n\thasChangesNotNotified: inst?.draft ?? appt.draft ?? false,\n\tinviteNeverSent: inst?.neverSent ?? appt.neverSent ?? false,\n\thasOtherAttendees: inst?.otherAtt ?? appt.otherAtt ?? false,\n\tisRecurrent: inst?.recur ?? appt.recur,\n\tisException: inst?.ex ?? false,\n\thasException: inst?.hasEx ?? appt.hasEx ?? false,\n\tparticipationStatus: inst?.ptst ?? appt.ptst,\n\torganizer:\n\t\tappt?.or?.d || appt?.or?.a\n\t\t\t? {\n\t\t\t\t\tname: appt?.or?.d,\n\t\t\t\t\temail: appt?.or?.a\n\t\t\t\t}\n\t\t\t: undefined,\n\tcompNum: appt.compNum,\n\tapptStart: inst?.s,\n\talarm: appt.alarm,\n\talarmData: invite?.alarmData ?? appt?.alarmData?.[0]?.alarm,\n\tuid: appt.uid,\n\ttags: appt.tags ?? [],\n\tneverSent: inst?.neverSent ?? appt.neverSent ?? false,\n\tisRespRequested: (inst?.ptst ?? appt.ptst) === 'NE' ?? false\n});\n\nexport const normalizeCalendarEvent = ({\n\tcalendar,\n\tappointment,\n\tinstance,\n\tinvite\n}: {\n\tcalendar: Folder;\n\tappointment: Appointment;\n\tinstance?: InstanceReference;\n\tinvite?: Invite;\n}): EventType => {\n\tconst allDay = (instance as ExceptionReference)?.allDay ?? appointment?.allDay;\n\tconst instanceStart = instance\n\t\t? (instance as ExceptionReference).s + ((instance as ExceptionReference)?.tzo ?? 0)\n\t\t: undefined;\n\tconst start = instanceStart || (invite as Invite)?.start?.u || appointment.inst?.[0]?.s;\n\tconst dur = (instance as ExceptionReference)?.dur ?? appointment.dur;\n\tconst user = getUserAccount();\n\n\treturn {\n\t\tstart: allDay ? new Date(moment(start).startOf('day').valueOf()) : new Date(start),\n\t\tend: allDay\n\t\t\t? new Date(\n\t\t\t\t\tmoment(start)\n\t\t\t\t\t\t.add(getDaysFromMillis(dur) - 1, 'days')\n\t\t\t\t\t\t.endOf('day')\n\t\t\t\t\t\t.valueOf()\n\t\t\t\t)\n\t\t\t: new Date(start + dur),\n\t\tresource: normalizeEventResource({\n\t\t\tappt: appointment,\n\t\t\tiAmOrganizer: user?.name === appointment?.or?.a,\n\t\t\tcalendar,\n\t\t\tinst: instance as ExceptionReference,\n\t\t\tinvite\n\t\t}),\n\t\ttitle: instance?.name ?? appointment?.name ?? '',\n\t\tallDay,\n\t\tid: `${appointment.id}:${(instance as ExceptionReference)?.inviteId ?? appointment.inviteId}:${\n\t\t\tinstance?.ridZ ?? ''\n\t\t}`,\n\t\tisShared: appointment?.l?.includes(':'),\n\t\thaveWriteAccess: calendar.perm ? /w/.test(calendar.perm) : true\n\t};\n};\n\nexport const normalizeCalendarEvents = (\n\tappts: Array<Appointment>,\n\tcalendars: Folders\n): Array<EventType> =>\n\t!isEmpty(appts)\n\t\t? reduce(\n\t\t\t\tappts,\n\t\t\t\t(acc, appt) => {\n\t\t\t\t\tconst isShared = appt?.l?.includes(':');\n\t\t\t\t\tconst cal = isShared\n\t\t\t\t\t\t? find(\n\t\t\t\t\t\t\t\tcalendars,\n\t\t\t\t\t\t\t\t(f) =>\n\t\t\t\t\t\t\t\t\t`${(f as LinkFolder).zid}:${(f as LinkFolder).rid}` === appt.l || f.id === appt.l\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t: find(calendars, (f) => f.id === appt.l);\n\t\t\t\t\treturn cal\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t...acc,\n\t\t\t\t\t\t\t\t...map(appt.inst, (inst) =>\n\t\t\t\t\t\t\t\t\tnormalizeCalendarEvent({\n\t\t\t\t\t\t\t\t\t\tcalendar: cal,\n\t\t\t\t\t\t\t\t\t\tappointment: appt,\n\t\t\t\t\t\t\t\t\t\tinstance: inst\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t: acc;\n\t\t\t\t},\n\t\t\t\t[] as Array<EventType>\n\t\t\t)\n\t\t: [];\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { filter, find, isNil, map, omitBy } from 'lodash';\nimport moment, { Moment } from 'moment';\n\nimport { getRoot } from '../carbonio-ui-commons/store/zustand/folder';\nimport { LinkFolder } from '../carbonio-ui-commons/types/folder';\nimport { getPrefs } from '../carbonio-ui-commons/utils/get-prefs';\nimport { extractBody, extractHtmlBody } from '../commons/body-message-renderer';\nimport { CALENDAR_RESOURCES, PREFS_DEFAULTS } from '../constants';\nimport { PARTICIPANT_ROLE } from '../constants/api';\nimport { CRB_XPARAMS, CRB_XPROPS } from '../constants/xprops';\nimport { CalendarEditor, Editor } from '../types/editor';\nimport { DateType } from '../types/event';\nimport { Attendee, Invite } from '../types/store/invite';\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const getVirtualRoom = (xprop: any): { label: string; link: string } | undefined => {\n\tconst room = find(xprop, ['name', CRB_XPROPS.MEETING_ROOM]);\n\tif (room) {\n\t\treturn {\n\t\t\tlabel: find(room.xparam, ['name', CRB_XPARAMS.ROOM_NAME])?.value,\n\t\t\tlink: find(room.xparam, ['name', CRB_XPARAMS.ROOM_LINK])?.value\n\t\t};\n\t}\n\n\treturn undefined;\n};\n\nexport const getMeetingRooms = (\n\tattendees: Array<Attendee>\n): Array<{ email: string; label: string }> | undefined => {\n\tconst rooms = filter(attendees, ['cutype', CALENDAR_RESOURCES.ROOM]);\n\treturn rooms.length\n\t\t? map(rooms, (at) => ({\n\t\t\t\tlabel: at.d,\n\t\t\t\temail: at.a\n\t\t\t}))\n\t\t: undefined;\n};\n\nexport const getEquipments = (\n\tattendees: Array<Attendee>\n): Array<{ email: string; label: string }> | undefined => {\n\tconst equipments = filter(attendees, ['cutype', CALENDAR_RESOURCES.RESOURCE]);\n\treturn equipments.length\n\t\t? map(equipments, (at) => ({\n\t\t\t\tlabel: at.d,\n\t\t\t\temail: at.a\n\t\t\t}))\n\t\t: undefined;\n};\n\nconst getAttendees = (attendees: any[], role: string): any[] =>\n\tmap(filter(attendees, ['role', role]), (at) =>\n\t\tomitBy(\n\t\t\t{\n\t\t\t\tcompany: undefined,\n\t\t\t\temail: at?.a,\n\t\t\t\tfirstName: undefined,\n\t\t\t\tfullName: at?.d,\n\t\t\t\tid: `${at?.a} ${at.d}`,\n\t\t\t\tlabel: at?.d,\n\t\t\t\tlastName: undefined,\n\t\t\t\tisGroup: at.isGroup,\n\t\t\t\texp: at.exp\n\t\t\t},\n\t\t\tisNil\n\t\t)\n\t);\n\nexport type EventPropType = {\n\tresource: {\n\t\tridZ?: string;\n\t\tcalendar: { id: string };\n\t\tisRecurrent: boolean;\n\t\tisException?: boolean;\n\t\tlocation: string;\n\t\tinviteId: string;\n\t\tid: string;\n\t};\n\ttitle: string;\n\tallDay: boolean;\n\tstart: Date | Moment;\n\tend: Date | Moment;\n};\n\nexport const getLocalTime = (\n\tdate: number | DateType,\n\ttimezone?: string,\n\tlocalTimezone?: string\n): number => {\n\tconst dateValueOf = moment(date).valueOf();\n\n\tif (timezone) {\n\t\tconst dateInTimezone = moment(date).tz(timezone);\n\t\tconst localOffset = localTimezone\n\t\t\t? moment().tz(localTimezone).utcOffset()\n\t\t\t: moment().utcOffset();\n\t\tconst appointmentOffset = dateInTimezone.utcOffset();\n\t\tconst offSetFromUTC = appointmentOffset - localOffset;\n\t\tconst offSet = offSetFromUTC * 60_000;\n\t\treturn dateValueOf + offSet;\n\t}\n\treturn dateValueOf;\n};\n\nexport const isTimezoneDifferentFromLocal = (date: number | DateType, timezone: string): boolean =>\n\tmoment(date).tz(timezone).utcOffset() !== moment(date).utcOffset();\n\nconst setEditorDate = ({\n\teditorType,\n\tinvite,\n\tevent\n}: {\n\teditorType: { isSeries: boolean; isInstance: boolean; isException: boolean };\n\tinvite: Invite | undefined;\n\tevent: EventPropType | undefined;\n}): { start: number; end: number } => {\n\tconst { zimbraPrefCalendarDefaultApptDuration = '3600' } = getPrefs();\n\tconst endDur = (zimbraPrefCalendarDefaultApptDuration as string)?.includes('m')\n\t\t? parseInt(zimbraPrefCalendarDefaultApptDuration as string, 10) * 60 * 1000\n\t\t: parseInt(zimbraPrefCalendarDefaultApptDuration as string, 10) * 1000;\n\tif (event && invite?.start && invite?.end) {\n\t\tif (editorType.isSeries && !editorType.isInstance && !editorType.isException && invite) {\n\t\t\tconst start = invite?.start?.u ?? moment(invite?.start?.d);\n\t\t\tconst end = invite?.end?.u ?? moment(invite?.end?.d);\n\t\t\tconst convertedStartDate = getLocalTime(start, invite?.tz);\n\t\t\tconst convertedEndDate = getLocalTime(end, invite?.tz);\n\t\t\tif (invite.tz && isTimezoneDifferentFromLocal(start, invite.tz)) {\n\t\t\t\treturn {\n\t\t\t\t\tstart: event?.allDay\n\t\t\t\t\t\t? moment(convertedStartDate)?.startOf('date').valueOf()\n\t\t\t\t\t\t: convertedStartDate,\n\t\t\t\t\tend: event?.allDay ? moment(convertedEndDate)?.endOf('date').valueOf() : convertedEndDate\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tstart: event?.allDay ? moment(start)?.startOf('date').valueOf() : moment(start).valueOf(),\n\t\t\t\tend: event?.allDay ? moment(end)?.endOf('date').valueOf() : moment(end).valueOf()\n\t\t\t};\n\t\t}\n\t\tconst convertedStartDate = getLocalTime(event.start, invite?.tz);\n\t\tconst convertedEndDate = getLocalTime(event.end, invite?.tz);\n\t\treturn invite?.tz && isTimezoneDifferentFromLocal(event.start, invite.tz)\n\t\t\t? {\n\t\t\t\t\tstart: event?.allDay\n\t\t\t\t\t\t? moment(convertedStartDate)?.startOf('date').valueOf()\n\t\t\t\t\t\t: convertedStartDate,\n\t\t\t\t\tend: event?.allDay ? moment(convertedEndDate)?.endOf('date').valueOf() : convertedEndDate\n\t\t\t\t}\n\t\t\t: {\n\t\t\t\t\tstart: event?.allDay\n\t\t\t\t\t\t? moment(event?.start)?.startOf('date').valueOf()\n\t\t\t\t\t\t: moment(event?.start).valueOf(),\n\t\t\t\t\tend: event?.allDay\n\t\t\t\t\t\t? moment(event?.end)?.endOf('date').valueOf()\n\t\t\t\t\t\t: moment(event?.end).valueOf()\n\t\t\t\t};\n\t}\n\treturn {\n\t\tstart: moment().set('second', 0).set('millisecond', 0).valueOf(),\n\t\tend: moment().set('second', 0).set('millisecond', 0).valueOf() + endDur\n\t};\n};\n\nexport const normalizeCalendarEditor = (folder: CalendarEditor): CalendarEditor => {\n\tconst root = getRoot(folder.id);\n\treturn {\n\t\tid: folder.id,\n\t\tname: folder.name,\n\t\trgb: folder.rgb,\n\t\tcolor: folder.color,\n\t\towner: folder.owner ?? (root as LinkFolder)?.owner\n\t};\n};\n\nexport const normalizeEditor = ({\n\tinvite,\n\tevent,\n\temptyEditor,\n\tcontext\n}: {\n\temptyEditor: Editor;\n\tinvite?: Invite;\n\tevent?: EventPropType;\n\tcontext: any;\n}): Editor => {\n\tif (event && invite) {\n\t\tconst isSeries = event?.resource?.isRecurrent;\n\t\tconst isInstance = context?.isInstance ?? !!event?.resource?.ridZ;\n\t\tconst isException = event?.resource?.isException ?? false;\n\t\tconst calendarId = event.resource.calendar.id ?? PREFS_DEFAULTS.DEFAULT_CALENDAR_ID;\n\t\tconst editorType = { isSeries, isInstance, isException };\n\n\t\tconst { start, end } = setEditorDate({ editorType, event, invite });\n\n\t\tconst isRichText = !(\n\t\t\tinvite?.textDescription?.[0]?._content && !invite?.htmlDescription?.[0]?._content\n\t\t);\n\n\t\tconst plainText = invite?.textDescription?.[0]?._content\n\t\t\t? extractBody(invite?.textDescription?.[0]?._content) ?? ''\n\t\t\t: '';\n\n\t\tconst richText = invite?.htmlDescription?.[0]?._content\n\t\t\t? extractHtmlBody(invite?.htmlDescription?.[0]?._content) ?? ''\n\t\t\t: '';\n\n\t\tconst folder =\n\t\t\tfind(context?.folders, ['id', calendarId]) ??\n\t\t\tfind(context?.folders, ['id', PREFS_DEFAULTS.DEFAULT_CALENDAR_ID]);\n\n\t\tconst calendar = normalizeCalendarEditor(folder);\n\n\t\tconst compiledEditor = omitBy(\n\t\t\t{\n\t\t\t\tcalendar,\n\t\t\t\tid: emptyEditor.id,\n\t\t\t\tridZ: event?.resource?.ridZ,\n\t\t\t\tattach: invite.attach,\n\t\t\t\tparts: invite.parts,\n\t\t\t\tattachmentFiles: invite.attachmentFiles,\n\t\t\t\tisInstance,\n\t\t\t\tisSeries,\n\t\t\t\tisException,\n\t\t\t\texceptId: invite?.exceptId,\n\t\t\t\ttitle: event?.title,\n\t\t\t\tlocation: event?.resource?.location,\n\t\t\t\tmeetingRoom: getMeetingRooms(invite.attendees),\n\t\t\t\tequipment: getEquipments(invite.attendees),\n\t\t\t\troom: getVirtualRoom(invite.xprop),\n\t\t\t\tattendees: getAttendees(invite.attendees, PARTICIPANT_ROLE.REQUIRED),\n\t\t\t\toptionalAttendees: getAttendees(invite.attendees, PARTICIPANT_ROLE.OPTIONAL),\n\t\t\t\tallDay: event?.allDay,\n\t\t\t\tfreeBusy: invite.freeBusy,\n\t\t\t\tclass: invite.class,\n\t\t\t\toriginalStart: start,\n\t\t\t\toriginalEnd: end,\n\t\t\t\tstart,\n\t\t\t\tend,\n\t\t\t\ttimezone: invite?.start?.tz,\n\t\t\t\tinviteId: event?.resource?.inviteId,\n\t\t\t\treminder: invite?.alarmValue,\n\t\t\t\trecur: !isInstance ? invite.recurrenceRule : undefined,\n\t\t\t\trichText,\n\t\t\t\tplainText,\n\t\t\t\tisRichText,\n\t\t\t\tuid: invite?.uid,\n\t\t\t\tms: invite?.ms,\n\t\t\t\trev: invite?.rev\n\t\t\t},\n\t\t\tisNil\n\t\t);\n\t\treturn {\n\t\t\t...emptyEditor,\n\t\t\t...compiledEditor\n\t\t};\n\t}\n\treturn emptyEditor;\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { filter, find, isNil } from 'lodash';\n\nimport {\n\tnormalizeMailPartMapFn,\n\tgetAlarmToString,\n\tnormalizeInviteParticipants,\n\tretrieveAttachmentsType,\n\tfindAttachments,\n\tgetAlarmValueInMinutes\n} from './normalizations-utils';\nimport { getLocationUrl } from './normalize-calendar-events';\nimport { Invite } from '../types/store/invite';\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const normalizeInvite = (m: any): Invite => ({\n\tciFolder: m?.inv?.[0]?.comp?.[0]?.ciFolder,\n\tallDay: m?.inv?.[0]?.comp?.[0]?.allDay ?? false,\n\tapptId: m?.inv?.[0]?.comp?.[0]?.apptId,\n\ttz: find(m?.inv?.[0]?.tz, (value) => value.id !== 'UTC')?.id,\n\tid: m.id,\n\tattendees: m?.inv?.[0]?.comp?.[0]?.at ?? [],\n\tparent: m.l,\n\tflags: m.f,\n\tparts: m.mp ? normalizeMailPartMapFn(m.mp) : [],\n\talarmString: getAlarmToString(m?.inv?.[0]?.comp?.[0]?.alarm),\n\talarmValue: getAlarmValueInMinutes(m?.inv?.[0]?.comp?.[0]?.alarm?.[0]?.trigger?.[0]?.rel?.[0]),\n\tclass: m?.inv?.[0]?.comp?.[0]?.class,\n\tcompNum: m?.inv?.[0]?.comp?.[0]?.compNum, // Component number of the invite\n\tdate: m.d,\n\ttextDescription: m?.inv?.[0]?.comp?.[0]?.desc, // todo: normalize\n\thtmlDescription: m?.inv?.[0]?.comp?.[0]?.descHtml,\n\tend: m?.inv?.[0]?.comp?.[0]?.e[0], // todo: normalize\n\tfreeBusy: m?.inv?.[0]?.comp?.[0]?.fb ?? 'B',\n\tfreeBusyActualStatus: m?.inv?.[0]?.comp?.[0]?.fba ?? 'B',\n\tfragment: m?.inv?.[0]?.comp?.[0]?.fr,\n\tisOrganizer: m?.inv?.[0]?.comp?.[0]?.isOrg ?? false,\n\tlocation: m?.inv?.[0]?.comp?.[0]?.loc ?? '',\n\tname: m?.inv?.[0]?.comp?.[0]?.name,\n\tnoBlob: m?.inv?.[0]?.comp?.[0]?.noBlob,\n\torganizer: m?.inv?.[0]?.comp?.[0]?.or, // todo: normalize\n\trecurrenceRule: m?.inv?.[0]?.comp?.[0]?.recur, // todo: normalize\n\tisRespRequested: m?.inv?.[0]?.comp?.[0]?.rsvp,\n\tstart: m?.inv?.[0]?.comp?.[0]?.s[0], // todo: normalize\n\tsequenceNumber: m?.inv?.[0]?.comp?.[0]?.seq,\n\tstatus: m?.inv?.[0]?.comp?.[0]?.status,\n\ttransparency: m?.inv?.[0]?.comp?.[0]?.transp, // todo: check what is this for\n\tuid: m?.inv?.[0]?.comp?.[0]?.uid,\n\turl: m?.inv?.[0]?.comp?.[0]?.url,\n\tisException: m?.inv?.[0]?.comp?.[0]?.ex || false,\n\texceptId: m?.inv?.[0]?.comp?.[0]?.exceptId, // shown only in exceptions todo: normalize\n\ttagNamesList: m.tn,\n\ttags: !isNil(m.t) ? filter(m.t.split(','), (t) => t !== '') : [],\n\tattach: {\n\t\tmp: retrieveAttachmentsType(m?.mp?.[0] ?? [], 'attachment', m?.id)\n\t},\n\tattachmentFiles: findAttachments(m.mp ?? [], []),\n\tparticipants: normalizeInviteParticipants(m?.inv?.[0]?.comp?.[0]?.at ?? []),\n\talarm: !!m?.inv?.[0]?.comp?.[0]?.alarm,\n\talarmData: m?.inv?.[0]?.comp?.[0]?.alarm,\n\tms: m.ms || 0,\n\trev: m.rev || 0,\n\tmeta: m.meta,\n\txprop: m?.inv?.[0]?.comp?.[0]?.xprop,\n\tneverSent: m?.inv?.[0]?.comp?.[0]?.neverSent ?? false,\n\tlocationUrl: getLocationUrl(m?.inv?.[0]?.comp?.[0]?.loc ?? '')\n});\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const normalizeInviteFromSync = (inv: any): Invite => ({\n\tciFolder: inv?.comp?.[0]?.ciFolder,\n\tapptId: inv?.comp?.[0]?.apptId,\n\tid: `${inv?.comp?.[0]?.apptId}-${inv.id}`,\n\tattendees: inv.comp?.[0]?.at ?? [],\n\tparent: inv?.comp?.[0]?.ciFolder, // id folder\n\tflags: inv.f, // read,unread,attachments,ecc...\n\tparts: inv.mp ? normalizeMailPartMapFn(inv.mp) : [],\n\talarmString: getAlarmToString(inv?.comp?.[0]?.alarm),\n\talarmValue: getAlarmValueInMinutes(inv?.comp?.[0]?.alarm?.[0]?.trigger?.[0]?.rel?.[0]),\n\tclass: inv.comp?.[0]?.class,\n\tcompNum: inv.comp?.[0]?.compNum, // Component number of the invite\n\tdate: inv.d, // todo: check what date is\n\ttextDescription: inv.comp?.[0]?.desc, // todo: normalize\n\thtmlDescription: inv.comp?.[0]?.descHtml,\n\tend: inv.comp?.[0]?.e[0], // todo: normalize\n\tfreeBusy: inv.comp?.[0]?.fb,\n\tfreeBusyActualStatus: inv.comp?.[0]?.fba,\n\tfragment: inv.comp?.[0]?.fr,\n\tisOrganizer: inv.comp?.[0]?.isOrg,\n\tlocation: inv.comp?.[0]?.loc ?? '',\n\tmeta: inv.meta,\n\tname: inv.comp?.[0]?.name,\n\tnoBlob: inv.comp?.[0]?.noBlob,\n\torganizer: inv.comp?.[0]?.or, // todo: normalize\n\trecurrenceRule: inv.comp?.[0]?.recur, // todo: normalize\n\tisRespRequested: inv.comp?.[0]?.rsvp,\n\tstart: inv.comp?.[0]?.s[0], // todo: normalize\n\tsequenceNumber: inv.comp?.[0]?.seq,\n\tstatus: inv.comp?.[0]?.status,\n\ttransparency: inv.comp?.[0]?.transp, // todo: check what is this for\n\tuid: inv.comp?.[0]?.uid,\n\turl: inv.comp?.[0]?.url,\n\tisException: inv.comp?.[0]?.ex || false,\n\texceptId: inv.comp?.[0]?.exceptId, // shown only in exceptions todo: normalize\n\ttagNamesList: inv.tn,\n\ttags: !isNil(inv.t) ? filter(inv.t.split(','), (t) => t !== '') : [],\n\tparticipants: normalizeInviteParticipants(inv.comp?.[0]?.at ?? []),\n\talarm: !!inv.comp?.[0]?.alarm,\n\talarmData: inv.comp?.[0]?.alarm,\n\tms: inv.ms || 0,\n\trev: inv.rev || 0,\n\txprop: inv.comp?.[0]?.xprop,\n\tneverSent: inv?.comp?.[0]?.neverSent ?? false,\n\tlocationUrl: getLocationUrl(inv?.comp?.[0]?.loc ?? '')\n});\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { getUserAccount } from '@zextras/carbonio-shell-ui';\nimport { compact, concat, includes, isNil, map, omitBy } from 'lodash';\nimport moment from 'moment';\n\nimport { Rel } from './normalizations-utils';\nimport { CALENDAR_RESOURCES, HTML_CLOSING_TAG, HTML_OPENING_TAG, ROOM_DIVIDER } from '../constants';\nimport { PARTICIPANT_ROLE } from '../constants/api';\nimport { CRB_XPARAMS, CRB_XPROPS } from '../constants/xprops';\nimport { getTimeString } from '../hooks/use-get-event-timezone';\nimport { CalendarEditor, CalendarOrganizer, CalendarSender, Editor } from '../types/editor';\nimport {\n\tisDaysInMinutes,\n\tisHoursInMinutes,\n\tisWeeksInMinutes,\n\tminutesToDays,\n\tminutesToHours,\n\tminutesToWeeks\n} from '../utils/times';\n\ntype Participants = {\n\ta?: string;\n\tp?: string;\n\tt: string;\n};\n\nconst isEventSentFromOrganizer = (organizer: string, sender: { address: string }): boolean =>\n\torganizer === sender.address;\n\nconst isTheSameIdentity = (\n\torganizer: { identityName: string },\n\tsender: { identityName: string }\n): boolean => organizer.identityName === sender.identityName;\n\nconst isTheSameEmail = (organizer: string, sender: { address: string }): boolean =>\n\torganizer === sender.address;\n\nconst setResourceDate = ({\n\ttime,\n\tallDay = false,\n\ttimezone\n}: {\n\ttime: number | undefined;\n\tallDay?: boolean;\n\ttimezone?: string;\n}): { d: string; tz?: string } => {\n\tif (allDay) {\n\t\treturn {\n\t\t\td: moment(time).startOf('day').format('YYYYMMDD')\n\t\t};\n\t}\n\treturn timezone\n\t\t? {\n\t\t\t\td: moment(time).format('YYYYMMDD[T]HHmmss'),\n\t\t\t\ttz: timezone\n\t\t\t}\n\t\t: {\n\t\t\t\td: moment(time).utc().format('YYYYMMDD[T]HHmmss[Z]')\n\t\t\t};\n};\n\nexport const setAlarmValue = (reminderInMinutes: string): { related: 'START'; neg: '1' } & Rel => {\n\tconst minutes = parseFloat(reminderInMinutes);\n\tconst AT_THE_TIME_OF_THE_EVENT = -1;\n\n\tconst unchangedProps = {\n\t\trelated: 'START',\n\t\tneg: '1'\n\t} as const;\n\n\tif (isWeeksInMinutes(minutes)) {\n\t\treturn {\n\t\t\tw: minutesToWeeks(minutes),\n\t\t\t...unchangedProps\n\t\t};\n\t}\n\tif (isDaysInMinutes(minutes)) {\n\t\treturn {\n\t\t\td: minutesToDays(minutes),\n\t\t\t...unchangedProps\n\t\t};\n\t}\n\tif (isHoursInMinutes(minutes)) {\n\t\treturn {\n\t\t\th: minutesToHours(minutes),\n\t\t\t...unchangedProps\n\t\t};\n\t}\n\tif (minutes === AT_THE_TIME_OF_THE_EVENT) {\n\t\treturn {\n\t\t\tm: 0,\n\t\t\t...unchangedProps\n\t\t};\n\t}\n\treturn {\n\t\tm: minutes,\n\t\trelated: 'START',\n\t\tneg: '1'\n\t};\n};\n\nexport const generateParticipantInformation = (resource: Editor): Array<Partial<Participants>> => {\n\tconst user = getUserAccount();\n\tconst iAmOrganizer = isEventSentFromOrganizer(user?.name ?? '', resource.sender);\n\tconst isSameIdentity = isTheSameIdentity(resource.organizer, resource.sender);\n\tconst isNotMyCalendar = resource.calendar?.owner;\n\tconst isSharedAccount = isTheSameEmail(resource.calendar?.owner ?? '', resource.sender);\n\n\tconst mainAccountOrganizer = omitBy<Participants>(\n\t\t{\n\t\t\ta: user?.name,\n\t\t\tp: resource?.organizer?.fullName,\n\t\t\tt: 'f'\n\t\t},\n\t\tisNil\n\t);\n\n\tconst sharedCalendarOrganizer = {\n\t\ta: resource.calendar?.owner,\n\t\tt: 'f'\n\t};\n\n\tconst sender = omitBy<Participants>(\n\t\t{\n\t\t\ta: resource?.sender?.address ?? resource?.sender?.label,\n\t\t\tp: resource?.sender?.fullName,\n\t\t\tt: 's'\n\t\t},\n\t\tisNil\n\t);\n\n\tconst organizer = isNotMyCalendar ? sharedCalendarOrganizer : mainAccountOrganizer;\n\tconst sentFrom =\n\t\t(iAmOrganizer && isSameIdentity && !isNotMyCalendar) || isSharedAccount ? undefined : sender;\n\n\tconst organizerParticipant = compact([organizer, sentFrom]);\n\treturn resource?.draft\n\t\t? organizerParticipant\n\t\t: concat<Partial<Participants>>(\n\t\t\t\tmap(\n\t\t\t\t\tconcat(\n\t\t\t\t\t\tresource?.attendees,\n\t\t\t\t\t\tresource?.optionalAttendees,\n\t\t\t\t\t\tresource?.meetingRoom ?? [],\n\t\t\t\t\t\tresource?.equipment ?? []\n\t\t\t\t\t),\n\t\t\t\t\t(attendee) => ({\n\t\t\t\t\t\ta: attendee?.email ?? attendee?.label,\n\t\t\t\t\t\tp:\n\t\t\t\t\t\t\tattendee?.firstName && attendee?.lastname\n\t\t\t\t\t\t\t\t? `${attendee.firstName} ${attendee.lastname}`\n\t\t\t\t\t\t\t\t: attendee.label,\n\t\t\t\t\t\tt: 't'\n\t\t\t\t\t})\n\t\t\t\t),\n\t\t\t\torganizerParticipant\n\t\t\t);\n};\n\nconst getOrganizer = ({\n\tcalendar,\n\tsender,\n\torganizer\n}: {\n\tcalendar?: CalendarEditor;\n\tsender: CalendarSender;\n\torganizer: CalendarOrganizer;\n}): { email?: string; name?: string; sentBy?: string } => {\n\tconst user = getUserAccount();\n\n\tconst isAlsoSender = isEventSentFromOrganizer(user?.name ?? '', sender);\n\tconst isSameIdentity = isTheSameIdentity(organizer, sender);\n\tconst isSameEmail = isTheSameEmail(user?.name ?? '', sender);\n\tconst isSharedAccount = isTheSameEmail(calendar?.owner ?? '', sender);\n\n\tif (!calendar?.owner) {\n\t\tif (isAlsoSender && isSameIdentity) {\n\t\t\treturn omitBy(\n\t\t\t\t{\n\t\t\t\t\temail: user?.name,\n\t\t\t\t\tname: organizer.fullName,\n\t\t\t\t\tsentBy: isSameEmail ? undefined : sender.address\n\t\t\t\t},\n\t\t\t\tisNil\n\t\t\t);\n\t\t}\n\t\treturn omitBy(\n\t\t\t{\n\t\t\t\temail: user?.name,\n\t\t\t\tname: sender.fullName,\n\t\t\t\tsentBy: isSameEmail ? undefined : sender.address\n\t\t\t},\n\t\t\tisNil\n\t\t);\n\t}\n\tif (isSharedAccount) {\n\t\treturn {\n\t\t\temail: calendar.owner,\n\t\t\tname: sender.fullName\n\t\t};\n\t}\n\treturn {\n\t\temail: calendar.owner,\n\t\tsentBy: sender.address\n\t};\n};\n\nfunction generateHtmlBodyRequest(app: Editor): string {\n\tconst attendees = [...app.attendees, ...app.optionalAttendees].map((a) => a.email).join(', ');\n\tconst organizer = getOrganizer({\n\t\tcalendar: app?.calendar,\n\t\tsender: app.sender,\n\t\torganizer: app.organizer\n\t});\n\tconst date = getTimeString(app.start, app.end, app.allDay, 'allDay');\n\n\tconst meetingHtml = `${ROOM_DIVIDER}<h3>${organizer.name} have invited you to a new meeting!</h3><p>Subject: ${app.title}</p><p>Organizer: ${organizer.name}</p><p>Location: ${app.location}</p><p>Time: ${date}</p><p>Invitees: ${attendees}</p><br/>${ROOM_DIVIDER}`;\n\tconst virtualRoomHtml = app?.room?.label\n\t\t? `${ROOM_DIVIDER}<h3>${organizer.name} invited you to a virtual meeting on Carbonio Chats system.</h3><p>Join the meeting now on <a href=\"${app.room.link}\">${app.room.label}</a></p><p>You can join the meeting via Web or by using native applications:</p><a href=\"https://play.google.com/store/apps/details?id=com.zextras.team&hl=it&gl=US\">https://play.google.com/store/apps/details?id=com.zextras.team&hl=it&gl=US</a><br/><a href=\"https://apps.apple.com/it/app/zextras-team/id1459844854\">https://apps.apple.com/it/app/zextras-team/id1459844854</a><br/>${ROOM_DIVIDER}`\n\t\t: '';\n\tconst defaultMessage =\n\t\tapp?.room && !includes(app.richText, ROOM_DIVIDER) ? virtualRoomHtml : meetingHtml;\n\treturn attendees?.length\n\t\t? `${HTML_OPENING_TAG}${defaultMessage}${app.richText}${HTML_CLOSING_TAG}`\n\t\t: app.richText;\n}\n\nfunction generateBodyRequest(app: Editor): string {\n\tconst attendees = [...app.attendees, ...app.optionalAttendees].map((a) => a.email).join(', ');\n\tconst organizer = getOrganizer({\n\t\tcalendar: app?.calendar,\n\t\tsender: app.sender,\n\t\torganizer: app.organizer\n\t});\n\tconst date = getTimeString(app.start, app.end, app.allDay, 'allDay');\n\n\tconst virtualRoomMessage = app?.room?.label\n\t\t? `${ROOM_DIVIDER}\\n${\n\t\t\t\torganizer.name ?? ''\n\t\t\t} have invited you to a virtual meeting on Carbonio Chats system!\\n\\nJoin the meeting now on ${\n\t\t\t\tapp.room.label\n\t\t\t}\\n\\n${\n\t\t\t\tapp.room.link\n\t\t\t} \\n\\nYou can join the meeting via Web or by using native applications:\\n\\nhttps://play.google.com/store/apps/details?id=com.zextras.team&hl=it&gl=US\\n\\nhttps://apps.apple.com/it/app/zextras-team/id1459844854\\n\\n${ROOM_DIVIDER}\\n`\n\t\t: '';\n\tconst meetingMessage = `${ROOM_DIVIDER}\\n${\n\t\torganizer.name ?? ''\n\t} have invited you to a new meeting!\\n\\nSubject: ${app.title} \\nOrganizer: \"${\n\t\torganizer.name\n\t} \\n\\nTime: ${date}\\n \\nInvitees: ${attendees} \\n\\n\\n${ROOM_DIVIDER}`;\n\tconst defaultMessage = app?.room?.label ? virtualRoomMessage : meetingMessage;\n\n\treturn attendees?.length ? `${defaultMessage}\\n${app.plainText}` : app.plainText;\n}\n\nconst generateMp = (msg: Editor): { ct: string; mp: Array<{ ct: string; content: string }> } => ({\n\tct: 'multipart/alternative',\n\tmp: msg.isRichText\n\t\t? [\n\t\t\t\t{\n\t\t\t\t\tct: 'text/html',\n\t\t\t\t\tcontent: generateHtmlBodyRequest(msg)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tct: 'text/plain',\n\t\t\t\t\tcontent: generateBodyRequest(msg)\n\t\t\t\t}\n\t\t\t]\n\t\t: [\n\t\t\t\t{\n\t\t\t\t\tct: 'text/plain',\n\t\t\t\t\tcontent: generateBodyRequest(msg)\n\t\t\t\t}\n\t\t\t]\n});\n\nconst generateInvite = (editorData: Editor): any => {\n\tconst at = [];\n\tconst organizer = getOrganizer({\n\t\tcalendar: editorData?.calendar,\n\t\tsender: editorData.sender,\n\t\torganizer: editorData.organizer\n\t});\n\tat.push(\n\t\t...editorData.attendees.map((c: any) => ({\n\t\t\ta: c?.email ?? c?.label,\n\t\t\td: c?.firstName && c?.lastname ? `${c.firstName} ${c.lastname}` : c.label,\n\t\t\trole: PARTICIPANT_ROLE.REQUIRED,\n\t\t\tptst: 'NE',\n\t\t\trsvp: '1'\n\t\t}))\n\t);\n\teditorData?.optionalAttendees &&\n\t\tat.push(\n\t\t\t...editorData.optionalAttendees.map((c: any) => ({\n\t\t\t\ta: c?.email ?? c?.label,\n\t\t\t\td: c.firstName && c.lastname ? `${c.firstName} ${c.lastname}` : c.label,\n\t\t\t\trole: PARTICIPANT_ROLE.OPTIONAL,\n\t\t\t\tptst: 'NE',\n\t\t\t\trsvp: '1'\n\t\t\t}))\n\t\t);\n\n\teditorData?.meetingRoom &&\n\t\tat.push(\n\t\t\t...editorData.meetingRoom.map((c) => ({\n\t\t\t\ta: c?.email,\n\t\t\t\td: c.label,\n\t\t\t\trole: PARTICIPANT_ROLE.NON_PARTICIPANT,\n\t\t\t\tptst: 'NE',\n\t\t\t\trsvp: true,\n\t\t\t\turl: c?.email,\n\t\t\t\tcutype: CALENDAR_RESOURCES.ROOM\n\t\t\t}))\n\t\t);\n\n\teditorData?.equipment &&\n\t\tat.push(\n\t\t\t...editorData.equipment.map((c) => ({\n\t\t\t\ta: c?.email,\n\t\t\t\td: c.label,\n\t\t\t\trole: PARTICIPANT_ROLE.NON_PARTICIPANT,\n\t\t\t\tptst: 'NE',\n\t\t\t\trsvp: true,\n\t\t\t\turl: c?.email,\n\t\t\t\tcutype: CALENDAR_RESOURCES.RESOURCE\n\t\t\t}))\n\t\t);\n\n\treturn {\n\t\tcomp: [\n\t\t\t{\n\t\t\t\talarm:\n\t\t\t\t\teditorData?.reminder && editorData?.reminder !== '0'\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\taction: 'DISPLAY',\n\t\t\t\t\t\t\t\t\ttrigger: {\n\t\t\t\t\t\t\t\t\t\trel: setAlarmValue(editorData.reminder)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t: undefined,\n\t\t\t\txprop: editorData?.room\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: CRB_XPROPS.MEETING_ROOM,\n\t\t\t\t\t\t\t\tvalue: CRB_XPROPS.MEETING_ROOM,\n\t\t\t\t\t\t\t\txparam: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: CRB_XPARAMS.ROOM_LINK,\n\t\t\t\t\t\t\t\t\t\tvalue: editorData.room.link\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tname: CRB_XPARAMS.ROOM_NAME,\n\t\t\t\t\t\t\t\t\t\tvalue: editorData.room.label\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t: undefined,\n\t\t\t\tat,\n\t\t\t\tallDay: editorData.allDay ? '1' : '0',\n\t\t\t\tfb: editorData.freeBusy,\n\t\t\t\tloc: editorData.location,\n\t\t\t\tname: editorData.title,\n\t\t\t\tor: omitBy(\n\t\t\t\t\t{\n\t\t\t\t\t\ta: organizer.email,\n\t\t\t\t\t\td: organizer.name,\n\t\t\t\t\t\tsentBy: organizer.sentBy\n\t\t\t\t\t},\n\t\t\t\t\tisNil\n\t\t\t\t),\n\t\t\t\trecur:\n\t\t\t\t\t(editorData?.isInstance && editorData?.isSeries) || editorData?.isException\n\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t: editorData?.recur,\n\t\t\t\tstatus: 'CONF',\n\t\t\t\ts: setResourceDate({\n\t\t\t\t\ttime: editorData.start,\n\t\t\t\t\tallDay: editorData?.allDay,\n\t\t\t\t\ttimezone: editorData?.timezone\n\t\t\t\t}),\n\t\t\t\te: setResourceDate({\n\t\t\t\t\ttime: editorData.end,\n\t\t\t\t\tallDay: editorData?.allDay,\n\t\t\t\t\ttimezone: editorData?.timezone\n\t\t\t\t}),\n\t\t\t\texceptId: editorData.exceptId,\n\t\t\t\tclass: editorData.class,\n\t\t\t\tdraft: editorData.draft ? 1 : 0\n\t\t\t}\n\t\t],\n\t\tuid: editorData.uid\n\t};\n};\n\nexport const normalizeSoapMessageFromEditor = (msg: Editor): any =>\n\tomitBy(\n\t\t{\n\t\t\techo: '1',\n\t\t\tid: msg?.inviteId,\n\t\t\tcomp: '0',\n\t\t\tm: omitBy(\n\t\t\t\t{\n\t\t\t\t\tattach: msg?.attach\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tmp: msg?.attach?.mp,\n\t\t\t\t\t\t\t\taid: msg?.attach?.aid?.length > 0 ? msg?.attach?.aid?.join(',') : undefined\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\te: generateParticipantInformation(msg),\n\t\t\t\t\tinv: generateInvite(msg),\n\t\t\t\t\tl: msg?.calendar?.id,\n\t\t\t\t\tmp: generateMp(msg),\n\t\t\t\t\tsu: msg?.title\n\t\t\t\t},\n\t\t\t\tisNil\n\t\t\t),\n\t\t\t_jsns: 'urn:zimbraMail'\n\t\t},\n\t\tisNil\n\t);\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { SettingsSubSection, t } from '@zextras/carbonio-shell-ui';\n\nexport const generalSubSection = (): SettingsSubSection => ({\n\tlabel: t('label.general', 'General'),\n\tid: 'general'\n});\nexport const workWeekSubSection = (): SettingsSubSection => ({\n\tlabel: t('label.work_week', 'Work week'),\n\tid: 'work_week'\n});\nexport const creatingAppointmentsSubSection = (): SettingsSubSection => ({\n\tlabel: t('label.create_appt_settings', 'Creating Appointments'),\n\tid: 'create_appt_settings'\n});\nexport const iCalSubSection = (): SettingsSubSection => ({\n\tlabel: t('label.apple_ical', 'Apple iCal'),\n\tid: 'ical'\n});\nexport const permissionsSubSection = (): SettingsSubSection => ({\n\tlabel: t('label.permissions', 'Permissions'),\n\tid: 'permissions'\n});\n\nexport const getSettingsSubSections = (): Array<SettingsSubSection> => [\n\tgeneralSubSection(),\n\tworkWeekSubSection(),\n\tcreatingAppointmentsSubSection(),\n\tiCalSubSection(),\n\tpermissionsSubSection()\n];\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { useCallback, useState } from 'react';\n\nimport {\n\tContainer,\n\tIcon,\n\tRow,\n\tTooltip,\n\tPadding,\n\tTextWithTooltip\n} from '@zextras/carbonio-design-system';\nimport { pushHistory } from '@zextras/carbonio-shell-ui';\nimport moment, { Moment } from 'moment';\nimport { useTranslation } from 'react-i18next';\n\nimport { TagIconComponent } from '../../../commons/tag-icon-component';\nimport { CALENDAR_ROUTE } from '../../../constants';\nimport { EventActionsEnum } from '../../../types/enums/event-actions-enum';\nimport { EventType } from '../../../types/event';\n\nconst useEventTimeString = (start: Moment | Date, end: Moment | Date, allDay: boolean): string => {\n\tconst [t] = useTranslation();\n\tconst isSingleAllDay = moment(start).day() === moment(end).day() && allDay;\n\tconst isMultiAllDay = moment(start).day() !== moment(end).day() && allDay;\n\tconst isMulti = moment(start).day() !== moment(end).day() && !allDay;\n\n\tif (isSingleAllDay) {\n\t\treturn t('label.all_day', 'All day');\n\t}\n\tif (isMulti) {\n\t\treturn `${moment(start).format('MMMM Do YYYY hh:mm A')} - ${moment(end).format(\n\t\t\t'MMMM Do YYYY hh:mm A'\n\t\t)}`;\n\t}\n\tif (isMultiAllDay) {\n\t\treturn `${moment(start).format('MMMM Do YYYY')} - ${moment(end).format('MMMM Do YYYY')} - ${t(\n\t\t\t'label.all_day',\n\t\t\t'All day'\n\t\t)}`;\n\t}\n\treturn `${moment(start).format('hh:mm A')} - ${moment(end).format('hh:mm A')}`;\n};\n\nexport const AppointmentCard = ({ event }: { event: EventType }): JSX.Element => {\n\tconst [t] = useTranslation();\n\tconst [tooltipVisible, setTooltipVisible] = useState(false);\n\n\tconst onClick = useCallback(() => {\n\t\tpushHistory({\n\t\t\troute: CALENDAR_ROUTE,\n\t\t\tpath: `${event.resource.calendar.id}/${EventActionsEnum.EXPAND}/${event.resource.id}/${event.resource.ridZ}`\n\t\t});\n\t}, [event.resource.calendar.id, event.resource.id, event.resource.ridZ]);\n\n\tconst eventTimeString = useEventTimeString(event.start, event.end, event.allDay);\n\n\tconst showInnerTooltip = useCallback(() => {\n\t\tsetTooltipVisible(true);\n\t}, []);\n\n\tconst hideInnerTooltip = useCallback(() => {\n\t\tsetTooltipVisible(false);\n\t}, []);\n\n\treturn (\n\t\t<Tooltip\n\t\t\tplacement={'top'}\n\t\t\tlabel={t('label.show_event', 'Double click to see more details on Calendars')}\n\t\t\tdisabled={tooltipVisible}\n\t\t>\n\t\t\t<Container\n\t\t\t\tdata-testid={`cardContainer-${event.id}`}\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\torientation={'row'}\n\t\t\t\tonDoubleClick={onClick}\n\t\t\t\tbackground={event.resource.calendar.color.background}\n\t\t\t\tborderColor={event.resource.calendar.color.color}\n\t\t\t\tpadding={{ all: 'extrasmall' }}\n\t\t\t\theight={'fit'}\n\t\t\t\tstyle={{ overflowY: 'auto', cursor: 'pointer' }}\n\t\t\t>\n\t\t\t\t<Tooltip placement=\"top\" label={event.resource.calendar.name}>\n\t\t\t\t\t<Row padding={{ all: 'extrasmall' }}>\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\ticon=\"Calendar2\"\n\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\tcolor={event.resource.calendar.color.color}\n\t\t\t\t\t\t\tonMouseEnter={showInnerTooltip}\n\t\t\t\t\t\t\tonMouseLeave={hideInnerTooltip}\n\t\t\t\t\t\t\tonFocus={showInnerTooltip}\n\t\t\t\t\t\t\tonBlur={hideInnerTooltip}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Row>\n\t\t\t\t</Tooltip>\n\t\t\t\t<Container style={{ overflowX: 'auto' }}>\n\t\t\t\t\t<Row\n\t\t\t\t\t\twidth=\"fill\"\n\t\t\t\t\t\tmainAlignment=\"space-between\"\n\t\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\t\twrap={'nowrap'}\n\t\t\t\t\t\tstyle={{ overflowX: 'hidden' }}\n\t\t\t\t\t>\n\t\t\t\t\t\t<TextWithTooltip\n\t\t\t\t\t\t\tsize=\"medium\"\n\t\t\t\t\t\t\tcolor={event.resource.calendar.color.color}\n\t\t\t\t\t\t\toverflow={'ellipsis'}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{eventTimeString}\n\t\t\t\t\t\t</TextWithTooltip>\n\t\t\t\t\t\t<Row mainAlignment=\"flex-end\" style={{ overflowX: 'visible' }} wrap={'nowrap'}>\n\t\t\t\t\t\t\t{event.resource.class === 'PRI' && (\n\t\t\t\t\t\t\t\t<Tooltip label={t('label.private', 'Private')} placement=\"top\">\n\t\t\t\t\t\t\t\t\t<Padding left=\"extrasmall\">\n\t\t\t\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\t\t\t\tcolor={event.resource.calendar.color.color}\n\t\t\t\t\t\t\t\t\t\t\ticon=\"Lock\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"medium\"\n\t\t\t\t\t\t\t\t\t\t\tonMouseEnter={showInnerTooltip}\n\t\t\t\t\t\t\t\t\t\t\tonMouseLeave={hideInnerTooltip}\n\t\t\t\t\t\t\t\t\t\t\tonFocus={showInnerTooltip}\n\t\t\t\t\t\t\t\t\t\t\tonBlur={hideInnerTooltip}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Padding>\n\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{event?.resource?.inviteNeverSent && (\n\t\t\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\t\t\tlabel={t(\n\t\t\t\t\t\t\t\t\t\t'label.invitation_not_sent',\n\t\t\t\t\t\t\t\t\t\t\"You haven't sent the invitation to the attendees yet\"\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tplacement=\"top\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Padding left=\"extrasmall\">\n\t\t\t\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\t\t\t\ticon=\"AlertCircleOutline\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"medium\"\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"#D74942\" // TODO: understand if a custom color is still needed, if so use a constant instead\n\t\t\t\t\t\t\t\t\t\t\tonMouseEnter={showInnerTooltip}\n\t\t\t\t\t\t\t\t\t\t\tonMouseLeave={hideInnerTooltip}\n\t\t\t\t\t\t\t\t\t\t\tonFocus={showInnerTooltip}\n\t\t\t\t\t\t\t\t\t\t\tonBlur={hideInnerTooltip}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Padding>\n\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{!event?.resource?.calendar?.owner &&\n\t\t\t\t\t\t\t\t!event?.resource?.iAmOrganizer &&\n\t\t\t\t\t\t\t\tevent.resource?.participationStatus === 'NE' && (\n\t\t\t\t\t\t\t\t\t<Tooltip placement=\"top\" label={t('event.action.needs_action', 'Needs action')}>\n\t\t\t\t\t\t\t\t\t\t<Padding left=\"extrasmall\">\n\t\t\t\t\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\t\t\t\t\ticon=\"CalendarWarning\"\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\t\t\t\t\tsize=\"medium\"\n\t\t\t\t\t\t\t\t\t\t\t\tonMouseEnter={showInnerTooltip}\n\t\t\t\t\t\t\t\t\t\t\t\tonMouseLeave={hideInnerTooltip}\n\t\t\t\t\t\t\t\t\t\t\t\tonFocus={showInnerTooltip}\n\t\t\t\t\t\t\t\t\t\t\t\tonBlur={hideInnerTooltip}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</Padding>\n\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<TagIconComponent event={event} disableOuterTooltip={setTooltipVisible} />\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t</Row>\n\t\t\t\t\t<Row\n\t\t\t\t\t\twidth=\"fill\"\n\t\t\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\t\twrap={'nowrap'}\n\t\t\t\t\t\tstyle={{ overflowX: 'hidden' }}\n\t\t\t\t\t>\n\t\t\t\t\t\t<TextWithTooltip\n\t\t\t\t\t\t\tsize=\"medium\"\n\t\t\t\t\t\t\tweight=\"bold\"\n\t\t\t\t\t\t\tcolor={event.resource.calendar.color.color}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{event.title}\n\t\t\t\t\t\t</TextWithTooltip>\n\t\t\t\t\t</Row>\n\t\t\t\t</Container>\n\t\t\t</Container>\n\t\t</Tooltip>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React, { useEffect, useMemo, useState } from 'react';\n\nimport { Container, Padding, Row, Shimmer } from '@zextras/carbonio-design-system';\nimport { FOLDERS } from '@zextras/carbonio-shell-ui';\nimport { filter, map, values } from 'lodash';\n\nimport { AppointmentCard } from './appointment-card';\nimport { useFoldersMapByRoot } from '../../../carbonio-ui-commons/store/zustand/folder';\nimport { LinkFolder } from '../../../carbonio-ui-commons/types/folder';\nimport { hasId } from '../../../carbonio-ui-commons/worker/handle-message';\nimport { normalizeAppointments } from '../../../normalizations/normalize-appointments';\nimport { normalizeCalendarEvents } from '../../../normalizations/normalize-calendar-events';\nimport { searchAppointments } from '../../../store/actions/search-appointments';\nimport { useAppDispatch } from '../../../store/redux/hooks';\nimport { EventType } from '../../../types/event';\n\nconst useAppointmentsInRange = (\n\tstart: number,\n\tend: number,\n\trootId: string,\n\tuid?: string\n): Array<EventType> | undefined => {\n\tconst [events, setEvents] = useState<Array<EventType> | undefined>(undefined);\n\tconst dispatch = useAppDispatch();\n\tconst calendars = useFoldersMapByRoot(rootId);\n\n\tconst filteredCalendars = useMemo(\n\t\t() =>\n\t\t\tfilter(\n\t\t\t\tcalendars,\n\t\t\t\t(calendar) =>\n\t\t\t\t\t!/b/.test(calendar?.f ?? '') &&\n\t\t\t\t\t!(calendar as LinkFolder).broken &&\n\t\t\t\t\t!hasId({ id: calendar.id }, FOLDERS.TRASH) &&\n\t\t\t\t\t!(calendar as LinkFolder).isLink\n\t\t\t),\n\t\t[calendars]\n\t);\n\n\tconst query = useMemo(\n\t\t() =>\n\t\t\tmap(filteredCalendars, (result, id) =>\n\t\t\t\tid === 0 ? `inid:\"${result.id}\"` : `OR inid:\"${result.id}\"`\n\t\t\t).join(' '),\n\t\t[filteredCalendars]\n\t);\n\n\tuseEffect(() => {\n\t\tif (start && end && !events) {\n\t\t\tdispatch(searchAppointments({ spanEnd: end, spanStart: start, query })).then((response) => {\n\t\t\t\tif (response?.payload?.appt?.length) {\n\t\t\t\t\tconst toNormalize = filter(\n\t\t\t\t\t\tresponse.payload.appt,\n\t\t\t\t\t\t(appt) => appt.fb !== 'F' && appt.uid !== uid\n\t\t\t\t\t);\n\t\t\t\t\tif (toNormalize.length) {\n\t\t\t\t\t\tconst appointments = values(normalizeAppointments(toNormalize));\n\t\t\t\t\t\tconst selectedEvents = normalizeCalendarEvents(appointments, calendars);\n\t\t\t\t\t\tsetEvents(selectedEvents);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetEvents([]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}, [calendars, dispatch, end, events, query, start, uid]);\n\n\treturn events;\n};\n\nexport const AppointmentCardContainer = ({\n\tstart,\n\tend,\n\trootId,\n\tuid\n}: {\n\tstart: number;\n\tend: number;\n\trootId: string;\n\tuid?: string;\n}): React.JSX.Element => {\n\tconst events = useAppointmentsInRange(start, end, rootId, uid);\n\tif (!events) {\n\t\treturn (\n\t\t\t<Container width={'fill'} padding={{ top: 'medium' }} data-testid=\"ShimmerContainer\">\n\t\t\t\t<Row width={'fill'} padding={{ bottom: 'small' }}>\n\t\t\t\t\t<Shimmer.ListItem width=\"100%\" type={3} />\n\t\t\t\t</Row>\n\t\t\t\t<Row width={'fill'} padding={{ bottom: 'small' }}>\n\t\t\t\t\t<Shimmer.ListItem width=\"100%\" type={3} />\n\t\t\t\t</Row>\n\t\t\t\t<Row width={'fill'}>\n\t\t\t\t\t<Shimmer.ListItem width=\"100%\" type={3} />\n\t\t\t\t</Row>\n\t\t\t</Container>\n\t\t);\n\t}\n\treturn (\n\t\t<Container\n\t\t\tdata-testid=\"AppointmentCardContainer\"\n\t\t\twidth={'fill'}\n\t\t\tpadding={{ top: 'medium', right: 'small' }}\n\t\t\tmaxHeight={'10rem'}\n\t\t\tstyle={{ overflowY: 'auto' }}\n\t\t\tmainAlignment=\"flex-start\"\n\t\t\tcrossAlignment=\"flex-start\"\n\t\t>\n\t\t\t{map(events, (event, index) => (\n\t\t\t\t<Container\n\t\t\t\t\tkey={`externalCardContainer-${event.id}`}\n\t\t\t\t\tdata-testid={`externalCardContainer-${event.id}`}\n\t\t\t\t>\n\t\t\t\t\t<AppointmentCard event={event} />\n\t\t\t\t\t{index < events.length - 1 && <Padding bottom={'small'} />}\n\t\t\t\t</Container>\n\t\t\t))}\n\t\t</Container>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { useCallback, useState } from 'react';\n\nimport { Icon, IconButton, Row, Shimmer, Text, Tooltip } from '@zextras/carbonio-design-system';\nimport { useTranslation } from 'react-i18next';\n\nimport { AppointmentCardContainer } from './appointment-card-container';\nimport { useAttendeesAvailability } from '../../../hooks/use-attendees-availability';\nimport { getIsBusyAtTimeOfTheEvent } from '../../../view/editor/parts/editor-availability-warning-row';\n\nconst RowContainer = ({ children }: JSX.ElementChildrenAttribute): JSX.Element => (\n\t<Row width=\"fill\" mainAlignment=\"flex-start\" padding={{ vertical: 'small' }}>\n\t\t{children}\n\t</Row>\n);\n\nexport const AvailabilityChecker = ({\n\temail,\n\tstart,\n\tend,\n\tallDay,\n\trootId,\n\tuid\n}: {\n\temail: string;\n\tstart: number;\n\tend: number;\n\tallDay: boolean;\n\trootId: string;\n\tuid?: string;\n}): JSX.Element | null => {\n\tconst [open, setOpen] = useState(false);\n\tconst something = useAttendeesAvailability(start, [{ email }], uid);\n\tconst [t] = useTranslation();\n\n\tconst onClick = useCallback(() => {\n\t\tsetOpen((prevValue) => !prevValue);\n\t}, []);\n\tif (!something) {\n\t\tconst label = t('label.checking_availability', 'Checking your availability');\n\t\treturn (\n\t\t\t<RowContainer>\n\t\t\t\t<Row mainAlignment=\"flex-start\" padding={{ right: 'small' }}>\n\t\t\t\t\t<Shimmer.Icon size=\"large\" />\n\t\t\t\t</Row>\n\n\t\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\">\n\t\t\t\t\t<Tooltip placement=\"right\" label={label}>\n\t\t\t\t\t\t<Text size=\"medium\" overflow=\"break-word\">\n\t\t\t\t\t\t\t{label}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</Row>\n\t\t\t</RowContainer>\n\t\t);\n\t}\n\tconst isBusy = getIsBusyAtTimeOfTheEvent(something[0], start, end, something, allDay);\n\tif (isBusy) {\n\t\tconst label = t('label.check_availability', 'Check your availability');\n\n\t\treturn (\n\t\t\t<RowContainer>\n\t\t\t\t<Row mainAlignment=\"flex-start\" padding={{ right: 'small' }}>\n\t\t\t\t\t<Icon size=\"large\" icon=\"CalendarWarning\" color={'warning'} />\n\t\t\t\t</Row>\n\n\t\t\t\t<Row mainAlignment=\"flex-start\">\n\t\t\t\t\t<Tooltip placement=\"right\" label={label}>\n\t\t\t\t\t\t<Text size=\"medium\" overflow=\"break-word\">\n\t\t\t\t\t\t\t{label}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</Row>\n\n\t\t\t\t<Row mainAlignment=\"flex-start\" padding={{ horizontal: 'extrasmall' }}>\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\tcustomSize={{ iconSize: 'large', paddingSize: 0 }}\n\t\t\t\t\t\ticon={open ? 'ChevronUpOutline' : 'ChevronDownOutline'}\n\t\t\t\t\t\tonClick={onClick}\n\t\t\t\t\t/>\n\t\t\t\t</Row>\n\t\t\t\t{open && <AppointmentCardContainer start={start} end={end} rootId={rootId} uid={uid} />}\n\t\t\t</RowContainer>\n\t\t);\n\t}\n\tconst label = t('label.available', 'You are available');\n\treturn (\n\t\t<RowContainer>\n\t\t\t<Row mainAlignment=\"flex-start\" padding={{ right: 'small' }}>\n\t\t\t\t<Icon size=\"large\" icon=\"Appointment\" color={'success'} />\n\t\t\t</Row>\n\n\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\">\n\t\t\t\t<Tooltip placement=\"right\" label={label}>\n\t\t\t\t\t<Text size=\"medium\" overflow=\"break-word\">\n\t\t\t\t\t\t{label}\n\t\t\t\t\t</Text>\n\t\t\t\t</Tooltip>\n\t\t\t</Row>\n\t\t</RowContainer>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { CreateSnackbarFn } from '@zextras/carbonio-design-system';\nimport { FOLDERS, replaceHistory, t } from '@zextras/carbonio-shell-ui';\n\nimport { Folder, LinkFolder } from '../../carbonio-ui-commons/types/folder';\nimport { moveAppointmentRequest } from '../../store/actions/move-appointment';\nimport { sendInviteResponse } from '../../store/actions/send-invite-response';\nimport { AppDispatch } from '../../store/redux';\n\ntype ResponseAction = {\n\tinviteId: string;\n\tnotifyOrganizer: boolean;\n\taction: string;\n\tdispatch: AppDispatch;\n\tactiveCalendar: Folder | null;\n\tcreateSnackbar: CreateSnackbarFn;\n\tparent: string;\n};\nexport const sendResponse = ({\n\tinviteId,\n\tnotifyOrganizer,\n\taction,\n\tdispatch,\n\tactiveCalendar,\n\tcreateSnackbar,\n\tparent\n}: ResponseAction): void => {\n\tdispatch(\n\t\tsendInviteResponse({\n\t\t\tinviteId,\n\t\t\tupdateOrganizer: notifyOrganizer,\n\t\t\taction\n\t\t})\n\t).then((res): void => {\n\t\tif (res.type.includes('fulfilled')) {\n\t\t\tif (parent) {\n\t\t\t\treplaceHistory(`/folder/${parent}`);\n\t\t\t}\n\t\t\tconst snackbarLabel =\n\t\t\t\t// eslint-disable-next-line no-nested-ternary\n\t\t\t\taction === 'ACCEPT'\n\t\t\t\t\t? t('message.snackbar.invite.accept', 'Youve replied as Accepted')\n\t\t\t\t\t: action === 'TENTATIVE'\n\t\t\t\t\t\t? t('message.snackbar.invite.tentative', 'Youve replied as Tentative')\n\t\t\t\t\t\t: t('message.snackbar.invite.decline', 'Youve replied as Declined');\n\t\t\tcreateSnackbar({\n\t\t\t\tkey: `invite_${action}`,\n\t\t\t\treplace: true,\n\t\t\t\ttype: 'info',\n\t\t\t\tlabel: snackbarLabel,\n\t\t\t\tautoHideTimeout: 3000\n\t\t\t});\n\t\t\tif (action === 'ACCEPT' || action === 'TENTATIVE') {\n\t\t\t\tconst calendarId = activeCalendar?.id ?? (activeCalendar as LinkFolder)?.zid;\n\t\t\t\tcalendarId &&\n\t\t\t\t\tcalendarId !== FOLDERS.CALENDAR &&\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tmoveAppointmentRequest({\n\t\t\t\t\t\t\tid: inviteId,\n\t\t\t\t\t\t\tl: calendarId || FOLDERS.CALENDAR\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tcreateSnackbar({\n\t\t\t\tkey: `invite_${action}_error`,\n\t\t\t\treplace: true,\n\t\t\t\ttype: 'error',\n\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\tautoHideTimeout: 3000\n\t\t\t});\n\t\t}\n\t});\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useCallback, useState, useMemo } from 'react';\n\nimport {\n\tContainer,\n\tPadding,\n\tButton,\n\tDivider,\n\tRow,\n\tCheckbox,\n\tuseSnackbar\n} from '@zextras/carbonio-design-system';\nimport { addBoard, Board } from '@zextras/carbonio-shell-ui';\nimport moment from 'moment';\nimport { useTranslation } from 'react-i18next';\n\nimport { useFoldersMap } from '../../../carbonio-ui-commons/store/zustand/folder';\nimport { Folder } from '../../../carbonio-ui-commons/types/folder';\nimport { generateEditor } from '../../../commons/editor-generator';\nimport { CALENDAR_ROUTE } from '../../../constants';\nimport {\n\tgetEquipments,\n\tgetMeetingRooms,\n\tgetVirtualRoom\n} from '../../../normalizations/normalize-editor';\nimport { useAppDispatch } from '../../../store/redux/hooks';\nimport { Editor } from '../../../types/editor';\nimport type {\n\tInviteReplyPartArguments,\n\tInviteResponseArguments\n} from '../../../types/integrations';\nimport { CalendarSelector } from '../../../view/editor/parts/calendar-selector';\nimport { sendResponse } from '../invite-reply-actions';\n\nconst normalizeEditorFromMailMessage = (\n\tmessageData: InviteResponseArguments['mailMsg']\n): Partial<Editor> => ({\n\tisException: messageData.ex ?? false,\n\texceptId: messageData.exceptId,\n\tisSeries: !!messageData.recur,\n\tisInstance: !messageData.recur,\n\tisRichText: true,\n\tisNew: false,\n\tattachmentFiles: [],\n\ttitle: messageData.name,\n\tlocation: messageData.loc,\n\tallDay: messageData.allDay ?? false,\n\tfreeBusy: messageData.fb,\n\tclass: messageData.class,\n\ttimezone: messageData?.s[0]?.tz ?? moment.tz.guess(true),\n\trecur: messageData.recur,\n\trichText: messageData.descHtml[0]?._content ?? '',\n\tplainText: messageData.desc[0]?._content ?? '',\n\tmeetingRoom: getMeetingRooms(messageData.at),\n\tequipment: getEquipments(messageData.at),\n\troom: getVirtualRoom(messageData.xprop),\n\tuid: messageData.uid,\n\toriginalStart: messageData.s[0].u ?? moment(messageData.s[0].d).valueOf(),\n\toriginalEnd: messageData.e[0].u ?? moment(messageData.e[0].d).valueOf(),\n\tstart: messageData.s[0].u ?? moment(messageData.s[0].d).valueOf(),\n\tend: messageData.e[0].u ?? moment(messageData.e[0].d).valueOf(),\n\tattendees: [\n\t\t{\n\t\t\temail: messageData.or.a ?? messageData.or.url,\n\t\t\tid: messageData.or.a ?? messageData.or.url\n\t\t}\n\t]\n});\n\nconst InviteReplyPart: FC<InviteReplyPartArguments> = ({ inviteId, message }): ReactElement => {\n\tconst [notifyOrganizer, setNotifyOrganizer] = useState(true);\n\tconst [activeCalendar, setActiveCalendar] = useState<Folder | null>(null);\n\tconst createSnackbar = useSnackbar();\n\tconst [t] = useTranslation();\n\tconst dispatch = useAppDispatch();\n\tconst calendarFolders = useFoldersMap();\n\n\tconst proposeNewTimeCb = useCallback(() => {\n\t\tconst messageData = message.invite[0].comp[0];\n\t\tconst partialEditor = normalizeEditorFromMailMessage(messageData);\n\n\t\tconst editor = generateEditor({\n\t\t\tcontext: {\n\t\t\t\tdispatch,\n\t\t\t\tfolders: calendarFolders,\n\t\t\t\tisProposeNewTime: true,\n\t\t\t\tpanel: false,\n\t\t\t\tinviteId,\n\t\t\t\tdisabled: {\n\t\t\t\t\ttitle: true,\n\t\t\t\t\tlocation: true,\n\t\t\t\t\torganizer: true,\n\t\t\t\t\tvirtualRoom: true,\n\t\t\t\t\trichTextButton: true,\n\t\t\t\t\tattachmentsButton: true,\n\t\t\t\t\tsaveButton: true,\n\t\t\t\t\tattendees: true,\n\t\t\t\t\toptionalAttendees: true,\n\t\t\t\t\tfreeBusy: true,\n\t\t\t\t\tcalendar: true,\n\t\t\t\t\tprivate: true,\n\t\t\t\t\tallDay: true,\n\t\t\t\t\treminder: true,\n\t\t\t\t\trecurrence: true,\n\t\t\t\t\tmeetingRoom: true,\n\t\t\t\t\tequipment: true,\n\t\t\t\t\ttimezone: true\n\t\t\t\t},\n\t\t\t\t...partialEditor\n\t\t\t}\n\t\t});\n\t\tif (editor.id) {\n\t\t\taddBoard({\n\t\t\t\turl: `${CALENDAR_ROUTE}/`,\n\t\t\t\ttitle: editor?.title ?? '',\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\teditor\n\t\t\t} as unknown as Board);\n\t\t}\n\t}, [calendarFolders, dispatch, inviteId, message.invite]);\n\n\tconst onAction = useCallback(\n\t\t(action: string): (() => void) =>\n\t\t\t(): void => {\n\t\t\t\tsendResponse({\n\t\t\t\t\taction,\n\t\t\t\t\tcreateSnackbar,\n\t\t\t\t\tinviteId,\n\t\t\t\t\tnotifyOrganizer,\n\t\t\t\t\tactiveCalendar,\n\t\t\t\t\tdispatch,\n\t\t\t\t\tparent: message.parent\n\t\t\t\t});\n\t\t\t},\n\t\t[createSnackbar, inviteId, notifyOrganizer, activeCalendar, dispatch, message.parent]\n\t);\n\n\t// TODO: find a more readable and descriptive way to handle this data\n\tconst participationStatus = useMemo(\n\t\t() => message?.invite?.[0]?.replies?.[0].reply?.[0]?.ptst ?? '',\n\t\t[message?.invite]\n\t);\n\treturn (\n\t\t<>\n\t\t\t<Row width=\"fill\" mainAlignment=\"space-between\" padding={{ vertical: 'small' }}>\n\t\t\t\t<Container width=\"35%\" mainAlignment=\"flex-start\" crossAlignment=\"baseline\">\n\t\t\t\t\t<Checkbox\n\t\t\t\t\t\tvalue={notifyOrganizer}\n\t\t\t\t\t\tonClick={(): void => setNotifyOrganizer(!notifyOrganizer)}\n\t\t\t\t\t\tlabel={t('label.notify_organizer', 'Notify Organizer')}\n\t\t\t\t\t/>\n\t\t\t\t</Container>\n\t\t\t\t<Container width=\"65%\" mainAlignment=\"flex-start\">\n\t\t\t\t\t<CalendarSelector\n\t\t\t\t\t\tcalendarId={message.parent}\n\t\t\t\t\t\tonCalendarChange={(cal): void => setActiveCalendar(cal)}\n\t\t\t\t\t\tlabel={t('label.scheduled_in', 'Scheduled in')}\n\t\t\t\t\t\texcludeTrash\n\t\t\t\t\t/>\n\t\t\t\t</Container>\n\t\t\t</Row>\n\t\t\t<Row\n\t\t\t\twidth=\"fill\"\n\t\t\t\theight=\"fit\"\n\t\t\t\tstyle={{\n\t\t\t\t\tflexGrow: 1,\n\t\t\t\t\tflexBasis: 'fit-content',\n\t\t\t\t\twhiteSpace: 'nowrap',\n\t\t\t\t\toverflow: 'hidden'\n\t\t\t\t}}\n\t\t\t\tpadding={{ vertical: 'small' }}\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t>\n\t\t\t\t<Padding right=\"small\" vertical=\"large\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\ttype=\"outlined\"\n\t\t\t\t\t\tlabel={t('event.action.accept', 'Accept')}\n\t\t\t\t\t\ticon=\"CheckmarkOutline\"\n\t\t\t\t\t\tcolor=\"success\"\n\t\t\t\t\t\tonClick={onAction('ACCEPT')}\n\t\t\t\t\t\tdisabled={participationStatus === 'AC'}\n\t\t\t\t\t/>\n\t\t\t\t</Padding>\n\t\t\t\t<Padding right=\"small\" vertical=\"medium\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\ttype=\"outlined\"\n\t\t\t\t\t\tlabel={t('label.tentative', 'Tentative')}\n\t\t\t\t\t\ticon=\"QuestionMarkOutline\"\n\t\t\t\t\t\tcolor=\"warning\"\n\t\t\t\t\t\tonClick={onAction('TENTATIVE')}\n\t\t\t\t\t\tdisabled={participationStatus === 'TE'}\n\t\t\t\t\t/>\n\t\t\t\t</Padding>\n\t\t\t\t<Padding right=\"small\" vertical=\"medium\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\ttype=\"outlined\"\n\t\t\t\t\t\tlabel={t('event.action.decline', 'Decline')}\n\t\t\t\t\t\ticon=\"CloseOutline\"\n\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\tonClick={onAction('DECLINE')}\n\t\t\t\t\t\tdisabled={participationStatus === 'DE'}\n\t\t\t\t\t/>\n\t\t\t\t</Padding>\n\t\t\t\t<Padding right=\"small\" vertical=\"large\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tlabel={t('label.propose_new_time', 'Propose new time')}\n\t\t\t\t\t\ticon=\"ClockOutline\"\n\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\ttype=\"outlined\"\n\t\t\t\t\t\tonClick={proposeNewTimeCb}\n\t\t\t\t\t/>\n\t\t\t\t</Padding>\n\t\t\t</Row>\n\t\t\t<Divider />\n\t\t</>\n\t);\n};\n\nexport default InviteReplyPart;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useCallback } from 'react';\n\nimport { Container, Padding, Button, Divider, useSnackbar } from '@zextras/carbonio-design-system';\nimport { useIntegratedFunction } from '@zextras/carbonio-shell-ui';\nimport { find, map } from 'lodash';\nimport moment from 'moment';\nimport { useTranslation } from 'react-i18next';\n\nimport { useFoldersMap } from '../../../carbonio-ui-commons/store/zustand/folder';\nimport { generateEditor } from '../../../commons/editor-generator';\nimport { getAppointment, normalizeFromGetAppointment } from '../../../commons/get-appointment';\nimport { normalizeCalendarEvent } from '../../../normalizations/normalize-calendar-events';\nimport { normalizeInvite } from '../../../normalizations/normalize-invite';\nimport { getInvite } from '../../../store/actions/get-invite';\nimport { modifyAppointment } from '../../../store/actions/new-modify-appointment';\nimport { useAppDispatch } from '../../../store/redux/hooks';\nimport { updateEditor } from '../../../store/slices/editor-slice';\nimport { ProposedTimeReplyArguments } from '../../../types/integrations';\n\nconst ProposedTimeReply: FC<ProposedTimeReplyArguments> = ({\n\tid,\n\tmoveToTrash,\n\ttitle,\n\tfragment,\n\tstart,\n\tend,\n\tmsg,\n\tto\n}): ReactElement => {\n\tconst [t] = useTranslation();\n\tconst createSnackbar = useSnackbar();\n\tconst dispatch = useAppDispatch();\n\tconst calendarFolders = useFoldersMap();\n\tconst [openComposer, available] = useIntegratedFunction('compose');\n\n\tconst acceptProposedTime = useCallback(() => {\n\t\tgetAppointment(id).then((res) => {\n\t\t\tif (res?.appt[0]) {\n\t\t\t\tconst inviteToNormalize =\n\t\t\t\t\tfind(\n\t\t\t\t\t\tres.appt[0]?.inv,\n\t\t\t\t\t\t(inv) => inv?.comp?.[0]?.ridZ === msg?.invite?.[0]?.comp?.[0]?.ridZ\n\t\t\t\t\t) ?? res.appt[0]?.inv[0];\n\t\t\t\tconst inviteId = `${inviteToNormalize.comp[0].apptId}-${inviteToNormalize.id}`;\n\t\t\t\tconst ridZ = inviteToNormalize?.comp?.[0]?.ridZ ?? msg?.invite?.[0]?.comp?.[0]?.ridZ;\n\t\t\t\tconst folderId = inviteToNormalize.comp[0].ciFolder;\n\t\t\t\tconst appointmentToNormalize = {\n\t\t\t\t\t...res?.appt[0],\n\t\t\t\t\tinv: [inviteToNormalize],\n\t\t\t\t\tinviteId\n\t\t\t\t};\n\n\t\t\t\tdispatch(\n\t\t\t\t\tgetInvite({\n\t\t\t\t\t\tinviteId,\n\t\t\t\t\t\tridZ\n\t\t\t\t\t})\n\t\t\t\t).then((res2) => {\n\t\t\t\t\tconst calendar = find(calendarFolders, ['id', folderId]);\n\t\t\t\t\tif (calendar && res2?.payload?.m) {\n\t\t\t\t\t\tconst invite = normalizeInvite(res2?.payload.m[0]);\n\t\t\t\t\t\tconst appointment = normalizeFromGetAppointment(appointmentToNormalize);\n\t\t\t\t\t\tconst event = normalizeCalendarEvent({ appointment, invite, calendar });\n\t\t\t\t\t\tconst editor = generateEditor({\n\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\tinvite,\n\t\t\t\t\t\t\tcontext: {\n\t\t\t\t\t\t\t\tattendees: map(invite.attendees, (attendee) => ({ email: attendee.a })),\n\t\t\t\t\t\t\t\tisInstance: !!ridZ,\n\t\t\t\t\t\t\t\toriginalStart:\n\t\t\t\t\t\t\t\t\tmoment(appointmentToNormalize?.inv?.[0]?.comp?.[0].s?.[0]?.d).valueOf() ?? start,\n\t\t\t\t\t\t\t\toriginalEnd:\n\t\t\t\t\t\t\t\t\tmoment(appointmentToNormalize?.inv?.[0]?.comp?.[0].e?.[0]?.d).valueOf() ?? end,\n\t\t\t\t\t\t\t\texceptId: msg?.invite?.[0]?.comp?.[0]?.exceptId,\n\t\t\t\t\t\t\t\tstart,\n\t\t\t\t\t\t\t\tend,\n\t\t\t\t\t\t\t\tfolders: calendarFolders,\n\t\t\t\t\t\t\t\tdispatch,\n\t\t\t\t\t\t\t\tpanel: false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tdispatch(modifyAppointment({ draft: false, editor })).then(({ payload }) => {\n\t\t\t\t\t\t\tconst { response, error } = payload;\n\t\t\t\t\t\t\tif (response && !error) {\n\t\t\t\t\t\t\t\tdispatch(updateEditor({ id: payload.editor.id, editor: payload.editor }));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\t\t\tkey: error ? 'proposedTimeDeclined' : 'proposedTimeAccepted',\n\t\t\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\t\t\ttype: error ? 'error' : 'success',\n\t\t\t\t\t\t\t\thideButton: true,\n\t\t\t\t\t\t\t\tlabel: error\n\t\t\t\t\t\t\t\t\t? t('label.error_try_again', 'Something went wrong, please try again')\n\t\t\t\t\t\t\t\t\t: t('snackbar.proposed_time_accepted', 'You accepted the proposed time'),\n\t\t\t\t\t\t\t\tautoHideTimeout: 3000\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tmoveToTrash?.();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}, [calendarFolders, createSnackbar, dispatch, end, id, moveToTrash, msg?.invite, start, t]);\n\n\tconst decline = useCallback(() => {\n\t\tif (available)\n\t\t\topenComposer(null, {\n\t\t\t\ttext: ['text', `${fragment}:`],\n\t\t\t\tsubject: `${t('label.proposal_declined', 'Proposal declined')}${title}`,\n\t\t\t\tto\n\t\t\t});\n\t}, [available, openComposer, fragment, t, title, to]);\n\n\treturn (\n\t\t<>\n\t\t\t<Container\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\twidth=\"fill\"\n\t\t\t\theight=\"fit\"\n\t\t\t\tpadding={{ vertical: 'small' }}\n\t\t\t>\n\t\t\t\t<Padding right=\"small\" vertical=\"medium\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\ttype=\"outlined\"\n\t\t\t\t\t\tlabel={t('event.action.accept', 'Accept')}\n\t\t\t\t\t\ticon=\"CheckmarkOutline\"\n\t\t\t\t\t\tcolor=\"success\"\n\t\t\t\t\t\tonClick={acceptProposedTime}\n\t\t\t\t\t/>\n\t\t\t\t</Padding>\n\t\t\t\t<Padding right=\"small\" vertical=\"medium\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\ttype=\"outlined\"\n\t\t\t\t\t\tlabel={t('event.action.decline', 'Decline')}\n\t\t\t\t\t\ticon=\"Close\"\n\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\tonClick={decline}\n\t\t\t\t\t/>\n\t\t\t\t</Padding>\n\t\t\t</Container>\n\t\t\t<Divider />\n\t\t</>\n\t);\n};\n\nexport default ProposedTimeReply;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\nimport { isNil, omitBy } from 'lodash';\n\nimport { Appointment } from '../types/store/appointments';\n\nexport const getAppointmentAndInvite = async ({\n\taptId,\n\tinviteId\n}: {\n\taptId: string;\n\tinviteId: string;\n}): Promise<{ appointment: any; invite: any }> => {\n\tconst result = (await soapFetch('Batch', {\n\t\tGetAppointmentRequest: {\n\t\t\tid: aptId,\n\t\t\tincludeContent: '1',\n\t\t\t_jsns: 'urn:zimbraMail'\n\t\t},\n\t\tGetMsgRequest: {\n\t\t\tm: {\n\t\t\t\thtml: 1,\n\t\t\t\tneedExp: 1,\n\t\t\t\tid: inviteId,\n\t\t\t\theader: [\n\t\t\t\t\t{\n\t\t\t\t\t\tn: 'List-ID'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tn: 'X-Zimbra-DL'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tn: 'IN-REPLY-TO'\n\t\t\t\t\t},\n\t\t\t\t\t{ n: 'GoPolicyd-isExtNetwork' }\n\t\t\t\t],\n\t\t\t\tmax: 250000\n\t\t\t},\n\t\t\t_jsns: 'urn:zimbraMail'\n\t\t},\n\t\t_jsns: 'urn:zimbra',\n\t\tonerror: 'continue'\n\t})) as Record<string, Array<any>>;\n\treturn {\n\t\tappointment: result.GetAppointmentResponse[0].appt[0],\n\t\tinvite: result.GetMsgResponse[0].m[0]\n\t};\n};\n\n// it is impossible to type right now or it will break too many parts of the app\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const normalizeFromGetAppointment = (appt: any): Appointment => <Appointment>omitBy(\n\t\t{\n\t\t\tid: appt?.apptId,\n\t\t\tl: appt.ciFolder,\n\t\t\talarm: appt?.inv?.[0]?.comp?.[0]?.alarm,\n\t\t\talarmData: appt?.inv?.[0]?.comp?.[0]?.alarmData,\n\t\t\tfb: appt?.inv?.[0]?.comp?.[0]?.fb,\n\t\t\tfr: appt?.inv?.[0]?.comp?.[0]?.fr,\n\t\t\td: appt?.d,\n\t\t\tfba: appt?.inv?.[0]?.comp?.[0]?.fba,\n\t\t\tmd: appt.md,\n\t\t\tflags: appt?.inv?.[0]?.comp?.[0]?.f,\n\t\t\tms: appt?.inv?.[0]?.comp?.[0]?.ms,\n\t\t\tptst: appt?.ptst,\n\t\t\trev: appt.rev,\n\t\t\tstatus: appt?.inv?.[0]?.comp?.[0]?.status,\n\t\t\ttransp: appt?.inv?.[0]?.comp?.[0]?.transp,\n\t\t\tuid: appt.uid,\n\t\t\tcompNum: appt?.inv?.[0]?.compNum,\n\t\t\tclass: appt?.inv?.[0]?.comp?.[0]?.class,\n\t\t\tdur:\n\t\t\t\tappt?.inv?.[0]?.comp?.[0]?.e?.[0]?.u && appt?.inv?.[0]?.comp?.[0]?.s?.[0]?.u\n\t\t\t\t\t? appt.inv[0].comp[0].e[0].u - appt.inv[0].comp[0].s[0].u\n\t\t\t\t\t: undefined,\n\t\t\tallDay: appt?.inv?.[0]?.comp?.[0]?.allDay ?? false,\n\t\t\tdraft: appt?.inv?.[0]?.comp?.[0]?.draft,\n\t\t\tinviteId: appt?.id && appt?.inv?.[0] ? `${appt.id}-${appt.inv[0].id}` : undefined,\n\t\t\tisOrg: appt?.inv?.[0]?.comp?.[0]?.isOrg,\n\t\t\tloc: appt?.inv?.[0]?.comp?.[0]?.loc,\n\t\t\totherAtt: appt?.inv?.[0]?.comp?.[0]?.otherAtt,\n\t\t\trecur: !!appt?.inv?.[0]?.comp?.[0]?.recur,\n\t\t\tname: appt?.inv?.[0]?.comp?.[0]?.name,\n\t\t\tmeta: appt?.meta,\n\t\t\tneverSent: appt?.inv?.[0]?.comp?.[0]?.neverSent,\n\t\t\tor: appt?.inv?.[0]?.comp?.[0]?.or,\n\t\t\ts: appt.s\n\t\t},\n\t\tisNil\n\t);\n\nexport const getAppointment = async (id: string): Promise<any> =>\n\tsoapFetch('GetAppointment', {\n\t\tid,\n\t\tincludeContent: '1',\n\t\t_jsns: 'urn:zimbraMail'\n\t});\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useMemo, useState } from 'react';\n\nimport {\n\tContainer,\n\tRow,\n\tIcon,\n\tText,\n\tDivider,\n\tTooltip,\n\tChip,\n\tPadding\n} from '@zextras/carbonio-design-system';\nimport { getAction, Action, useUserAccount, FOLDERS, ROOT_NAME } from '@zextras/carbonio-shell-ui';\nimport { filter, find, includes, map } from 'lodash';\nimport moment from 'moment';\nimport { useTranslation } from 'react-i18next';\nimport styled from 'styled-components';\n\nimport 'moment-timezone';\nimport { AvailabilityChecker } from './parts/availability-checker';\nimport InviteReplyPart from './parts/invite-reply-part';\nimport ProposedTimeReply from './parts/proposed-time-reply';\nimport { getRootAccountId, useRoot } from '../../carbonio-ui-commons/store/zustand/folder';\nimport BodyMessageRenderer, { extractBody } from '../../commons/body-message-renderer';\nimport { CALENDAR_RESOURCES } from '../../constants';\nimport { MESSAGE_METHOD, PARTICIPANT_ROLE } from '../../constants/api';\nimport { CRB_XPROPS, CRB_XPARAMS } from '../../constants/xprops';\nimport { useGetEventTimezoneString } from '../../hooks/use-get-event-timezone';\nimport { getLocalTime } from '../../normalizations/normalize-editor';\nimport { normalizeInvite } from '../../normalizations/normalize-invite';\nimport { StoreProvider } from '../../store/redux';\nimport type { InviteResponseArguments } from '../../types/integrations';\n\nexport function mailToContact(contact: object): Action | undefined {\n\tconst [mailTo, available] = getAction('contact-list', 'mail-to', [contact]);\n\treturn available ? mailTo : undefined;\n}\n\nconst InviteContainer = styled(Container)`\n\tborder: 0.0625rem solid ${({ theme }): string => theme.palette.gray2.regular};\n\tborder-radius: 0.875rem;\n\tmargin: ${({ theme }): string => theme.sizes.padding.extrasmall};\n\tpadding: ${({ theme }): string => theme.sizes.padding.extralarge};\n`;\n\nconst LinkText = styled(Text)`\n\tcursor: pointer;\n\ttext-decoration: underline;\n\t&:hover {\n\t\ttext-decoration: none;\n\t}\n`;\n\nexport const InviteResponse: FC<InviteResponseArguments> = ({\n\tmailMsg,\n\tmoveToTrash\n}): ReactElement => {\n\tconst account = useUserAccount();\n\tconst invite = normalizeInvite({ ...mailMsg, inv: mailMsg.invite });\n\tconst [t] = useTranslation();\n\n\tconst rootAccountId = getRootAccountId(mailMsg.parent) ?? FOLDERS.USER_ROOT;\n\tconst root = useRoot(rootAccountId);\n\tconst email = useMemo(\n\t\t() => (root?.name === ROOT_NAME ? account.name : root?.name ?? account.name),\n\t\t[account.name, root?.name]\n\t);\n\tconst isAttendee = useMemo(\n\t\t() => invite?.organizer?.a !== account.name,\n\t\t[account.name, invite?.organizer?.a]\n\t);\n\n\tconst to = useMemo(\n\t\t() =>\n\t\t\tfilter(\n\t\t\t\tmailMsg.participants as [{ address: string; fullName: string; name: string; type: string }],\n\t\t\t\t{ type: 'f' }\n\t\t\t),\n\t\t[mailMsg?.participants]\n\t);\n\n\tconst method = mailMsg.invite[0]?.comp[0].method;\n\n\tconst room = useMemo(() => find(invite.xprop, ['name', CRB_XPROPS.MEETING_ROOM]), [invite]);\n\tconst roomName = find(room?.xparam, ['name', CRB_XPARAMS.ROOM_NAME])?.value;\n\tconst roomLink = find(room?.xparam, ['name', CRB_XPARAMS.ROOM_LINK])?.value;\n\n\tconst meetingRooms = useMemo(\n\t\t() => filter(invite.attendees, ['cutype', CALENDAR_RESOURCES.ROOM]),\n\t\t[invite.attendees]\n\t);\n\n\tconst equipments = useMemo(\n\t\t() => filter(invite.attendees, ['cutype', CALENDAR_RESOURCES.RESOURCE]),\n\t\t[invite.attendees]\n\t);\n\n\tconst equipmentsString = useMemo(\n\t\t() => map(equipments, (equipment) => equipment.d).join(', '),\n\t\t[equipments]\n\t);\n\n\tconst rooms = useMemo(\n\t\t() => map(meetingRooms, (meetingRoom) => meetingRoom.d).join(', '),\n\t\t[meetingRooms]\n\t);\n\n\tconst [maxReqParticipantsToShow, setMaxReqParticipantsToShow] = useState(2);\n\tconst requiredParticipants = useMemo(\n\t\t() => invite.attendees.filter((user) => user.role === PARTICIPANT_ROLE.REQUIRED),\n\t\t[invite]\n\t);\n\n\tconst [maxOptParticipantsToShow, setMaxOptParticipantsToShow] = useState(5);\n\tconst optionalParticipants = useMemo(\n\t\t() => invite.attendees.filter((user) => user.role === PARTICIPANT_ROLE.OPTIONAL),\n\t\t[invite]\n\t);\n\n\tconst replyMsg = (user: { a?: string; d?: string }): void => {\n\t\tconst obj = {\n\t\t\temail: {\n\t\t\t\temail: {\n\t\t\t\t\tmail: user.a\n\t\t\t\t}\n\t\t\t},\n\t\t\tfirstName: user.d ?? user.a,\n\t\t\tmiddleName: ''\n\t\t};\n\n\t\tmailToContact(obj)\n\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t// @ts-ignore\n\t\t\t?.onClick?.();\n\t};\n\n\tconst localTimezone = useMemo(() => moment.tz.guess(), []);\n\n\t/* start and end value are already converted to the creation timezone value, so to convert it back to the local timezone we need to convert it again to local */\n\tconst localStart = useMemo(\n\t\t() =>\n\t\t\tgetLocalTime(\n\t\t\t\tmoment(invite.start?.d ?? invite.start.u).valueOf() ?? 0,\n\t\t\t\tlocalTimezone,\n\t\t\t\tinvite.tz\n\t\t\t),\n\t\t[invite.start?.d, invite.start.u, invite.tz, localTimezone]\n\t);\n\tconst localEnd = useMemo(\n\t\t() =>\n\t\t\tgetLocalTime(moment(invite.end?.d ?? invite.end.u).valueOf() ?? 0, localTimezone, invite.tz),\n\t\t[invite.end?.d, invite.end.u, invite.tz, localTimezone]\n\t);\n\n\tconst { localTimeString, localTimezoneString, showTimezoneTooltip, localTimezoneTooltip } =\n\t\tuseGetEventTimezoneString(localStart, localEnd, invite.allDay, invite.tz);\n\n\tconst messageHasABody = useMemo(() => {\n\t\tconst body = extractBody(invite?.textDescription?.[0]?._content);\n\t\t/* TODO: appointments descriptions needs a refactor. Currently appointments descriptions are created with a double\n\t\t    quotes inside breaking the first condition */\n\t\treturn body?.length > 0 && body !== '\"';\n\t}, [invite?.textDescription]);\n\n\tconst inviteId =\n\t\tinvite.apptId && !includes(invite.id, ':') ? `${invite.apptId}-${invite.id}` : invite.id;\n\n\tconst requiredSlice = requiredParticipants.slice(0, maxReqParticipantsToShow);\n\treturn (\n\t\t<InviteContainer data-testid={'invite-response'}>\n\t\t\t<Container padding={{ horizontal: 'small', vertical: 'large' }} width=\"100%\">\n\t\t\t\t<Row width=\"fill\" mainAlignment=\"flex-start\" padding={{ bottom: 'extrasmall' }}>\n\t\t\t\t\t{method === 'COUNTER' ? (\n\t\t\t\t\t\t<Text weight=\"light\" size=\"large\">\n\t\t\t\t\t\t\t{mailMsg.subject}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Text weight=\"regular\" size=\"large\" style={{ fontSize: '1.125rem' }}>\n\t\t\t\t\t\t\t\t{`${invite.organizer?.d ?? invite.organizer?.a} ${t(\n\t\t\t\t\t\t\t\t\t'message.invited_you',\n\t\t\t\t\t\t\t\t\t'invited you to an event'\n\t\t\t\t\t\t\t\t)}`}\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t\t<Text weight=\"bold\" size=\"large\" style={{ fontSize: '1.125rem' }}>\n\t\t\t\t\t\t\t\t{mailMsg.subject ? mailMsg.subject : invite?.name}\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t</Row>\n\t\t\t\t<Row width=\"100%\" mainAlignment=\"flex-start\">\n\t\t\t\t\t<Text overflow=\"ellipsis\" color=\"secondary\" weight=\"bold\" size=\"small\">\n\t\t\t\t\t\t{localTimeString}\n\t\t\t\t\t</Text>\n\t\t\t\t\t{showTimezoneTooltip && (\n\t\t\t\t\t\t<Tooltip label={localTimezoneTooltip}>\n\t\t\t\t\t\t\t<Padding left=\"small\">\n\t\t\t\t\t\t\t\t<Icon icon=\"GlobeOutline\" color=\"gray1\" />\n\t\t\t\t\t\t\t</Padding>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t)}\n\t\t\t\t</Row>\n\t\t\t\t<Row width=\"100%\" mainAlignment=\"flex-start\">\n\t\t\t\t\t<Text overflow=\"ellipsis\" color=\"secondary\" weight=\"bold\" size=\"small\">\n\t\t\t\t\t\t{localTimezoneString}\n\t\t\t\t\t</Text>{' '}\n\t\t\t\t</Row>\n\t\t\t\t{method === MESSAGE_METHOD.REQUEST && root && (\n\t\t\t\t\t<AvailabilityChecker\n\t\t\t\t\t\temail={email}\n\t\t\t\t\t\trootId={root.id}\n\t\t\t\t\t\tstart={invite?.start?.u ?? moment(mailMsg.invite[0].comp[0].s[0].d).valueOf()}\n\t\t\t\t\t\tend={invite?.end?.u ?? moment(mailMsg.invite[0].comp[0].e[0].d).valueOf()}\n\t\t\t\t\t\tallDay={invite.allDay ?? false}\n\t\t\t\t\t\tuid={invite.uid}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t{method === 'COUNTER'\n\t\t\t\t\t? mailMsg.parent !== '5' && (\n\t\t\t\t\t\t\t// eslint-disable-next-line react/jsx-indent\n\t\t\t\t\t\t\t<ProposedTimeReply\n\t\t\t\t\t\t\t\tid={invite?.apptId}\n\t\t\t\t\t\t\t\tstart={invite?.start?.u ?? moment(mailMsg.invite[0].comp[0].s[0].d).valueOf()}\n\t\t\t\t\t\t\t\tend={invite?.end?.u ?? moment(mailMsg.invite[0].comp[0].e[0].d).valueOf()}\n\t\t\t\t\t\t\t\tmoveToTrash={moveToTrash}\n\t\t\t\t\t\t\t\ttitle={mailMsg.subject}\n\t\t\t\t\t\t\t\tto={to}\n\t\t\t\t\t\t\t\tmsg={mailMsg}\n\t\t\t\t\t\t\t\tfragment={invite?.fragment}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)\n\t\t\t\t\t: isAttendee && <InviteReplyPart inviteId={inviteId} message={mailMsg} />}\n\n\t\t\t\t{invite?.location && (\n\t\t\t\t\t<Row width=\"fill\" mainAlignment=\"flex-start\" padding={{ top: 'large' }}>\n\t\t\t\t\t\t<Tooltip placement=\"left\" label={t('tooltip.location', 'Location')}>\n\t\t\t\t\t\t\t<Row mainAlignment=\"flex-start\" padding={{ right: 'small' }}>\n\t\t\t\t\t\t\t\t<Icon size=\"large\" icon=\"PinOutline\" />\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t</Tooltip>\n\n\t\t\t\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\">\n\t\t\t\t\t\t\t<Tooltip placement=\"right\" label={invite?.organizer?.a}>\n\t\t\t\t\t\t\t\t<Text size=\"medium\" overflow=\"break-word\">\n\t\t\t\t\t\t\t\t\t{invite?.location}\n\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t</Row>\n\t\t\t\t)}\n\n\t\t\t\t{roomName && roomLink && (\n\t\t\t\t\t<Row width=\"fill\" mainAlignment=\"flex-start\" padding={{ top: 'large' }}>\n\t\t\t\t\t\t<Tooltip placement=\"top\" label={t('tooltip.virtual_room', 'Virtual room')}>\n\t\t\t\t\t\t\t<Row mainAlignment=\"flex-start\" padding={{ right: 'small' }}>\n\t\t\t\t\t\t\t\t<Icon size=\"large\" icon=\"VideoOutline\" />\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\">\n\t\t\t\t\t\t\t<Tooltip placement=\"right\" label={roomLink}>\n\t\t\t\t\t\t\t\t<LinkText color=\"gray1\" size=\"medium\" overflow=\"break-word\">\n\t\t\t\t\t\t\t\t\t<a href={roomLink} target=\"_blank\" rel=\"noreferrer\">\n\t\t\t\t\t\t\t\t\t\t{roomName}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</LinkText>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t</Row>\n\t\t\t\t)}\n\n\t\t\t\t{meetingRooms && meetingRooms?.length > 0 && (\n\t\t\t\t\t<Row width=\"fill\" mainAlignment=\"flex-start\" padding={{ top: 'large', bottom: 'small' }}>\n\t\t\t\t\t\t<Tooltip placement=\"left\" label={t('tooltip.meetingRooms', 'MeetingRooms')}>\n\t\t\t\t\t\t\t<Row mainAlignment=\"flex-start\" padding={{ right: 'small' }}>\n\t\t\t\t\t\t\t\t<Icon size=\"large\" icon=\"BuildingOutline\" />\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\">\n\t\t\t\t\t\t\t<Tooltip placement=\"right\" label={t('tooltip.meetingRooms', 'MeetingRooms')}>\n\t\t\t\t\t\t\t\t<Text size=\"medium\" overflow=\"break-word\">\n\t\t\t\t\t\t\t\t\t{rooms}\n\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t</Row>\n\t\t\t\t)}\n\n\t\t\t\t{equipments && equipments.length > 0 && (\n\t\t\t\t\t<Row width=\"fill\" mainAlignment=\"flex-start\" padding={{ top: 'large', bottom: 'small' }}>\n\t\t\t\t\t\t<Tooltip placement=\"left\" label={t('tooltip.equipment', 'Equipment')}>\n\t\t\t\t\t\t\t<Row mainAlignment=\"flex-start\" padding={{ right: 'small' }}>\n\t\t\t\t\t\t\t\t<Icon size=\"large\" icon=\"BriefcaseOutline\" />\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\">\n\t\t\t\t\t\t\t<Tooltip placement=\"right\" label={t('tooltip.equipment', 'Equipment')}>\n\t\t\t\t\t\t\t\t<Text size=\"medium\" overflow=\"break-word\">\n\t\t\t\t\t\t\t\t\t{equipmentsString}\n\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t</Row>\n\t\t\t\t)}\n\n\t\t\t\t<Row\n\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\tpadding={{ vertical: 'medium' }}\n\t\t\t\t>\n\t\t\t\t\t<Row width=\"50%\" mainAlignment=\"flex-start\" crossAlignment=\"flex-start\">\n\t\t\t\t\t\t<Row mainAlignment=\"flex-start\" padding={{ right: 'small' }}>\n\t\t\t\t\t\t\t<Icon size=\"large\" icon=\"PeopleOutline\" />\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\" crossAlignment=\"flex-start\">\n\t\t\t\t\t\t\t<Row mainAlignment=\"flex-start\" width=\"100%\" padding={{ bottom: 'extrasmall' }}>\n\t\t\t\t\t\t\t\t<Text overflow=\"break-word\">\n\t\t\t\t\t\t\t\t\t{t('message.required_participant', {\n\t\t\t\t\t\t\t\t\t\tcount: requiredParticipants.length,\n\t\t\t\t\t\t\t\t\t\tdefaultValue_one: '{{count}} Participant',\n\t\t\t\t\t\t\t\t\t\tdefaultValue_other: '{{count}} Participants'\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t</Row>\n\n\t\t\t\t\t\t\t<Row mainAlignment=\"flex-start\" width=\"100%\" padding={{ top: 'small' }}>\n\t\t\t\t\t\t\t\t{invite?.organizer?.d ? (\n\t\t\t\t\t\t\t\t\t<Tooltip placement=\"top\" label={invite?.organizer?.a} maxWidth=\"100%\">\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<Chip\n\t\t\t\t\t\t\t\t\t\t\t\tavatarLabel={invite?.organizer?.d}\n\t\t\t\t\t\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Text size=\"small\">{invite?.organizer?.d}</Text>&nbsp;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Text size=\"small\" color=\"secondary\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t({t('message.organizer')})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tbackground={'gray3'}\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: 'action1',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: t('message.send_email'),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'button',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon: 'EmailOutline',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick: () => replyMsg(invite?.organizer)\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<Chip\n\t\t\t\t\t\t\t\t\t\tavatarLabel={invite?.organizer?.a}\n\t\t\t\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t<Text>{invite?.organizer?.a}</Text>&nbsp;\n\t\t\t\t\t\t\t\t\t\t\t\t<Text color=\"secondary\">({t('message.organizer')})</Text>\n\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tbackground={'gray3'}\n\t\t\t\t\t\t\t\t\t\tcolor=\"text\"\n\t\t\t\t\t\t\t\t\t\tactions={[\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tid: 'action1',\n\t\t\t\t\t\t\t\t\t\t\t\tlabel: t('message.send_email'),\n\t\t\t\t\t\t\t\t\t\t\t\ttype: 'button',\n\t\t\t\t\t\t\t\t\t\t\t\ticon: 'EmailOutline',\n\t\t\t\t\t\t\t\t\t\t\t\tonClick: () => replyMsg(invite?.organizer)\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t{requiredSlice.map((p, index: number) => (\n\t\t\t\t\t\t\t\t<Row\n\t\t\t\t\t\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\t\t\t\tpadding={{ top: 'small' }}\n\t\t\t\t\t\t\t\t\tkey={`${p.d ?? p.a}-${index}-1`}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t<Tooltip placement=\"top\" label={p.a ?? p.d ?? ''} maxWidth=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t<Chip label={p.d ?? p.a} />\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t{maxReqParticipantsToShow < requiredParticipants.length && (\n\t\t\t\t\t\t\t\t<Row mainAlignment=\"flex-start\" width=\"100%\" padding={{ top: 'small' }}>\n\t\t\t\t\t\t\t\t\t<LinkText\n\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\t\t\tsize=\"medium\"\n\t\t\t\t\t\t\t\t\t\tonClick={(): void => setMaxReqParticipantsToShow(requiredParticipants.length)}\n\t\t\t\t\t\t\t\t\t\toverflow=\"break-word\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{t('message.more', 'More...')}\n\t\t\t\t\t\t\t\t\t</LinkText>\n\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t</Row>\n\n\t\t\t\t\t{optionalParticipants.length > 0 && (\n\t\t\t\t\t\t<Row width=\"50%\" mainAlignment=\"flex-start\" crossAlignment=\"flex-start\">\n\t\t\t\t\t\t\t<Row mainAlignment=\"flex-start\" padding={{ right: 'small' }}>\n\t\t\t\t\t\t\t\t<Icon size=\"large\" icon=\"OptionalInviteeOutline\" />\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\" crossAlignment=\"flex-start\">\n\t\t\t\t\t\t\t\t<Row mainAlignment=\"flex-start\" width=\"100%\" padding={{ bottom: 'extrasmall' }}>\n\t\t\t\t\t\t\t\t\t<Text overflow=\"break-word\">\n\t\t\t\t\t\t\t\t\t\t{t('message.optional_participant', {\n\t\t\t\t\t\t\t\t\t\t\tcount: optionalParticipants.length,\n\t\t\t\t\t\t\t\t\t\t\tdefaultValue_one: '{{count}} Optional',\n\t\t\t\t\t\t\t\t\t\t\tdefaultValue_other: '{{count}} Optionals'\n\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t\t{optionalParticipants.slice(0, maxOptParticipantsToShow).map((p, index: number) => (\n\t\t\t\t\t\t\t\t\t<Row\n\t\t\t\t\t\t\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\t\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\t\t\t\t\tpadding={{ top: 'small' }}\n\t\t\t\t\t\t\t\t\t\tkey={`${p.d ?? p.a}-${index}-2`}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip placement=\"top\" label={p.d ?? p.a} maxWidth=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Chip label={p.d ?? p.a} />\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t{maxOptParticipantsToShow < optionalParticipants.length && (\n\t\t\t\t\t\t\t\t\t<Row mainAlignment=\"flex-start\" width=\"100%\" padding={{ top: 'small' }}>\n\t\t\t\t\t\t\t\t\t\t<LinkText\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"medium\"\n\t\t\t\t\t\t\t\t\t\t\t// eslint-disable-next-line max-len\n\t\t\t\t\t\t\t\t\t\t\tonClick={(): void => setMaxOptParticipantsToShow(optionalParticipants.length)}\n\t\t\t\t\t\t\t\t\t\t\toverflow=\"break-word\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{t('message.more', 'More...')}\n\t\t\t\t\t\t\t\t\t\t</LinkText>\n\t\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t)}\n\t\t\t\t</Row>\n\t\t\t\t{invite && messageHasABody && (\n\t\t\t\t\t<Row\n\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\t\t\tpadding={{ bottom: 'large' }}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Row width=\"100%\" padding={{ vertical: 'medium' }}>\n\t\t\t\t\t\t\t<Divider />\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t<Row padding={{ right: 'small' }}>\n\t\t\t\t\t\t\t<Icon size=\"large\" icon=\"MessageSquareOutline\" />\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\">\n\t\t\t\t\t\t\t<BodyMessageRenderer fullInvite={invite} inviteId={inviteId} parts={invite?.parts} />\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t</Row>\n\t\t\t\t)}\n\t\t\t</Container>\n\t\t</InviteContainer>\n\t);\n};\n\nconst InviteResponseComp: FC<InviteResponseArguments> = (props) => (\n\t<StoreProvider>\n\t\t<InviteResponse {...props} />\n\t</StoreProvider>\n);\nexport default InviteResponseComp;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\n\nimport { SoapRequests } from '../types/soap/soap-actions';\n\nexport const batchRequest = async (body: SoapRequests): Promise<any> => {\n\tconst response = soapFetch('Batch', body);\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\treturn response?.Fault ? { ...response.Fault, error: true } : response;\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\nimport { isNil, omitBy } from 'lodash';\n\nexport type ItemActionRejectedType = { error: boolean; m?: never; Fault: any };\nexport type ItemActionFulfilledType = { m: any; Fault?: never; error?: never };\nexport type ItemActionReturnType = ItemActionFulfilledType | ItemActionRejectedType;\n\nexport const itemActionRequest = async ({\n\tid,\n\top,\n\ttagName,\n\tparent\n}: {\n\tid?: string;\n\top: string;\n\ttagName?: string;\n\tparent?: string;\n}): Promise<ItemActionReturnType> => {\n\tconst response: ItemActionReturnType = await soapFetch('ItemAction', {\n\t\t_jsns: 'urn:zimbraMail',\n\t\taction: omitBy(\n\t\t\t{\n\t\t\t\top,\n\t\t\t\tid,\n\t\t\t\ttn: tagName,\n\t\t\t\tl: parent\n\t\t\t},\n\t\t\tisNil\n\t\t)\n\t});\n\treturn response?.Fault ? { ...response.Fault, error: true } : response;\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\n\nimport { FolderAction } from '../types/soap/soap-actions';\n\nexport const folderActionRequest = async (action: FolderAction): Promise<any> =>\n\tsoapFetch('FolderAction', {\n\t\taction,\n\t\t_jsns: 'urn:zimbraMail'\n\t});\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { isArray, map } from 'lodash';\n\nimport { batchRequest } from '../../soap/batch-request';\nimport { folderActionRequest } from '../../soap/folder-action-request';\nimport { FolderAction, FolderActionRequest } from '../../types/soap/soap-actions';\n\nexport const folderAction = async (actions: Array<FolderAction> | FolderAction): Promise<any> => {\n\tif (isArray(actions)) {\n\t\tconst body: FolderActionRequest = {\n\t\t\t_jsns: 'urn:zimbra',\n\t\t\tonerror: 'continue',\n\t\t\tFolderActionRequest: map(actions, (action, idx) => ({\n\t\t\t\taction,\n\t\t\t\trequestId: idx,\n\t\t\t\t_jsns: 'urn:zimbraMail'\n\t\t\t}))\n\t\t};\n\t\treturn batchRequest(body);\n\t}\n\treturn folderActionRequest(actions);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\n\nimport {\n\tItemActionRejectedType,\n\titemActionRequest,\n\tItemActionReturnType\n} from '../../soap/item-action-request';\nimport { AppointmentsSlice } from '../../types/store/store';\n\nexport type DeleteAppointmentArguments = {\n\tid: string;\n\tpreviousState?: AppointmentsSlice['appointments'];\n};\n\nexport type DeleteAppointmentReturnType = {\n\tresponse: ItemActionReturnType;\n\tid: string;\n};\n\nexport const deleteAppointmentPermanent = createAsyncThunk<\n\tDeleteAppointmentReturnType,\n\tDeleteAppointmentArguments,\n\t{\n\t\trejectValue: ItemActionRejectedType;\n\t}\n>('appointments/deleteAppointmentPermanent', async ({ id }, { rejectWithValue }) => {\n\tconst response = await itemActionRequest({ id, op: 'delete' });\n\tif (response?.error) {\n\t\treturn rejectWithValue(response);\n\t}\n\treturn { response, id };\n});\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\n\nimport { DateType } from '../types/event';\n\nexport type DismissItem = Array<{ id: string; dismissedAt: DateType }>;\n\nexport type DismissCalendarItemAlarmRejectedType = { error: boolean; m?: never; Fault: any };\nexport type DismissCalendarItemAlarmFulfilledType = { m: any; Fault?: never; error?: never };\nexport type DismissCalendarItemAlarmReturnType =\n\t| DismissCalendarItemAlarmFulfilledType\n\t| DismissCalendarItemAlarmRejectedType;\n\nexport const dismissCalendarItemAlarmRequest = async ({\n\titems\n}: {\n\titems: DismissItem;\n}): Promise<DismissCalendarItemAlarmReturnType> => {\n\tconst response: DismissCalendarItemAlarmReturnType = await soapFetch('DismissCalendarItemAlarm', {\n\t\t_jsns: 'urn:zimbraMail',\n\t\tappt: items\n\t});\n\treturn response?.Fault ? { ...response.Fault, error: true } : response;\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\n\nimport {\n\tDismissCalendarItemAlarmRejectedType,\n\tdismissCalendarItemAlarmRequest,\n\tDismissCalendarItemAlarmReturnType,\n\tDismissItem\n} from '../../soap/dismiss-calendar-item-alarm-request';\nimport { AppointmentsSlice } from '../../types/store/store';\n\nexport type DismissApptReminderArguments = {\n\tdismissItems: DismissItem;\n\tpreviousState?: AppointmentsSlice['appointments'];\n};\n\nexport const dismissApptReminder = createAsyncThunk<\n\tDismissCalendarItemAlarmReturnType,\n\tDismissApptReminderArguments,\n\t{\n\t\trejectValue: DismissCalendarItemAlarmRejectedType;\n\t}\n>(\n\t'calendar/dismissAppointmentReminder',\n\tasync ({ dismissItems }: DismissApptReminderArguments, { rejectWithValue }) => {\n\t\tconst response = await dismissCalendarItemAlarmRequest({ items: dismissItems });\n\t\tif (response?.error) {\n\t\t\treturn rejectWithValue(response);\n\t\t}\n\t\treturn response;\n\t}\n);\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\nimport { isNil, omitBy } from 'lodash';\n\nexport type GetMessageRejectedType = { error: boolean; m?: never; Fault: any };\nexport type GetMessageFulfilledType = { m: any; Fault?: never; error?: never };\nexport type GetMessageReturnType = GetMessageFulfilledType | GetMessageRejectedType;\n\nexport const getMessageRequest = async ({\n\tinviteId,\n\tridZ\n}: {\n\tinviteId: string;\n\tridZ?: string;\n}): Promise<GetMessageReturnType> => {\n\tconst response: GetMessageReturnType = await soapFetch('GetMsg', {\n\t\t_jsns: 'urn:zimbraMail',\n\t\tm: omitBy(\n\t\t\t{\n\t\t\t\thtml: 1,\n\t\t\t\tneedExp: 1,\n\t\t\t\tid: inviteId,\n\t\t\t\tridZ,\n\t\t\t\theader: [\n\t\t\t\t\t{\n\t\t\t\t\t\tn: 'List-ID'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tn: 'X-Zimbra-DL'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tn: 'IN-REPLY-TO'\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tmax: 250000\n\t\t\t},\n\t\t\tisNil\n\t\t)\n\t});\n\treturn response?.Fault ? { ...response.Fault, error: true } : response;\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\n\nimport {\n\tGetMessageRejectedType,\n\tgetMessageRequest,\n\tGetMessageReturnType\n} from '../../soap/get-message-request';\n\nexport type GetInviteArguments = { inviteId: string; ridZ?: string };\n\nexport const getInvite = createAsyncThunk<\n\tGetMessageReturnType,\n\tGetInviteArguments,\n\t{ rejectValue: GetMessageRejectedType }\n>('invites/get invite', async ({ inviteId, ridZ }, { rejectWithValue }) => {\n\tconst response = await getMessageRequest({ inviteId, ridZ });\n\tif (response?.error) {\n\t\treturn rejectWithValue(response);\n\t}\n\treturn response;\n});\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\nimport { TFunction } from 'i18next';\nimport { compact, lowerCase } from 'lodash';\n\nimport {\n\tCancelAppointmentRejectedType,\n\tcancelAppointmentRequest,\n\tCancelAppointmentReturnType\n} from '../../soap/cancel-appointment-request';\nimport { Invite } from '../../types/store/invite';\nimport { AppointmentsSlice } from '../../types/store/store';\nimport { formatAppointmentRange, parseDateFromICS } from '../../utils/dates';\nimport { InstanceExceptionId } from '../../utils/event';\nimport type { RootState } from '../redux';\n\ntype MessagePart = { ct: string; mp: { ct: string; content: string }[] };\n\nexport const buildMessagePart = ({\n\tt,\n\tfullInvite,\n\tnewMessage,\n\tdeleteSingleInstance = true,\n\tinst\n}: {\n\tt: TFunction;\n\tfullInvite: Invite;\n\tdeleteSingleInstance?: boolean;\n\tnewMessage?: string;\n\tinst?: InstanceExceptionId;\n}): MessagePart => {\n\tconst meetingCanceled =\n\t\tnewMessage ?? `${t('message.meeting_canceled', 'The following meeting has been cancelled')}:`;\n\tconst allDayLabel = t('label.all_day', 'All day');\n\tconst originalInviteTitle = t('message.original_invite', `-----Original Invite-----`);\n\n\tconst originalInviteContentPlain = fullInvite?.textDescription?.[0]?._content ?? '';\n\n\tconst originalInviteContentHtml = fullInvite?.htmlDescription?.[0]?._content?.slice?.(6) ?? '';\n\tconst startAsString = inst?.d ?? fullInvite.start.d;\n\tconst endAsString = inst?.d ?? fullInvite.end.d;\n\n\tconst parsedStart = parseDateFromICS(startAsString, inst?.tz ?? fullInvite?.end?.tz).valueOf();\n\tconst parsedEnd = parseDateFromICS(endAsString, inst?.tz ?? fullInvite?.end?.tz).valueOf();\n\n\tconst dur = (fullInvite?.end?.u ?? parsedEnd) - (fullInvite?.start?.u ?? parsedStart);\n\n\tconst startToFormat = startAsString ? parsedStart : fullInvite.start.u ?? 0;\n\tconst endToFormat = endAsString && inst?.d ? parsedEnd + dur : parsedEnd ?? fullInvite.end.u ?? 0;\n\n\tconst date = formatAppointmentRange({\n\t\tstart: startToFormat,\n\t\tend: endToFormat,\n\t\tallDay: fullInvite.allDay ?? false,\n\t\tallDayLabel,\n\t\ttimezone: inst?.tz ?? fullInvite?.tz\n\t});\n\tconst instance =\n\t\t!fullInvite.recurrenceRule || deleteSingleInstance\n\t\t\t? t('label.instance', 'instance')\n\t\t\t: t('label.series', 'series');\n\n\tconst instanceData = `\"${fullInvite?.name ?? ''}\" ${lowerCase(instance)}, ${date}`;\n\n\tconst originalContentPlainSection = originalInviteContentPlain\n\t\t? `\\n\\n${originalInviteTitle}\\n\\n${originalInviteContentPlain}`\n\t\t: '';\n\n\tconst originalContentHtmlSection = originalInviteContentHtml\n\t\t? `<br/><br/>${originalInviteTitle}<br/><br/>${originalInviteContentHtml}`\n\t\t: '';\n\n\tconst plainMessagePart = {\n\t\tct: 'text/plain',\n\t\tcontent: `${meetingCanceled}\\n\\n${instanceData}${originalContentPlainSection}`\n\t};\n\n\tconst htmlMessagePart = fullInvite.htmlDescription\n\t\t? {\n\t\t\t\tct: 'text/html',\n\t\t\t\tcontent: `<html><h3>${meetingCanceled}</h3>${instanceData}${originalContentHtmlSection}</html>`\n\t\t\t}\n\t\t: undefined;\n\n\treturn {\n\t\tct: 'multipart/alternative',\n\t\tmp: compact([plainMessagePart, htmlMessagePart])\n\t};\n};\n\n// eslint-disable-next-line @typescript-eslint/explicit-function-return-type\nfunction getParticipants(participants: any) {\n\treturn participants.map((p: { email: any; name: any }) => ({\n\t\ta: p.email,\n\t\tp: p.name,\n\t\tt: 't'\n\t}));\n}\n\nfunction createMessageForDelete({\n\tinvite,\n\tt,\n\tnewMessage,\n\tdeleteSingleInstance,\n\tinst\n}: {\n\tt: TFunction;\n\tinvite: Invite;\n\tdeleteSingleInstance: boolean;\n\tnewMessage: string;\n\tinst: InstanceExceptionId;\n}): { e: any; su: string; mp: MessagePart } {\n\tconst organizer = [\n\t\t{\n\t\t\ta: invite?.organizer?.a,\n\t\t\tp: invite?.organizer?.d,\n\t\t\tt: 'f'\n\t\t}\n\t];\n\tconst participants = invite.neverSent\n\t\t? organizer\n\t\t: getParticipants(Object.entries(invite?.participants).flatMap(([_, value]) => value)).concat(\n\t\t\t\torganizer\n\t\t\t) ?? organizer;\n\treturn {\n\t\te: participants,\n\t\tsu: `${t('label.cancelled', 'Cancelled')}: ${invite?.name ?? ''}`,\n\t\tmp: buildMessagePart({ t, fullInvite: invite, newMessage, deleteSingleInstance, inst })\n\t};\n}\n\nexport type MoveAppointmentToTrashArguments = {\n\tinviteId: string;\n\tt: TFunction;\n\tisOrganizer: boolean;\n\tdeleteSingleInstance: boolean;\n\tinst: InstanceExceptionId;\n\ts: number;\n\tinv?: Invite;\n\tnewMessage: string;\n\tridZ: string;\n\trecur: boolean;\n\tisRecurrent: boolean;\n\tid: string;\n\tpreviousState?: AppointmentsSlice['appointments'];\n};\n\nexport type MoveAppointmentToTrashReturnType = {\n\tresponse: CancelAppointmentReturnType;\n\tinviteId: string;\n};\n\nexport const moveAppointmentToTrash = createAsyncThunk<\n\tMoveAppointmentToTrashReturnType,\n\tMoveAppointmentToTrashArguments,\n\t{\n\t\tstate: RootState;\n\t\trejectValue: CancelAppointmentRejectedType;\n\t}\n>(\n\t'appointments/moveAppointmentToTrash',\n\tasync (\n\t\t{ inviteId, t, isOrganizer = true, deleteSingleInstance = false, inst, s, inv, newMessage },\n\t\t{ getState, rejectWithValue }\n\t) => {\n\t\tconst state = getState();\n\t\tconst invite = inv ?? state.invites.invites[inviteId];\n\t\tconst m = createMessageForDelete({ invite, t, newMessage, deleteSingleInstance, inst });\n\t\tconst response = await cancelAppointmentRequest({\n\t\t\tdeleteSingleInstance,\n\t\t\tid: inviteId,\n\t\t\tinst,\n\t\t\ts,\n\t\t\tm,\n\t\t\tisOrganizer\n\t\t});\n\t\tif (response?.error) {\n\t\t\treturn rejectWithValue(response);\n\t\t}\n\t\treturn { response, inviteId };\n\t}\n);\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\n\ntype Props = {\n\tdeleteSingleInstance: boolean;\n\tinst?: any;\n\tid: string;\n\tisOrganizer: boolean;\n\tm: any;\n\ts: number;\n};\n\nexport type CancelAppointmentRejectedType = { error: boolean; m?: never; Fault: any };\nexport type CancelAppointmentFulfilledType = { m: any; Fault?: never; error?: never };\nexport type CancelAppointmentReturnType =\n\t| CancelAppointmentFulfilledType\n\t| CancelAppointmentRejectedType;\n\nexport const cancelAppointmentRequest = async ({\n\tdeleteSingleInstance,\n\tinst,\n\tid,\n\tisOrganizer,\n\tm,\n\ts\n}: Props): Promise<CancelAppointmentReturnType> => {\n\tconst body = deleteSingleInstance\n\t\t? {\n\t\t\t\t_jsns: 'urn:zimbraMail',\n\t\t\t\tinst,\n\t\t\t\tid,\n\t\t\t\tcomp: '0',\n\t\t\t\ts,\n\t\t\t\tm: isOrganizer ? m : { ...m, e: [] }\n\t\t\t}\n\t\t: {\n\t\t\t\t_jsns: 'urn:zimbraMail',\n\t\t\t\tid,\n\t\t\t\tcomp: '0',\n\t\t\t\tm: isOrganizer ? m : { ...m, e: [] }\n\t\t\t};\n\tconst response: CancelAppointmentReturnType = await soapFetch('CancelAppointment', body);\n\treturn response?.Fault ? { ...response.Fault, error: true } : response;\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\n\nimport {\n\titemActionRequest,\n\tItemActionRejectedType,\n\tItemActionReturnType\n} from '../../soap/item-action-request';\n\nexport type MoveAppointmentArguments = {\n\tid: string;\n\tl: string;\n};\nexport type MoveAppointmentReturnType = ItemActionReturnType;\n\nexport const moveAppointmentRequest = createAsyncThunk<\n\tMoveAppointmentReturnType,\n\tMoveAppointmentArguments,\n\t{\n\t\trejectValue: ItemActionRejectedType;\n\t}\n>('appointments/moveAppointment', async ({ id, l }, { rejectWithValue }) => {\n\tconst response = await itemActionRequest({ id, op: 'move', parent: l });\n\tif (response?.error) {\n\t\treturn rejectWithValue(response);\n\t}\n\treturn response;\n});\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\nimport moment from 'moment';\n\nimport {\n\tfindAttachments,\n\tretrieveAttachmentsType\n} from '../../normalizations/normalizations-utils';\nimport { normalizeSoapMessageFromEditor } from '../../normalizations/normalize-soap-message-from-editor';\nimport { Editor } from '../../types/editor';\nimport { convertDateToLocal } from '../../utils/dates';\nimport { getInstanceExceptionId } from '../../utils/event';\n\nexport type ModifyAppointmentReturnType = { res: { calItemId: string; echo: any }; editor: Editor };\nexport type ModifyAppointmentArguments = { draft: boolean; editor: Editor };\n\nexport const modifyAppointment = createAsyncThunk<\n\tModifyAppointmentReturnType,\n\tModifyAppointmentArguments,\n\t{ rejectValue: any }\n>(\n\t'appointment/modify appointment',\n\tasync ({ draft, editor }, { rejectWithValue }: any): Promise<any> => {\n\t\tif (editor) {\n\t\t\tif (editor.isSeries && editor.isInstance && !editor.isException) {\n\t\t\t\tconst exceptId =\n\t\t\t\t\teditor?.exceptId ??\n\t\t\t\t\tgetInstanceExceptionId({\n\t\t\t\t\t\tstart: convertDateToLocal(new Date(editor.originalStart), editor.timezone),\n\t\t\t\t\t\tallDay: editor.allDay,\n\t\t\t\t\t\ttz: editor.timezone\n\t\t\t\t\t});\n\t\t\t\tconst body = normalizeSoapMessageFromEditor({ ...editor, draft, exceptId });\n\t\t\t\tconst res: { calItemId: string; invId: string } = await soapFetch(\n\t\t\t\t\t'CreateAppointmentException',\n\t\t\t\t\tbody\n\t\t\t\t);\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tconst response = res?.Fault ? { ...res.Fault, error: true } : res;\n\t\t\t\tif (response?.error) {\n\t\t\t\t\treturn rejectWithValue(response);\n\t\t\t\t}\n\t\t\t\tconst updatedEditor = {\n\t\t\t\t\t...editor,\n\t\t\t\t\tisSeries: false,\n\t\t\t\t\tisInstance: true,\n\t\t\t\t\tisException: true,\n\t\t\t\t\tisNew: false,\n\t\t\t\t\tinviteId: response.invId\n\t\t\t\t};\n\t\t\t\treturn { response, editor: updatedEditor };\n\t\t\t}\n\t\t\tconst body = normalizeSoapMessageFromEditor({ ...editor, draft });\n\t\t\tconst res: { calItemId: string; echo: any } = await soapFetch('ModifyAppointment', body);\n\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t// @ts-ignore\n\t\t\tconst response = res?.Fault ? { ...res.Fault, error: true } : res;\n\t\t\tif (response?.error) {\n\t\t\t\treturn rejectWithValue(response);\n\t\t\t}\n\t\t\tconst attach = {\n\t\t\t\tmp: retrieveAttachmentsType(\n\t\t\t\t\tres?.echo?.[0]?.m?.[0]?.mp?.[0] ?? [],\n\t\t\t\t\t'attachment',\n\t\t\t\t\tres?.echo?.[0]?.m?.[0]?.id\n\t\t\t\t)\n\t\t\t};\n\t\t\tconst attachmentFiles = findAttachments(res?.echo?.[0]?.m?.[0]?.mp ?? [], []);\n\t\t\tconst updatedEditor = {\n\t\t\t\t...editor,\n\t\t\t\tisSeries: !!editor.recur,\n\t\t\t\tisInstance: !editor.recur,\n\t\t\t\tisNew: false,\n\t\t\t\tattach,\n\t\t\t\tattachmentFiles\n\t\t\t};\n\t\t\treturn { response: res, editor: updatedEditor };\n\t\t}\n\t\treturn undefined;\n\t}\n);\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\nimport moment from 'moment';\n\nimport { HTML_OPENING_TAG } from '../constants';\nimport { generateParticipantInformation } from '../normalizations/normalize-soap-message-from-editor';\nimport { Editor } from '../types/editor';\n\nexport type CounterAppointmentRejectedType = {\n\terror: boolean;\n\tFault: any;\n\tjsns?: never;\n};\nexport type CounterAppointmentFulfilledType = {\n\tjsns?: string;\n\tFault?: never;\n\terror?: never;\n};\nexport type CounterAppointmentReturnType =\n\t| CounterAppointmentFulfilledType\n\t| CounterAppointmentRejectedType;\n\nexport const counterAppointmentRequest = async ({\n\tappt\n}: {\n\tappt: Editor;\n}): Promise<CounterAppointmentReturnType> => {\n\tconst res: CounterAppointmentReturnType = await soapFetch('CounterAppointment', {\n\t\t_jsns: 'urn:zimbraMail',\n\t\tcomp: '0',\n\t\tid: appt.inviteId?.includes('-') ? appt.inviteId : undefined,\n\t\tm: {\n\t\t\te: generateParticipantInformation(appt),\n\t\t\tinv: {\n\t\t\t\tcomp: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: appt.title,\n\t\t\t\t\t\tuid: appt.uid,\n\t\t\t\t\t\tseq: 1,\n\t\t\t\t\t\tallDay: appt.allDay ? '1' : '0',\n\t\t\t\t\t\te: {\n\t\t\t\t\t\t\ttz: appt?.timezone,\n\t\t\t\t\t\t\td: moment(moment(appt.end)).format('YYYYMMDDTHHmm00')\n\t\t\t\t\t\t},\n\t\t\t\t\t\texceptId: appt.exceptId,\n\t\t\t\t\t\tor: { a: appt.organizer?.address },\n\t\t\t\t\t\ts: {\n\t\t\t\t\t\t\ttz: appt?.timezone,\n\t\t\t\t\t\t\td: moment(moment(appt.start)).format('YYYYMMDDTHHmm00')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\tmp: {\n\t\t\t\tct: 'multipart/alternative',\n\t\t\t\tmp: [\n\t\t\t\t\t{\n\t\t\t\t\t\tct: 'text/html',\n\t\t\t\t\t\tcontent: `${HTML_OPENING_TAG}\n\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t<tr height=\"1.5rem\"><td>New Time Proposed</td></tr>\n\t\t\t\t\t\t\t\t<tr height=\"1.5rem\"><td>Subject: ${appt.title}</td></tr>\n\t\t\t\t\t\t\t\t<tr height=\"1.5rem\" style=\"color:#2b73d2;font-weight:bold\">\n\t\t\t\t\t\t\t\t\t<td>Time: ${moment(appt.start).format('dddd, D MMMM, YYYY, HH:mm:ss')} - ${moment(appt.end).format(\n\t\t\t\t\t\t\t\t\t\t'HH:mm:ss'\n\t\t\t\t\t\t\t\t\t)} GMT ${moment(appt.start)\n\t\t\t\t\t\t\t\t\t\t.tz(moment.tz.guess())\n\t\t\t\t\t\t\t\t\t\t.format('Z')} ${moment.tz.guess()} [MODIFIED]</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\\n<div>*~*~*~*~*~*~*~*~*~*</div><br>\n\t\t\t\t\t\t\t${appt?.richText}\n\t\t\t\t\t\t`\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: `New Time Proposed\\n\\nSubject: ${appt.title} \\n\\nTime: ${moment(\n\t\t\t\t\t\t\tappt.start\n\t\t\t\t\t\t).format('dddd, D MMMM, YYYY, HH:mm:ss')} - ${moment(appt.end).format('HH:mm:ss')} GMT\n\t\t\t\t\t\t\t${moment(appt.start)\n\t\t\t\t\t\t\t\t.tz(moment.tz.guess())\n\t\t\t\t\t\t\t\t.format('Z')} ${moment.tz.guess()} [MODIFIED]\\n\\n*~*~*~*~*~*~*~*~*~*\\n\\n${\n\t\t\t\t\t\t\t\tappt.plainText\n\t\t\t\t\t\t\t}`,\n\t\t\t\t\t\tct: 'text/plain'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\tsu: `New Time Proposed: ${appt.title}`\n\t\t}\n\t});\n\treturn res?.Fault ? { ...res.Fault, error: true } : res;\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\n\nimport {\n\tCounterAppointmentRejectedType,\n\tcounterAppointmentRequest\n} from '../../soap/counter-appointment-request';\nimport type { RootState } from '../redux';\n\n// it is impossible to write down the proper type due to other missing types around the functions\nexport const proposeNewTime = createAsyncThunk<\n\tany,\n\t{ id: string },\n\t{\n\t\tstate: RootState;\n\t\trejectValue: CounterAppointmentRejectedType;\n\t}\n>('calendars/proposeNewTime', async ({ id }, { getState, rejectWithValue }) => {\n\tconst editor = getState()?.editor?.editors?.[id];\n\tconst res = await counterAppointmentRequest({ appt: editor });\n\n\tif (res?.error) {\n\t\treturn rejectWithValue(res);\n\t}\n\treturn { response: res, editor };\n});\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\n\nimport { Cn, SearchRequestProps } from '../types/soap/soap-actions';\n\nexport type SearchRejectedType = {\n\terror: boolean;\n\tFault: any;\n\tappt?: never;\n\tcn?: never;\n\tmore?: never;\n\toffset?: never;\n\tsortBy?: never;\n};\nexport type SearchFulfilledType = {\n\tcn?: Cn;\n\tappt?: any;\n\tFault?: never;\n\terror?: never;\n\tmore: boolean;\n\toffset: number;\n\tsortBy: string;\n};\nexport type SearchReturnType = SearchFulfilledType | SearchRejectedType;\n\nexport const searchRequest = async ({\n\tstart,\n\tend,\n\toffset,\n\tsortBy,\n\tcontent\n}: SearchRequestProps): Promise<SearchReturnType> => {\n\tconst response: SearchReturnType = await soapFetch('Search', {\n\t\t_jsns: 'urn:zimbraMail',\n\t\tlimit: '500',\n\t\tcalExpandInstEnd: end,\n\t\tcalExpandInstStart: start,\n\t\toffset: offset ?? 0,\n\t\tsortBy: sortBy ?? 'none',\n\t\ttypes: 'appointment',\n\t\tquery: {\n\t\t\t_content: content\n\t\t}\n\t});\n\treturn response?.Fault ? { ...response.Fault, error: true } : response;\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\nimport { isNil, omitBy } from 'lodash';\n\nimport { SearchRejectedType, searchRequest, SearchReturnType } from '../../soap/search-request';\nimport { SearchRequestProps } from '../../types/soap/soap-actions';\nimport { AppointmentsSlice } from '../../types/store/store';\nimport type { RootState } from '../redux';\n\nexport type SearchAppointmentsArguments = {\n\tspanStart: number;\n\tspanEnd: number;\n\tquery?: string;\n\toffset?: number;\n\tsortBy?: string;\n\tpreviousState?: AppointmentsSlice['appointments'];\n};\n\nexport const searchAppointments = createAsyncThunk<\n\tSearchReturnType,\n\tSearchAppointmentsArguments,\n\t{\n\t\tstate: RootState;\n\t\trejectValue: SearchRejectedType;\n\t}\n>(\n\t'calendars/search',\n\tasync ({ spanStart, spanEnd, query, offset, sortBy }, { rejectWithValue }) => {\n\t\tconst arg = omitBy(\n\t\t\t{ start: spanStart, end: spanEnd, content: query, sortBy, offset },\n\t\t\tisNil\n\t\t) as SearchRequestProps;\n\t\tconst response = await searchRequest(arg);\n\t\tif (response?.error) {\n\t\t\treturn rejectWithValue(response);\n\t\t}\n\t\treturn response;\n\t}\n);\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\n\nimport { InstanceExceptionId } from '../utils/event';\n\nexport type SendInviteReplyRejectedType = {\n\terror: boolean;\n\tFault?: {\n\t\tCode: {\n\t\t\tValue: string;\n\t\t};\n\t\tReason: {\n\t\t\tText: string;\n\t\t};\n\t\tDetail: {\n\t\t\tError: {\n\t\t\t\tCode: string;\n\t\t\t\tTrace: string;\n\t\t\t\t_jsns: string;\n\t\t\t};\n\t\t};\n\t};\n\tapptId?: never;\n\tcalItemId?: never;\n\tinvId?: never;\n};\nexport type SendInviteReplyFulfilledType = {\n\tFault?: never;\n\terror?: never;\n\tapptId: string;\n\tcalItemId: string;\n\tinvId: string;\n};\nexport type SendInviteReplyReturnType = SendInviteReplyFulfilledType | SendInviteReplyRejectedType;\n\nexport const sendInviteReplyRequest = async ({\n\tid,\n\taction,\n\tupdateOrganizer,\n\texceptId\n}: {\n\tid: string;\n\taction: string;\n\tupdateOrganizer: boolean;\n\texceptId: InstanceExceptionId | undefined;\n}): Promise<SendInviteReplyReturnType> => {\n\tconst response: SendInviteReplyReturnType = await soapFetch('SendInviteReply', {\n\t\t_jsns: 'urn:zimbraMail',\n\t\tid,\n\t\tcompNum: 0,\n\t\texceptId,\n\t\tverb: action,\n\t\trt: 'r',\n\t\tupdateOrganizer\n\t});\n\treturn response?.Fault ? { ...response.Fault, error: true } : response;\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\n\nimport {\n\tSendInviteReplyRejectedType,\n\tsendInviteReplyRequest,\n\tSendInviteReplyReturnType\n} from '../../soap/send-invite-reply-request';\nimport { InstanceExceptionId } from '../../utils/event';\n\nexport type SendInviteArguments = {\n\tinviteId: string;\n\taction: string;\n\texceptId?: InstanceExceptionId | undefined;\n\tupdateOrganizer: boolean;\n\tfromMail?: boolean;\n};\n\nexport const sendInviteResponse = createAsyncThunk<\n\tSendInviteReplyReturnType,\n\tSendInviteArguments,\n\t{ rejectValue: SendInviteReplyRejectedType }\n>(\n\t'invites/sendInviteResponse',\n\tasync ({ inviteId, action, updateOrganizer, exceptId }, { rejectWithValue }) => {\n\t\tconst response = await sendInviteReplyRequest({\n\t\t\tid: inviteId,\n\t\t\taction,\n\t\t\tupdateOrganizer,\n\t\t\texceptId\n\t\t});\n\t\tif (response?.error) {\n\t\t\treturn rejectWithValue(response);\n\t\t}\n\t\treturn response;\n\t}\n);\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\n\nexport type SnoozeCalendarItemAlarmRejectedType = { error: boolean; Fault: any };\nexport type SnoozeCalendarItemAlarmFulfilledType = { Fault?: never; error?: never };\nexport type SnoozeCalendarItemAlarmReturnType =\n\t| SnoozeCalendarItemAlarmFulfilledType\n\t| SnoozeCalendarItemAlarmRejectedType;\n\nexport const snoozeCalendarItemAlarmRequest = async ({\n\tid,\n\tuntil\n}: {\n\tid: string;\n\tuntil: number;\n}): Promise<SnoozeCalendarItemAlarmReturnType> => {\n\tconst response: SnoozeCalendarItemAlarmReturnType = await soapFetch('SnoozeCalendarItemAlarm', {\n\t\t_jsns: 'urn:zimbraMail',\n\t\tappt: [{ id, until }]\n\t});\n\treturn response?.Fault ? { ...response.Fault, error: true } : response;\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\n\nimport {\n\tSnoozeCalendarItemAlarmRejectedType,\n\tsnoozeCalendarItemAlarmRequest,\n\tSnoozeCalendarItemAlarmReturnType\n} from '../../soap/snooze-calendar-item-alarm-request';\nimport { AppointmentsSlice } from '../../types/store/store';\n\nexport type SnoozeApptReminderArguments = {\n\tid: string;\n\tuntil: number;\n\tpreviousState?: AppointmentsSlice['appointments'];\n};\nexport const snoozeApptReminder = createAsyncThunk<\n\tSnoozeCalendarItemAlarmReturnType,\n\tSnoozeApptReminderArguments,\n\t{\n\t\trejectValue: SnoozeCalendarItemAlarmRejectedType;\n\t}\n>('reminder/snoozeApptReminder', async ({ id, until }, { rejectWithValue }) => {\n\tconst response = await snoozeCalendarItemAlarmRequest({ id, until });\n\tif (response?.error) {\n\t\treturn rejectWithValue(response);\n\t}\n\treturn response;\n});\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { PayloadAction, SerializedError } from '@reduxjs/toolkit';\nimport { filter } from 'lodash';\n\nimport {\n\tAppointmentsSlice,\n\tFulfilledResponse,\n\tInvitesSlice,\n\tPendingResponse,\n\tRejectedResponse\n} from '../../types/store/store';\nimport {\n\tMoveAppointmentToTrashArguments,\n\tMoveAppointmentToTrashReturnType\n} from '../actions/move-appointment-to-trash';\n\ntype ModifyAppointmentRejectedType = { error: boolean; m?: never; Fault: any };\n\nexport const moveAppointmentToTrashPending = (\n\tstate: AppointmentsSlice,\n\t{ meta }: PayloadAction<undefined, string, PendingResponse<MoveAppointmentToTrashArguments>>\n): void => {\n\tconst { ridZ, deleteSingleInstance, id } = meta.arg;\n\n\tstate.status = 'pending';\n\tif (state.appointments) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\tmeta.arg.previousState = state.appointments;\n\t\tdeleteSingleInstance\n\t\t\t? (state.appointments[id].inst = filter(\n\t\t\t\t\tstate.appointments[id].inst,\n\t\t\t\t\t(inst) => inst.ridZ !== ridZ\n\t\t\t\t))\n\t\t\t: (state.appointments[id].l = '3');\n\t}\n};\n\nexport const moveAppointmentToTrashFulfilled = (\n\tstate: InvitesSlice | AppointmentsSlice,\n\taction: PayloadAction<\n\t\tMoveAppointmentToTrashReturnType,\n\t\tstring,\n\t\tFulfilledResponse<MoveAppointmentToTrashArguments>\n\t>\n): void => {\n\tstate.status = 'fulFilled';\n\tconst { inviteId, ridZ, deleteSingleInstance, isRecurrent, id } = action.meta.arg;\n\tif ((state as InvitesSlice).invites) {\n\t\tif (!deleteSingleInstance) delete (state as InvitesSlice)?.invites?.[inviteId];\n\t}\n\n\tif ((state as AppointmentsSlice).appointments && isRecurrent) {\n\t\t(state as AppointmentsSlice).appointments[id].inst = filter(\n\t\t\t(state as AppointmentsSlice).appointments[id].inst,\n\t\t\t(inst) => inst.ridZ !== ridZ\n\t\t);\n\t}\n};\n\nexport const moveAppointmentToTrashRejected = (\n\tstate: AppointmentsSlice,\n\t{\n\t\tmeta\n\t}: PayloadAction<\n\t\tModifyAppointmentRejectedType | undefined,\n\t\tstring,\n\t\tRejectedResponse<MoveAppointmentToTrashArguments>,\n\t\tSerializedError\n\t>\n): void => {\n\tif (meta?.arg?.previousState) {\n\t\tstate.appointments = meta.arg.previousState;\n\t\tstate.status = 'error';\n\t}\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\n\nimport { AppDispatch, RootState } from './index';\n\nexport const useAppDispatch: () => AppDispatch = useDispatch;\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC } from 'react';\n\nimport { combineReducers, configureStore } from '@reduxjs/toolkit';\nimport { Provider } from 'react-redux';\n\nimport { CALENDAR_APP_ID } from '../../constants';\nimport appointmentsSliceReducer from '../slices/appointments-slice';\nimport editorSliceReducer from '../slices/editor-slice';\nimport invitesSliceReducer from '../slices/invites-slice';\n\nexport const reducers = {\n\tappointments: appointmentsSliceReducer,\n\teditor: editorSliceReducer,\n\tinvites: invitesSliceReducer\n};\n\nconst store = configureStore({\n\tdevTools: {\n\t\tname: CALENDAR_APP_ID\n\t},\n\treducer: combineReducers(reducers)\n});\n\nexport const StoreProvider: FC = ({ children }) => <Provider store={store}>{children}</Provider>;\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppDispatch = typeof store.dispatch;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createSelector } from '@reduxjs/toolkit';\nimport { find, values, reduce, filter } from 'lodash';\n\nimport { Folder, Folders } from '../../carbonio-ui-commons/types/folder';\nimport { normalizeCalendarEvents } from '../../normalizations/normalize-calendar-events';\nimport { EventType } from '../../types/event';\nimport { Appointment, InstanceReference } from '../../types/store/appointments';\nimport { AppointmentsSlice } from '../../types/store/store';\nimport type { RootState } from '../redux';\n\nconst selectAppointmentsSlice = (state: RootState): AppointmentsSlice => state.appointments;\n\nexport const selectAppointments = createSelector(\n\t[selectAppointmentsSlice],\n\t(slice) => slice.appointments\n);\n\nexport const selectAppointmentsArray = createSelector([selectAppointments], (collections) =>\n\tvalues(collections)\n);\n\nexport const selectAppointment =\n\t(id: string | undefined): (({ appointments }: RootState) => Appointment | undefined) =>\n\t({ appointments }: RootState): Appointment | undefined =>\n\t\tid ? appointments?.appointments?.[id] : undefined;\n\nexport const selectAppointmentInstance =\n\t(\n\t\tapptId: string | undefined,\n\t\tridZ: string | undefined\n\t): (({ appointments }: RootState) => InstanceReference | undefined) =>\n\t({ appointments }: RootState): InstanceReference | undefined =>\n\t\tapptId && ridZ ? find(appointments?.appointments?.[apptId]?.inst, ['ridZ', ridZ]) : undefined;\n\nexport function selectApptStatus({ appointments }: RootState): string {\n\treturn appointments?.status;\n}\n\nexport function getSelectedEvents(\n\t{ appointments }: RootState,\n\tidMap: Record<string, Array<string>>,\n\tcalendars: Folders\n): Array<EventType> {\n\treturn normalizeCalendarEvents(\n\t\tvalues(\n\t\t\treduce(\n\t\t\t\tidMap,\n\t\t\t\t(acc, v, k) => {\n\t\t\t\t\tconst res = filter(\n\t\t\t\t\t\tappointments?.appointments[k]?.inst,\n\t\t\t\t\t\t(i) => !!find(v, (obj) => obj === i.ridZ)\n\t\t\t\t\t);\n\t\t\t\t\treturn [...acc, { ...appointments?.appointments[k], inst: res }];\n\t\t\t\t},\n\t\t\t\t[] as Array<Appointment>\n\t\t\t)\n\t\t),\n\t\tcalendars\n\t);\n}\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { Editor, IdentityItem, Resource } from '../../types/editor';\nimport { InviteFreeBusy } from '../../types/store/invite';\nimport type { RootState } from '../redux';\n\nexport const selectEditor =\n\t(id: string) =>\n\t(state: RootState): Editor =>\n\t\tstate.editor.editors[id];\n\nexport function selectEditors(state: RootState): Record<string, Editor> {\n\treturn state.editor.editors;\n}\n\nexport const selectEditorIsRichText =\n\t(id: string) =>\n\t(state: RootState): boolean | undefined =>\n\t\tstate?.editor?.editors?.[id]?.isRichText;\n\nexport const selectOrganizer =\n\t(id: string) =>\n\t(state: RootState): IdentityItem =>\n\t\tstate?.editor?.editors?.[id]?.organizer;\n\nexport const selectSender =\n\t(id: string) =>\n\t(state: RootState): IdentityItem =>\n\t\tstate?.editor?.editors?.[id]?.sender;\n\nexport const selectEditorTitle =\n\t(id: string) =>\n\t(state: RootState): string | undefined =>\n\t\tstate?.editor?.editors?.[id]?.title;\n\nexport const selectEditorLocation =\n\t(id: string) =>\n\t(state: RootState): string | undefined =>\n\t\tstate?.editor?.editors?.[id]?.location;\n\nexport const selectEditorRoom =\n\t(id: string) =>\n\t(state: RootState): Editor['room'] | undefined =>\n\t\tstate?.editor?.editors?.[id]?.room;\n\nexport const selectEditorAttendees =\n\t(id: string) =>\n\t(state: RootState): Array<any> =>\n\t\tstate?.editor?.editors?.[id]?.attendees;\n\nexport const selectEditorUid =\n\t(id: string) =>\n\t(state: RootState): string | undefined =>\n\t\tstate?.editor?.editors?.[id]?.uid;\n\nexport const selectEditorOptionalAttendees =\n\t(id: string) =>\n\t(state: RootState): Array<any> =>\n\t\tstate?.editor?.editors?.[id]?.optionalAttendees;\n\nexport const selectEditorAllDay =\n\t(id: string) =>\n\t(state: RootState): boolean | undefined =>\n\t\tstate?.editor?.editors?.[id]?.allDay;\n\nexport const selectEditorFreeBusy =\n\t(id: string) =>\n\t(state: RootState): InviteFreeBusy | undefined =>\n\t\tstate?.editor?.editors?.[id]?.freeBusy;\n\nexport const selectEditorClass =\n\t(id: string) =>\n\t(state: RootState): string | undefined =>\n\t\tstate?.editor?.editors?.[id]?.class;\n\nexport const selectEditorStart =\n\t(id: string) =>\n\t(state: RootState): number | undefined =>\n\t\tstate?.editor?.editors?.[id]?.start;\n\nexport const selectEditorEnd =\n\t(id: string) =>\n\t(state: RootState): number | undefined =>\n\t\tstate?.editor?.editors?.[id]?.end;\n\nexport const selectEditorRichText =\n\t(id: string) =>\n\t(state: RootState): string =>\n\t\tstate?.editor?.editors?.[id]?.richText;\n\nexport const selectEditorPlainText =\n\t(id: string) =>\n\t(state: RootState): string =>\n\t\tstate?.editor?.editors?.[id]?.plainText;\n\nexport const selectEditorTimezone =\n\t(id: string) =>\n\t(state: RootState): string | undefined =>\n\t\tstate?.editor?.editors?.[id]?.timezone;\n\nexport const selectEditorReminder =\n\t(id: string) =>\n\t(state: RootState): string | undefined =>\n\t\tstate?.editor?.editors?.[id]?.reminder;\n\nexport const selectEditorRecurrence =\n\t(id: string) =>\n\t(state: RootState): any =>\n\t\tstate?.editor?.editors?.[id]?.recur;\n\nexport const selectEditorRecurrenceFrequency =\n\t(id: string) =>\n\t(state: RootState): string | undefined =>\n\t\tstate?.editor?.editors?.[id]?.recur?.[0]?.add?.[0]?.rule?.[0]?.freq;\n\nexport const selectEditorRecurrenceInterval =\n\t(id: string) =>\n\t(state: RootState): { ival: number } | undefined =>\n\t\tstate?.editor?.editors?.[id]?.recur?.[0]?.add?.[0]?.rule?.[0]?.interval?.[0]?.ival && {\n\t\t\tival: state?.editor?.editors?.[id]?.recur?.[0]?.add?.[0]?.rule?.[0]?.interval?.[0]?.ival\n\t\t};\n\nexport const selectEditorRecurrenceByDay =\n\t(id: string) =>\n\t(state: RootState): { wkday: Array<{ day: string }> } | undefined =>\n\t\tstate?.editor?.editors?.[id]?.recur?.[0]?.add?.[0]?.rule?.[0]?.byday?.[0]?.wkday && {\n\t\t\twkday: state?.editor?.editors?.[id]?.recur?.[0]?.add?.[0]?.rule?.[0]?.byday?.[0]?.wkday\n\t\t};\n\nexport const selectEditorRecurrenceUntilDate =\n\t(id: string) =>\n\t(state: RootState): string | undefined =>\n\t\tstate?.editor?.editors?.[id]?.recur?.[0]?.add?.[0]?.rule?.[0]?.until?.[0]?.d;\n\nexport const selectEditorRecurrenceSetPos =\n\t(id: string) =>\n\t(state: RootState): string | undefined =>\n\t\tstate?.editor?.editors?.[id]?.recur?.[0]?.add?.[0]?.rule?.[0]?.bysetpos?.poslist;\n\nexport const selectEditorRecurrenceCount =\n\t(id: string) =>\n\t(state: RootState): number | undefined =>\n\t\tstate?.editor?.editors?.[id]?.recur?.[0]?.add?.[0]?.rule?.[0]?.count?.[0]?.num;\n\nexport const selectEditorCalendar =\n\t(id: string) =>\n\t(state: RootState): any =>\n\t\tstate?.editor?.editors?.[id]?.calendar;\n\nexport const selectEditorCalendarId =\n\t(id: string) =>\n\t(state: RootState): string | undefined =>\n\t\tstate?.editor?.editors?.[id]?.calendar?.id;\n\nexport const selectEditorIsNew =\n\t(id: string) =>\n\t(state: RootState): boolean =>\n\t\tstate?.editor?.editors?.[id]?.isNew;\n\nexport const selectEditorInviteId =\n\t(id: string) =>\n\t(state: RootState): string | undefined =>\n\t\tstate?.editor?.editors?.[id]?.inviteId;\n\nexport const selectEditorAttachmentFiles =\n\t(id: string) =>\n\t(state: RootState): Array<any> =>\n\t\tstate?.editor?.editors?.[id]?.attachmentFiles;\n\nexport const selectEditorAttachmentAid =\n\t(id: string) =>\n\t(state: RootState): Array<string> =>\n\t\tstate?.editor?.editors?.[id]?.attach?.aid;\n\nexport const selectEditorAttach =\n\t(id: string) =>\n\t(state: RootState): Array<any> =>\n\t\tstate?.editor?.editors?.[id]?.attach?.mp;\n\nexport const selectEditorDisabled =\n\t(id: string) =>\n\t(state: RootState): Record<string, boolean> =>\n\t\tstate?.editor?.editors?.[id]?.disabled;\n\nexport const selectEditorMeetingRoom =\n\t(id: string) =>\n\t(state: RootState): Array<Resource> | undefined =>\n\t\tstate?.editor?.editors?.[id]?.meetingRoom;\n\nexport const selectEditorEquipment =\n\t(id: string) =>\n\t(state: RootState): Array<Resource> | undefined =>\n\t\tstate?.editor?.editors?.[id]?.equipment;\n\nexport const selectIsInstance =\n\t(id: string) =>\n\t(state: RootState): boolean =>\n\t\tstate?.editor?.editors?.[id]?.isInstance;\n\nexport const selectIsSeries =\n\t(id: string) =>\n\t(state: RootState): boolean =>\n\t\tstate?.editor?.editors?.[id]?.isSeries;\n\nexport const selectIsException =\n\t(id: string) =>\n\t(state: RootState): boolean =>\n\t\tstate?.editor?.editors?.[id]?.isException;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { PayloadAction, SerializedError } from '@reduxjs/toolkit';\n\nimport { ItemActionRejectedType } from '../../soap/item-action-request';\nimport { AppointmentsSlice, PendingResponse, RejectedResponse } from '../../types/store/store';\nimport { DeleteAppointmentArguments } from '../actions/delete-appointment-permanent';\n\nexport const deleteAppointmentPermanentlyPending = (\n\tstate: AppointmentsSlice,\n\t{ meta }: PayloadAction<unknown, string, PendingResponse<DeleteAppointmentArguments>>\n): void => {\n\tconst { id } = meta.arg;\n\t// eslint-disable-next-line no-param-reassign\n\tmeta.arg.previousState = state.appointments;\n\tdelete state.appointments[id];\n};\n\nexport const deleteAppointmentPermanentlyFulfilled = (state: AppointmentsSlice): void => {\n\tstate.status = 'completed';\n};\n\nexport const deleteAppointmentPermanentlyRejected = (\n\tstate: AppointmentsSlice,\n\t{\n\t\tmeta\n\t}: PayloadAction<\n\t\tItemActionRejectedType | undefined,\n\t\tstring,\n\t\tRejectedResponse<DeleteAppointmentArguments>,\n\t\tSerializedError\n\t>\n): void => {\n\tif (meta.arg.previousState) {\n\t\tstate.appointments = meta.arg.previousState;\n\t}\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { PayloadAction, SerializedError } from '@reduxjs/toolkit';\nimport { cloneDeep, forEach } from 'lodash';\n\nimport { DismissCalendarItemAlarmRejectedType } from '../../soap/dismiss-calendar-item-alarm-request';\nimport { AppointmentsSlice, PendingResponse, RejectedResponse } from '../../types/store/store';\nimport { DismissApptReminderArguments } from '../actions/dismiss-appointment-reminder';\n\nexport const dismissAppointmentPending = (\n\tstate: AppointmentsSlice,\n\t{ meta }: PayloadAction<unknown, string, PendingResponse<DismissApptReminderArguments>>\n): void => {\n\t// eslint-disable-next-line no-param-reassign\n\tmeta.arg.previousState = cloneDeep(state.appointments);\n\tforEach(meta.arg.dismissItems, (appt: any): void => {\n\t\tstate.appointments[appt.id].alarmData = undefined;\n\t});\n};\n\nexport const dismissAppointmentFulfilled = (state: AppointmentsSlice): void => {\n\tstate.status = 'fulFilled';\n};\n\nexport const dismissAppointmentRejected = (\n\tstate: AppointmentsSlice,\n\t{\n\t\tmeta\n\t}: PayloadAction<\n\t\tDismissCalendarItemAlarmRejectedType | undefined,\n\t\tstring,\n\t\tRejectedResponse<DismissApptReminderArguments>,\n\t\tSerializedError\n\t>\n): void => {\n\tif (meta.arg.previousState) {\n\t\tstate.appointments = meta.arg.previousState;\n\t}\n\tstate.status = 'error';\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { find, forEach, merge } from 'lodash';\n\nimport { normalizeAppointmentsFromNotify } from '../../normalizations/normalize-appointments';\nimport { AppointmentsSlice } from '../../types/store/store';\n\nexport const handleCreatedAppointmentsReducer = (\n\tstate: AppointmentsSlice,\n\t// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\t{ payload }: any\n): void => {\n\tconst norm = normalizeAppointmentsFromNotify(payload);\n\n\tforEach(norm, (appt) => {\n\t\tconst old = find(state.appointments, ['id', appt.id]);\n\t\tif (old) {\n\t\t\tmerge(old, appt);\n\t\t} else {\n\t\t\tmerge(state.appointments, { [appt.id]: appt });\n\t\t}\n\t});\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { AppointmentsSlice } from '../../types/store/store';\n\nexport const moveAppointmentFulfilled = (state: AppointmentsSlice): void => {\n\tstate.status = 'completed';\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { forEach } from 'lodash';\n\nimport { Appointment } from '../../types/store/appointments';\nimport { AppointmentsSlice } from '../../types/store/store';\n\nexport const replaceAppointmentsToStore = (\n\tstate: AppointmentsSlice,\n\tappts: Array<Appointment>\n): void => {\n\tforEach(appts, (appt) => {\n\t\tif (appt.id) {\n\t\t\tstate.appointments = { ...state.appointments, [appt.id]: appt };\n\t\t}\n\t});\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { PayloadAction } from '@reduxjs/toolkit';\nimport { values } from 'lodash';\n\nimport { normalizeAppointments } from '../../normalizations/normalize-appointments';\nimport { SearchReturnType } from '../../soap/search-request';\nimport { AppointmentsSlice, FulfilledResponse } from '../../types/store/store';\nimport { replaceAppointmentsToStore } from '../../utils/store/appointments';\nimport { SearchAppointmentsArguments } from '../actions/search-appointments';\n\nexport const searchAppointmentsPending = (state: AppointmentsSlice): void => {\n\tstate.status = 'pending';\n};\n\nexport const searchAppointmentsFulfilled = (\n\tstate: AppointmentsSlice,\n\t{\n\t\tpayload\n\t}: PayloadAction<SearchReturnType, string, FulfilledResponse<SearchAppointmentsArguments>>\n): void => {\n\tconst appt = normalizeAppointments(payload.appt);\n\treplaceAppointmentsToStore(state, values(appt));\n\tstate.status = 'idle';\n};\n\nexport const searchAppointmentsRejected = (state: AppointmentsSlice): void => {\n\tstate.status = 'error';\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { PayloadAction, SerializedError } from '@reduxjs/toolkit';\nimport { cloneDeep } from 'lodash';\n\nimport { SnoozeCalendarItemAlarmRejectedType } from '../../soap/snooze-calendar-item-alarm-request';\nimport { AppointmentsSlice, PendingResponse, RejectedResponse } from '../../types/store/store';\nimport { SnoozeApptReminderArguments } from '../actions/snooze-appointment-reminder';\n\nexport const snoozeApptReminderPending = (\n\tstate: AppointmentsSlice,\n\t{ meta }: PayloadAction<unknown, string, PendingResponse<SnoozeApptReminderArguments>>\n): void => {\n\t// eslint-disable-next-line no-param-reassign\n\tmeta.arg.previousState = cloneDeep(state.appointments);\n\tconst alarmData = state?.appointments?.[meta.arg.id]?.alarmData;\n\tif (alarmData && alarmData?.[0]?.nextAlarm) {\n\t\talarmData[0].nextAlarm = meta.arg.until;\n\t}\n};\n\nexport const snoozeApptReminderFulfilled = (state: AppointmentsSlice): void => {\n\tstate.status = 'fulFilled';\n};\n\nexport const snoozeApptReminderRejected = (\n\tstate: AppointmentsSlice,\n\t{\n\t\tmeta\n\t}: PayloadAction<\n\t\tSnoozeCalendarItemAlarmRejectedType | undefined,\n\t\tstring,\n\t\tRejectedResponse<SnoozeApptReminderArguments>,\n\t\tSerializedError\n\t>\n): void => {\n\tif (meta.arg.previousState) {\n\t\tstate.appointments = meta.arg.previousState;\n\t}\n\tstate.status = 'error';\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createSlice } from '@reduxjs/toolkit';\nimport produce from 'immer';\n\nimport { AppointmentsSlice } from '../../types/store/store';\nimport { deleteAppointmentPermanent } from '../actions/delete-appointment-permanent';\nimport { dismissApptReminder } from '../actions/dismiss-appointment-reminder';\nimport { moveAppointmentRequest } from '../actions/move-appointment';\nimport { moveAppointmentToTrash } from '../actions/move-appointment-to-trash';\nimport { searchAppointments } from '../actions/search-appointments';\nimport { snoozeApptReminder } from '../actions/snooze-appointment-reminder';\nimport {\n\tdeleteAppointmentPermanentlyFulfilled,\n\tdeleteAppointmentPermanentlyPending,\n\tdeleteAppointmentPermanentlyRejected\n} from '../reducers/delete-appointment-permanently';\nimport {\n\tdismissAppointmentFulfilled,\n\tdismissAppointmentPending,\n\tdismissAppointmentRejected\n} from '../reducers/dismiss-appointment';\nimport { handleCreatedAppointmentsReducer } from '../reducers/handle-created-appointments';\nimport { handleDeletedAppointmentsReducer } from '../reducers/handle-deleted-appointments';\nimport { handleModifiedAppointmentsReducer } from '../reducers/handle-modified-appointments';\nimport { moveAppointmentFulfilled } from '../reducers/move-appointment';\nimport {\n\tmoveAppointmentToTrashFulfilled,\n\tmoveAppointmentToTrashPending,\n\tmoveAppointmentToTrashRejected\n} from '../reducers/move-appointment-to-trash';\nimport {\n\tsearchAppointmentsFulfilled,\n\tsearchAppointmentsPending,\n\tsearchAppointmentsRejected\n} from '../reducers/search-appointments';\nimport {\n\tsnoozeApptReminderFulfilled,\n\tsnoozeApptReminderPending,\n\tsnoozeApptReminderRejected\n} from '../reducers/snooze-appointment';\n\nconst initialState: AppointmentsSlice = {\n\tstatus: 'init',\n\tappointments: {}\n};\n\nexport const appointmentsSlice = createSlice({\n\tname: 'appointments',\n\tinitialState,\n\treducers: {\n\t\thandleModifiedAppointments: produce(handleModifiedAppointmentsReducer),\n\t\thandleCreatedAppointments: produce(handleCreatedAppointmentsReducer),\n\t\thandleDeletedAppointments: produce(handleDeletedAppointmentsReducer)\n\t},\n\textraReducers: (builder) => {\n\t\tbuilder.addCase(moveAppointmentToTrash.pending, moveAppointmentToTrashPending);\n\t\tbuilder.addCase(moveAppointmentToTrash.rejected, moveAppointmentToTrashRejected);\n\t\tbuilder.addCase(moveAppointmentToTrash.fulfilled, moveAppointmentToTrashFulfilled);\n\t\tbuilder.addCase(moveAppointmentRequest.fulfilled, moveAppointmentFulfilled);\n\t\tbuilder.addCase(deleteAppointmentPermanent.pending, deleteAppointmentPermanentlyPending);\n\t\tbuilder.addCase(deleteAppointmentPermanent.fulfilled, deleteAppointmentPermanentlyFulfilled);\n\t\tbuilder.addCase(deleteAppointmentPermanent.rejected, deleteAppointmentPermanentlyRejected);\n\t\tbuilder.addCase(dismissApptReminder.pending, dismissAppointmentPending);\n\t\tbuilder.addCase(dismissApptReminder.fulfilled, dismissAppointmentFulfilled);\n\t\tbuilder.addCase(dismissApptReminder.rejected, dismissAppointmentRejected);\n\t\tbuilder.addCase(snoozeApptReminder.pending, snoozeApptReminderPending);\n\t\tbuilder.addCase(snoozeApptReminder.fulfilled, snoozeApptReminderFulfilled);\n\t\tbuilder.addCase(snoozeApptReminder.rejected, snoozeApptReminderRejected);\n\t\tbuilder.addCase(searchAppointments.pending, searchAppointmentsPending);\n\t\tbuilder.addCase(searchAppointments.fulfilled, searchAppointmentsFulfilled);\n\t\tbuilder.addCase(searchAppointments.rejected, searchAppointmentsRejected);\n\t}\n});\n\nexport const { handleModifiedAppointments, handleDeletedAppointments } = appointmentsSlice.actions;\n\nexport default appointmentsSlice.reducer;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { find, forEach, merge } from 'lodash';\n\nimport { AppointmentsSlice } from '../../types/store/store';\n\nexport const handleModifiedAppointmentsReducer = (\n\tstate: AppointmentsSlice,\n\t// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\t{ payload }: any\n): void => {\n\tforEach(payload, (appt) => {\n\t\tconst oldAppt = find(state.appointments, ['id', appt.id]);\n\t\tif (oldAppt) {\n\t\t\tmerge(oldAppt, { l: appt.l });\n\t\t}\n\t});\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { forEach } from 'lodash';\n\nimport { AppointmentsSlice } from '../../types/store/store';\n\nexport const handleDeletedAppointmentsReducer = (\n\tstate: AppointmentsSlice,\n\t{ payload }: { payload: Array<string> }\n): void => {\n\tforEach(payload, (id) => {\n\t\tdelete state.appointments[id];\n\t});\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport type { PayloadAction } from '@reduxjs/toolkit';\nimport { isNil, union } from 'lodash';\n\nimport type { CalendarEditor, Resource, IdentityItem, Editor, Room } from '../../types/editor';\nimport type { Attendee, InviteClass, InviteFreeBusy } from '../../types/store/invite';\nimport type { EditorSlice } from '../../types/store/store';\n\ntype SenderPayload = {\n\tid: string | undefined;\n\tsender: IdentityItem;\n};\n\ntype TitlePayload = {\n\tid: string | undefined;\n\ttitle: string;\n};\n\ntype LocationPayload = {\n\tid: string | undefined;\n\tlocation: string;\n};\n\ntype RoomPayload = {\n\tid: string | undefined;\n\troom: Room;\n};\n\ntype CalendarPayload = {\n\tid: string;\n\tcalendar: CalendarEditor;\n};\n\ntype ClassPayload = {\n\tid: string | undefined;\n\tclass: InviteClass;\n};\n\ntype TextPayload = {\n\tid: string | undefined;\n\trichText: string;\n\tplainText: string;\n};\n\ntype AllDayPayload = {\n\tid: string | undefined;\n\tallDay: boolean;\n};\n\ntype AttendeePayload = { id: string; attendees: Attendee[] };\n\ntype OptionalAttendeePayload = {\n\tid: string;\n\toptionalAttendees: Attendee[];\n};\n\ntype FreeBusyPayload = {\n\tid: string;\n\tfreeBusy: InviteFreeBusy;\n};\n\ntype DateReducer = {\n\tid: string;\n\tstart: number;\n\tend: number;\n};\n\ntype IsRichTextPayload = {\n\tid: string;\n\tisRichText: boolean;\n};\n\ntype AttachmentFilesPayload = {\n\tid: string;\n\tattach: any;\n\tattachmentFiles: any[];\n};\n\nexport const newEditorReducer = (state: EditorSlice, action: PayloadAction<Editor>): void => {\n\tif (action.payload) {\n\t\tstate.editors[action.payload.id] = action.payload;\n\t}\n};\n\nexport const editIsRichTextReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<IsRichTextPayload>\n): void => {\n\tif (payload?.id && !isNil(editors?.[payload?.id]?.isRichText)) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].isRichText = payload.isRichText;\n\t}\n};\n\nexport const editEditorAttachmentsReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<AttachmentFilesPayload>\n): void => {\n\tif (payload?.id && editors?.[payload?.id]) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].attachmentFiles = payload.attachmentFiles;\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].attach = payload?.attach;\n\t}\n};\nexport const editSenderReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<SenderPayload>\n): void => {\n\tif (payload?.id && editors?.[payload?.id]?.sender && payload?.sender) {\n\t\tconst editor = editors[payload.id];\n\t\teditor.sender = payload.sender;\n\t}\n};\n\nexport const editTitleReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<TitlePayload>\n): void => {\n\tif (payload?.id && !isNil(editors?.[payload?.id]?.title) && !isNil(payload?.title)) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].title = payload.title;\n\t}\n};\n\nexport const editLocationReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<LocationPayload>\n): void => {\n\tif (payload?.id && !isNil(editors?.[payload?.id]?.location) && !isNil(payload?.location)) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].location = payload.location;\n\t}\n};\n\nexport const editEditorMeetingRoomReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<{ id: string; meetingRoom: Array<Resource> }>\n): void => {\n\tif (payload?.id && !isNil(editors?.[payload?.id])) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].meetingRoom = payload.meetingRoom;\n\t}\n};\n\nexport const editEditorEquipmentReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<{ id: string; equipment: Array<Resource> }>\n): void => {\n\tif (payload?.id && !isNil(editors?.[payload?.id])) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].equipment = payload.equipment;\n\t}\n};\n\nexport const editEditorRoomReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<RoomPayload>\n): void => {\n\tconst { label, link, attendees } = payload.room;\n\tif (payload?.id) {\n\t\tif (label && link) {\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\teditors[payload.id].room = { label, link };\n\t\t} else {\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\teditors[payload.id].room = undefined;\n\t\t}\n\t\tif (attendees) {\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\teditors[payload.id].attendees = union(editors[payload.id].attendees, attendees);\n\t\t}\n\t}\n};\n\nexport const editEditorAttendeesReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<AttendeePayload>\n): void => {\n\t// eslint-disable-next-line no-param-reassign\n\teditors[payload.id].attendees = payload.attendees;\n};\n\nexport const editEditorOptionalAttendeesReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<OptionalAttendeePayload>\n): void => {\n\t// eslint-disable-next-line no-param-reassign\n\teditors[payload.id].optionalAttendees = payload.optionalAttendees;\n};\n\nexport const editEditorDisplayStatusReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<FreeBusyPayload>\n): void => {\n\tif (editors?.[payload?.id]) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].freeBusy = payload.freeBusy;\n\t}\n};\n\nexport const editEditorCalendarReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<CalendarPayload>\n): void => {\n\tif (payload?.id && editors?.[payload?.id]) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].calendar = payload.calendar;\n\t}\n};\n\nexport const editEditorClassReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<ClassPayload>\n): void => {\n\tif (payload?.id && editors?.[payload?.id]) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].class = payload.class;\n\t}\n};\n\nexport const editEditorDateReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<DateReducer>\n): void => {\n\tif (payload?.id && editors?.[payload?.id]) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].start = payload.start;\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].end = payload.end;\n\t}\n};\n\nexport const editEditorTextReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<TextPayload>\n): void => {\n\tif (payload?.id && editors?.[payload?.id]) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].richText = payload.richText;\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].plainText = payload.plainText;\n\t}\n};\n\nexport const editEditorAllDayReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<AllDayPayload>\n): void => {\n\tif (payload?.id && editors?.[payload?.id]) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].allDay = payload.allDay;\n\t}\n};\n\nexport const editEditorTimezoneReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<any>\n): void => {\n\tif (payload?.id && editors?.[payload?.id]) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].timezone = payload.timezone;\n\t}\n};\n\nexport const editEditorReminderReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<any>\n): void => {\n\tif (payload?.id && editors?.[payload?.id]) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].reminder = payload.reminder;\n\t}\n};\n\nexport const editEditorRecurrenceReducer = (\n\t{ editors }: EditorSlice,\n\t{ payload }: PayloadAction<any>\n): void => {\n\tif (payload?.id && editors?.[payload?.id]) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditors[payload.id].recur = payload.recur;\n\t}\n};\n\nexport const updateEditorReducer = (\n\teditor: EditorSlice,\n\t{ payload }: PayloadAction<{ id: string; editor: Editor }>\n): void => {\n\tif (payload?.id && editor?.editors?.[payload?.id]) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\teditor.editors[payload.id] = { ...editor.editors[payload.id], ...payload.editor };\n\t}\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createSlice } from '@reduxjs/toolkit';\n\nimport type { EditorSlice } from '../../types/store/store';\nimport {\n\teditEditorAllDayReducer,\n\teditEditorAttendeesReducer,\n\teditEditorCalendarReducer,\n\teditEditorClassReducer,\n\teditEditorDateReducer,\n\teditEditorDisplayStatusReducer,\n\teditEditorOptionalAttendeesReducer,\n\teditEditorRecurrenceReducer,\n\teditEditorReminderReducer,\n\teditEditorRoomReducer,\n\teditEditorTextReducer,\n\teditEditorTimezoneReducer,\n\teditLocationReducer,\n\teditTitleReducer,\n\teditIsRichTextReducer,\n\teditEditorAttachmentsReducer,\n\tupdateEditorReducer,\n\tnewEditorReducer,\n\teditSenderReducer,\n\teditEditorMeetingRoomReducer,\n\teditEditorEquipmentReducer\n} from '../reducers/editor-reducers';\n\nconst initialState: EditorSlice = {\n\tstatus: 'idle',\n\teditors: {}\n};\n\nexport const editorSlice = createSlice({\n\tname: 'editor',\n\tinitialState,\n\treducers: {\n\t\tcreateNewEditor: newEditorReducer,\n\t\teditIsRichText: editIsRichTextReducer,\n\t\teditEditorAttachments: editEditorAttachmentsReducer,\n\t\teditSender: editSenderReducer,\n\t\teditEditorTitle: editTitleReducer,\n\t\teditEditorLocation: editLocationReducer,\n\t\teditEditorRoom: editEditorRoomReducer,\n\t\teditEditorAttendees: editEditorAttendeesReducer,\n\t\teditEditorOptionalAttendees: editEditorOptionalAttendeesReducer,\n\t\teditEditorDisplayStatus: editEditorDisplayStatusReducer,\n\t\teditEditorCalendar: editEditorCalendarReducer,\n\t\teditEditorClass: editEditorClassReducer,\n\t\teditEditorDate: editEditorDateReducer,\n\t\teditEditorMeetingRoom: editEditorMeetingRoomReducer,\n\t\teditEditorEquipment: editEditorEquipmentReducer,\n\t\teditEditorText: editEditorTextReducer,\n\t\teditEditorAllDay: editEditorAllDayReducer,\n\t\teditEditorTimezone: editEditorTimezoneReducer,\n\t\teditEditorReminder: editEditorReminderReducer,\n\t\teditEditorRecurrence: editEditorRecurrenceReducer,\n\t\tupdateEditor: updateEditorReducer\n\t}\n});\n\nexport const {\n\tcreateNewEditor,\n\teditIsRichText,\n\teditEditorAttachments,\n\teditSender,\n\teditEditorTitle,\n\teditEditorLocation,\n\teditEditorRoom,\n\teditEditorMeetingRoom,\n\teditEditorEquipment,\n\teditEditorAttendees,\n\teditEditorOptionalAttendees,\n\teditEditorDisplayStatus,\n\teditEditorCalendar,\n\teditEditorClass,\n\teditEditorDate,\n\teditEditorText,\n\teditEditorAllDay,\n\teditEditorTimezone,\n\teditEditorReminder,\n\teditEditorRecurrence,\n\tupdateEditor\n} = editorSlice.actions;\n\nexport default editorSlice.reducer;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { PayloadAction } from '@reduxjs/toolkit';\n\nimport { normalizeInvite } from '../../normalizations/normalize-invite';\nimport { GetMessageReturnType } from '../../soap/get-message-request';\nimport { FulfilledResponse, InvitesSlice } from '../../types/store/store';\nimport { GetInviteArguments } from '../actions/get-invite';\n\nexport function getInviteFulfilled(\n\tstate: InvitesSlice,\n\taction: PayloadAction<GetMessageReturnType, string, FulfilledResponse<GetInviteArguments>>\n): void {\n\tconst { m } = action.payload;\n\tstate.invites[action.meta.arg.inviteId] = normalizeInvite(m?.[0]);\n}\n\nexport function getInviteRejected(state: InvitesSlice): void {\n\tstate.status = 'error';\n}\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport type { PayloadAction } from '@reduxjs/toolkit';\nimport { forEach, isNil, map, omitBy } from 'lodash';\n\nimport { normalizeInviteFromSync } from '../../normalizations/normalize-invite';\nimport type { Invite } from '../../types/store/invite';\nimport type { InvitesSlice } from '../../types/store/store';\n\nexport const handleModifiedInvitesReducer = (\n\tstate: InvitesSlice,\n\taction: PayloadAction<Array<Invite>>\n): void => {\n\tconst invites = map(action.payload, (inv) => omitBy(normalizeInviteFromSync(inv), isNil));\n\tforEach(invites, (inv) => {\n\t\tif (state?.invites?.[inv.id]) {\n\t\t\tstate.invites[inv.id] = { ...state.invites?.[inv.id], ...inv };\n\t\t}\n\t});\n};\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { PayloadAction } from '@reduxjs/toolkit';\n\nimport { FulfilledResponse, InvitesSlice } from '../../types/store/store';\nimport {\n\tModifyAppointmentArguments,\n\tModifyAppointmentReturnType\n} from '../actions/new-modify-appointment';\n\nexport const modifyAppointmentFullfilled = (\n\tstate: InvitesSlice,\n\t{\n\t\tpayload\n\t}: PayloadAction<\n\t\tModifyAppointmentReturnType,\n\t\tstring,\n\t\tFulfilledResponse<ModifyAppointmentArguments>\n\t>\n): void => {\n\tif (payload?.editor?.inviteId) {\n\t\tdelete state.invites[payload?.editor?.inviteId];\n\t}\n};\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { InvitesSlice } from '../../types/store/store';\n\n// todo: types are wrong somewhere else, needs a type refactor in order to type this properly\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const proposeNewTimeFulfilled = (state: InvitesSlice, { payload }): void => {\n\tif (payload?.editor?.inviteId) {\n\t\tdelete state.invites[payload?.editor?.inviteId];\n\t}\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { PayloadAction } from '@reduxjs/toolkit';\n\nimport { SendInviteReplyReturnType } from '../../soap/send-invite-reply-request';\nimport { FulfilledResponse, InvitesSlice, PendingResponse } from '../../types/store/store';\nimport { SendInviteArguments } from '../actions/send-invite-response';\n\nexport const sendInviteResponsePending = (\n\tstate: InvitesSlice,\n\taction: PayloadAction<undefined, string, PendingResponse<SendInviteArguments>>\n): void => {\n\tif (!action.meta.arg.fromMail) {\n\t\tstate.status = 'pending';\n\t}\n};\n\nexport const sendInviteResponseFulfilled = (\n\tstate: InvitesSlice,\n\taction: PayloadAction<SendInviteReplyReturnType, string, FulfilledResponse<SendInviteArguments>>\n): void => {\n\tif (!action.meta.arg.fromMail) {\n\t\tstate.status = 'fulfilled';\n\t}\n\tif (action.payload) {\n\t\tdelete state.invites[action.meta.arg.inviteId];\n\t}\n};\n\nexport const sendInviteResponseRejected = (state: InvitesSlice): void => {\n\tstate.status = 'error';\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createSlice } from '@reduxjs/toolkit';\n\nimport { InvitesSlice } from '../../types/store/store';\nimport { getInvite } from '../actions/get-invite';\nimport { moveAppointmentToTrash } from '../actions/move-appointment-to-trash';\nimport { modifyAppointment } from '../actions/new-modify-appointment';\nimport { proposeNewTime } from '../actions/propose-new-time';\nimport { sendInviteResponse } from '../actions/send-invite-response';\nimport { getInviteFulfilled, getInviteRejected } from '../reducers/get-invite';\nimport { handleModifiedInvitesReducer } from '../reducers/handle-modified-invites';\nimport { modifyAppointmentFullfilled } from '../reducers/modify-appointment-response';\nimport { moveAppointmentToTrashFulfilled } from '../reducers/move-appointment-to-trash';\nimport { proposeNewTimeFulfilled } from '../reducers/propose-new-time';\nimport {\n\tsendInviteResponseFulfilled,\n\tsendInviteResponsePending,\n\tsendInviteResponseRejected\n} from '../reducers/send-invite-response';\n\nconst initialState: InvitesSlice = {\n\tstatus: 'idle',\n\tinvites: {}\n};\n\nexport const invitesSlice = createSlice({\n\tname: 'invites',\n\tinitialState,\n\treducers: {\n\t\thandleModifiedInvites: handleModifiedInvitesReducer\n\t},\n\textraReducers: (builder) => {\n\t\tbuilder.addCase(getInvite.fulfilled, getInviteFulfilled);\n\t\tbuilder.addCase(getInvite.rejected, getInviteRejected);\n\t\tbuilder.addCase(sendInviteResponse.pending, sendInviteResponsePending);\n\t\tbuilder.addCase(sendInviteResponse.fulfilled, sendInviteResponseFulfilled);\n\t\tbuilder.addCase(sendInviteResponse.rejected, sendInviteResponseRejected);\n\t\tbuilder.addCase(moveAppointmentToTrash.fulfilled, moveAppointmentToTrashFulfilled);\n\t\tbuilder.addCase(modifyAppointment.fulfilled, modifyAppointmentFullfilled);\n\t\tbuilder.addCase(proposeNewTime.fulfilled, proposeNewTimeFulfilled);\n\t}\n});\n\nexport const { handleModifiedInvites } = invitesSlice.actions;\n\nexport default invitesSlice.reducer;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { AppState, SetRange, useAppStatusStore } from './store';\nimport { Resource } from '../../types/editor';\n\nexport const useCalendarView = (): string => useAppStatusStore((s: AppState) => s.calendarView);\nexport const useCalendarDate = (): Date => useAppStatusStore((s: AppState) => s.date);\nexport const useSummaryView = (): string | undefined =>\n\tuseAppStatusStore((s: AppState) => s.summaryViewId);\nexport const useMeetingRooms = (): Array<Resource> | undefined =>\n\tuseAppStatusStore((s: AppState) => s.meetingRoom);\n\nexport const useEquipments = (): Array<Resource> | undefined =>\n\tuseAppStatusStore((s: AppState) => s.equipment);\n\nexport const useIsSummaryViewOpen = (): boolean =>\n\tuseAppStatusStore((s: AppState) => !!s.summaryViewId);\n\n// range hooks\nexport const useSetRange = (): SetRange => useAppStatusStore((s: AppState) => s.setRange);\nexport const useRangeStart = (): number => useAppStatusStore((s: AppState) => s.range.start);\nexport const useRangeEnd = (): number => useAppStatusStore((s: AppState) => s.range.end);\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport moment from 'moment';\nimport { create } from 'zustand';\n\nimport { Resource } from '../../types/editor';\n\nexport type SetRange = ({ start, end }: { start: number; end: number }) => void;\nexport type CalendarRange = {\n\tstart: number;\n\tend: number;\n};\n\nexport type AppState = {\n\tcalendarView: string;\n\tdate: Date;\n\tsummaryViewId: string | undefined;\n\trange: CalendarRange;\n\tsetRange: SetRange;\n\tequipment: Array<Resource> | undefined;\n\tmeetingRoom: Array<Resource> | undefined;\n};\n\nexport const useAppStatusStore = create<AppState>((set) => ({\n\tcalendarView: '',\n\tdate: new Date(),\n\tsummaryViewId: undefined,\n\tequipment: undefined,\n\tmeetingRoom: undefined,\n\trange: {\n\t\tstart: moment().subtract('7', 'days').valueOf(),\n\t\tend: moment().add('15', 'days').valueOf()\n\t},\n\tsetRange: ({ start, end }: { start: number; end: number }): void => {\n\t\tset(({ range }) => {\n\t\t\tif (start < range.start) {\n\t\t\t\tif (moment(range.end).diff(moment(start), 'days') >= 400) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tend: moment(start).add('399', 'days').valueOf(),\n\t\t\t\t\t\t\tstart\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn { range: { ...range, start } };\n\t\t\t}\n\t\t\tif (range.end < end) {\n\t\t\t\tif (moment(end).diff(moment(range.start), 'days') >= 400) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\trange: { start: moment(end).subtract('399', 'days').valueOf(), end }\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn { range: { ...range, end } };\n\t\t\t}\n\t\t\treturn { range };\n\t\t});\n\t}\n}));\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nexport const EventActionsEnum = {\n\tEXPAND: 'expand',\n\tTRASH: 'trash',\n\tMOVE: 'move',\n\tEDIT: 'edit',\n\tEDIT_TAGS: 'edit_tags',\n\tPRINT: 'print',\n\tREPLY_ALL: 'reply_all',\n\tFORWARD: 'forward',\n\tSHOW_ORIGNAL: 'show_orignal',\n\tCREATE_COPY: 'create_copy',\n\tREINVITE_ATT: 'reinvite_attendees',\n\tACCEPT: 'accept',\n\tTENTATIVE: 'tentative',\n\tDECLINE: 'decline',\n\tPROPOSE_NEW_TIME: 'propose_new_time',\n\tREPLY: 'reply',\n\tFIND_SHARES: 'find_shares',\n\tEXPAND_SERIES: 'expand_series',\n\tDELETE_PERMANENTLY: 'deletePermanently',\n\tNEW_TAG: 'new_tag',\n\tDELETE_TAG: 'delete_tag',\n\tEDIT_TAG: 'edit_tag',\n\tAPPLY_TAG: 'apply_tag',\n\tINSTANCE: 'instance',\n\tSERIES: 'series',\n\tSHOW_ORIGINAL: 'show_original',\n\tDOWNLOAD_ICS: 'download_ics',\n\tANSWER: 'answer'\n} as const;\n\nexport const CalendarIntegrations = {\n\tCREATE_APPOINTMENT: 'create_appointment'\n} as const;\n\nexport type ObjectValues<T> = T[keyof T];\n\nexport type CalendarIntegrationId = ObjectValues<typeof CalendarIntegrations>;\nexport type EventActionsId = ObjectValues<typeof EventActionsEnum>;\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { getUserSettings } from '@zextras/carbonio-shell-ui';\nimport { isNaN } from 'lodash';\n\nexport const getTimezoneOffsetFromUtc = (timeZone?: string, date?: Date): number => {\n\tif (!timeZone) return 0;\n\n\tconst timeZoneName = Intl.DateTimeFormat('en', {\n\t\ttimeZoneName: 'shortOffset',\n\t\ttimeZone\n\t})\n\t\t.formatToParts(date)\n\t\t.find((i) => i.type === 'timeZoneName')?.value;\n\tif (!timeZoneName) return 0;\n\tconst offset = timeZoneName.slice(3);\n\tif (!offset) return 0;\n\n\tconst matchData = offset.match(/([+-])(\\d+)(?::(\\d+))?/);\n\tif (matchData) {\n\t\tconst [, sign, hour, minute] = matchData;\n\t\tlet result = parseInt(hour, 10) * 60;\n\t\tif (minute) result += parseInt(minute, 10);\n\t\tif (sign === '+') result *= -1;\n\n\t\treturn result;\n\t}\n\treturn 0;\n};\n\nexport const convertDateToLocal = (date: Date, timezone?: string): Date => {\n\tconst utcOffset = getTimezoneOffsetFromUtc(timezone, date);\n\tconst offset = timezone ? utcOffset - date.getTimezoneOffset() : 0;\n\n\treturn new Date(date.getTime() + 60000 * offset);\n};\n\nexport const parseDateFromICS = (icsString: string, timezone?: string): Date => {\n\tconst strYear = parseInt(icsString.substring(0, 4), 10);\n\tconst strMonth = parseInt(icsString.substring(4, 6), 10) - 1;\n\tconst strDay = parseInt(icsString.substring(6, 8), 10);\n\tconst strHourTest = parseInt(icsString.substring(9, 11), 10);\n\tconst strMinTest = parseInt(icsString.substring(11, 13), 10);\n\tconst strSecTest = parseInt(icsString.substring(13, 15), 10);\n\n\tconst strHour = isNaN(strHourTest) ? 0 : strHourTest;\n\tconst strMin = isNaN(strMinTest) ? 0 : strMinTest;\n\tconst strSec = isNaN(strSecTest) ? 0 : strSecTest;\n\n\tconst dateReceived = new Date(strYear, strMonth, strDay, strHour, strMin, strSec);\n\n\treturn convertDateToLocal(dateReceived, timezone);\n};\n\nconst dateTimeFormat = ({\n\tlocale,\n\ttimezone,\n\tallDay,\n\tintlOptions\n}: {\n\tlocale?: string;\n\ttimezone?: string;\n\tallDay: boolean;\n\tintlOptions?: Partial<Intl.DateTimeFormatOptions>;\n}): Intl.DateTimeFormat => {\n\tconst localToApply =\n\t\tlocale ??\n\t\tgetUserSettings().prefs.zimbraPrefLocale ??\n\t\tIntl.NumberFormat().resolvedOptions().locale;\n\n\tconst localTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n\n\tconst timezoneToApply = timezone ?? localTimezone;\n\n\tconst options = {\n\t\tweekday: 'long',\n\t\tyear: 'numeric',\n\t\tmonth: 'long',\n\t\tday: 'numeric',\n\t\thour: allDay ? undefined : 'numeric',\n\t\tminute: allDay ? undefined : 'numeric',\n\t\ttimeZone: timezoneToApply,\n\t\ttimeZoneName: allDay ? undefined : 'short',\n\t\t...intlOptions\n\t} as const;\n\n\treturn new Intl.DateTimeFormat(localToApply, options);\n};\n\nexport const formatAppointmentRange = ({\n\tstart,\n\tend,\n\tlocale,\n\tallDay,\n\tallDayLabel,\n\ttimezone,\n\tintlOptions\n}: {\n\tstart: number;\n\tend: number;\n\tlocale?: string;\n\tallDay: boolean;\n\tallDayLabel: string;\n\ttimezone?: string;\n\tintlOptions?: Partial<Intl.DateTimeFormatOptions>;\n}): string => {\n\tconst formattedRange = dateTimeFormat({ locale, timezone, allDay, intlOptions }).formatRange(\n\t\tstart,\n\t\tend\n\t);\n\treturn allDay ? `${formattedRange} - ${allDayLabel}` : formattedRange;\n};\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport moment from 'moment';\n\nimport { DATE_FORMAT } from '../constants';\nimport { EventType } from '../types/event';\nimport { Invite } from '../types/store/invite';\n\nexport type InstanceExceptionId = { d: string; tz: string | undefined };\n\nexport const getInstanceExceptionId = ({\n\tstart,\n\ttz,\n\tallDay\n}: {\n\tstart?: EventType['start'];\n\ttz?: Invite['start']['tz'];\n\tallDay?: EventType['allDay'];\n}): InstanceExceptionId =>\n\tallDay\n\t\t? {\n\t\t\t\td: moment(start).format(DATE_FORMAT.ALL_DAY),\n\t\t\t\ttz\n\t\t\t}\n\t\t: {\n\t\t\t\td: tz\n\t\t\t\t\t? moment(start).tz(tz).format(DATE_FORMAT.LOCAL)\n\t\t\t\t\t: moment(start).utc().format(DATE_FORMAT.UTC),\n\t\t\t\ttz\n\t\t\t};\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport {\n\tDAYS_PER_WEEK,\n\tHOURS_PER_DAY,\n\tMINUTES_PER_DAY,\n\tMINUTES_PER_HOUR,\n\tMINUTES_PER_WEEK,\n\tSECONDS_PER_MINUTE\n} from '../constants';\n\nfunction converts(\n\tfn: (value: number, factor: number) => number\n): (factor: number) => (value: number) => number {\n\treturn (factor: number) => (value: number) => fn(value, factor);\n}\n\nconst convertsIn = converts((value, factor) => value * factor);\nconst convertsFrom = converts((value, factor) => value / factor);\n\nexport const daysToMinutes = convertsIn(MINUTES_PER_DAY);\nexport const hoursToMinutes = convertsIn(MINUTES_PER_HOUR);\nexport const weeksToMinutes = convertsIn(MINUTES_PER_WEEK);\n\nexport const secondsToMinutes = convertsFrom(SECONDS_PER_MINUTE);\nexport const minutesToHours = convertsFrom(MINUTES_PER_HOUR);\nexport const minutesToDays = convertsFrom(MINUTES_PER_DAY);\nexport const minutesToWeeks = convertsFrom(MINUTES_PER_WEEK);\n\nexport const isWeeksInMinutes = (minutes: number): boolean =>\n\tminutes % (MINUTES_PER_HOUR * HOURS_PER_DAY * DAYS_PER_WEEK) === 0;\nexport const isDaysInMinutes = (minutes: number): boolean =>\n\tminutes % (MINUTES_PER_HOUR * HOURS_PER_DAY) === 0;\nexport const isHoursInMinutes = (minutes: number): boolean => minutes % MINUTES_PER_HOUR === 0;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { ReactElement, useCallback, useMemo } from 'react';\n\nimport { Select } from '@zextras/carbonio-design-system';\nimport { FOLDERS, LinkFolder, ROOT_NAME, useUserSettings } from '@zextras/carbonio-shell-ui';\nimport { filter, find, map, reject } from 'lodash';\nimport { useTranslation } from 'react-i18next';\n\nimport LabelFactory, { ItemFactory } from './select-label-factory';\nimport {\n\tgetRootAccountId,\n\tuseFoldersMap,\n\tuseFoldersMapByRoot\n} from '../../../carbonio-ui-commons/store/zustand/folder';\nimport { isTrashOrNestedInIt } from '../../../carbonio-ui-commons/store/zustand/folder/utils';\nimport { Folder } from '../../../carbonio-ui-commons/types/folder';\nimport { hasId } from '../../../carbonio-ui-commons/worker/handle-message';\nimport { PREFS_DEFAULTS } from '../../../constants';\nimport {\n\tsetCalendarColor,\n\tsetCalendarColorFromNumber\n} from '../../../normalizations/normalizations-utils';\n\ntype CalendarSelectorProps = {\n\tcalendarId: string;\n\tonCalendarChange: (calendar: Folder) => void;\n\tlabel?: string;\n\texcludeTrash?: boolean;\n\tshowCalWithWritePerm?: boolean;\n\tdisabled?: boolean;\n};\n\nexport const CalendarSelector = ({\n\tcalendarId,\n\tonCalendarChange,\n\tlabel,\n\texcludeTrash = false,\n\tshowCalWithWritePerm = true,\n\tdisabled\n}: CalendarSelectorProps): ReactElement | null => {\n\tconst [t] = useTranslation();\n\tconst rootAccountId = getRootAccountId(calendarId);\n\n\tconst allCalendarsByRoot = useFoldersMapByRoot(rootAccountId ?? FOLDERS.USER_ROOT);\n\tconst allCalendars = useFoldersMap();\n\n\tconst calendars = reject(\n\t\trootAccountId?.includes(':') ? allCalendarsByRoot : allCalendars,\n\t\t(item) => item.name === ROOT_NAME || (item as LinkFolder).oname === ROOT_NAME\n\t);\n\n\tconst { zimbraPrefDefaultCalendarId } = useUserSettings().prefs;\n\n\tconst calWithWritePerm = useMemo(\n\t\t() =>\n\t\t\tshowCalWithWritePerm\n\t\t\t\t? filter(calendars, (calendar) =>\n\t\t\t\t\t\tcalendar.perm ? /w/.test(calendar.perm) : !(calendar as LinkFolder).owner\n\t\t\t\t\t)\n\t\t\t\t: calendars,\n\t\t[calendars, showCalWithWritePerm]\n\t);\n\n\tconst requiredCalendars = useMemo(\n\t\t() =>\n\t\t\texcludeTrash\n\t\t\t\t? filter(calWithWritePerm, (cal) => !isTrashOrNestedInIt(cal))\n\t\t\t\t: calWithWritePerm,\n\t\t[calWithWritePerm, excludeTrash]\n\t);\n\tconst calendarItems = useMemo(\n\t\t() =>\n\t\t\tmap(requiredCalendars, (cal) => {\n\t\t\t\tconst color = setCalendarColor({ color: cal.color, rgb: cal.rgb });\n\t\t\t\tconst labelName = hasId(cal, FOLDERS.CALENDAR) ? t('label.calendar', 'Calendar') : cal.name;\n\t\t\t\treturn {\n\t\t\t\t\t...cal,\n\t\t\t\t\tlabel: labelName,\n\t\t\t\t\tvalue: cal.id,\n\t\t\t\t\tcolor: color.color,\n\t\t\t\t\tcustomComponent: (\n\t\t\t\t\t\t<ItemFactory\n\t\t\t\t\t\t\tdisabled={disabled ?? false}\n\t\t\t\t\t\t\tabsFolderPath={cal.absFolderPath}\n\t\t\t\t\t\t\tcolor={color.color}\n\t\t\t\t\t\t\tisLink={cal.isLink}\n\t\t\t\t\t\t\tlabel={labelName}\n\t\t\t\t\t\t\tacl={cal.acl}\n\t\t\t\t\t\t\tid={cal.id}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)\n\t\t\t\t};\n\t\t\t}),\n\t\t[disabled, requiredCalendars, t]\n\t);\n\n\tconst defaultCalendarSelection = useMemo(() => {\n\t\tconst defaultCal = find(requiredCalendars, [\n\t\t\t'id',\n\t\t\tzimbraPrefDefaultCalendarId ?? PREFS_DEFAULTS?.DEFAULT_CALENDAR_ID\n\t\t]);\n\t\tconst defaultCalendar = {\n\t\t\tid: requiredCalendars?.[0]?.id ?? defaultCal?.id,\n\t\t\tacl: requiredCalendars?.[0]?.acl ?? defaultCal?.acl,\n\t\t\tisLink: requiredCalendars?.[0]?.isLink ?? defaultCal?.isLink,\n\t\t\tabsFolderPath: requiredCalendars?.[0]?.absFolderPath ?? defaultCal?.absFolderPath,\n\t\t\tvalue: requiredCalendars?.[0]?.id ?? defaultCal?.id,\n\t\t\tlabel: requiredCalendars?.[0]?.name ?? defaultCal?.name,\n\t\t\tcolor: requiredCalendars?.[0]?.color\n\t\t\t\t? setCalendarColorFromNumber(requiredCalendars?.[0]?.color).color\n\t\t\t\t: defaultCal?.color\n\t\t};\n\t\treturn find(calendarItems, ['value', calendarId]) ?? defaultCalendar;\n\t}, [requiredCalendars, zimbraPrefDefaultCalendarId, calendarItems, calendarId]);\n\n\tconst onSelectedCalendarChange = useCallback(\n\t\t(id) => {\n\t\t\tconst calendar = find(calendars, ['id', id]) ?? requiredCalendars[0];\n\t\t\treturn onCalendarChange(calendar);\n\t\t},\n\t\t[calendars, onCalendarChange, requiredCalendars]\n\t);\n\n\treturn calendars && defaultCalendarSelection ? (\n\t\t<Select\n\t\t\tlabel={label || t('label.calendar', 'Calendar')}\n\t\t\tonChange={onSelectedCalendarChange}\n\t\t\titems={calendarItems}\n\t\t\tmaxWidth={'fill'}\n\t\t\tdefaultSelection={defaultCalendarSelection}\n\t\t\tdisablePortal\n\t\t\tdisabled={disabled}\n\t\t\tLabelFactory={LabelFactory}\n\t\t\tbackground=\"white\"\n\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t/>\n\t) : null;\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { useMemo } from 'react';\n\nimport { ChipItem, Row, Text } from '@zextras/carbonio-design-system';\nimport { find, intersectionBy, isNil, startsWith } from 'lodash';\nimport moment from 'moment';\n\nimport {\n\tAttendeesAvailabilityListType,\n\tAttendeesAvailabilityType\n} from '../../../hooks/use-attendees-availability';\nimport { useAppSelector } from '../../../store/redux/hooks';\nimport {\n\tselectEditorAllDay,\n\tselectEditorEnd,\n\tselectEditorStart\n} from '../../../store/selectors/editor';\nimport { Editor } from '../../../types/editor';\n\nexport const getIsBusyAtTimeOfTheEvent = (\n\titem: AttendeesAvailabilityType,\n\tstart: Editor['start'],\n\tend: Editor['end'],\n\tattendeesAvailabilityList: AttendeesAvailabilityListType,\n\tisAllDay: Editor['allDay']\n): boolean => {\n\tif (start && end && attendeesAvailabilityList && !isNil(isAllDay)) {\n\t\tconst startDate = moment(start);\n\t\tconst endDate = moment(end);\n\n\t\tconst startDay = startDate.format('DDMMYYYY');\n\t\tconst endDay = endDate.format('DDMMYYYY');\n\t\tconst diffInDays = endDate.diff(startDate, 'days');\n\t\tconst startHour = startDate.format('HHmm');\n\t\tconst endHour = endDate.format('HHmm');\n\n\t\tif (isAllDay) {\n\t\t\tconst diffInDaysAllDay = endDate\n\t\t\t\t.add(1, 'day')\n\t\t\t\t.startOf('day')\n\t\t\t\t.diff(startDate.startOf('day'), 'days');\n\t\t\treturn diffInDaysAllDay > 1\n\t\t\t\t? false\n\t\t\t\t: !!find(\n\t\t\t\t\t\t(item.t ?? []).concat(item.b ?? []),\n\t\t\t\t\t\t(slot) =>\n\t\t\t\t\t\t\tmoment(slot.s).format('DD') === startDate.format('DD') ||\n\t\t\t\t\t\t\tmoment(slot.e).format('DD') === startDate.format('DD')\n\t\t\t\t\t);\n\t\t}\n\n\t\t// from 00:00 to 00:00\n\t\tconst lastsEntireDay = diffInDays === 1 && startHour === endHour && startsWith(startHour, '00');\n\t\tconst endsTheSameDay = startDay === endDay;\n\t\tif (lastsEntireDay || endsTheSameDay) {\n\t\t\treturn !!find(\n\t\t\t\t(item.t ?? []).concat(item.b ?? []),\n\t\t\t\t(slot) =>\n\t\t\t\t\t// appointment starts while attendee is busy\n\t\t\t\t\t(start > slot.s && start < slot.e) ||\n\t\t\t\t\t// the appointment ends while attendee is busy\n\t\t\t\t\t(end > slot.s && end < slot.e) ||\n\t\t\t\t\t// the appointment starts before the attendee is busy and ends after the attendee is busy\n\t\t\t\t\t(start < slot.s && end > slot.e) ||\n\t\t\t\t\t// the appointment starts when the attendee has another appointment starting at the same time\n\t\t\t\t\tstart === slot.s ||\n\t\t\t\t\t// the appointment ends when the attendee has another appointment ending at the same time\n\t\t\t\t\tend === slot.e\n\t\t\t);\n\t\t}\n\t}\n\n\treturn false;\n};\n\nexport const EditorAvailabilityWarningRow = ({\n\tlabel,\n\tlist,\n\titems,\n\teditorId\n}: {\n\tlabel: string;\n\tlist: AttendeesAvailabilityListType;\n\titems: ChipItem[];\n\teditorId: string;\n}): JSX.Element | null => {\n\tconst start = useAppSelector(selectEditorStart(editorId));\n\tconst end = useAppSelector(selectEditorEnd(editorId));\n\tconst allDay = useAppSelector(selectEditorAllDay(editorId));\n\n\tconst availableRooms = useMemo(() => intersectionBy(list, items ?? [], 'email'), [items, list]);\n\n\tconst anyoneIsBusyAtTimeOfEvent = useMemo(\n\t\t() =>\n\t\t\t!!find(availableRooms, (item) => getIsBusyAtTimeOfTheEvent(item, start, end, list, allDay)),\n\t\t[allDay, list, availableRooms, end, start]\n\t);\n\n\treturn anyoneIsBusyAtTimeOfEvent ? (\n\t\t<Row height=\"fit\" width=\"fill\" mainAlignment={'flex-start'} padding={{ top: 'small' }}>\n\t\t\t<Text size=\"small\" color=\"error\">\n\t\t\t\t{label}\n\t\t\t</Text>\n\t\t</Row>\n\t) : null;\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { ReactElement, useMemo } from 'react';\n\nimport {\n\tContainer,\n\tPadding,\n\tText,\n\tRow,\n\tIcon,\n\tTextProps,\n\tIconProps,\n\tSelectItem,\n\tLabelFactoryProps,\n\tTooltip\n} from '@zextras/carbonio-design-system';\nimport { useTranslation } from 'react-i18next';\nimport styled from 'styled-components';\n\nimport { useRoot } from '../../../carbonio-ui-commons/store/zustand/folder';\nimport { FOLDERS } from '../../../carbonio-ui-commons/test/mocks/carbonio-shell-ui-constants';\nimport { Grant } from '../../../carbonio-ui-commons/types/folder';\nimport { isLinkChild } from '../../../commons/utilities';\n\nexport const Square = styled.div`\n\twidth: 1rem;\n\theight: 1rem;\n\tbackground: ${({ color }): string | undefined => color};\n\tborder-radius: 0.25rem;\n\topacity: ${({ disabled }: { disabled?: boolean }): number => (disabled ? 0.5 : 1)};\n`;\n\nexport const ColorContainer = styled(Container)`\n\tborder-bottom: 0.0625rem solid ${({ theme }): string => theme.palette.gray2.regular};\n`;\n\nexport const TextUpperCase = styled(Text)`\n\ttext-transform: capitalize;\n\ttext-overflow: ellipsis;\n\twhite-space: nowrap;\n\tcolor: ${({ theme, disabled, color }): string => {\n\t\tif (color) {\n\t\t\treturn disabled ? theme.palette.text.disabled : color;\n\t\t}\n\t\treturn disabled ? theme.palette.text.disabled : theme.palette.text.regular;\n\t}};\n`;\n\nexport const LabelText = styled(Text)<TextProps & { $showPrimary?: boolean }>`\ncolor: ${({ theme, disabled, $showPrimary }): string =>\n\t// eslint-disable-next-line no-nested-ternary\n\tdisabled\n\t\t? theme.palette.text.disabled\n\t\t: $showPrimary\n\t\t\t? theme.palette.primary.regular\n\t\t\t: theme.palette.secondary.regular}};`;\n\nexport const StyledIcon = styled(Icon)<IconProps & { $showPrimary?: boolean }>`\ncolor: ${({ theme, disabled, $showPrimary }): string =>\n\t// eslint-disable-next-line no-nested-ternary\n\tdisabled\n\t\t? theme.palette.text.disabled\n\t\t: $showPrimary\n\t\t\t? theme.palette.primary.regular\n\t\t\t: theme.palette.secondary.regular}};`;\n\ninterface CustomSelectItem extends SelectItem {\n\tid?: string;\n\tacl?: { grant: Array<Grant> };\n\tisLink?: boolean;\n\tabsFolderPath?: string | undefined;\n\tcolor?: string;\n}\n\ninterface CustomLabelFactoryProps extends LabelFactoryProps {\n\tselected: CustomSelectItem[];\n}\n\nconst RowWithIcon = ({\n\ticon,\n\tcolor,\n\ttooltipText\n}: {\n\ticon: string;\n\tcolor: string;\n\ttooltipText: string;\n}): JSX.Element => (\n\t<Padding left=\"small\">\n\t\t<Tooltip placement=\"right\" label={tooltipText}>\n\t\t\t<Row>\n\t\t\t\t<Icon icon={icon} color={color} size=\"medium\" />\n\t\t\t</Row>\n\t\t</Tooltip>\n\t</Padding>\n);\n\nexport const ItemFactory = ({\n\tid,\n\tcolor,\n\tlabel,\n\tacl,\n\tisLink,\n\tabsFolderPath,\n\tdisabled\n}: {\n\tid: string | undefined;\n\tcolor: string | undefined;\n\tlabel: string;\n\tacl?: { grant: Array<Grant> };\n\tisLink?: boolean;\n\tabsFolderPath?: string | undefined;\n\tdisabled: boolean;\n}): JSX.Element => {\n\tconst [t] = useTranslation();\n\tconst root = useRoot(id ?? '');\n\tconst sharedStatusIcon = useMemo(() => {\n\t\tif (isLink || isLinkChild({ absFolderPath })) {\n\t\t\tconst tooltipText = t('tooltip.folder_linked_status', 'Linked to me');\n\t\t\treturn <RowWithIcon icon={'Linked'} color={'linked'} tooltipText={tooltipText} />;\n\t\t}\n\t\tif (acl?.grant) {\n\t\t\tconst tooltipText = t('tooltip.calendar_sharing_status', {\n\t\t\t\tcount: acl?.grant?.length,\n\t\t\t\tdefaultValue_one: 'Shared with 1 person',\n\t\t\t\tdefaultValue_other: 'Shared with {{count}} people'\n\t\t\t});\n\t\t\treturn <RowWithIcon icon={'Shared'} color={'shared'} tooltipText={tooltipText} />;\n\t\t}\n\t\treturn null;\n\t}, [absFolderPath, acl?.grant, isLink, t]);\n\treturn (\n\t\t<Row wrap={'nowrap'}>\n\t\t\t<Padding right=\"small\">\n\t\t\t\t<Square color={color} disabled={disabled} />\n\t\t\t</Padding>\n\t\t\t<TextUpperCase disabled={disabled}>{label}</TextUpperCase>\n\t\t\t{sharedStatusIcon}\n\t\t\t<Row takeAvailableSpace>\n\t\t\t\t{root && root.id !== FOLDERS.USER_ROOT && (\n\t\t\t\t\t<Padding left=\"small\" style={{ overflow: 'hidden' }}>\n\t\t\t\t\t\t<TextUpperCase color={'gray1'}>{`(${root.name})`}</TextUpperCase>\n\t\t\t\t\t</Padding>\n\t\t\t\t)}\n\t\t\t</Row>\n\t\t</Row>\n\t);\n};\n\nconst LabelFactory = (item: CustomLabelFactoryProps): ReactElement => {\n\tconst { selected, label, open, focus, disabled } = item;\n\treturn (\n\t\t<ColorContainer\n\t\t\torientation=\"horizontal\"\n\t\t\twidth=\"fill\"\n\t\t\tcrossAlignment=\"center\"\n\t\t\tmainAlignment=\"space-between\"\n\t\t\tborderRadius=\"half\"\n\t\t\tpadding={{\n\t\t\t\tall: 'small'\n\t\t\t}}\n\t\t\tbackground={'gray5'}\n\t\t\tstyle={{ cursor: disabled ? 'no-drop' : 'pointer' }}\n\t\t>\n\t\t\t<Row width=\"100%\" takeAvailableSpace mainAlignment=\"space-between\">\n\t\t\t\t<Row\n\t\t\t\t\torientation=\"vertical\"\n\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\t\tpadding={{ left: 'small' }}\n\t\t\t\t>\n\t\t\t\t\t<LabelText size=\"small\" disabled={disabled} $showPrimary={open || focus}>\n\t\t\t\t\t\t{label}\n\t\t\t\t\t</LabelText>\n\t\t\t\t\t{selected?.[0] && (\n\t\t\t\t\t\t<ItemFactory\n\t\t\t\t\t\t\tlabel={selected[0].label}\n\t\t\t\t\t\t\tcolor={selected[0].color}\n\t\t\t\t\t\t\tisLink={selected[0].isLink}\n\t\t\t\t\t\t\tabsFolderPath={selected[0].absFolderPath}\n\t\t\t\t\t\t\tacl={selected[0].acl}\n\t\t\t\t\t\t\tid={selected[0].id}\n\t\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</Row>\n\t\t\t</Row>\n\t\t\t<StyledIcon\n\t\t\t\tsize=\"large\"\n\t\t\t\ticon={open ? 'ChevronUpOutline' : 'ChevronDownOutline'}\n\t\t\t\tdisabled={disabled}\n\t\t\t\t$showPrimary={open || focus}\n\t\t\t\tstyle={{ alignSelf: 'center' }}\n\t\t\t/>\n\t\t</ColorContainer>\n\t);\n};\nexport default LabelFactory;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { useMemo } from 'react';\n\nimport { Row, Select, Text, Padding, Icon, Container } from '@zextras/carbonio-design-system';\nimport { ZIMBRA_STANDARD_COLORS } from '@zextras/carbonio-shell-ui';\n\nimport { ColorContainer, Square, TextUpperCase } from './styled-components';\n\nconst LabelFactory = ({ selected, label, open, focus }) => (\n\t<ColorContainer\n\t\torientation=\"horizontal\"\n\t\twidth=\"fill\"\n\t\tcrossAlignment=\"center\"\n\t\tmainAlignment=\"space-between\"\n\t\tborderRadius=\"half\"\n\t\tbackground=\"gray5\"\n\t\tpadding={{\n\t\t\tall: 'small'\n\t\t}}\n\t>\n\t\t<Row width=\"100%\" takeAvailableSpace mainAlignment=\"space-between\">\n\t\t\t<Row\n\t\t\t\torientation=\"vertical\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\tpadding={{ left: 'small' }}\n\t\t\t>\n\t\t\t\t<Text size=\"small\" color={open || focus ? 'primary' : 'secondary'}>\n\t\t\t\t\t{label}\n\t\t\t\t</Text>\n\t\t\t\t<TextUpperCase>{selected[0].label}</TextUpperCase>\n\t\t\t</Row>\n\t\t\t<Padding right=\"small\">\n\t\t\t\t<Square color={ZIMBRA_STANDARD_COLORS[Number(selected[0].value)].hex} />\n\t\t\t</Padding>\n\t\t</Row>\n\t\t<Icon\n\t\t\tsize=\"large\"\n\t\t\ticon={open ? 'ChevronUpOutline' : 'ChevronDownOutline'}\n\t\t\tcolor={open || focus ? 'primary' : 'secondary'}\n\t\t\tstyle={{ alignSelf: 'center' }}\n\t\t/>\n\t</ColorContainer>\n);\n\nconst getStatusItems = (t) =>\n\tZIMBRA_STANDARD_COLORS.map((el, index) => ({\n\t\tlabel: t(el.zLabel),\n\t\tvalue: index.toString(),\n\t\tcustomComponent: (\n\t\t\t<Container\n\t\t\t\twidth=\"100%\"\n\t\t\t\ttakeAvailableSpace\n\t\t\t\tmainAlignment=\"space-between\"\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\theight=\"fit\"\n\t\t\t>\n\t\t\t\t<Padding left=\"small\">\n\t\t\t\t\t<TextUpperCase>{t(el.zLabel)}</TextUpperCase>\n\t\t\t\t</Padding>\n\t\t\t\t<Square color={el.hex} />\n\t\t\t</Container>\n\t\t)\n\t}));\n\nexport default function ColorSelect({ t, onChange, defaultColor = 0, label }) {\n\tconst colors = useMemo(() => getStatusItems(t), [t]);\n\tconst defaultSelection = useMemo(() => colors[defaultColor], [colors, defaultColor]);\n\treturn (\n\t\t<Select\n\t\t\tlabel={label}\n\t\t\tonChange={onChange}\n\t\t\titems={colors}\n\t\t\tdefaultSelection={defaultSelection}\n\t\t\tLabelFactory={LabelFactory}\n\t\t/>\n\t);\n}\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React, { FC, ReactElement, useCallback, useMemo, useState } from 'react';\n\nimport { Input, Padding, Text, useSnackbar } from '@zextras/carbonio-design-system';\nimport { changeTagColor, createTag, renameTag, t } from '@zextras/carbonio-shell-ui';\n\nimport ModalFooter from '../../carbonio-ui-commons/components/modals/modal-footer';\nimport ModalHeader from '../../carbonio-ui-commons/components/modals/modal-header';\nimport { ItemType } from '../../carbonio-ui-commons/types/tags';\nimport ColorPicker from '../../commons/color-select';\nimport { itemActionRequest } from '../../soap/item-action-request';\nimport { EventType } from '../../types/event';\n\ntype ComponentProps = {\n\tonClose: () => void;\n\teditMode?: boolean;\n\ttag?: ItemType;\n\tevent?: EventType;\n};\nconst NonSupportedCharacters = /[!@#$%^&*()_+\\-=[\\]{};':\"\\\\|,.<>/?]+/;\nconst CreateUpdateTagModal: FC<ComponentProps> = ({\n\tonClose,\n\teditMode = false,\n\ttag,\n\tevent\n}): ReactElement => {\n\tconst createSnackbar = useSnackbar();\n\tconst [name, setName] = useState(tag?.name || '');\n\tconst [color, setColor] = useState(tag?.color || 0);\n\tconst title = useMemo(\n\t\t() =>\n\t\t\teditMode\n\t\t\t\t? t('label.edit_tag_name', { name: tag?.name, defaultValue: 'Edit \"{{name}}\" tag' })\n\t\t\t\t: t('label.create_tag', 'Create a new Tag'),\n\t\t[editMode, tag?.name]\n\t);\n\tconst label = useMemo(() => t('label.tag_name', 'Tag name'), []);\n\tconst handleColorChange = useCallback((c: number) => setColor(c), []);\n\tconst handleNameChange = useCallback((ev) => setName(ev.target.value), []);\n\n\tconst showMaxLengthWarning = useMemo(() => name.length >= 128, [name]);\n\tconst showSpecialCharWarning = useMemo(() => NonSupportedCharacters.test(name), [name]);\n\n\tconst showWarning = useMemo(\n\t\t() => showMaxLengthWarning || showSpecialCharWarning,\n\t\t[showMaxLengthWarning, showSpecialCharWarning]\n\t);\n\tconst disabled = useMemo(() => name === '' || showWarning, [name, showWarning]);\n\n\tconst applyNewlyCreatedTag = useCallback(\n\t\t({ inviteId, tagName }) => {\n\t\t\titemActionRequest({\n\t\t\t\top: 'tag',\n\t\t\t\tid: inviteId,\n\t\t\t\ttagName\n\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `tag`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\thideButton: true,\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\tlabel: t('snackbar.tag_applied', {\n\t\t\t\t\t\t\ttag: tagName,\n\t\t\t\t\t\t\tdefaultValue: '\"{{tag}}\" tag applied'\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tautoHideTimeout: 3000\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `tag`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t},\n\t\t[createSnackbar]\n\t);\n\tconst onCreate = useCallback(\n\t\t() =>\n\t\t\tcreateTag({ name, color }).then((res) => {\n\t\t\t\tif (res.tag) {\n\t\t\t\t\tif (event) {\n\t\t\t\t\t\tapplyNewlyCreatedTag({ inviteId: event.resource.id, tagName: res.tag?.[0]?.name });\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\t\tkey: `new-tag`,\n\t\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\t\tlabel: t('messages.snackbar.tag_created', {\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\tdefaultValue: 'Tag {{name}} successfully created'\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\t\thideButton: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tonClose();\n\t\t\t}),\n\t\t[name, color, onClose, event, applyNewlyCreatedTag, createSnackbar]\n\t);\n\tconst onUpdate = useCallback(() => {\n\t\tPromise.all([renameTag(`${tag?.id}`, name), changeTagColor(`${tag?.id}`, Number(color))])\n\t\t\t.then(() => {\n\t\t\t\tonClose();\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `update-tag`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\ttype: 'info',\n\t\t\t\t\tlabel: t('messages.snackbar.tag_updated', 'Tag successfully updated'),\n\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\thideButton: true\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tonClose();\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `update-tag-error`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\tlabel: t(\n\t\t\t\t\t\t'messages.snackbar.tag_not_updated',\n\t\t\t\t\t\t'Something went wrong, tag not updated. Please try again.'\n\t\t\t\t\t),\n\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\thideButton: true\n\t\t\t\t});\n\t\t\t});\n\t}, [color, createSnackbar, name, onClose, tag]);\n\n\treturn (\n\t\t<>\n\t\t\t<ModalHeader onClose={onClose} title={title} />\n\t\t\t<Input\n\t\t\t\tlabel={label}\n\t\t\t\tvalue={name}\n\t\t\t\tonChange={handleNameChange}\n\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\ttextColor={showWarning ? 'error' : 'text'}\n\t\t\t\thasError={showWarning}\n\t\t\t/>\n\n\t\t\t{showWarning && (\n\t\t\t\t<Padding all=\"small\">\n\t\t\t\t\t{showMaxLengthWarning && (\n\t\t\t\t\t\t<Text size=\"extrasmall\" color=\"error\" overflow=\"break-word\">\n\t\t\t\t\t\t\t{t('label.tag_max_length', 'Max 128 characters are allowed')}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t)}\n\t\t\t\t\t{showSpecialCharWarning && (\n\t\t\t\t\t\t<Text size=\"extrasmall\" color=\"error\" overflow=\"break-word\">\n\t\t\t\t\t\t\t{t('label.no_special_char_allowed', 'Name should not contain any special character')}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t)}\n\t\t\t\t</Padding>\n\t\t\t)}\n\n\t\t\t<Padding top=\"small\" />\n\t\t\t<ColorPicker\n\t\t\t\tonChange={handleColorChange}\n\t\t\t\tt={t}\n\t\t\t\tlabel={t('label.select_color', 'Select Color')}\n\t\t\t\tdefaultColor={color}\n\t\t\t/>\n\t\t\t<ModalFooter\n\t\t\t\tonConfirm={editMode ? onUpdate : onCreate}\n\t\t\t\tlabel={editMode ? t('label.edit', 'edit') : t('label.create', 'Create')}\n\t\t\t\tdisabled={disabled}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default CreateUpdateTagModal;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React, { FC, useCallback, useMemo } from 'react';\n\nimport { Container, Text, useSnackbar } from '@zextras/carbonio-design-system';\nimport { deleteTag, t } from '@zextras/carbonio-shell-ui';\n\nimport type { DeleteTagModalPropsType } from '../../types/sidebar';\nimport ModalFooter from '../modals/modal-footer';\nimport ModalHeader from '../modals/modal-header';\n\nconst DeleteTagModal: FC<DeleteTagModalPropsType> = ({ onClose, tag }) => {\n\tconst createSnackbar = useSnackbar();\n\n\tconst title = useMemo(\n\t\t() =>\n\t\t\tt('label.delete_tag_name', {\n\t\t\t\tname: tag?.name,\n\t\t\t\tdefaultValue: 'Delete \"{{name}}\" tag'\n\t\t\t}),\n\t\t[tag?.name]\n\t);\n\n\tconst onConfirm = useCallback(() => {\n\t\tif (tag)\n\t\t\tdeleteTag(tag?.id).then((res: any) => {\n\t\t\t\tif (res.action) {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `delete-tag`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\tlabel: t('messages.snackbar.tag_deleted', {\n\t\t\t\t\t\t\tname: tag?.name,\n\t\t\t\t\t\t\tdefaultValue: '{{name}} Tag deleted successfully'\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tonClose();\n\t\t\t});\n\t}, [createSnackbar, onClose, tag]);\n\n\treturn (\n\t\t<>\n\t\t\t<ModalHeader onClose={onClose} title={title} />\n\t\t\t<Container padding={{ horizontal: 'large' }}>\n\t\t\t\t<Text>\n\t\t\t\t\t{t('message.delete_tag_message1', {\n\t\t\t\t\t\tname: tag?.name,\n\t\t\t\t\t\tdefaultValue: `Are you sure to delete \"{{name}}\" Tag?`\n\t\t\t\t\t})}\n\t\t\t\t</Text>\n\t\t\t\t<Text overflow=\"break-word\" style={{ textAlign: 'center' }}>\n\t\t\t\t\t{t(\n\t\t\t\t\t\t'message.delete_tag_message2',\n\t\t\t\t\t\t'Once deleted, it will be removed from every item marked with it.'\n\t\t\t\t\t)}\n\t\t\t\t</Text>\n\t\t\t</Container>\n\t\t\t<ModalFooter\n\t\t\t\tonConfirm={onConfirm}\n\t\t\t\tlabel={t('label.delete', 'Delete')}\n\t\t\t\tdisabled={false}\n\t\t\t\tcolor=\"error\"\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default DeleteTagModal;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { ReactElement, SyntheticEvent, useCallback, useMemo, useState } from 'react';\n\nimport {\n\tButton,\n\tCheckbox,\n\tCreateModalFn,\n\tCreateSnackbarFn,\n\tIcon,\n\tPadding,\n\tRow,\n\tText,\n\tuseModal,\n\tuseSnackbar\n} from '@zextras/carbonio-design-system';\nimport { ZIMBRA_STANDARD_COLORS, useTags, Tag, t } from '@zextras/carbonio-shell-ui';\nimport { differenceBy, includes, noop, reduce } from 'lodash';\n\nimport CreateUpdateTagModal from './create-update-tag-modal';\nimport DeleteTagModal from '../../carbonio-ui-commons/components/tags/delete-tag-modal';\nimport { ItemType } from '../../carbonio-ui-commons/types/tags';\nimport { itemActionRequest } from '../../soap/item-action-request';\nimport { StoreProvider } from '../../store/redux';\nimport { ActionsProps } from '../../types/actions';\nimport { EventActionsEnum, EventActionsId } from '../../types/enums/event-actions-enum';\nimport { EventType } from '../../types/event';\nimport { TagType } from '../../types/tags';\n\nexport type ReturnType = {\n\tid: EventActionsId;\n\ticon: string;\n\tlabel: string;\n\tonClick?: (arg: React.SyntheticEvent<EventTarget> | KeyboardEvent) => void;\n\titems?: Array<{\n\t\tcustomComponent: ReactElement;\n\t\tid: string;\n\t\ticon: string;\n\t\tlabel: string;\n\t}>;\n};\n\nexport type ArgumentType = {\n\tcreateModal?: CreateModalFn;\n\tcreateSnackbar?: CreateSnackbarFn;\n\titems?: ReturnType;\n\ttag?: ItemType;\n};\n\nconst labelTag: string = t('label.tags', 'Tags');\n\nexport const createTag = ({ createModal }: ArgumentType): ReturnType => ({\n\tid: EventActionsEnum.NEW_TAG,\n\ticon: 'TagOutline',\n\tlabel: t('label.create_tag', 'Create Tag'),\n\tonClick: (e): void => {\n\t\tif (e) {\n\t\t\te.stopPropagation();\n\t\t}\n\n\t\tconst closeModal = createModal?.(\n\t\t\t{\n\t\t\t\tchildren: (\n\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t<CreateUpdateTagModal onClose={(): void => closeModal?.()} />\n\t\t\t\t\t</StoreProvider>\n\t\t\t\t)\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n});\n\nexport const createAndApplyTag = ({\n\tcontext,\n\tevent\n}: {\n\tcontext: ActionsProps['context'];\n\tevent: EventType;\n}): ReturnType => ({\n\tid: EventActionsEnum.NEW_TAG,\n\ticon: 'TagOutline',\n\tlabel: t('label.create_tag', 'Create Tag'),\n\tonClick: (e: SyntheticEvent<EventTarget> | KeyboardEvent): void => {\n\t\tif (e) {\n\t\t\te.stopPropagation();\n\t\t}\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t// @ts-ignore\n\t\tconst closeModal = context.createModal(\n\t\t\t{\n\t\t\t\tchildren: (\n\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t<CreateUpdateTagModal onClose={(): void => closeModal()} event={event} />\n\t\t\t\t\t</StoreProvider>\n\t\t\t\t)\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n});\nexport const editTag = ({ createModal, tag }: ArgumentType): ReturnType => ({\n\tid: EventActionsEnum.EDIT_TAGS,\n\ticon: 'Edit2Outline',\n\tlabel: t('label.edit_tag', 'Edit Tag'),\n\tonClick: (e): void => {\n\t\tif (e) {\n\t\t\te.stopPropagation();\n\t\t}\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t// @ts-ignore\n\t\tconst closeModal = createModal(\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tchildren: (\n\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t<CreateUpdateTagModal onClose={(): void => closeModal()} tag={tag} editMode />\n\t\t\t\t\t</StoreProvider>\n\t\t\t\t)\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n});\n\nexport const deleteTag = ({ createModal, tag }: ArgumentType): ReturnType => ({\n\tid: EventActionsEnum.DELETE_TAG,\n\ticon: 'Untag',\n\tlabel: t('label.delete_tag', 'Delete Tag'),\n\tonClick: (e): void => {\n\t\tif (e) {\n\t\t\te.stopPropagation();\n\t\t}\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t// @ts-ignore\n\t\tconst closeModal = createModal(\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tchildren: (\n\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t<DeleteTagModal onClose={(): void => closeModal()} tag={tag} />\n\t\t\t\t\t</StoreProvider>\n\t\t\t\t)\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n});\n\nexport const TagsDropdownItem = ({ tag, event }: { tag: Tag; event: EventType }): ReactElement => {\n\tconst createSnackbar = useSnackbar();\n\n\tconst [checked, setChecked] = useState(includes(event.resource.tags, tag.id));\n\tconst [isHovering, setIsHovering] = useState(false);\n\tconst toggleCheck = useCallback(\n\t\t(value) => {\n\t\t\tsetChecked((c) => !c);\n\n\t\t\titemActionRequest({\n\t\t\t\top: value ? '!tag' : 'tag',\n\t\t\t\tid: event.resource.id,\n\t\t\t\ttagName: tag.name\n\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `tag`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\thideButton: true,\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\tlabel: value\n\t\t\t\t\t\t\t? t('snackbar.tag_removed', { tag: tag.name, defaultValue: '\"{{tag}}\" tag removed' })\n\t\t\t\t\t\t\t: t('snackbar.tag_applied', {\n\t\t\t\t\t\t\t\t\ttag: tag.name,\n\t\t\t\t\t\t\t\t\tdefaultValue: '\"{{tag}}\" tag applied'\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\tautoHideTimeout: 3000\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `tag`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t},\n\t\t[event?.resource?.id, createSnackbar, tag.name]\n\t);\n\tconst tagColor = useMemo(() => ZIMBRA_STANDARD_COLORS[tag.color || 0].hex, [tag.color]);\n\tconst tagIcon = useMemo(() => (checked ? 'Tag' : 'TagOutline'), [checked]);\n\tconst tagIconOnHovered = useMemo(() => (checked ? 'Untag' : 'Tag'), [checked]);\n\n\treturn (\n\t\t<Row\n\t\t\ttakeAvailableSpace\n\t\t\tmainAlignment=\"flex-start\"\n\t\t\tonClick={(): void => toggleCheck(checked)}\n\t\t\tonMouseEnter={(): void => setIsHovering(true)}\n\t\t\tonMouseLeave={(): void => setIsHovering(false)}\n\t\t>\n\t\t\t<Padding right=\"small\">\n\t\t\t\t<Checkbox value={checked} />\n\t\t\t</Padding>\n\t\t\t<Row takeAvailableSpace mainAlignment=\"space-between\">\n\t\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\">\n\t\t\t\t\t<Text>{tag.name}</Text>\n\t\t\t\t</Row>\n\t\t\t\t<Row mainAlignment=\"flex-end\">\n\t\t\t\t\t<Icon icon={isHovering ? tagIconOnHovered : tagIcon} color={tagColor} />\n\t\t\t\t</Row>\n\t\t\t</Row>\n\t\t</Row>\n\t);\n};\n\nexport const applyTag = ({\n\tcontext,\n\tevent\n}: {\n\tevent: EventType;\n\tcontext: ActionsProps['context'];\n}): {\n\tid: EventActionsId;\n\titems: TagType[];\n\tonClick: () => void;\n\tcustomComponent?: ReactElement;\n\ttooltipLabel: string;\n\tlabel: string;\n\ticon: string;\n\tdisabled: boolean;\n} => {\n\tconst tagItem = reduce(\n\t\tcontext.tags,\n\t\t(\n\t\t\tacc: Array<{\n\t\t\t\tid: string;\n\t\t\t\tlabel?: string;\n\t\t\t\ticon?: string;\n\t\t\t\tkeepOpen: boolean;\n\t\t\t\tcustomComponent: ReactElement;\n\t\t\t}>,\n\t\t\tv\n\t\t) => {\n\t\t\tconst item = {\n\t\t\t\tid: v.id,\n\t\t\t\tlabel: v.name,\n\t\t\t\ticon: 'TagOutline',\n\t\t\t\tkeepOpen: true,\n\t\t\t\tcustomComponent: <TagsDropdownItem tag={v} event={event} />\n\t\t\t};\n\t\t\tacc.push(item);\n\t\t\treturn acc;\n\t\t},\n\t\t[]\n\t);\n\n\ttagItem.push({\n\t\tid: 'new_tag',\n\t\tkeepOpen: true,\n\t\tcustomComponent: (\n\t\t\t<Button\n\t\t\t\tlabel={t('label.new_tag', 'New Tag')}\n\t\t\t\ttype=\"outlined\"\n\t\t\t\twidth=\"fill\"\n\t\t\t\tsize=\"small\"\n\t\t\t\tonClick={(): void => context.createAndApplyTag({ context, event }).onClick()}\n\t\t\t/>\n\t\t)\n\t});\n\treturn event.haveWriteAccess\n\t\t? {\n\t\t\t\tid: EventActionsEnum.APPLY_TAG,\n\t\t\t\titems: tagItem,\n\t\t\t\tonClick: noop,\n\t\t\t\ticon: 'TagsMoreOutline',\n\t\t\t\tlabel: labelTag,\n\t\t\t\tdisabled: false,\n\t\t\t\ttooltipLabel: t('label.no_rights', 'You do not have permission to perform this action'),\n\t\t\t\tcustomComponent: (\n\t\t\t\t\t<Row takeAvailableSpace mainAlignment=\"flex-start\">\n\t\t\t\t\t\t<Padding right=\"small\">\n\t\t\t\t\t\t\t<Icon icon=\"TagsMoreOutline\" />\n\t\t\t\t\t\t</Padding>\n\t\t\t\t\t\t<Row takeAvailableSpace mainAlignment=\"space-between\">\n\t\t\t\t\t\t\t<Padding right=\"small\">\n\t\t\t\t\t\t\t\t<Text>{labelTag}</Text>\n\t\t\t\t\t\t\t</Padding>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t</Row>\n\t\t\t\t)\n\t\t\t}\n\t\t: {\n\t\t\t\tid: EventActionsEnum.APPLY_TAG,\n\t\t\t\titems: [],\n\t\t\t\tonClick: noop,\n\t\t\t\ttooltipLabel: t('label.no_rights', 'You do not have permission to perform this action'),\n\t\t\t\tlabel: labelTag,\n\t\t\t\ticon: 'TagsMoreOutline',\n\t\t\t\tdisabled: true\n\t\t\t};\n};\n\nexport const useGetTagsActions = ({ tag }: ArgumentType): Array<ReturnType> => {\n\tconst createModal = useModal();\n\tconst createSnackbar = useSnackbar();\n\treturn useMemo(\n\t\t() => [\n\t\t\tcreateTag({ createModal }),\n\t\t\teditTag({ createModal, tag }),\n\t\t\tdeleteTag({ tag, createSnackbar, createModal })\n\t\t],\n\t\t[createModal, createSnackbar, tag]\n\t);\n};\n\nexport const useTagsArrayFromStore = (): Array<TagType> => {\n\tconst tagsFromStore = useTags();\n\treturn useMemo(\n\t\t() =>\n\t\t\treduce(\n\t\t\t\ttagsFromStore,\n\t\t\t\t(acc: Array<TagType>, v: TagType) => {\n\t\t\t\t\tacc.push(v);\n\t\t\t\t\treturn acc;\n\t\t\t\t},\n\t\t\t\t[]\n\t\t\t),\n\t\t[tagsFromStore]\n\t);\n};\n\nexport const useTagExist = (tags: Array<Tag>): boolean => {\n\tconst tagsArrayFromStore = useTagsArrayFromStore();\n\treturn useMemo(\n\t\t() => tags?.length > 0 && differenceBy(tags, tagsArrayFromStore, 'id')?.length === 0,\n\t\t[tags, tagsArrayFromStore]\n\t);\n};\n","var map = {\n\t\"./af\": 6678,\n\t\"./af.js\": 6678,\n\t\"./ar\": 25295,\n\t\"./ar-dz\": 45476,\n\t\"./ar-dz.js\": 45476,\n\t\"./ar-kw\": 31348,\n\t\"./ar-kw.js\": 31348,\n\t\"./ar-ly\": 22025,\n\t\"./ar-ly.js\": 22025,\n\t\"./ar-ma\": 33478,\n\t\"./ar-ma.js\": 33478,\n\t\"./ar-ps\": 77430,\n\t\"./ar-ps.js\": 77430,\n\t\"./ar-sa\": 71018,\n\t\"./ar-sa.js\": 71018,\n\t\"./ar-tn\": 57371,\n\t\"./ar-tn.js\": 57371,\n\t\"./ar.js\": 25295,\n\t\"./az\": 63895,\n\t\"./az.js\": 63895,\n\t\"./be\": 10796,\n\t\"./be.js\": 10796,\n\t\"./bg\": 99983,\n\t\"./bg.js\": 99983,\n\t\"./bm\": 3740,\n\t\"./bm.js\": 3740,\n\t\"./bn\": 67013,\n\t\"./bn-bd\": 5046,\n\t\"./bn-bd.js\": 5046,\n\t\"./bn.js\": 67013,\n\t\"./bo\": 30393,\n\t\"./bo.js\": 30393,\n\t\"./br\": 30965,\n\t\"./br.js\": 30965,\n\t\"./bs\": 5228,\n\t\"./bs.js\": 5228,\n\t\"./ca\": 49744,\n\t\"./ca.js\": 49744,\n\t\"./cs\": 73141,\n\t\"./cs.js\": 73141,\n\t\"./cv\": 79831,\n\t\"./cv.js\": 79831,\n\t\"./cy\": 38153,\n\t\"./cy.js\": 38153,\n\t\"./da\": 15477,\n\t\"./da.js\": 15477,\n\t\"./de\": 63062,\n\t\"./de-at\": 84080,\n\t\"./de-at.js\": 84080,\n\t\"./de-ch\": 71626,\n\t\"./de-ch.js\": 71626,\n\t\"./de.js\": 63062,\n\t\"./dv\": 72168,\n\t\"./dv.js\": 72168,\n\t\"./el\": 56800,\n\t\"./el.js\": 56800,\n\t\"./en-au\": 43047,\n\t\"./en-au.js\": 43047,\n\t\"./en-ca\": 10033,\n\t\"./en-ca.js\": 10033,\n\t\"./en-gb\": 25383,\n\t\"./en-gb.js\": 25383,\n\t\"./en-ie\": 90853,\n\t\"./en-ie.js\": 90853,\n\t\"./en-il\": 65665,\n\t\"./en-il.js\": 65665,\n\t\"./en-in\": 31886,\n\t\"./en-in.js\": 31886,\n\t\"./en-nz\": 36072,\n\t\"./en-nz.js\": 36072,\n\t\"./en-sg\": 86350,\n\t\"./en-sg.js\": 86350,\n\t\"./eo\": 88684,\n\t\"./eo.js\": 88684,\n\t\"./es\": 48898,\n\t\"./es-do\": 78613,\n\t\"./es-do.js\": 78613,\n\t\"./es-mx\": 6587,\n\t\"./es-mx.js\": 6587,\n\t\"./es-us\": 4654,\n\t\"./es-us.js\": 4654,\n\t\"./es.js\": 48898,\n\t\"./et\": 78351,\n\t\"./et.js\": 78351,\n\t\"./eu\": 71733,\n\t\"./eu.js\": 71733,\n\t\"./fa\": 12401,\n\t\"./fa.js\": 12401,\n\t\"./fi\": 47303,\n\t\"./fi.js\": 47303,\n\t\"./fil\": 98889,\n\t\"./fil.js\": 98889,\n\t\"./fo\": 86588,\n\t\"./fo.js\": 86588,\n\t\"./fr\": 10500,\n\t\"./fr-ca\": 78579,\n\t\"./fr-ca.js\": 78579,\n\t\"./fr-ch\": 21445,\n\t\"./fr-ch.js\": 21445,\n\t\"./fr.js\": 10500,\n\t\"./fy\": 20235,\n\t\"./fy.js\": 20235,\n\t\"./ga\": 98789,\n\t\"./ga.js\": 98789,\n\t\"./gd\": 93110,\n\t\"./gd.js\": 93110,\n\t\"./gl\": 22881,\n\t\"./gl.js\": 22881,\n\t\"./gom-deva\": 26778,\n\t\"./gom-deva.js\": 26778,\n\t\"./gom-latn\": 55522,\n\t\"./gom-latn.js\": 55522,\n\t\"./gu\": 59273,\n\t\"./gu.js\": 59273,\n\t\"./he\": 53979,\n\t\"./he.js\": 53979,\n\t\"./hi\": 29356,\n\t\"./hi.js\": 29356,\n\t\"./hr\": 72592,\n\t\"./hr.js\": 72592,\n\t\"./hu\": 52674,\n\t\"./hu.js\": 52674,\n\t\"./hy-am\": 76846,\n\t\"./hy-am.js\": 76846,\n\t\"./id\": 30029,\n\t\"./id.js\": 30029,\n\t\"./is\": 28255,\n\t\"./is.js\": 28255,\n\t\"./it\": 9085,\n\t\"./it-ch\": 34451,\n\t\"./it-ch.js\": 34451,\n\t\"./it.js\": 9085,\n\t\"./ja\": 5864,\n\t\"./ja.js\": 5864,\n\t\"./jv\": 95688,\n\t\"./jv.js\": 95688,\n\t\"./ka\": 31848,\n\t\"./ka.js\": 31848,\n\t\"./kk\": 8786,\n\t\"./kk.js\": 8786,\n\t\"./km\": 33226,\n\t\"./km.js\": 33226,\n\t\"./kn\": 51243,\n\t\"./kn.js\": 51243,\n\t\"./ko\": 98852,\n\t\"./ko.js\": 98852,\n\t\"./ku\": 77226,\n\t\"./ku-kmr\": 74293,\n\t\"./ku-kmr.js\": 74293,\n\t\"./ku.js\": 77226,\n\t\"./ky\": 10896,\n\t\"./ky.js\": 10896,\n\t\"./lb\": 37104,\n\t\"./lb.js\": 37104,\n\t\"./lo\": 86111,\n\t\"./lo.js\": 86111,\n\t\"./lt\": 91059,\n\t\"./lt.js\": 91059,\n\t\"./lv\": 7962,\n\t\"./lv.js\": 7962,\n\t\"./me\": 74899,\n\t\"./me.js\": 74899,\n\t\"./mi\": 26642,\n\t\"./mi.js\": 26642,\n\t\"./mk\": 68949,\n\t\"./mk.js\": 68949,\n\t\"./ml\": 49043,\n\t\"./ml.js\": 49043,\n\t\"./mn\": 12241,\n\t\"./mn.js\": 12241,\n\t\"./mr\": 23022,\n\t\"./mr.js\": 23022,\n\t\"./ms\": 29403,\n\t\"./ms-my\": 4188,\n\t\"./ms-my.js\": 4188,\n\t\"./ms.js\": 29403,\n\t\"./mt\": 27104,\n\t\"./mt.js\": 27104,\n\t\"./my\": 87673,\n\t\"./my.js\": 87673,\n\t\"./nb\": 74363,\n\t\"./nb.js\": 74363,\n\t\"./ne\": 49995,\n\t\"./ne.js\": 49995,\n\t\"./nl\": 25363,\n\t\"./nl-be\": 62352,\n\t\"./nl-be.js\": 62352,\n\t\"./nl.js\": 25363,\n\t\"./nn\": 89574,\n\t\"./nn.js\": 89574,\n\t\"./oc-lnc\": 41822,\n\t\"./oc-lnc.js\": 41822,\n\t\"./pa-in\": 40430,\n\t\"./pa-in.js\": 40430,\n\t\"./pl\": 56165,\n\t\"./pl.js\": 56165,\n\t\"./pt\": 51781,\n\t\"./pt-br\": 66584,\n\t\"./pt-br.js\": 66584,\n\t\"./pt.js\": 51781,\n\t\"./ro\": 83145,\n\t\"./ro.js\": 83145,\n\t\"./ru\": 23270,\n\t\"./ru.js\": 23270,\n\t\"./sd\": 22181,\n\t\"./sd.js\": 22181,\n\t\"./se\": 86638,\n\t\"./se.js\": 86638,\n\t\"./si\": 88434,\n\t\"./si.js\": 88434,\n\t\"./sk\": 28634,\n\t\"./sk.js\": 28634,\n\t\"./sl\": 38661,\n\t\"./sl.js\": 38661,\n\t\"./sq\": 75890,\n\t\"./sq.js\": 75890,\n\t\"./sr\": 41865,\n\t\"./sr-cyrl\": 42155,\n\t\"./sr-cyrl.js\": 42155,\n\t\"./sr.js\": 41865,\n\t\"./ss\": 12220,\n\t\"./ss.js\": 12220,\n\t\"./sv\": 34292,\n\t\"./sv.js\": 34292,\n\t\"./sw\": 56803,\n\t\"./sw.js\": 56803,\n\t\"./ta\": 65669,\n\t\"./ta.js\": 65669,\n\t\"./te\": 50774,\n\t\"./te.js\": 50774,\n\t\"./tet\": 28794,\n\t\"./tet.js\": 28794,\n\t\"./tg\": 50652,\n\t\"./tg.js\": 50652,\n\t\"./th\": 48819,\n\t\"./th.js\": 48819,\n\t\"./tk\": 19620,\n\t\"./tk.js\": 19620,\n\t\"./tl-ph\": 28767,\n\t\"./tl-ph.js\": 28767,\n\t\"./tlh\": 10812,\n\t\"./tlh.js\": 10812,\n\t\"./tr\": 23935,\n\t\"./tr.js\": 23935,\n\t\"./tzl\": 40080,\n\t\"./tzl.js\": 40080,\n\t\"./tzm\": 96112,\n\t\"./tzm-latn\": 99882,\n\t\"./tzm-latn.js\": 99882,\n\t\"./tzm.js\": 96112,\n\t\"./ug-cn\": 68037,\n\t\"./ug-cn.js\": 68037,\n\t\"./uk\": 8358,\n\t\"./uk.js\": 8358,\n\t\"./ur\": 73244,\n\t\"./ur.js\": 73244,\n\t\"./uz\": 4535,\n\t\"./uz-latn\": 55334,\n\t\"./uz-latn.js\": 55334,\n\t\"./uz.js\": 4535,\n\t\"./vi\": 45622,\n\t\"./vi.js\": 45622,\n\t\"./x-pseudo\": 21161,\n\t\"./x-pseudo.js\": 21161,\n\t\"./yo\": 11517,\n\t\"./yo.js\": 11517,\n\t\"./zh-cn\": 9902,\n\t\"./zh-cn.js\": 9902,\n\t\"./zh-hk\": 17658,\n\t\"./zh-hk.js\": 17658,\n\t\"./zh-mo\": 29702,\n\t\"./zh-mo.js\": 29702,\n\t\"./zh-tw\": 73465,\n\t\"./zh-tw.js\": 73465\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 46700;"],"names":["useFoldersController","view","initializing","setInitializing","useState","seq","setSeq","notify","useNotify","useEffect","previous","getFolderRequest","then","rootFolders","getShareInfoRequest","sharedFolders","folders","sharedAccounts","filter","length","filteredLinks","reject","folder","link","async","Promise","all","map","ownerEmail","response","oname","name","owner","getFoldersByAccounts","Fault","folderWorker","op","currentView","catch","forEach","sortBy","item","isEmpty","created","modified","deleted","state","useFolderStore","createAppointmentIntegration","dispatch","context","contextToApply","pick","editor","generateEditor","panel","addBoard","url","CALENDAR_ROUTE","title","Notifications","window","Notification","requestPermission","console","warn","React","AppointmentReminderItem","reminderItem","toggleModal","removeReminder","setActiveReminder","start","id","isRecurrent","end","alarmData","location","isOrg","key","useAppDispatch","t","useTranslation","now","setNow","moment","valueOf","locationUrl","useMemo","getLocationUrl","dismissReminder","useCallback","dismissApptReminder","dismissItems","dismissedAt","reminderItems","useGetReminderItems","setSnooze","diff","alarmInstStart","beforeList","label","value","count","defaultValue_one","defaultValue_other","afterList","beforeEvent","createDropDownItem","option","onClick","type","time","isBefore","untilForBefore","set","hour","minute","subtract","snoozeApptReminder","until","add","timeToDisplay","color","size","text","getTimeToDisplayData","Text","interval","setInterval","clearInterval","Container","padding","vertical","mainAlignment","crossAlignment","orientation","Row","width","Icon","icon","target","href","rel","e","stopPropagation","top","wrap","format","Padding","left","horizontal","Tooltip","placement","IconButton","Dropdown","items","noop","toUpperCase","SetNewAppointmentTimeModal","setNewTime","height","ModalHeader","overflow","ModalFooter","onConfirm","secondaryAction","secondaryLabel","ReminderModal","reminders","setReminders","showNewTimeModal","setShowNewTimeModal","activeReminder","undefined","calendarFolders","useFoldersMap","openModal","dismissAll","a","removeFromAppList","tmp","omit","getInvite","inviteId","payload","invite","normalizeInvite","m","event","resource","calendar","isException","allDay","headerLabel","Object","keys","footerLabel","CustomModal","open","onClose","maxHeight","style","display","reminder","AppointmentReminder","appointments","useAppSelector","selectAppointmentsArray","status","selectApptStatus","useRangeStart","useRangeEnd","query","useCheckedCalendarsQuery","calendars","alarms","appts","compact","appt","isShared","l","includes","defaultCalendar","normalizeReminderItem","appointment","user","getUserAccount","iAmOrganizer","or","Date","recur","dur","loc","hasEx","find","f","zid","rid","notificationAudio","Audio","sound","reminderRange","appointmentsToRemind","nextAlarm","isSameOrAfter","isSameOrBefore","FOLDERS","searchAppointments","spanEnd","spanStart","remindersToNotify","newValue","reduce","acc","push","play","rem","showNotification","body","vibrate","dir","SyncDataHandler","refresh","useRefresh","notifyList","initialized","setInitialized","apptToUpdate","v","handleModifiedAppointments","invites","inv","handleModifiedInvites","handleDeletedAppointments","LazyCalendarView","lazy","LazyEditorView","LazySettingsView","LazySidebarView","LazySearchView","CalendarView","Suspense","fallback","Spinner","StoreProvider","ModalManager","EditorView","SettingsView","SidebarView","props","SearchView","AppRegistrations","onClickNewButton","useOnClickNewButton","ev","preventDefault","appLabel","addRoute","route","position","visible","primaryBar","secondaryBar","appView","addSettingsView","component","subSections","getSettingsSubSections","addSearchView","addBoardView","registerFunctions","CalendarIntegrations","fn","registerActions","action","disabled","group","CALENDAR_APP_ID","primary","ACTION_TYPES","registerComponents","InviteResponseComp","App","FOLDER_VIEW","primaryBtnType","secondaryBtnType","secondaryDisabled","background","secondarybackground","secondaryColor","showDivider","tooltip","secondaryTooltip","paddingTop","additionalAction","additionalBtnType","additionalColor","additionalLabel","primaryButtonIcon","cancelLabel","bottom","Divider","Button","right","maxWidth","backgroundColor","iconPlacement","showCloseIcon","takeAvailableSpace","weight","margin","search_folder","tag","conversation","message","contact","document","virtual_conversation","remote_folder","wiki","task","chat","account","omitBy","_jsns","tr","isNil","soapFetch","result","includeSelf","resolve","isFulfilled","share","create","linksIdMap","searches","updateFolder","opt","produce","data","setState","useFolder","s","getFoldersMap","getRootFolderId","parent","ROOT_NAME","useRoot","rootFolderId","getRoot","useRootsArray","split","getRootsArray","getRootAccountId","roots","root","r","some","useFoldersMapByRoot","rootId","getFlatChildrenFolders","children","getUpdateFolder","isRoot","isNestedInTrash","absFolderPath","isTrashOrNestedInIt","isTrash","hasId","destination","child","USER_ROOT","INBOX","TRASH","SPAM","SENT","DRAFTS","CONTACTS","TAGS","CONVERSATIONS","CALENDAR","ROOT","NOTEBOOK","AUTO_CONTACTS","IM_LOGS","TASKS","BRIEFCASE","getPrefs","prefs","getUserSettings","Worker","URL","roomValidationRegEx","RegExp","ROOM_DIVIDER","replaceLinkToAnchor","content","replace","createElement","anchor","startsWith","innerHTML","appendChild","trim","plainTextToHTML","str","TextMessageRenderer","convertedHTML","dangerouslySetInnerHTML","__html","HtmlMessageRenderer","msgId","parts","iframeRef","useRef","divRef","convertInRem","px","base","tempPx","String","parseInt","calculateHeight","isNull","current","scrollHeight","contentDocument","querySelector","updatedBody","useLayoutEffect","write","close","styleTag","textContent","head","append","resizeObserver","ResizeObserver","observe","disconnect","ref","className","onLoad","border","EmptyBody","extractBody","defaultMessage","exec","extractHtmlBody","htmlBody","slice","BodyMessageRenderer","fullInvite","fragment","htmlDescription","_content","originalHtml","roomHtmlDesc","htmlContent","originalText","textDescription","roomTextDesc","momentLocalizer","counter","getEndTime","duration","isNaN","disabledFields","richTextButton","attachmentsButton","saveButton","sendButton","organizer","meetingRoom","virtualRoom","equipment","attendees","optionalAttendees","freeBusySelector","calendarSelector","private","datePicker","timezone","recurrence","attachments","composer","emptyEditor","createEmptyEditor","identities","getIdentityItems","zimbraPrefCalendarDefaultApptDuration","zimbraPrefCalendarApptReminderWarningTime","zimbraPrefDefaultCalendarId","defaultOrganizer","PREFS_DEFAULTS","defaultTimezone","attach","rgb","exceptId","isSeries","isInstance","isRichText","isNew","attachmentFiles","sender","room","freeBusy","class","originalStart","originalEnd","richText","plainText","applyContextToEditor","contextObj","editorWithContext","normalizeEditor","createNewEditor","sortedList","identity","idx","_attrs","zimbraPrefFromDisplay","fromAddress","zimbraPrefFromAddress","join","address","fullName","zimbraPrefFromAddressType","identityName","Square","styled","displayName","componentId","theme","palette","gray2","regular","ColorContainer","withConfig","TextUpperCase","TagIconComponent","disableOuterTooltip","showDropdown","setShowDropdown","onIconClick","o","onDropdownClose","tags","useTags","tagItems","tagIcon","tagIconColor","ZIMBRA_STANDARD_COLORS","hex","tagName","isTagInStore","useTagExist","showMultiTagIcon","showTagIcon","tagsDropdownItems","customComponent","onMouseEnter","onMouseLeave","onFocus","onBlur","forceOpen","getMiniCal","createAsyncThunk","getState","values","checked","broken","getMiniCalRequest","c","FileExtensionRegex","isLinkChild","parentFoldersNames","pop","parentFolders","ff","isMainRootChild","calcColor","sum","i","charCodeAt","avatarColors","getFileExtension","file","match","filename","contentType","convertToDecimal","source","charCode","temp","toString","charAt","currentTime","difference","from","fromNow","getFolderTranslatedName","folderId","folderName","checkAllChildren","_folder","itemToCheck","SIDEBAR_ITEMS","recursiveToggleCheck","foldersToToggleIds","FOLDER_OPERATIONS","actions","folderAction","res","getFolderIcon","isLink","COLOR","RENAME","MOVE","DELETE","GRANT","REVOKE_GRANT","CHECK","UNCHECK","EMPTY","FREE_BUSY","PARTICIPANT_ROLE","REQUIRED","OPTIONAL","NON_PARTICIPANT","MESSAGE_METHOD","COUNTER","REQUEST","SEARCH_RESOURCES_ATTRS","EMAIL","CAL_RES_TYPE","FULL_NAME","SEARCH_RESOURCE_OP","EQUAL","WEEK_SCHEDULE","CALENDARS_STANDARD_COLORS","PANEL_VIEW","APP","BOARD","SEARCH","DEFAULT_CALENDAR_ID","HTML_OPENING_TAG","HTML_CLOSING_TAG","CALENDAR_RESOURCES","ROOM","RESOURCE","SHARE_USER_TYPE","USER","PUBLIC","PUBLIC_SHARE_ZID","DATE_FORMAT","ALL_DAY","LOCAL","UTC","UPDATE_VIEW_EVENT","DAYS_PER_WEEK","HOURS_PER_DAY","MINUTES_PER_HOUR","SECONDS_PER_MINUTE","MINUTES_PER_WEEK","MINUTES_PER_DAY","FOLDER_ACTIONS","CRB_XPROPS","CRB_XPARAMS","getFreeBusyRequest","uid","excludeUid","useAttendeesAvailability","previousStart","setPreviousStart","attendeesWithEmail","attendee","email","attendeesAvailabilityList","setAttendeesAvailabilityList","currentStartDay","newRangeStart","startOf","newRangeEnd","endOf","newAttendeesInRangeRetrievedList","usr","b","requestedDays","newAttendees","differenceBy","newAttendee","newList","concat","previousStartDay","AttendeesToRetrieve","oldItem","oldAttendeesInRangeRetrievedList","useCheckedFolders","getTimeString","_start","_end","allDayLabel","startEvent","endEvent","dayFormat","timeFormat","completeFormat","allDayString","notAllDayString","useGetEventTimezoneString","localTimezone","localStart","getLocalTime","localEnd","eventStart","eventEnd","getTimeZoneString","_timezone","tz","getTimezoneTooltip","timeString","timezoneString","localTimeString","eventTimeString","localTimezoneString","eventTimezoneString","showTimezoneTooltip","isTimezoneDifferentFromLocal","localTimezoneTooltip","eventTimezoneTooltip","retrieveAttachmentsType","original","disposition","dataID","mp","part","cd","mid","normalizeInviteParticipants","participants","groupBy","uniqBy","p","d","isOptional","role","ptst","cutype","normalizeMailPartMapFn","ret","ct","ci","findAttachments","found","getAlarmValueInMinutes","relativeTrigger","h","w","isAtTheTimeOfTheEvent","weeksToMinutes","daysToMinutes","hoursToMinutes","secondsToMinutes","getAlarmToString","alarm","trigger","seconds","weeks","days","hours","minutes","setCalendarColorFromNumber","setCalendarColor","setLightness","setCalendarColorFromRGB","normalizeApptInstancesRefs","instRefs","instRef","draft","invId","neverSent","otherAtt","ex","fr","ridZ","tzo","normalizeApptInstanceRef","normalizeAppointment","fb","fba","md","flags","ms","rev","transp","compNum","inst","normalizeAppointments","normalizeAppointmentFromNotify","comp","u","meta","normalizeAppointmentsFromNotify","getCalendarResource","perm","normalizeEventResource","iAmVisitor","iAmAttendee","hasChangesNotNotified","inviteNeverSent","hasOtherAttendees","hasException","participationStatus","apptStart","isRespRequested","normalizeCalendarEvent","instance","milliseconds","haveWriteAccess","test","normalizeCalendarEvents","cal","getVirtualRoom","xprop","xparam","getMeetingRooms","rooms","at","getEquipments","equipments","getAttendees","company","firstName","lastName","isGroup","exp","date","dateValueOf","dateInTimezone","localOffset","utcOffset","normalizeCalendarEditor","calendarId","editorType","setEditorDate","endDur","convertedStartDate","convertedEndDate","compiledEditor","alarmValue","recurrenceRule","ciFolder","apptId","alarmString","desc","descHtml","freeBusyActualStatus","isOrganizer","noBlob","rsvp","sequenceNumber","transparency","tagNamesList","tn","normalizeInviteFromSync","isEventSentFromOrganizer","isTheSameIdentity","isTheSameEmail","setResourceDate","utc","setAlarmValue","reminderInMinutes","parseFloat","unchangedProps","related","neg","isWeeksInMinutes","minutesToWeeks","isDaysInMinutes","minutesToDays","isHoursInMinutes","minutesToHours","generateParticipantInformation","isSameIdentity","isNotMyCalendar","isSharedAccount","mainAccountOrganizer","sharedCalendarOrganizer","sentFrom","organizerParticipant","lastname","getOrganizer","isAlsoSender","isSameEmail","sentBy","generateHtmlBodyRequest","app","meetingHtml","virtualRoomHtml","generateBodyRequest","virtualRoomMessage","meetingMessage","generateMp","msg","generateInvite","editorData","normalizeSoapMessageFromEditor","echo","aid","su","generalSubSection","workWeekSubSection","creatingAppointmentsSubSection","iCalSubSection","permissionsSubSection","AppointmentCard","tooltipVisible","setTooltipVisible","pushHistory","path","EventActionsEnum","useEventTimeString","isSingleAllDay","day","isMultiAllDay","isMulti","showInnerTooltip","hideInnerTooltip","onDoubleClick","borderColor","overflowY","cursor","overflowX","TextWithTooltip","AppointmentCardContainer","events","useAppointmentsInRange","setEvents","filteredCalendars","toNormalize","selectedEvents","index","Shimmer","RowContainer","AvailabilityChecker","setOpen","something","prevValue","getIsBusyAtTimeOfTheEvent","customSize","iconSize","paddingSize","InviteReplyPart","notifyOrganizer","setNotifyOrganizer","activeCalendar","setActiveCalendar","createSnackbar","useSnackbar","proposeNewTimeCb","partialEditor","messageData","isProposeNewTime","onAction","sendResponse","sendInviteResponse","updateOrganizer","replaceHistory","snackbarLabel","autoHideTimeout","moveAppointmentRequest","replies","reply","Checkbox","CalendarSelector","onCalendarChange","excludeTrash","flexGrow","flexBasis","whiteSpace","ProposedTimeReply","moveToTrash","to","openComposer","available","useIntegratedFunction","acceptProposedTime","includeContent","getAppointment","inviteToNormalize","appointmentToNormalize","res2","modifyAppointment","error","updateEditor","hideButton","decline","subject","mailToContact","mailTo","getAction","InviteContainer","sizes","extrasmall","extralarge","LinkText","InviteResponse","mailMsg","useUserAccount","rootAccountId","isAttendee","method","roomName","roomLink","meetingRooms","equipmentsString","maxReqParticipantsToShow","setMaxReqParticipantsToShow","requiredParticipants","maxOptParticipantsToShow","setMaxOptParticipantsToShow","optionalParticipants","replyMsg","obj","mail","middleName","messageHasABody","requiredSlice","fontSize","Chip","avatarLabel","batchRequest","itemActionRequest","isArray","onerror","FolderActionRequest","requestId","folderActionRequest","deleteAppointmentPermanent","rejectWithValue","dismissCalendarItemAlarmRequest","html","needExp","header","n","max","getMessageRequest","buildMessagePart","newMessage","deleteSingleInstance","meetingCanceled","originalInviteTitle","originalInviteContentPlain","originalInviteContentHtml","startAsString","endAsString","parsedStart","parseDateFromICS","parsedEnd","startToFormat","endToFormat","formatAppointmentRange","instanceData","lowerCase","originalContentHtmlSection","plainMessagePart","htmlMessagePart","moveAppointmentToTrash","entries","flatMap","_","createMessageForDelete","cancelAppointmentRequest","getInstanceExceptionId","convertDateToLocal","proposeNewTime","editors","counterAppointmentRequest","offset","arg","limit","calExpandInstEnd","calExpandInstStart","types","searchRequest","verb","rt","sendInviteReplyRequest","snoozeCalendarItemAlarmRequest","moveAppointmentToTrashPending","previousState","moveAppointmentToTrashFulfilled","moveAppointmentToTrashRejected","useDispatch","useSelector","reducers","appointmentsSliceReducer","editorSliceReducer","invitesSliceReducer","store","configureStore","devTools","reducer","combineReducers","Provider","selectAppointments","createSelector","collections","selectAppointment","selectAppointmentInstance","getSelectedEvents","idMap","k","selectEditor","selectEditorIsRichText","selectSender","selectEditorTitle","selectEditorLocation","selectEditorRoom","selectEditorAttendees","selectEditorUid","selectEditorOptionalAttendees","selectEditorAllDay","selectEditorFreeBusy","selectEditorClass","selectEditorStart","selectEditorEnd","selectEditorRichText","selectEditorPlainText","selectEditorTimezone","selectEditorReminder","selectEditorRecurrence","selectEditorRecurrenceFrequency","rule","freq","selectEditorRecurrenceInterval","ival","selectEditorRecurrenceByDay","byday","wkday","selectEditorRecurrenceUntilDate","selectEditorRecurrenceCount","num","selectEditorCalendar","selectEditorCalendarId","selectEditorIsNew","selectEditorInviteId","selectEditorAttachmentFiles","selectEditorAttachmentAid","selectEditorAttach","selectEditorDisabled","selectEditorMeetingRoom","selectEditorEquipment","deleteAppointmentPermanentlyPending","deleteAppointmentPermanentlyFulfilled","deleteAppointmentPermanentlyRejected","dismissAppointmentPending","cloneDeep","dismissAppointmentFulfilled","dismissAppointmentRejected","moveAppointmentFulfilled","searchAppointmentsPending","searchAppointmentsFulfilled","replaceAppointmentsToStore","searchAppointmentsRejected","snoozeApptReminderPending","snoozeApptReminderFulfilled","snoozeApptReminderRejected","appointmentsSlice","createSlice","initialState","handleModifiedAppointmentsReducer","oldAppt","merge","handleCreatedAppointments","handleCreatedAppointmentsReducer","norm","old","handleDeletedAppointmentsReducer","extraReducers","builder","addCase","editorSlice","newEditorReducer","editIsRichText","editIsRichTextReducer","editEditorAttachments","editEditorAttachmentsReducer","editSender","editSenderReducer","editEditorTitle","editTitleReducer","editEditorLocation","editLocationReducer","editEditorRoom","editEditorRoomReducer","union","editEditorAttendees","editEditorAttendeesReducer","editEditorOptionalAttendees","editEditorOptionalAttendeesReducer","editEditorDisplayStatus","editEditorDisplayStatusReducer","editEditorCalendar","editEditorCalendarReducer","editEditorClass","editEditorClassReducer","editEditorDate","editEditorDateReducer","editEditorMeetingRoom","editEditorMeetingRoomReducer","editEditorEquipment","editEditorEquipmentReducer","editEditorText","editEditorTextReducer","editEditorAllDay","editEditorAllDayReducer","editEditorTimezone","editEditorTimezoneReducer","editEditorReminder","editEditorReminderReducer","editEditorRecurrence","editEditorRecurrenceReducer","updateEditorReducer","getInviteFulfilled","getInviteRejected","modifyAppointmentFullfilled","proposeNewTimeFulfilled","sendInviteResponsePending","fromMail","sendInviteResponseFulfilled","sendInviteResponseRejected","invitesSlice","handleModifiedInvitesReducer","useCalendarView","useAppStatusStore","calendarView","useCalendarDate","useSummaryView","summaryViewId","useIsSummaryViewOpen","useSetRange","setRange","range","EXPAND","EDIT","EDIT_TAGS","PRINT","REPLY_ALL","FORWARD","SHOW_ORIGNAL","CREATE_COPY","REINVITE_ATT","ACCEPT","TENTATIVE","DECLINE","PROPOSE_NEW_TIME","REPLY","FIND_SHARES","EXPAND_SERIES","DELETE_PERMANENTLY","NEW_TAG","DELETE_TAG","EDIT_TAG","APPLY_TAG","INSTANCE","SERIES","SHOW_ORIGINAL","DOWNLOAD_ICS","ANSWER","CREATE_APPOINTMENT","getTimezoneOffsetFromUtc","timeZone","timeZoneName","Intl","DateTimeFormat","formatToParts","matchData","sign","getTimezoneOffset","getTime","icsString","strYear","substring","strMonth","strDay","strHourTest","strMinTest","strSecTest","strHour","strMin","strSec","dateReceived","locale","intlOptions","formattedRange","dateTimeFormat","localToApply","zimbraPrefLocale","NumberFormat","resolvedOptions","options","weekday","year","month","formatRange","converts","factor","convertsIn","convertsFrom","showCalWithWritePerm","allCalendarsByRoot","allCalendars","useUserSettings","calWithWritePerm","requiredCalendars","calendarItems","labelName","ItemFactory","acl","defaultCalendarSelection","defaultCal","onSelectedCalendarChange","Select","onChange","defaultSelection","disablePortal","LabelFactory","isAllDay","startDate","endDate","startDay","endDay","diffInDays","startHour","endHour","slot","EditorAvailabilityWarningRow","list","editorId","availableRooms","intersectionBy","LabelText","$showPrimary","secondary","StyledIcon","RowWithIcon","tooltipText","sharedStatusIcon","grant","selected","focus","borderRadius","alignSelf","Number","ColorSelect","defaultColor","colors","el","zLabel","getStatusItems","NonSupportedCharacters","CreateUpdateTagModal","editMode","setName","setColor","defaultValue","handleColorChange","handleNameChange","showMaxLengthWarning","showSpecialCharWarning","showWarning","applyNewlyCreatedTag","onCreate","createTag","onUpdate","renameTag","changeTagColor","Input","textColor","hasError","ColorPicker","DeleteTagModal","deleteTag","textAlign","labelTag","createModal","closeModal","createAndApplyTag","editTag","TagsDropdownItem","setChecked","isHovering","setIsHovering","toggleCheck","tagColor","tagIconOnHovered","applyTag","tagItem","keepOpen","tooltipLabel","useGetTagsActions","useModal","tagsArrayFromStore","useTagsArrayFromStore","tagsFromStore","webpackContext","req","webpackContextResolve","__webpack_require__","Error","code","module","exports"],"sourceRoot":""}