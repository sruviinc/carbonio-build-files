"use strict";(self.webpackChunkcarbonio_mails_ui=self.webpackChunkcarbonio_mails_ui||[]).push([[321],{9099:(e,t,a)=>{a.d(t,{l:()=>s,n:()=>i});var l=a(7196),r=a(2509),n=a(7431);const o={sortType:"date",sortDirection:"Desc",sortOrder:"dateDesc",remainingFoldersSortOrder:"",remainingSortOptions:""};function i(e,t){if(!t||!e)return o;const a=",BDLV",l=t.split(a)[0].split(","),i=(0,r.find)(l,(t=>t.substring(0,t.lastIndexOf(":"))===e)),s=a.concat(t.split(a)[1])??"",d=l.filter((t=>t.substring(0,t.lastIndexOf(":"))!==e)).join(",")??"";if(i&&!i.includes(n.A.size.value)){const e=i.substring(i.lastIndexOf(":")+1),t=e.includes("Desc")?"Desc":"Asc";return{sortType:e.split(/Asc|Desc/i)[0],sortDirection:t,sortOrder:e,remainingFoldersSortOrder:d,remainingSortOptions:s}}return o}function s({prefSortOrder:e,sortingTypeValue:t,sortingDirection:a,folderId:r}){if(!e){const e={prefs:{zimbraPrefSortOrder:`${r}:${t}${a},BDLV`}};return void(0,l.editSettings)(e)}const n=e.substring(e.indexOf(",BDLV")),o=`${r}:${t}${a}`,i=function(e,t,a){const l=new RegExp(`${a}:(.*?)(Asc|Desc)`);return l.test(e)?e.replace(l,`${t}`):`${e},${t}`}(e.split(",BDLV")[0],o,r),s={prefs:{zimbraPrefSortOrder:i+n}};(0,l.editSettings)(s)}},5322:(e,t,a)=>{a.d(t,{C:()=>n});var l=a(7559),r=a(2509);const n=({setCount:e,count:t,items:a=[]})=>{const n=(0,l.useRef)({}),[o,i]=(0,l.useState)(!1),s=(0,l.useMemo)((()=>t===a.length),[t,a.length]),d=(0,l.useCallback)((a=>{n.current[a]?(n.current=(0,r.omit)(n.current,[a]),e((e=>e-1)),t-1==0?i(!1):0===t&&i(!0)):(n.current={...n.current,[a]:!0},e((e=>e+1)),i(!0))}),[t,e]),c=(0,l.useCallback)((()=>{n.current={},e(0),i(!1)}),[e,i]),m=(0,l.useCallback)((()=>{(0,r.map)(a,(e=>{n.current[e.id]||d(e.id)}))}),[a,d,n]),u=(0,l.useCallback)((()=>{n.current={},e(0),setTimeout((()=>{i(!0)}))}),[e]);return{selected:n.current,toggle:d,deselectAll:c,isSelectModeOn:o,setIsSelectModeOn:i,selectAll:m,isAllSelected:s,selectAllModeOff:u}}},6978:(e,t,a)=>{a.d(t,{U:()=>l});const l="#c2e7ff"},4990:(e,t,a)=>{a.d(t,{i:()=>m});var l=a(7559),r=a.n(l),n=a(4702),o=a(7196),i=a(2509),s=a(9628),d=a(9902),c=a(9431);const m=({folder:e,onClose:t,headerTitle:a,actionLabel:m,actionTooltip:u,disabledActionTooltip:p,inputLabel:g,confirmAction:h,showSharedAccounts:f,showTrashFolder:b,showSpamFolder:E,allowFolderCreation:v,allowRootSelection:y})=>{const[C,w]=(0,l.useState)(e),A=(0,l.useCallback)((()=>{h(C,w,t)}),[h,C,t]),_=(0,l.useMemo)((()=>(0,i.isNil)(C)||C?.id===e?.l),[e?.l,C]),k=_?p??(0,o.t)("label.folder_not_valid_destination","The selected folder is not a valid destination"):u;return r().createElement(n.Container,{padding:{all:"large"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit",style:{overflowY:"auto"}},r().createElement(d.A,{onClose:t,title:a}),r().createElement(n.Container,{"data-testid":"select-folder-modal",padding:{all:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit",style:{overflowY:"auto"}},r().createElement(n.Container,{padding:{all:"small"},mainAlignment:"center",crossAlignment:"flex-start"},r().createElement(n.Text,{overflow:"break-word"},g)),r().createElement(c.W,{selectedFolderId:C?.id,onFolderSelected:w,showTrashFolder:b,showSpamFolder:E,allowFolderCreation:v,allowRootSelection:y,showSharedAccounts:f}),r().createElement(s.A,{tooltip:k,onConfirm:A,secondaryAction:t,label:m,secondaryLabel:(0,o.t)("label.cancel","Cancel"),disabled:_})))}},5274:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Pe});var l=a(7559),r=a.n(l),n=a(1748),o=a(4702),i=a(7196),s=a(2509),d=a(8698),c=a(4710),m=a.n(c),u=a(9628),p=a(9902),g=a(6928),h=a(9518),f=a(7625);async function b({folder:e,color:t,zid:a,op:l,name:r,l:n,recursive:o,retentionPolicy:d,type:c}){return(0,s.isEmpty)(d)?await(0,i.soapFetch)("FolderAction",{action:(0,s.omitBy)({id:e.id,op:l,l:n,recursive:o,name:r,color:t,zid:a,...c&&{type:c}},s.isNil),_jsns:"urn:zimbraMail"}):await(0,i.soapFetch)("Batch",{FolderActionRequest:[{action:{id:e.id,op:l,l:n,recursive:o,name:r,color:t},_jsns:"urn:zimbraMail"},{action:{id:e.id,op:"retentionpolicy",retentionPolicy:d},_jsns:"urn:zimbraMail"}],_jsns:"urn:zimbra"})}const E=({folder:e,onClose:t})=>{const{createSnackbar:a}=(0,f.m)(),n=(0,l.useCallback)((()=>{const l=(0,h.iQ)({folder:e});b((0,h.bc)(e.id)&&!l?{folder:e,op:g.xy.TRASH}:{folder:e,l:i.FOLDERS.TRASH,op:l?g.xy.DELETE:g.xy.MOVE}).then((t=>{a("Fault"in t?{key:"trash",replace:!0,type:"error",label:(0,i.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0}:{key:"trash-folder",replace:!0,type:"info",label:l||(0,h.bc)(e.id)?(0,i.t)("messages.snackbar.folder_deleted","Folder permanently deleted."):(0,i.t)("messages.snackbar.folder_moved_to_trash","Folder moved to trash"),autoHideTimeout:5e3,hideButton:l||(0,h.bc)(e.id),actionLabel:(0,i.t)("label.undo","Undo"),onActionClick:()=>{b({folder:e,l:e.parent,op:g.xy.MOVE}).then((e=>{a("Fault"in e?{key:"trash",replace:!0,type:"error",label:(0,i.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0}:{key:"trash-folder",replace:!0,type:"success",label:(0,i.t)("messages.snackbar.folder_restored","Folder restored"),autoHideTimeout:3e3,hideButton:!0})})).catch(i.report)}})})).catch(i.report),t()}),[a,e,t]);return e?r().createElement(o.Container,{padding:{all:"large"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},r().createElement(p.A,{title:`${(0,i.t)("label.delete","Delete")} ${e.name}`,onClose:t}),r().createElement(o.Container,{padding:{all:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},(0,s.startsWith)(e.absFolderPath,"/Trash")?r().createElement(r().Fragment,null,r().createElement(o.Text,{overflow:"break-word"},(0,i.t)("folder_panel.modal.delete.body.message2","Do you want to delete the selected folder permanently?")),r().createElement(o.Text,{overflow:"break-word"},(0,i.t)("folder_panel.modal.delete.body.message4","If you delete it, all the related content will be permanently removed and the folder will no longer be recoverable."))):r().createElement(r().Fragment,null,r().createElement(o.Text,{overflow:"break-word"},(0,i.t)("folder_panel.modal.delete.body.message1","Do you want to delete the selected folder?")),r().createElement(o.Text,{overflow:"break-word"},(0,i.t)("folder_panel.modal.delete.body.message3","If you delete it, all the related content will be moved to Trash and the folder will no longer be visible.")))),r().createElement(o.Divider,null),r().createElement(u.A,{onConfirm:n,secondaryAction:t,secondaryLabel:(0,i.t)("label.cancel","cancel"),label:(0,i.t)("action.ok","Ok"),color:"error"})):r().createElement(r().Fragment,null)},v=(0,l.createContext)({});var y=a(8032),C=a(612),w=a(2940);const A=(0,w.createAsyncThunk)("mail/sendShareNotification",(async(e,{getState:t})=>Promise.all((0,s.map)(e.contacts,((t,a)=>fetch("/service/soap/SendShareNotificationRequest",{method:"POST",headers:{"content-type":"application/soap+xml"},body:`<?xml version="1.0" encoding="utf-8"?>\n                <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope">\n                    <soap:Header>\n                        <context xmlns="urn:zimbra">\n                            <account by="name">${e.accounts[0].name}</account>\n                            <format type="js"/>\n                        </context>\n                    </soap:Header>\n                    <soap:Body>\n                    <SendShareNotificationRequest xmlns="urn:zimbraMail">\n                           <item id="${e.folder.id}"/>\n                           <e a="${t.email}"/>\n                           ${e.standardMessage.length>0?`<notes>${e.standardMessage}</notes>`:""}\n                           \n                    </SendShareNotificationRequest>\t\t\t\t\n                    </soap:Body>\n                </soap:Envelope>\n            `}).then((e=>e.json()))))))),_=m()(o.Chip).withConfig({displayName:"share-folder-properties__HoverChip",componentId:"sc-1tfr3tv-0"})(["background-color:",";"],(({theme:e,hovered:t})=>t?e.palette.gray3.hover:e.palette.gray3.regular)),k=({grant:e,shareCalendarRoleOptions:t,hovered:a})=>{const n=(0,l.useMemo)((()=>(0,C.E7)(t,e.perm||"")),[t,e.perm]),i=(0,l.useMemo)((()=>{const t=e=>`${e} - ${n}`;return e.d?t(e.d):t(e.zid)}),[e,n]);return r().createElement(o.Container,{crossAlignment:"flex-start"},r().createElement(o.Text,null,r().createElement(_,{label:i,hovered:a})))},S=({folder:e,grant:t,setActiveModal:a,onMouseLeave:n,onMouseEnter:s})=>{const d=(0,i.useUserAccounts)(),{setActiveGrant:c}=(0,l.useContext)(v),m=(0,y.j)(),u=(0,l.useCallback)((()=>{c&&c(t),a("revoke")}),[a,c,t]),{createSnackbar:p}=(0,f.m)(),g=(0,l.useCallback)((()=>{m(A({standardMessage:"",contacts:[{email:t.d}],folder:e,accounts:d})).then((t=>{t.type.includes("fulfilled")&&p({key:`resend-${e.id}`,replace:!0,type:"info",label:(0,i.t)("snackbar.share_resend","Share invite resent"),autoHideTimeout:2e3,hideButton:!0})}))}),[d,p,m,e,t.d]),h=(0,l.useCallback)((()=>{c&&c(t),a("edit")}),[a,c,t]);return r().createElement(o.Container,{orientation:"horizontal",mainAlignment:"flex-end",onMouseEnter:s,onMouseLeave:n,maxWidth:"fit"},r().createElement(o.Tooltip,{label:(0,i.t)("tooltip.edit","Edit share properties"),placement:"top"},r().createElement(o.Button,{type:"outlined",label:(0,i.t)("label.edit","Edit"),onClick:h,size:"small"})),r().createElement(o.Padding,{horizontal:"extrasmall"}),r().createElement(o.Tooltip,{label:(0,i.t)("tooltip.revoke","Revoke access"),placement:"top"},r().createElement(o.Button,{type:"outlined",label:(0,i.t)("label.revoke","Revoke"),color:"error",onClick:u,size:"small"})),r().createElement(o.Padding,{horizontal:"extrasmall"}),r().createElement(o.Tooltip,{label:(0,i.t)("tooltip.resend","Send mail notification about this share"),placement:"top",maxWidth:"18.75rem"},r().createElement(o.Button,{type:"outlined",label:(0,i.t)("label.resend","Resend"),onClick:g,size:"small"})))},R=({grant:e,folder:t,setActiveModal:a,shareCalendarRoleOptions:n})=>{const[i,s]=(0,l.useState)(!1),d=(0,l.useCallback)((()=>{s(!0)}),[]),c=(0,l.useCallback)((()=>{s(!1)}),[]);return r().createElement(o.Container,{orientation:"horizontal",mainAlignment:"flex-end",padding:{bottom:"small"}},r().createElement(k,{grant:e,shareCalendarRoleOptions:n,hovered:i}),r().createElement(S,{folder:t,onMouseLeave:c,onMouseEnter:d,grant:e,setActiveModal:a}))},F=({folder:e,setActiveModal:t})=>{const[a,n]=(0,l.useState)();(0,l.useEffect)((()=>{(0,i.soapFetch)("GetFolder",{_jsns:"urn:zimbraMail",folder:{l:e.id}}).then((e=>{e?.folder&&n(e.folder[0].acl.grant)}))}),[e.id]);const d=(0,l.useMemo)((()=>(0,C.kL)(i.t,a?.[0]?.perm?.includes("p"))),[a]);return r().createElement(o.Container,{mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},r().createElement(o.Padding,{vertical:"small"}),r().createElement(o.Text,{weight:"bold"},(0,i.t)("label.shares_folder_edit","Sharing of this folder")),r().createElement(o.Padding,{vertical:"small"}),(0,s.map)(a,(a=>r().createElement(R,{key:a?.zid,grant:a,folder:e,setActiveModal:t,shareCalendarRoleOptions:d}))),r().createElement(o.Padding,{top:"medium"}),r().createElement(o.Divider,null),r().createElement(o.Padding,{bottom:"medium"}))},x=(0,w.createAsyncThunk)("mail/shareFolder",(async e=>{const t=e?.contacts?.map(((t,a)=>({_jsns:"urn:zimbraMail",requestId:a,action:{id:e.folder.id,op:"grant",grant:{gt:"usr",d:(0,s.trim)(t.email,"<>"),perm:e.shareWithUserRole,pw:"",inh:"1"}}})));return{response:await(0,i.soapFetch)("Batch",{_jsns:"urn:zimbra",FolderActionRequest:t})}})),T=({onClose:e,folder:t,editMode:a=!1,grant:n,goBack:d})=>{const c=(0,y.j)(),[m,g]=(0,i.useIntegratedComponent)("contact-input"),h=(0,l.useMemo)((()=>(0,C.kL)(i.t)),[]),[b,E]=(0,l.useState)(!0),[v,w]=(0,l.useState)(""),[_,S]=(0,l.useState)([]),[R,F]=(0,l.useState)(a?n.perm:"r"),{createSnackbar:T}=(0,f.m)(),D=(0,i.useUserAccounts)(),O=(0,l.useMemo)((()=>a?`${(0,i.t)("label.edit_access","Edit access")} `:`${(0,i.t)("label.share","Share")} ${t.name}`),[a,t.name]),M=(0,l.useCallback)((e=>{F(e)}),[]),L=(0,l.useCallback)((()=>{c(x({sendNotification:b,standardMessage:v,contacts:a?[{email:n.d||n.zid}]:_,shareWithUserRole:R,folder:t,accounts:D})).then((l=>{"Fault"in l||(T({key:`share-${t.id}`,replace:!0,hideButton:!0,type:"info",label:a?(0,i.t)("snackbar.share_updated",'"Access rights updated"'):(0,i.t)("snackbar.folder_shared","Folder shared"),autoHideTimeout:3e3}),b&&c(A({sendNotification:b,standardMessage:v,contacts:a?[{email:n.d||n.zid}]:_,shareWithUserRole:R,folder:t,accounts:D})).then((e=>{e.type.includes("fulfilled")||T({key:`share-${t.id}`,replace:!0,type:"error",hideButton:!0,label:(0,i.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3})}))),e()}))}),[c,b,v,a,n,_,R,t,D,e,T]),P=(0,l.useMemo)((()=>n?.perm===R),[n?.perm,R]);return r().createElement(r().Fragment,null,r().createElement(o.Container,{mainAlignment:"center",crossAlignment:"flex-start",height:"fit",padding:{vertical:"small"}},r().createElement(p.A,{title:O,onClose:e}),r().createElement(o.Padding,{top:"small"}),a?r().createElement(o.Container,{orientation:"horizontal",mainAlignment:"flex-end",padding:{bottom:"large",top:"large"}},r().createElement(k,{grant:n,shareCalendarRoleOptions:h})):r().createElement(o.Container,{height:"fit",padding:{vertical:"small"}},g?r().createElement(m,{background:"gray4",placeholder:(0,i.t)("share.recipients_address","Recipients’ e-mail addresses"),onChange:e=>{S(e)},defaultValue:_}):r().createElement(o.ChipInput,{placeholder:(0,i.t)("share.recipients_address","Recipients’ e-mail addresses"),onChange:e=>{S((0,s.map)(e,(e=>({email:e}))))}})),r().createElement(o.Container,{height:"fit"},r().createElement(o.Select,{"data-testid":"share-role",items:h,background:"gray5",label:(0,i.t)("label.role","Role"),onChange:M,defaultSelection:{value:a?n?.perm:"r",label:(0,C.E7)(h,a?n?.perm:"r")}})),r().createElement(o.Container,{height:"fit",mainAlignment:"flex-start",crossAlignment:"flex-start",padding:{vertical:"medium"},"data-testid":"sendNotificationCheckboxContainer"},r().createElement(o.Checkbox,{value:b,defaultChecked:b,onClick:()=>E(!b),label:(0,i.t)("share.send_notification","Send a notification about this share")})),r().createElement(o.Container,{height:"fit"},r().createElement(o.Input,{label:(0,i.t)("share.standard_message","Add a note to the standard message"),value:v,onChange:e=>{w(e.target.value)},disabled:!b,backgroundColor:"gray5"})),r().createElement(o.Container,{orientation:"horizontal",crossAlignment:"baseline",mainAlignment:"baseline",padding:{all:"small"}},r().createElement(o.Row,{padding:{right:"small"}},r().createElement(o.Text,{weight:"bold",size:"small",color:"gray0"},"Note:")),r().createElement(o.Row,{padding:{bottom:"small"}},r().createElement(o.Text,{overflow:"break-word",size:"small",color:"gray1"},(0,i.t)("share.share_note","The standard message displays your name, the name of the shared item, pemissions granted to the recipients, and sign in information, if necessary."))))),r().createElement(u.A,{label:a?(0,i.t)("action.edit_share","Edit Share"):(0,i.t)("action.share_folder","Share folder"),onConfirm:L,disabled:a?P:_.length<1,secondaryAction:d,secondaryLabel:(0,i.t)("label.go_back","Go Back")}))},D=({folder:e})=>r().createElement(r().Fragment,null,r().createElement(o.Container,{mainAlignment:"flex-start",padding:{all:"small"},crossAlignment:"flex-start",width:"100%",orientation:"horizontal"},r().createElement(o.Row,{orientation:"vertical",width:"33.33%",crossAlignment:"flex-start"},r().createElement(o.Text,{size:"small",color:"secondary"},(0,i.t)("label.type","Type")),r().createElement(o.Padding,{top:"extrasmall"}),r().createElement(o.Text,null,(0,i.t)("label.mail_folder","E-mail folder"))),r().createElement(o.Row,{orientation:"vertical",width:"33.33%",crossAlignment:"flex-start"},r().createElement(o.Text,{size:"small",color:"secondary"},(0,i.t)("label.messages","Messages")),r().createElement(o.Padding,{top:"extrasmall"}),r().createElement(o.Text,null,e.n)),r().createElement(o.Row,{orientation:"vertical",width:"33.33%",crossAlignment:"flex-start"},r().createElement(o.Text,{size:"small",color:"secondary"},(0,i.t)("label.size","Size")),r().createElement(o.Padding,{top:"extrasmall"}),r().createElement(o.Text,null,(e=>{if(0===e)return"0 Byte";const t=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/1024**t)} ${["Bytes","KB","MB","GB","TB"][t]}`})(e.s||0)))),r().createElement(o.Divider,null),r().createElement(o.Padding,{bottom:"medium"})),O="new",M="move",L="delete",P="edit",B="empty",$="removeFromList",I="sharesInfo",z="share",H="read",N=e=>!!e.trim()&&!(/["/:]/.test(e)||e.length>128),V=(e,t)=>{const a=e.perm;switch(t){case O:return!a||!!a.includes("rwidx");case z:return!a||!!a.includes("rwidxa");default:return!0}};var W=a(6279);const U=({setInputValue:e,inpDisable:t,showWarning:a,inputValue:l,folderColor:n,setFolderColor:s})=>r().createElement(o.Container,{mainAlignment:"center",crossAlignment:"flex-start"},r().createElement(o.Input,{label:(0,i.t)("label.folder_name","Folder name"),onChange:t=>e(t.target.value),disabled:t,value:l,hasError:a&&!t,"data-testid":"folder-name"}),a&&!t&&r().createElement(o.Padding,{all:"small"},r().createElement(o.Text,{size:"small",color:"error","data-testid":"rename-error-msg"},l&&!N(l)?(0,i.t)("folder.modal.edit.invalid_folder_name_warning_msg","Special characters not allowed. Max lenght is 128 characters."):(0,i.t)("folder.modal.edit.rename_warning","You cannot rename a folder as a system one"))),r().createElement(o.Padding,{top:"small"}),r().createElement(W.A,{onChange:e=>s(e??""),label:(0,i.t)("label.select_color","Select Color"),defaultColor:parseInt(n??"0",10),"data-testid":"folder-color"})),j=({showPolicy:e,setShowPolicy:t,emptyRtnValue:a,setEmptyRtnValue:l,dsblMsgRet:n,setDsblMsgRet:s,rtnValue:d,setRtnValue:c,retentionPeriod:m,rtnYear:u,setRtnYear:p,dsblMsgDis:g,setDsblMsgDis:h,emptyDisValue:f,setEmptyDisValue:b,purgeValue:E,setPurgeValue:v,dspYear:y,setDspYear:C,rtnRange:w,dspRange:A})=>r().createElement(r().Fragment,null,r().createElement(o.Row,{orientation:"horizontal",mainAlignment:"space-between",takeAvailableSpace:!0,width:"100%"},r().createElement(o.Text,{weight:"bold",size:"large"},(0,i.t)("label.retention_policy","Retention policy")),r().createElement(o.IconButton,{size:"medium",style:{padding:0,margin:0},onClick:()=>t(!e),icon:e?"ChevronUpOutline":"ChevronDownOutline","data-testid":"retention_policy-icon"})),r().createElement(o.Collapse,{orientation:"vertical",open:e},r().createElement(o.Container,{mainAlignment:"flex-start",crossAlignment:"flex-start",padding:{top:"medium"}},r().createElement(o.Checkbox,{value:n,onClick:()=>{a&&l(!1),s(!n)},label:(0,i.t)("label.enable_message_retention","Enable Message Retention"),"data-testid":"enableMsgRetention"}),r().createElement(o.Container,{padding:{all:"small"}},r().createElement(o.Text,{overflow:"break-word"},(0,i.t)("folder.modal.edit.retention_message","Messages in this folder which fall within the retention range will require explicit confirmation before being deleted"))),r().createElement(o.Row,{mainAlignment:"space-between",padding:{vertical:"small",horizontal:"medium"},crossAlignment:"flex-start",takeAvailableSpace:!0,width:"100%",orientation:"horizontal"},r().createElement(o.Row,{orientation:"vertical",width:"48%",crossAlignment:"flex-start"},r().createElement(o.Input,{disabled:!n,onChange:e=>{a&&l(!1),c(e.target.value)},label:(0,i.t)("label.retention_range","Retention Range"),value:0===d?"":d}),a&&r().createElement(o.Padding,{all:"small"},r().createElement(o.Text,{size:"small",color:"error"},(0,i.t)("folder.modal.edit.retention_duration_warning","The retention duration must be a positive number")))),r().createElement(o.Row,{orientation:"vertical",width:"48%",crossAlignment:"flex-start"},w&&u&&r().createElement(o.Select,{disabled:!n,items:m,background:"gray5",label:(0,i.t)("label.select","Select"),disablePortal:!0,multiple:!1,onChange:p,defaultSelection:{label:w,value:u}}))),r().createElement(o.Padding,{top:"small"}),r().createElement(o.Container,{mainAlignment:"flex-start",crossAlignment:"flex-start"},r().createElement(o.Checkbox,{value:g,onClick:()=>{f&&b(!1),h(!g)},label:(0,i.t)("label.enable_message_disposal","Enable Message Disposal"),"data-testid":"enableMsgDisposal"}),r().createElement(o.Container,{padding:{all:"small"}},r().createElement(o.Text,{overflow:"break-word"},(0,i.t)("folder.modal.edit.threshold_message","Messages in this folder which are older than the disposal threshold will be subject to automated cleanup and deletion."))),r().createElement(o.Row,{mainAlignment:"space-between",padding:{vertical:"small",horizontal:"medium"},crossAlignment:"flex-start",takeAvailableSpace:!0,width:"100%",orientation:"horizontal"},r().createElement(o.Row,{orientation:"vertical",width:"48%",crossAlignment:"flex-start"},r().createElement(o.Input,{label:(0,i.t)("label.disposal_threshold","Disposal Threshold"),onChange:e=>{f&&b(!1),v(e.target.value)},disabled:!g,value:0===E?"":E}),f&&r().createElement(o.Padding,{all:"small"},r().createElement(o.Text,{size:"small",color:"error"},(0,i.t)("folder.modal.edit.retention_duration_warning","The retention duration must be a positive number")))),r().createElement(o.Row,{orientation:"vertical",width:"48%",crossAlignment:"flex-start"},A&&y&&r().createElement(o.Select,{disabled:!g,items:m,background:"gray5",label:(0,i.t)("label.select","Select"),disablePortal:!0,onChange:C,defaultSelection:{value:y,label:A}})))))));var Y=a(790);const G=/^\d+$/,q="label.days",X="label.weeks",Q="label.months",Z="label.years",K=({folder:e,onClose:t,setActiveModal:a})=>{const[n,d]=(0,l.useState)(e.name),[c,m]=(0,l.useState)(!1),[g,h]=(0,l.useState)(0),[E,v]=(0,l.useState)(0),[y,C]=(0,l.useState)("d"),[w,A]=(0,l.useState)("d"),[_,k]=(0,l.useState)(""),[S,R]=(0,l.useState)(""),[x,T]=(0,l.useState)(!1),[O,M]=(0,l.useState)(!1),[L,P]=(0,l.useState)(!1),[B,$]=(0,l.useState)(!1),[I,H]=(0,l.useState)(e?.color??0),W=[{label:(0,i.t)(q,"Days"),value:"d"},{label:(0,i.t)(X,"Weeks"),value:"w"},{label:(0,i.t)(Q,"Months"),value:"m"},{label:(0,i.t)(Z,"Years"),value:"y"}],{createSnackbar:K}=(0,f.m)();(0,l.useEffect)((()=>{if(e.retentionPolicy&&e.retentionPolicy?.length&&void 0!==e.retentionPolicy[0].keep&&e.retentionPolicy[0].keep&&0!==Object.keys(e.retentionPolicy[0].keep[0]).length){const t=e.retentionPolicy[0]?.keep[0]?.policy[0]?.lifetime,a=parseInt(t);M(!0),m(!0),a%365==0?(C("y"),h(a/365),k((0,i.t)(Z,"Years"))):a%31==0?(C("m"),h(a/31),k((0,i.t)(Q,"Months"))):a%7==0?(C("w"),h(a/7),k((0,i.t)(X,"Weeks"))):(C("d"),h(a),k((0,i.t)(q,"Days")))}else C("d"),k((0,i.t)(q,"Days"));if(e.retentionPolicy&&e.retentionPolicy.length&&void 0!==e.retentionPolicy[0].purge&&e.retentionPolicy[0].purge&&0!==Object.keys(e.retentionPolicy[0].purge[0]).length){const t=e.retentionPolicy[0]?.purge[0]?.policy[0]?.lifetime,a=parseInt(t,10);T(!0),m(!0),a%365==0?(A("y"),v(a/365),R((0,i.t)(Z,"Years"))):a%31==0?(A("m"),v(a/31),R((0,i.t)(Q,"Months"))):a%7==0?(A("w"),v(a/7),R((0,i.t)(X,"Weeks"))):(A("d"),v(a),R((0,i.t)(q,"Days")))}else A("d"),R((0,i.t)(q,"Days"))}),[e.retentionPolicy]);const J=(0,l.useMemo)((()=>(0,s.includes)((0,Y.rS)(),n)||n&&!N(n)),[n]),ee=(0,l.useMemo)((()=>(0,s.includes)([i.FOLDERS.INBOX,i.FOLDERS.TRASH,i.FOLDERS.SPAM,i.FOLDERS.SENT,i.FOLDERS.DRAFTS],e.id)),[e]),te=(0,l.useMemo)((()=>(J||L)&&!ee),[J,L,ee]),ae=(0,l.useCallback)((()=>{let a=!0;if(O){if(a=!1,!g||!G.test(g.toString()))return void P(!0);a=!0}if(x){if(a=!1,!E||!G.test(E.toString()))return void $(!0);a=!0}if(n&&a){let t,a;t="w"===y?7*Number(g):"m"===y?31*Number(g):"y"===y?365*Number(g):Number(g),a="w"===w?7*Number(E):"m"===w?31*Number(E):"y"===w?365*Number(E):Number(E),b({folder:{...e,parent:e.l||"",path:e.absFolderPath,absParent:"2",children:[]},name:n,op:"update",color:Number(I),retentionPolicy:O||x||e?.retentionPolicy?{keep:O?{policy:{lifetime:`${t}d`,type:"user"}}:{},purge:x?{policy:{lifetime:`${a}d`,type:"user"}}:{}}:{}}).then((e=>{K("Fault"in e?{key:"edit",replace:!0,type:"error",hideButton:!0,label:(0,i.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3}:{key:"edit",replace:!0,type:"info",hideButton:!0,label:(0,i.t)("messages.snackbar.folder_edited","Changes correctly saved"),autoHideTimeout:3e3})}))}d(""),t()}),[O,x,n,t,g,E,y,w,e,I,K]),le=(0,i.t)("label.edit_folder_properties",{name:e.name,defaultValue:"Edit {{name}} properties"});return r().createElement(r().Fragment,null,r().createElement(p.A,{onClose:t,title:le}),r().createElement(U,{showWarning:J,setInputValue:d,inputValue:n,inpDisable:ee,folderColor:String(I),setFolderColor:H}),r().createElement(o.Container,{mainAlignment:"flex-start",crossAlignment:"flex-start",padding:{top:"medium"}},r().createElement(D,{folder:e}),!(0,s.isEmpty)(e?.acl)&&!e.owner&&r().createElement(F,{folder:e,setActiveModal:a}),r().createElement(j,{setShowPolicy:m,emptyRtnValue:L,setEmptyRtnValue:P,showPolicy:c,dsblMsgRet:O,setDsblMsgRet:M,setRtnValue:h,rtnValue:g,retentionPeriod:W,setRtnYear:C,dsblMsgDis:x,emptyDisValue:B,setEmptyDisValue:$,setDsblMsgDis:T,setPurgeValue:v,setDspYear:A,rtnYear:y,rtnRange:_,dspYear:w,dspRange:S,purgeValue:E})),r().createElement(u.A,{onConfirm:ae,label:(0,i.t)("label.edit","Edit"),secondaryAction:()=>a("share"),secondaryLabel:(0,i.t)("folder.modal.edit.add_share","Add Share"),disabled:te,secondaryDisabled:!V(e,z),secondaryBtnType:"outlined",secondaryColor:"primary",tooltip:te?(0,i.t)("folder.modal.edit.enter_valid_folder_name","Enter a valid folder name"):""}))},J=({folder:e,onClose:t,grant:a,goBack:n})=>{const[s,d]=(0,l.useState)(!1),[c,m]=(0,l.useState)(""),g=(0,i.useUserAccounts)(),h=(0,y.j)(),{createSnackbar:E}=(0,f.m)(),v=(0,l.useCallback)((()=>{s?h(A({sendNotification:s,standardMessage:c,contacts:[{email:a?.d}],folder:e,accounts:g})).then((()=>{b({folder:e,zid:a.zid,op:"!grant"}).then((t=>{"Fault"in t||E({key:`remove-share-${e.id}`,replace:!0,type:"info",label:(0,i.t)("snackbar.share_revoke","Share access revoked"),autoHideTimeout:2e3,hideButton:!0}),n()}))})):b({folder:e,zid:a.zid,op:"!grant"}).then((t=>{"Fault"in t||E({key:`remove-share-${e.id}`,replace:!0,type:"info",label:(0,i.t)("snackbar.share_revoke","Share access revoked"),autoHideTimeout:2e3,hideButton:!0}),n()}))}),[s,h,c,a.d,a.zid,e,g,n,E]),w=(0,l.useMemo)((()=>(0,C.kL)(i.t,a.perm?.includes("p"))),[a.perm]),_=(0,l.useMemo)((()=>s&&c.length>0?(0,i.t)("label.revoke_with_custom_message","Revoke access sending a custom notification"):s?(0,i.t)("label.revoke_access_tooltip","Revoke access sending a standard notification"):(0,i.t)("label.revoke_access_without_notification","Revoke access without sending a notification")),[s,c]);return r().createElement(o.Container,{padding:{all:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},r().createElement(p.A,{title:(0,i.t)("label.revoke_share","Revoke share"),onClose:t}),r().createElement(o.Container,{orientation:"horizontal",mainAlignment:"flex-end",padding:{bottom:"large",top:"large"}},r().createElement(k,{grant:a,hovered:!1,shareCalendarRoleOptions:w})),r().createElement(o.Checkbox,{iconSize:"medium",value:s,defaultChecked:s,onClick:()=>d(!s),label:(0,i.t)("label.send_notification","Send a notification message to")}),r().createElement(o.Container,{mainAlignment:"center",crossAlignment:"flex-start",height:"fit",padding:{bottom:"large",top:"large"}},r().createElement(o.Input,{label:(0,i.t)("share.standard_message","Add a note to the standard message"),value:c,onChange:e=>{m(e.target.value)},disabled:!s,backgroundColor:"gray5"})),r().createElement(o.Container,{orientation:"horizontal",crossAlignment:"baseline",mainAlignment:"baseline",padding:{all:"small"}},r().createElement(o.Row,{padding:{right:"small"}},r().createElement(o.Text,{weight:"bold",size:"small",color:"gray0"},"Note:")),r().createElement(o.Row,{padding:{bottom:"small"}},r().createElement(o.Text,{overflow:"break-word",size:"small",color:"gray1"},(0,i.t)("share.share_note","The standard message displays your name, the name of the shared item, pemissions granted to the recipients, and sign in information, if necessary.")))),r().createElement(o.Container,{mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},r().createElement(u.A,{background:"error",onConfirm:v,secondaryAction:n,secondaryLabel:(0,i.t)("label.go_back","Go Back"),label:(0,i.t)("label.revoke","Revoke"),tooltip:_})))},ee=({folder:e,onClose:t})=>{const[a,n]=(0,l.useState)("default"),[i,s]=(0,l.useState)({}),d=(0,l.useCallback)((()=>{n("default")}),[n]);return r().createElement(v.Provider,{value:{activeModal:a,setActiveModal:n,activeGrant:i,setActiveGrant:s,onClose:t}},r().createElement(o.Container,{padding:{all:"medium"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},"default"===a&&r().createElement(K,{folder:e,onClose:t,setActiveModal:n}),"edit"===a&&r().createElement(T,{folder:e,onClose:t,goBack:d,editMode:!0,grant:Object.keys(i).length>0?i:e?.acl?.grant[0]}),"revoke"===a&&r().createElement(J,{folder:e,goBack:d,grant:Object.keys(i).length>0?i:e?.acl?.grant[0]}),"share"===a&&r().createElement(T,{folder:e,onClose:t})))},te=({folder:e,onClose:t})=>{const{createSnackbar:a}=(0,f.m)(),n=(0,l.useCallback)((()=>{b({folder:e,recursive:!0,op:"empty",type:"emails"}).then((t=>{a("Fault"in t?{key:"trash",replace:!0,type:"error",label:(0,i.t)("label.error_try_again","Something went wrong, please try again."),autoHideTimeout:3e3,hideButton:!0}:{key:"trash",replace:!0,type:"info",label:(0,h.wL)(e.id).id===i.FOLDERS.TRASH?(0,i.t)("messages.snackbar.folder_empty","Trash successfully emptied"):(0,i.t)("messages.snackbar.folder_wiped","Folder successfully wiped"),autoHideTimeout:3e3,hideButton:!0})})),t()}),[a,e,t]),s=(0,l.useMemo)((()=>(0,h.wL)(e.id).id===i.FOLDERS.TRASH?`${(0,i.t)("label.empty","Empty")} ${e.name}`:`${(0,i.t)("label.wipe","Wipe")} ${e.name}`),[e.id,e.name]);return r().createElement(o.Container,{padding:{all:"large"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},r().createElement(p.A,{title:s,onClose:t}),r().createElement(o.Container,{padding:{top:"large",bottom:"large"},crossAlignment:"flex-start"},(0,h.wL)(e.id).id===i.FOLDERS.TRASH?r().createElement(o.Text,{overflow:"break-word"},(0,i.t)("folder_panel.modal.empty.body.message1","Do you want to empty the selected folder?"),r().createElement("br",null),(0,i.t)("folder_panel.modal.empty.body.message2","If you empty it, all the related content will be deleted permanently.")):r().createElement(o.Text,{overflow:"break-word"},(0,i.t)("folder_panel.modal.wipe.body.message1","Do you want to wipe the selected folder?"),r().createElement("br",null),(0,i.t)("folder_panel.modal.wipe.body.message2","If you wipe it, all the related content will be deleted permanently."))),r().createElement(u.A,{onConfirm:n,label:(0,h.wL)(e.id).id===i.FOLDERS.TRASH?(0,i.t)("label.empty","Empty"):(0,i.t)("label.wipe","Wipe"),color:"error"}))};var ae=a(9431),le=a(9452);const re=({folder:e,onClose:t})=>{const[a,n]=(0,l.useState)((()=>(0,i.t)("new_folder","New Folder"))),[d,c]=(0,l.useState)(e),[m,g]=(0,l.useState)(!0),[h,b]=(0,l.useState)(!1),[E,v]=(0,l.useState)((0,i.t)("folder_panel.modal.new.input.name","Enter Folder Name")),[y,C]=(0,l.useState)((0,i.t)("folder.modal.edit.rename_warning","You cannot rename a folder as a system one.")),w=(0,l.useMemo)((()=>(0,s.includes)((0,Y.rS)(),a)?(C((0,i.t)("folder.modal.edit.rename_warning","You cannot rename a folder as a system one.")),!0):!(!a||N(a)||(C((0,i.t)("folder.modal.edit.invalid_folder_name_warning_msg","Special characters not allowed. Max lenght is 128 characters.")),0))),[a]),{createSnackbar:A}=(0,f.m)();(0,l.useEffect)((()=>{if(!d||!a.length||w)return void g(!0);const e=!!(0,s.find)(d?.children,(e=>e.name===a));v(e?(0,i.t)("folder_panel.modal.new.input.name_exist","Name already exists in this path"):(0,i.t)("folder_panel.modal.new.input.name","Enter Folder Name")),b(e),g(e)}),[d,a,w]);const _=(0,l.useCallback)((()=>{(0,le.v)({parentFolderId:d?.id??"",name:a}).then((e=>{A("Fault"in e?{key:"edit",replace:!0,type:"error",label:(0,i.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0}:{key:"edit",replace:!0,type:"success",label:(0,i.t)("messages.snackbar.folder_created","New folder created"),autoHideTimeout:3e3,hideButton:!0})})).catch((()=>s.noop)),n(""),v((0,i.t)("folder_panel.modal.new.input.name","Enter Folder Name")),c(void 0),b(!1),t()}),[A,d?.id,a,t]);return e?r().createElement(o.Container,{padding:{all:"large"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit",style:{overflowY:"auto"}},r().createElement(p.A,{title:(0,i.t)("folder_panel.modal.new.title","Create a new folder"),onClose:t}),r().createElement(o.Container,{mainAlignment:"center",crossAlignment:"flex-start",height:"fit",style:{overflowY:"auto"}},r().createElement(o.Input,{label:E,backgroundColor:"gray5",hasError:h||w,defaultValue:a,onChange:e=>n(e.target.value),"data-testid":"new-folder-name"}),w&&r().createElement(o.Padding,{all:"small"},r().createElement(o.Text,{size:"small",color:"error"},y)),r().createElement(ae.W,{selectedFolderId:d?.id,onFolderSelected:c,showSharedAccounts:!0,showTrashFolder:!1,showSpamFolder:!1,allowRootSelection:!0,allowFolderCreation:!1}),r().createElement(u.A,{onConfirm:_,secondaryAction:t,label:(0,i.t)("label.create","Create"),secondaryLabel:(0,i.t)("label.cancel","Cancel"),disabled:m,tooltip:m?(0,i.t)("folder.modal.edit.enter_valid_folder_name","Enter a valid folder name"):""}))):r().createElement(r().Fragment,null)},ne=({icon:e,label:t,text:a})=>r().createElement(o.Row,{width:"fill",mainAlignment:"flex-start",padding:{all:"small"}},r().createElement(o.Row,{padding:{right:"small"}},r().createElement(o.Icon,{icon:e}),r().createElement(o.Row,{padding:{right:"small",left:"small"}},r().createElement(o.Text,{weight:"bold"},`${t}: `)),r().createElement(o.Row,{takeAvailableSpace:!0},r().createElement(o.Text,{overflow:"break-word"},a)))),oe=({onClose:e,folder:t})=>{const a=(/r/.test(t.perm||"")?`${(0,i.t)("label.read","Read")}`:"").concat(/w/.test(t.perm||"")?`, ${(0,i.t)("label.write","Write")}`:"").concat(/i/.test(t.perm||"")?`, ${(0,i.t)("label.insert","Insert")}`:"").concat(/d/.test(t.perm||"")?`, ${(0,i.t)("label.delete","Delete")}`:"").concat(/a/.test(t.perm||"")?`, ${(0,i.t)("label.administer","Administer")}`:"").concat(/p/.test(t.perm||"")?`, ${(0,i.t)("label.private","Private")}`:"").concat(/f/.test(t.perm||"")?`, ${(0,i.t)("label.freebusy","FreeBusy")}`:"").concat(/c/.test(t.perm||"")?`, ${(0,i.t)("label.create","Create")}`:"").concat(/x/.test(t.perm||"")?`, ${(0,i.t)("label.workflow","WorkFlow")}`:""),n=(0,l.useMemo)((()=>(0,i.t)("label.mail_folder","E-mail folder")),[]);return r().createElement(o.Container,{padding:{bottom:"large"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},r().createElement(p.A,{title:`${(0,i.t)("label.shares_info","Shared folder's info")} `,onClose:e}),r().createElement(ne,{icon:"InfoOutline",label:`${(0,i.t)("label.shared_item","Shared item")}`,text:t.name}),r().createElement(ne,{icon:"PersonOutline",label:`${(0,i.t)("label.owner","Owner: ")}`,text:t.isLink?t?.owner:""}),r().createElement(ne,{icon:"MailModOutline",label:`${(0,i.t)("label.type","Type")}`,text:n}),r().createElement(ne,{icon:"UnlockOutline",label:`${(0,i.t)("label.allowed_actions","Allowed actions")}`,text:a}),r().createElement(ne,{icon:"EmailOutline",label:`${(0,i.t)("label.messages","Messages")}`,text:String(t.n)}))};var ie=a(5322),se=a(348),de=a(8333),ce=a(4990),me=a(6784);var ue=a(2816),pe=a(7431),ge=a(9099),he=a(7656);m()(o.Row).withConfig({displayName:"accordion-custom-component__FittedRow",componentId:"sc-neot2g-0"})(["max-width:calc(100% - (2 * ","));height:3rem;"],(({theme:e})=>e.sizes.padding.small));const fe=m()(o.Container).withConfig({displayName:"accordion-custom-component__DropOverlayContainer",componentId:"sc-neot2g-1"})(["position:absolute;width:calc(15.5rem - ","rem);height:5rem;background:#ffffff;border-radius:2rem;border:0.25rem solid #d5e3f6;"],(e=>e.folder.depth-2)),be=m()(o.Container).withConfig({displayName:"accordion-custom-component__DropDenyOverlayContainer",componentId:"sc-neot2g-2"})(["position:absolute;width:calc(15.5rem - ","rem);height:100%;background:white;border-radius:0.25rem;border:0.25rem solid #d5e3f6;"],(e=>e.folder.depth-2)),Ee=({item:e})=>{const t=(0,i.useUserAccount)().name,a=(0,y.j)(),{folderId:n}=(0,d.useParams)(),{createSnackbar:c}=(0,f.m)(),{prefs:m}=(0,i.useUserSettings)(),u=(0,l.useCallback)((t=>"conversation"!==t.type&&"message"!==t.type||!(t.data.parentFolderId===e.id||t.data.parentFolderId===i.FOLDERS.INBOX&&[5,6].includes(Number(e.id))||t.data.parentFolderId===i.FOLDERS.DRAFTS&&![3].includes(Number(e.id))||e.id===i.FOLDERS.DRAFTS&&t.data.parentFolderId!==i.FOLDERS.TRASH||e.isLink&&-1===e.perm?.indexOf("w")||e.id===i.FOLDERS.USER_ROOT||e.isLink&&e.oname===i.ROOT_NAME)?"folder"===t.type&&(e.id===t.data.id||e.isLink||(0,h.Qx)(e.id)||(0,h.kf)(e.id))?{success:!1}:void 0:{success:!1}),[e]),p=(0,l.useMemo)((()=>(0,ue.mY)(e.id)||e.isLink),[e.id,e.isLink]),{zimbraPrefGroupMailBy:g}=(0,i.useUserSettings)().prefs,v=(0,l.useCallback)((()=>{(0,i.pushHistory)(`/folder/${e.id}`);const{sortOrder:t}=(0,ge.n)(e.id,m.zimbraPrefSortOrder);a((0,he.$P)({folderId:e.id,limit:pe.bh.INITIAL_LIMIT,sortBy:t,types:e.id===i.FOLDERS.DRAFTS||"string"!=typeof g?"message":g}))}),[a,e.id,m.zimbraPrefSortOrder,g]),C=(0,l.useMemo)((()=>e.id&&e.id===i.FOLDERS.DRAFTS?"read":"unread"),[e.id]),w=(0,l.useMemo)((()=>({size:"small"})),[]),A=(0,l.useMemo)((()=>{return{...e,label:e.id===i.FOLDERS.USER_ROOT?t:(0,Y.k0)({folderId:e.id,folderName:e.name})??"",icon:(0,Y.fX)(e)??void 0,iconColor:(0,Y.dk)(e)??"",badgeCounter:(a=e.id===i.FOLDERS.DRAFTS?e.n:e?.u,a&&a>0?a:void 0),badgeType:C,to:`/folder/${e.id}`,textProps:w};var a}),[e,t,C,w]),_=(e=>{const t=(0,y.j)(),a=(0,o.useModal)(),n=(0,h.wL)(e.id??"0").id===i.FOLDERS.TRASH,d=(0,y.G)(se.c0).filter((e=>(0,h.wL)(e.parent).id===i.FOLDERS.TRASH)),c=(0,l.useMemo)((()=>d.map((e=>e.id))),[d]),{setCount:m}=(0,i.useAppContext)(),{deselectAll:u}=(0,ie.C)({currentFolderId:e.id,setCount:m,count:0}),{createSnackbar:p}=(0,f.m)(),g=(0,l.useMemo)((()=>[{id:O,"data-testid":`folder-action-${O}`,icon:"FolderAddOutline",label:(0,i.t)("label.new_folder","New Folder"),onClick:t=>{t&&t.stopPropagation();const l=a({maxHeight:"90vh",size:"medium",children:r().createElement(de.t,null,r().createElement(re,{folder:e,onClose:()=>l()}))},!0)},tooltipLabel:V(e,O)?"":(0,i.t)("label.do_not_have_perm","You don't have permission"),disabled:!V(e,O)},{id:M,"data-testid":`folder-action-${M}`,icon:n?"RestoreOutline":"MoveOutline",label:n?(0,i.t)("label.restore","Restore"):(0,i.t)("label.move","Move"),onClick:l=>{if(l&&l.stopPropagation(),n){const l=a({maxHeight:"90vh",size:"medium",children:r().createElement(de.t,null,r().createElement(me.A,{folderId:e.id,selectedIDs:c,onClose:()=>l(),isMessageView:!0,isRestore:!0,deselectAll:u,dispatch:t}))},!0)}else{const t=(0,i.t)("folder_panel.modal.move.body.message1","Select a folder to move the considered one to:"),l=(t,a,l)=>{b({folder:e,l:t?.id??i.FOLDERS.USER_ROOT,op:"move"}).then((t=>{p("Fault"in t?{key:"move",replace:!0,type:"error",label:(0,i.t)("label.error_try_again","Something went wrong, please try again."),autoHideTimeout:3e3}:{key:"move",replace:!0,type:"success",label:(0,i.t)("messages.snackbar.folder_moved","Folder successfully moved"),autoHideTimeout:5e3,hideButton:!1,actionLabel:(0,i.t)("label.undo","Undo"),onActionClick:()=>b({folder:e,l:e.l,op:"move"}).then((e=>{p("Fault"in e?{key:"move",replace:!0,type:"error",label:(0,i.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0}:{key:"move-folder",replace:!0,type:"success",label:(0,i.t)("messages.snackbar.folder_restored","Folder restored"),autoHideTimeout:3e3,hideButton:!0})}))}),a(void 0),l()})).catch((()=>s.noop))},n=a({maxHeight:"90vh",size:"medium",children:r().createElement(de.t,null,r().createElement(ce.i,{folder:e,onClose:()=>n(),headerTitle:`${(0,i.t)("label.move","Move")} ${e?.name}`,actionLabel:(0,i.t)("label.move","Move"),inputLabel:t,confirmAction:l,allowFolderCreation:!1,allowRootSelection:!0,showSharedAccounts:!1,showTrashFolder:!1,showSpamFolder:!1}))},!0)}}},{id:B,"data-testid":`folder-action-${B}`,icon:(0,h.wL)(e.id).id===i.FOLDERS.TRASH?"DeletePermanentlyOutline":"EmptyFolderOutline",label:(0,h.wL)(e.id).id===i.FOLDERS.TRASH?(0,i.t)("folder_panel.action.empty.trash","Empty Trash"):(0,i.t)("folder_panel.action.wipe.folder_panel","Wipe Folder"),disabled:0===e.n&&0===e.children?.length,onClick:t=>{t&&t.stopPropagation();const l=a({children:r().createElement(de.t,null,r().createElement(te,{onClose:()=>l(),folder:e}))},!0)}},{id:P,"data-testid":`folder-action-${P}`,icon:"Edit2Outline",label:e.isLink?(0,i.t)("folder_panel.action.edit_properties","Edit Properties"):(0,i.t)("label.edit","Edit"),onClick:t=>{t&&t.stopPropagation();const l=a({maxHeight:"90vh",children:r().createElement(de.t,null,r().createElement(ee,{onClose:()=>l(),folder:e}))},!0)}},{id:L,"data-testid":`folder-action-${L}`,icon:"Trash2Outline",label:(0,s.startsWith)(e.absFolderPath,"/Trash")?(0,i.t)("label.delete_permanently","Delete Permanently"):(0,i.t)("label.delete","Delete"),onClick:t=>{t&&t.stopPropagation();const l=a({children:r().createElement(de.t,null,r().createElement(E,{onClose:()=>l(),folder:e}))},!0)}},{id:$,"data-testid":`folder-action-${$}`,icon:"CloseOutline",label:(0,i.t)("label.remove_from_this_list","Remove from this list"),onClick:t=>{t&&(t.stopPropagation(),b({folder:e,op:"delete"}))}},{id:I,"data-testid":`folder-action-${I}`,icon:"InfoOutline",label:(0,i.t)("label.shares_info","Shared folder's info"),onClick:t=>{t&&t.stopPropagation();const l=a({children:r().createElement(de.t,null,r().createElement(oe,{onClose:()=>l(),folder:e}))},!0)}},{id:H,"data-testid":`folder-action-${H}`,icon:"EmailReadOutline",label:(0,i.t)("label.mark_all_as_read","Mark all as read"),onClick:t=>{t&&(t.stopPropagation(),b({folder:e,op:"read",l:e.id}))}}]),[a,p,u,t,e,n,c]),v=(0,l.useMemo)((()=>g.filter((e=>e.id!==I&&e.id!==$))),[g]);switch(-1!==e.id.indexOf(":")?e.id.slice(e.id.indexOf(":")+1):e.id){case i.FOLDERS.INBOX:case i.FOLDERS.SENT:return v.map((e=>e.id===M||e.id===L?{...e,disabled:!0}:e));case i.FOLDERS.DRAFTS:return v.map((e=>e.id===M||e.id===L||e.id===H?{...e,disabled:!0}:e));case i.FOLDERS.SPAM:return v.map((e=>e.id===O||e.id===M||e.id===L?{...e,disabled:!0}:e));case i.FOLDERS.TRASH:return v.map((e=>e.id===M&&0===d.length||e.id===L||e.id===P?{...e,disabled:!0}:e));default:return e.isLink?g.filter((e=>e.id===I||e.id===$||e.id===P)):v.map((t=>!(0,s.startsWith)(e.absFolderPath,"/Trash")||t.id!==O&&t.id!==P?t:{...t,disabled:!0}))}})(e),k=(0,l.useMemo)((()=>{const t=(e,t,a)=>r().createElement(o.Padding,{left:"small"},r().createElement(o.Tooltip,{placement:"right",label:a},r().createElement(o.Row,null,r().createElement(o.Icon,{icon:e,color:t,size:"medium"}))));return e.acl?.grant?t("Shared","shared",(0,i.t)("tooltip.folder_sharing_status",{count:e.acl.grant.length,defaultValue_one:"Shared with {{count}} person",defaultValue:"Shared with {{count}} people"})):e.isLink?t("Linked","linked",(0,i.t)("tooltip.folder_linked_status","Linked to me")):""}),[e]);return e.isLink&&e.broken?r().createElement(r().Fragment,null):e.id===i.FOLDERS.USER_ROOT||e.isLink&&e.oname===i.ROOT_NAME?null:r().createElement(o.Row,{width:"fill",minWidth:0},r().createElement(o.Drop,{acceptType:["message","conversation","folder"],onDrop:t=>{(t=>{const l=u(t);if(l&&!1===l?.success)return;let r=[t.data.id];"folder"!==t.type&&t.data?.selectedIDs?.length&&t.data?.selectedIDs.includes(t.data.id)&&(r=t.data?.selectedIDs),"folder"===t.type?b({folder:t.data,l:e.id||i.FOLDERS.USER_ROOT,op:"move"}).then((e=>{c("Fault"in e?{key:"move",replace:!0,type:"error",label:(0,i.t)("label.error_try_again","Something went wrong, please try again."),autoHideTimeout:3e3}:{key:"move",replace:!0,type:"success",label:(0,i.t)("messages.snackbar.folder_moved","Folder successfully moved"),autoHideTimeout:3e3})})):"messages"in t.data?a((0,he.Rs)({operation:"move",ids:r,parent:e.id})).then((a=>{a.type.includes("fulfilled")?((0,i.replaceHistory)(`/folder/${n}`),t.data.deselectAll&&t.data.deselectAll(),c({key:"edit",replace:!0,type:"info",label:(0,i.t)("messages.snackbar.conversation_move","Conversation successfully moved"),autoHideTimeout:3e3,actionLabel:(0,i.t)("action.goto_folder","GO TO FOLDER"),onActionClick:()=>{(0,i.replaceHistory)(`/folder/${e.id}`)}})):c({key:"edit",replace:!0,type:"error",label:(0,i.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})})):a((0,he.SU)({operation:"move",ids:r,parent:e.id})).then((a=>{a.type.includes("fulfilled")?(t.data.deselectAll&&t.data.deselectAll(),c({key:"edit",replace:!0,type:"info",label:(0,i.t)("messages.snackbar.message_move","Message successfully moved"),autoHideTimeout:3e3,actionLabel:(0,i.t)("action.goto_folder","GO TO FOLDER"),onActionClick:()=>{(0,i.replaceHistory)(`/folder/${e.id}`)}})):c({key:"edit",replace:!0,type:"error",label:(0,i.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})}))})({type:t.type??"",data:t.data,event:t.event})},onDragEnter:e=>u({type:e.type??"",data:e.data,event:e.event}),overlayAcceptComponent:r().createElement(fe,{folder:e}),overlayDenyComponent:r().createElement(be,{folder:e})},r().createElement(o.Drag,{type:"folder",data:e,dragDisabled:p,style:{display:"block"}},r().createElement(i.AppLink,{onClick:v,to:`/folder/${e.id}`,style:{width:"100%",height:"100%",textDecoration:"none"}},r().createElement(o.Dropdown,{"data-testid":`folder-context-menu-${e.id}`,contextMenu:!0,items:_,display:"block",width:"100%"},r().createElement(o.Row,null,r().createElement(o.Padding,{left:"small"}),r().createElement(o.Tooltip,{label:A.label,placement:"right",maxWidth:"100%"},r().createElement(o.AccordionItem,{"data-testid":`accordion-folder-item-${e.id}`,item:A},k))))))))},ve=({folder:e})=>{const t=(0,l.useMemo)((()=>(0,Y.dk)(e)),[e]),a=(0,l.useMemo)((()=>(0,Y.fX)(e)),[e]);return r().createElement(i.AppLink,{to:`/folder/${e.id}`,style:{width:"100%",textDecoration:"none"}},r().createElement(o.Row,{mainAlignment:"flex-start",takeAvailableSpace:!0},r().createElement(o.Tooltip,{label:(0,Y.VN)({folderName:e.name}),placement:"right"},r().createElement(o.Padding,{all:"extrasmall"},r().createElement(o.IconButton,{customSize:{iconSize:"large",paddingSize:"small"},icon:a??"",customIconColor:t,onClick:()=>null})))))};var ye=a(505),Ce=a(4424),we=a(9026),Ae=a(679),_e=a(4714);const ke=(0,_e.A)({palette:{currentColor:{regular:"currentColor",hover:"currentColor",active:"currentColor",focus:"currentColor",disabled:"currentColor"},transparent:{regular:"rgba(0, 0, 0, 0)",hover:"rgba(0, 0, 0, 0.05)",active:"rgba(0, 0, 0, 0.1)",focus:"rgba(0, 0, 0, 0.05)",disabled:"rgba(0, 0, 0, 0)"},primary:{regular:"#2b73d2",hover:"#225ca8",active:"#1e5092",focus:"#225ca8",disabled:"#aac8ee",main:"#2b73d2"},secondary:{regular:"#828282",hover:"#696969",active:"#5c5c5c",focus:"#696969",disabled:"#cccccc",main:"#828282"},header:{regular:"#cfd5dc",hover:"#b1bbc6",active:"#a3aebc",focus:"#b1bbc6",disabled:"#cfd5dc"},highlight:{regular:"#d5e3f6",hover:"#abc7ed",active:"#96b8e8",focus:"#abc7ed",disabled:"#d5e3f6"},gray0:{regular:"#414141",hover:"#282828",active:"#1b1b1b",focus:"#282828",disabled:"#cccccc"},gray1:{regular:"#828282",hover:"#696969",active:"#5c5c5c",focus:"#696969",disabled:"#cccccc"},gray2:{regular:"#cfd5dc",hover:"#b1bbc6",active:"#a3aebc",focus:"#b1bbc6",disabled:"#cfd5dc"},gray3:{regular:"#e6e9ed",hover:"#c8cfd8",active:"#bac2cd",focus:"#c8cfd8",disabled:"#e6e9ed"},gray4:{regular:"#eeeff3",hover:"#d0d3de",active:"#c1c5d3",focus:"#d0d3de",disabled:"#eeeff3"},gray5:{regular:"#f5f6f8",hover:"#d7dbe3",active:"#c8ced9",focus:"#d7dbe3",disabled:"#f5f6f8"},gray6:{regular:"#ffffff",hover:"#e6e6e6",active:"#d9d9d9",focus:"#e6e6e6",disabled:"#ffffff"},warning:{regular:"#ffc107",hover:"#d39e00",active:"#ba8b00",focus:"#d39e00",disabled:"#ffe699",main:"#ffc107"},error:{regular:"#d74942",hover:"#be3028",active:"#a92a24",focus:"#be3028",disabled:"#edaeab",main:"#d74942"},success:{regular:"#8bc34a",hover:"#71a436",active:"#639030",focus:"#71a436",disabled:"#cee6b2",main:"#8bc34a"},info:{regular:"#2196d3",hover:"#1a75a7",active:"#176691",focus:"#1a75a7",disabled:"#a7d7f1",main:"#2196d3"},text:{regular:"#333333",hover:"#1a1a1a",active:"#0d0d0d",focus:"#1a1a1a",disabled:"#cccccc",main:"#333333"}},avatarColors:{avatar_1:"#EF9A9A",avatar_2:"#F48FB1",avatar_3:"#CE93D8",avatar_4:"#B39DDB",avatar_5:"#9FA8DA",avatar_6:"#90CAF9",avatar_7:"#81D4FA",avatar_8:"#80DEEA",avatar_9:"#80CBC4",avatar_10:"#A5D6A7",avatar_11:"#C5E1A5",avatar_12:"#E6EE9C",avatar_13:"#FFE082",avatar_14:"#FFCC80",avatar_15:"#FFAB91",avatar_16:"#BCAAA4",avatar_17:"#E57373",avatar_18:"#F06292",avatar_19:"#BA68C8",avatar_20:"#9575CD",avatar_21:"#7986CB",avatar_22:"#64B5F6",avatar_23:"#4FC3F7",avatar_24:"#4DD0E1",avatar_25:"#4DB6AC",avatar_26:"#81C784",avatar_27:"#AED581",avatar_28:"#DCE775",avatar_29:"#FFD54F",avatar_30:"#FFB74D",avatar_31:"#FF8A65",avatar_32:"#A1887F",avatar_33:"#0097A7",avatar_34:"#EF5350",avatar_35:"#EC407A",avatar_36:"#AB47BC",avatar_37:"#7E57C2",avatar_38:"#5C6BC0",avatar_39:"#42A5F5",avatar_40:"#29B6F6",avatar_41:"#26C6DA",avatar_42:"#26A69A",avatar_43:"#66BB6A",avatar_44:"#9CCC65",avatar_45:"#D4E157",avatar_46:"#FFCA28",avatar_47:"#FFA726",avatar_48:"#FF7043",avatar_49:"#8D6E63",avatar_50:"#0288D1"}}),Se=(0,_e.A)({components:{MuiSvgIcon:{styleOverrides:{root:{color:ke.palette.text.regular,"&:hover":{background:ke.palette.gray3.hover},fontSize:"1.25rem",fontWeight:400}}},MuiAccordionSummary:{styleOverrides:{root:{padding:"0 1rem 0 0",margin:"0",minHeight:"0",justifyContent:"left"},content:{margin:"0",maxWidth:"calc(100% - 1.25rem)"}}},MuiAccordionDetails:{styleOverrides:{root:{background:ke.palette.gray5.regular,padding:"0 0 0 0.5rem",margin:"0"}}},MuiButtonBase:{styleOverrides:{root:{padding:"0"}}},MuiPaper:{styleOverrides:{root:{borderBottomLeftRadius:"0",borderTopLeftRadius:"0",borderBottomRightRadius:"0",borderTopRightRadius:"0"}}},MuiAccordion:{styleOverrides:{root:{":last-of-type":{borderBottomLeftRadius:"0",borderTopLeftRadius:"0",borderBottomRightRadius:"0",borderTopRightRadius:"0"},":first-of-type":{borderBottomLeftRadius:"0",borderTopLeftRadius:"0",borderBottomRightRadius:"0",borderTopRightRadius:"0"},boxShadow:"none",background:ke.palette.gray5.highlight,"&.MuiAccordion-root:before":{top:"0"}}}}}});var Re=a(6978);const Fe=({accordions:e,folderId:t,localStorageName:a,AccordionCustomComponent:n,setSelectedFolder:o,buttonFindShares:s,initialExpanded:d})=>{const[c,m]=(0,i.useLocalStorage)(a,d??[]),u=(0,l.useRef)(null);return(0,l.useCallback)((({accordion:e,expanded:t})=>{m(t?t=>t.includes(e.id)?t:[...t,e.id]:t=>t.filter((t=>t!==e.id)))}),[m]),r().createElement(ye.A,{ref:u,disableGutters:!0},e.map((e=>"find_shares"===e.id?s:r().createElement(Ce.A,{disableGutters:!0,TransitionProps:{unmountOnExit:!0},expanded:c.includes(e.id),key:e.id},r().createElement(we.A,{onClick:()=>{o&&o(e.id)},"aria-controls":"panel1a-content",id:e.id,sx:{backgroundColor:e.id===t?Re.U:ke.palette.transperant,"&:hover":{backgroundColor:e.id===t?ke.palette.highlight.active:ke.palette.gray5.hover},borderRadius:"16px"}},r().createElement(n,{item:e})),e?.children?.length>0&&r().createElement(Ae.A,null,r().createElement(Fe,{accordions:e.children,folderId:t,key:e.id,localStorageName:a,AccordionCustomComponent:n,setSelectedFolder:o,buttonFindShares:s,initialExpanded:d}))))))};var xe=a(1765),Te=a(4899),De=a(1843);const Oe=e=>{const t=(0,De.kv)({tag:e?.item}),a=(0,l.useCallback)((()=>(0,i.runSearch)([{avatarBackground:i.ZIMBRA_STANDARD_COLORS[e?.item?.color||0].hex,avatarIcon:"Tag",background:"gray2",hasAvatar:!0,isGeneric:!1,isQueryFilter:!0,label:`tag:${e?.item?.name}`,value:`tag:"${e?.item?.name}"`}],"mails")),[e?.item?.color,e?.item?.name]);return r().createElement(o.Dropdown,{contextMenu:!0,items:t,display:"block",width:"fit",onClick:a},r().createElement(o.Row,{mainAlignment:"flex-start",height:"fit",padding:{left:"large"},takeAvailableSpace:!0},r().createElement(o.Icon,{size:"large",icon:"Tag",color:i.ZIMBRA_STANDARD_COLORS[e?.item?.color??0].hex}),r().createElement(o.Padding,{right:"large"}),r().createElement(o.Tooltip,{label:e?.item?.name,placement:"right",maxWidth:"100%"},r().createElement(o.AccordionItem,(0,Te.A)({},e,{height:"2.5rem"})))))},Me=e=>{const t=(0,l.useContext)(o.ModalManagerContext);return r().createElement(o.Dropdown,{contextMenu:!0,display:"block",width:"fit",items:[(0,De.VZ)({createModal:t})]},r().createElement(o.Row,{mainAlignment:"flex-start",padding:{horizontal:"large"},takeAvailableSpace:!0},r().createElement(o.Icon,{size:"large",icon:"TagsMoreOutline"})," ",r().createElement(o.Padding,{right:"large"}),r().createElement(o.AccordionItem,(0,Te.A)({},e,{color:`${e.color}`,height:"2.5rem"}))))},Le=(0,l.memo)((function({accordions:e}){const{folderId:t}=(0,d.useParams)(),a=(()=>{const e=(0,i.useTags)();return(0,l.useMemo)((()=>({id:"Tags",label:(0,i.t)("label.tags","Tags"),active:!1,open:!1,onClick:e=>{e.stopPropagation()},CustomComponent:Me,items:(0,s.reduce)(e,((e,t)=>{const a={id:t.id,item:t,active:!1,color:t.color||0,label:t.name,name:t.name,open:!1,CustomComponent:Oe};return e.push(a),e}),[])})),[e])})(),n=(0,l.useMemo)((()=>(e?.[0]?.children.find((e=>"find_shares"===e.id))||e[0]?.children?.push({id:"find_shares",disableHover:!0}),(0,s.map)(e,(e=>({...e,background:"transparent"}))))),[e]);return r().createElement(o.Container,{orientation:"vertical",style:{backgroundColor:"transparent"},height:"fit",width:"fill"},r().createElement(Fe,{accordions:n,folderId:t,localStorageName:pe.l7.EXPANDED_FOLDERS,AccordionCustomComponent:Ee,buttonFindShares:r().createElement(r().Fragment,null),initialExpanded:[i.FOLDERS.USER_ROOT]}),r().createElement(o.Accordion,{background:"transparent",items:[a]}))})),Pe=({expanded:e})=>{const{path:t}=(0,d.useRouteMatch)(),a=(0,xe.nv)();return r().createElement(r().Fragment,null,r().createElement(n.A,{theme:Se},e?r().createElement(d.Switch,null,r().createElement(d.Route,{path:`${t}/folder/:folderId/:type?/:itemId?`},r().createElement(Le,{accordions:a}))):a[0].children.map((e=>r().createElement(ve,{key:e.id,folder:e})))))}}}]);
//# sourceMappingURL=mail-sidebar-view.7edd5709.chunk.js.map