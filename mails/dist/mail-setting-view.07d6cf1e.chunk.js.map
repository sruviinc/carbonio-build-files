{"version":3,"file":"mail-setting-view.07d6cf1e.chunk.js","mappings":"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","sources":["webpack://carbonio-mails-ui/./src/assets/animated-loader.tsx","webpack://carbonio-mails-ui/./src/carbonio-ui-commons/helpers/api-wrapper.ts","webpack://carbonio-mails-ui/./src/carbonio-ui-commons/utils/text/html.ts","webpack://carbonio-mails-ui/./src/commons/gap-container.tsx","webpack://carbonio-mails-ui/./src/helpers/signatures.ts","webpack://carbonio-mails-ui/./src/sruvi/EditedColors.tsx","webpack://carbonio-mails-ui/./src/ui-actions/modals/select-folder-modal.tsx","webpack://carbonio-mails-ui/./src/views/settings/components/utils.js","webpack://carbonio-mails-ui/./src/views/settings/components/settings-heading.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/custom-select.tsx","webpack://carbonio-mails-ui/./src/hooks/use-click-outside-picker.tsx","webpack://carbonio-mails-ui/./src/commons/color-picker.tsx","webpack://carbonio-mails-ui/./src/views/settings/compose-msg-settings.tsx","webpack://carbonio-mails-ui/./src/views/settings/displaying-messages-settings.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/filter-context.ts","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/filter-item.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/actions.ts","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filter-context.ts","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filter-modal-footer.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/utils.js","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filters-conditions/default.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filters-conditions/message.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filters-conditions/from-to.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filters-conditions/size.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filters-conditions/date.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filters-conditions/body.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filters-conditions/attachment.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filters-conditions/read-receipt.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filters-conditions/address-in.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filters-conditions/calendar.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filters-conditions/header.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filters-conditions/social.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/get-row.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/filter-test-rows.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/filter-test-condition-row.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/filter-action-rows.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/new-filter-action-conditions.tsx","webpack://carbonio-mails-ui/./src/store/actions/modify-filter-rules.ts","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-filter-modal.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/delete-filter-modal.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/get-test-component.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/modify-filter/modify-filter-modal.tsx","webpack://carbonio-mails-ui/./src/api/apply-filter-rules.ts","webpack://carbonio-mails-ui/./src/commons/text-styler.tsx","webpack://carbonio-mails-ui/./src/ui-actions/select-folders.tsx","webpack://carbonio-mails-ui/./src/ui-actions/modals/apply-filter-modal.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/incoming-filters-actions.tsx","webpack://carbonio-mails-ui/./src/ui-actions/apply-filter.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/loading-shimmer.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/use-filter-selection.jsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/incoming-message-filter-tab.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/create-outgoing-filter-modal.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/delete-outgoing-filter-modal.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/modify-filter/modify-outgoing-filter-modal.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/outgoing-filters-actions.tsx","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/outgoing-message-filter-tab.tsx","webpack://carbonio-mails-ui/./src/store/actions/get-outgoing-filters.ts","webpack://carbonio-mails-ui/./src/views/settings/filters/parts/filter-tabs.tsx","webpack://carbonio-mails-ui/./src/store/actions/get-incoming-filters.ts","webpack://carbonio-mails-ui/./src/normalizations/normalize-filter-rules.ts","webpack://carbonio-mails-ui/./src/views/settings/filters/index.tsx","webpack://carbonio-mails-ui/./src/views/settings/receiving-messages-settings.tsx","webpack://carbonio-mails-ui/./src/views/settings/components/recover-messages-modal.tsx","webpack://carbonio-mails-ui/./src/views/settings/recover-messages.tsx","webpack://carbonio-mails-ui/./src/api/search-backup-deleted-messages.ts","webpack://carbonio-mails-ui/./src/views/settings/components/select-identity-signature.tsx","webpack://carbonio-mails-ui/./src/store/actions/signatures.ts","webpack://carbonio-mails-ui/./src/views/settings/signature-settings.tsx","webpack://carbonio-mails-ui/./src/views/settings/components/trustee-list-item.tsx","webpack://carbonio-mails-ui/./src/views/settings/trustee-addresses.tsx","webpack://carbonio-mails-ui/./src/views/settings/settings-view.tsx","webpack://carbonio-mails-ui/./src/views/settings/hooks/use-signature-settings.ts"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React from 'react';\n\nimport styled, { keyframes } from 'styled-components';\n\nconst rotate = keyframes`\n\tfrom {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n`;\n\nconst AnimatedLoaderSvg = styled.svg`\n\tanimation: ${rotate} 3s ease-in-out infinite normal forwards;\n`;\n\nexport const AnimatedLoader = (props: React.SVGAttributes<SVGSVGElement>): React.JSX.Element => (\n\t<AnimatedLoaderSvg\n\t\tid=\"e9AcbENh5Z71\"\n\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\tviewBox=\"0 0 24 24\"\n\t\tshapeRendering=\"geometricPrecision\"\n\t\ttextRendering=\"geometricPrecision\"\n\t\tfill=\"currentColor\"\n\t\t{...props}\n\t>\n\t\t<g id=\"e9AcbENh5Z72\">\n\t\t\t<path\n\t\t\t\tid=\"e9AcbENh5Z73\"\n\t\t\t\td=\"M12,2C11.734800,2,11.480400,2.105360,11.292900,2.292890C11.105400,2.480430,11,2.734780,11,3L11,5C11,5.265220,11.105400,5.519570,11.292900,5.707110C11.480400,5.894640,11.734800,6,12,6C12.265200,6,12.519600,5.894640,12.707100,5.707110C12.894600,5.519570,13,5.265220,13,5L13,3C13,2.734780,12.894600,2.480430,12.707100,2.292890C12.519600,2.105360,12.265200,2,12,2L12,2Z\"\n\t\t\t\tfill=\"rgb(65,65,65)\"\n\t\t\t\tstroke=\"none\"\n\t\t\t\tstrokeWidth=\"1\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\tid=\"e9AcbENh5Z74\"\n\t\t\t\td=\"M21,11L19,11C18.734800,11,18.480400,11.105400,18.292900,11.292900C18.105400,11.480400,18,11.734800,18,12C18,12.265200,18.105400,12.519600,18.292900,12.707100C18.480400,12.894600,18.734800,13,19,13L21,13C21.265200,13,21.519600,12.894600,21.707100,12.707100C21.894600,12.519600,22,12.265200,22,12C22,11.734800,21.894600,11.480400,21.707100,11.292900C21.519600,11.105400,21.265200,11,21,11Z\"\n\t\t\t\tfill=\"rgb(65,65,65)\"\n\t\t\t\tstroke=\"none\"\n\t\t\t\tstrokeWidth=\"1\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\tid=\"e9AcbENh5Z75\"\n\t\t\t\td=\"M6,12C6,11.734800,5.894640,11.480400,5.707110,11.292900C5.519570,11.105400,5.265220,11,5,11L3,11C2.734780,11,2.480430,11.105400,2.292890,11.292900C2.105360,11.480400,2,11.734800,2,12C2,12.265200,2.105360,12.519600,2.292890,12.707100C2.480430,12.894600,2.734780,13,3,13L5,13C5.265220,13,5.519570,12.894600,5.707110,12.707100C5.894640,12.519600,6,12.265200,6,12Z\"\n\t\t\t\ttransform=\"matrix(1 0 0 1 0.26234975000000 0)\"\n\t\t\t\tfill=\"rgb(65,65,65)\"\n\t\t\t\tstroke=\"none\"\n\t\t\t\tstrokeWidth=\"1\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\tid=\"e9AcbENh5Z76\"\n\t\t\t\td=\"M6.220230,4.999950C6.025300,4.815620,5.765120,4.716280,5.496950,4.723780C5.228770,4.731290,4.974560,4.845010,4.790230,5.039950C4.605910,5.234880,4.506570,5.495050,4.514070,5.763230C4.521570,6.031410,4.635300,6.285620,4.830230,6.469950L6.270230,7.859950C6.366870,7.953260,6.481310,8.026140,6.606730,8.074250C6.732150,8.122360,6.865980,8.144700,7.000230,8.139950C7.134940,8.139430,7.268150,8.111710,7.391870,8.058440C7.515600,8.005170,7.627280,7.927450,7.720230,7.829950C7.906480,7.642580,8.011020,7.389130,8.011020,7.124950C8.011020,6.860760,7.906480,6.607310,7.720230,6.419950L6.220230,4.999950Z\"\n\t\t\t\ttransform=\"matrix(1 0 0 1 0.02050050000000 0)\"\n\t\t\t\tfill=\"rgb(43,115,210)\"\n\t\t\t\tstroke=\"none\"\n\t\t\t\tstrokeWidth=\"1\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\tid=\"e9AcbENh5Z77\"\n\t\t\t\td=\"M16.999600,8.139990C17.257100,8.138970,17.504200,8.038670,17.689600,7.859990L19.129600,6.469990C19.305300,6.286440,19.404500,6.042910,19.407100,5.788860C19.409700,5.534810,19.315600,5.289290,19.143700,5.102160C18.971900,4.915030,18.735200,4.800340,18.481900,4.781360C18.228500,4.762380,17.977400,4.840550,17.779600,4.999990L16.339600,6.419990C16.153400,6.607350,16.048800,6.860810,16.048800,7.124990C16.048800,7.389180,16.153400,7.642630,16.339600,7.829990C16.512800,8.012710,16.748400,8.123410,16.999600,8.139990Z\"\n\t\t\t\tfill=\"rgb(65,65,65)\"\n\t\t\t\tstroke=\"none\"\n\t\t\t\tstrokeWidth=\"1\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\tid=\"e9AcbENh5Z78\"\n\t\t\t\td=\"M12,18C11.734800,18,11.480400,18.105400,11.292900,18.292900C11.105400,18.480400,11,18.734800,11,19L11,21C11,21.265200,11.105400,21.519600,11.292900,21.707100C11.480400,21.894600,11.734800,22,12,22C12.265200,22,12.519600,21.894600,12.707100,21.707100C12.894600,21.519600,13,21.265200,13,21L13,19C13,18.734800,12.894600,18.480400,12.707100,18.292900C12.519600,18.105400,12.265200,18,12,18Z\"\n\t\t\t\tfill=\"rgb(65,65,65)\"\n\t\t\t\tstroke=\"none\"\n\t\t\t\tstrokeWidth=\"1\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\tid=\"e9AcbENh5Z79\"\n\t\t\t\td=\"M17.729900,16.140000C17.538900,15.955600,17.282600,15.854700,17.017200,15.859400C16.751800,15.864100,16.499200,15.974000,16.314900,16.165000C16.130600,16.355900,16.029600,16.612300,16.034300,16.877600C16.039000,17.143000,16.148900,17.395600,16.339900,17.580000L17.779900,19C17.965300,19.178600,18.212400,19.278900,18.469900,19.280000C18.603900,19.280700,18.736700,19.254600,18.860300,19.203100C18.984000,19.151500,19.096100,19.075700,19.189900,18.980000C19.283600,18.887000,19.358000,18.776400,19.408800,18.654500C19.459600,18.532700,19.485700,18.402000,19.485700,18.270000C19.485700,18.138000,19.459600,18.007200,19.408800,17.885400C19.358000,17.763500,19.283600,17.652900,19.189900,17.560000L17.729900,16.140000Z\"\n\t\t\t\ttransform=\"matrix(1 0 0 1 -0.03194850000000 0)\"\n\t\t\t\tfill=\"rgb(65,65,65)\"\n\t\t\t\tstroke=\"none\"\n\t\t\t\tstrokeWidth=\"1\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\tid=\"e9AcbENh5Z710\"\n\t\t\t\td=\"M6.269980,16.140000L4.829980,17.530000C4.736250,17.623000,4.661860,17.733600,4.611090,17.855400C4.560320,17.977300,4.534180,18.108000,4.534180,18.240000C4.534180,18.372000,4.560320,18.502700,4.611090,18.624600C4.661860,18.746400,4.736250,18.857000,4.829980,18.950000C4.923770,19.045700,5.035840,19.121600,5.159520,19.173100C5.283210,19.224600,5.415990,19.250800,5.549980,19.250000C5.796490,19.252100,6.035090,19.163100,6.219980,19L7.659980,17.610000C7.850930,17.425700,7.960850,17.173000,7.965530,16.907700C7.970220,16.642300,7.869300,16.385900,7.684980,16.195000C7.500650,16.004000,7.248020,15.894100,6.982660,15.889400C6.717290,15.884800,6.460930,15.985700,6.269980,16.170000L6.269980,16.140000Z\"\n\t\t\t\tfill=\"rgb(65,65,65)\"\n\t\t\t\tstroke=\"none\"\n\t\t\t\tstrokeWidth=\"1\"\n\t\t\t/>\n\t\t</g>\n\t</AnimatedLoaderSvg>\n);\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\ntype ErrorResponse<K> = { error: K };\n\ntype DataResponse<T> = { data: T };\n\nexport async function apiWrapper<T, K>(\n\tpromise: Promise<Response>\n): Promise<DataResponse<T> | ErrorResponse<K>> {\n\treturn Promise.allSettled([promise]).then(async ([result]) => {\n\t\tif (result.status === 'fulfilled') {\n\t\t\tconst responseBody = await result.value.text();\n\t\t\treturn responseBody ? { data: JSON.parse(responseBody) as T } : { data: {} as T };\n\t\t}\n\t\treturn { error: result.reason };\n\t});\n}\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nconst P_TAG = /<p[^>]*>/g;\nconst BR_TAG = /<br[^>]*>/g;\nconst DIV_TAG = /<div[^>]*>/g;\nconst SCRIPT_TAG = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\nconst STYLE_TAG = /<style\\b[^<]*(?:(?!<\\/style>)<[^<]*)*<\\/style>/gi;\n\nexport const convertHtmlToPlainText = (html: string): string => {\n\tif (!html) {\n\t\treturn '';\n\t}\n\n\tlet result = html\n\t\t// Remove script tags\n\t\t.replace(SCRIPT_TAG, '')\n\t\t// Remove style tags\n\t\t.replace(STYLE_TAG, '')\n\t\t// Add a couple of newline before every p tag\n\t\t.replace(P_TAG, '\\n\\n<p>')\n\t\t// Convert br tags to new lines\n\t\t.replace(BR_TAG, '\\n')\n\t\t// Add a newline before every p tag\n\t\t.replace(DIV_TAG, '\\n<div>');\n\tconst doc = new DOMParser().parseFromString(result, 'text/html');\n\tresult = doc.body.textContent || '';\n\n\treturn result;\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React from 'react';\n\nimport {\n\tContainer,\n\tContainerProps,\n\tgetPadding,\n\tRow,\n\tRowProps\n} from '@zextras/carbonio-design-system';\nimport styled, { SimpleInterpolation } from 'styled-components';\n\ntype GapContainerProps = ContainerProps & { gap?: ContainerProps['padding'] };\n\ntype GapRowProps = RowProps & { gap?: RowProps['padding'] };\n\nconst StyledGapContainer = styled(Container)<GapContainerProps>`\n\tgap: ${({ theme, gap }): SimpleInterpolation => gap && getPadding(gap, theme)};\n`;\n\nconst StyledGapRow = styled(Row)<GapRowProps>`\n\tgap: ${({ theme, gap }): SimpleInterpolation => gap && getPadding(gap, theme)};\n`;\n\nconst GapContainer = React.forwardRef<HTMLDivElement, GapContainerProps>(function GapContainerFn(\n\t{ children, ...rest },\n\tref\n) {\n\treturn (\n\t\t<StyledGapContainer ref={ref} {...rest}>\n\t\t\t{children}\n\t\t</StyledGapContainer>\n\t);\n});\n\nconst GapRow = React.forwardRef<HTMLDivElement, GapRowProps>(function GapRowFn(\n\t{ children, ...rest },\n\tref\n) {\n\treturn (\n\t\t<StyledGapRow ref={ref} {...rest}>\n\t\t\t{children}\n\t\t</StyledGapRow>\n\t);\n});\n\nexport { GapContainer, GapRow, GapContainerProps, GapRowProps };\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { Account, getUserAccount } from '@zextras/carbonio-shell-ui';\nimport { find, map } from 'lodash';\n\nimport { convertHtmlToPlainText } from '../carbonio-ui-commons/utils/text/html';\nimport { LineType } from '../commons/utils';\nimport type { EditorText } from '../types/editor';\nimport type { SignatureDescriptor } from '../types/signatures';\n\nconst NO_SIGNATURE_ID = '11111111-1111-1111-1111-111111111111';\nconst NO_SIGNATURE_LABEL = 'No signature';\n\n/**\n * Match the first string which is between a\n * signature separator and either a quoted text\n * delimiter or the end of the content\n */\nconst PLAINTEXT_SIGNATURE_REGEX = new RegExp(\n\t`^(${LineType.SIGNATURE_PRE_SEP}\\\\n)(((?!\\\\s${LineType.PLAINTEXT_SEP}$).)*)`,\n\t'ms'\n);\n\n/**\n * Returns signatures descriptors for the given account\n * @param account\n */\nconst getSignatures = (account: Account | undefined): Array<SignatureDescriptor> => {\n\tconst signatureArray = [\n\t\t{\n\t\t\tlabel: NO_SIGNATURE_LABEL,\n\t\t\tvalue: { description: '', id: NO_SIGNATURE_ID }\n\t\t}\n\t];\n\tmap(account?.signatures?.signature, (item) =>\n\t\tsignatureArray.push({\n\t\t\t// FIXME the Account type defined in Shell needs to be refactored (signatures and identities type)\n\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t// @ts-ignore\n\t\t\tlabel: item.name,\n\t\t\t// FIXME the Account type defined in Shell needs to be refactored (signatures and identities type)\n\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t// @ts-ignore\n\t\t\tvalue: { description: item.content ? item.content[0]._content : '', id: item?.id }\n\t\t})\n\t);\n\treturn signatureArray;\n};\n\n/**\n * Returns signature descriptor for the given account and signature id\n * @param account\n * @param signatureId\n * @param fallbackOnFirst - If set to true and if no signature matches the give id (or the given id is undefined) the\n * first signature of the account is returned, instead of returning undefined\n */\nconst getSignature = (\n\taccount: Account | undefined,\n\tsignatureId: string,\n\tfallbackOnFirst?: boolean\n): SignatureDescriptor | undefined => {\n\tconst signatures = getSignatures(account);\n\tconst result = find(\n\t\tsignatures,\n\t\t(signature: SignatureDescriptor) => signature.value.id === signatureId\n\t);\n\n\treturn result ?? (fallbackOnFirst ? signatures?.[0] : undefined);\n};\n\n/**\n * Returns the signature text value for the given account and signature id\n * @param account\n * @param signatureId\n */\nconst getSignatureValue = (account: Account | undefined, signatureId: string): string =>\n\tgetSignature(account, signatureId)?.value.description ?? '';\n\n/**\n * Composes the body of an email with the given signature\n * @param signatureValue\n * @param isRichText\n */\nconst composeMailBodyWithSignature = (\n\tsignatureValue: string | undefined,\n\tisRichText: boolean\n): string => {\n\tif (!signatureValue) {\n\t\treturn '';\n\t}\n\n\treturn isRichText\n\t\t? `<p></p><div class=\"${LineType.SIGNATURE_CLASS}\">${signatureValue}</div>`\n\t\t: `\\n\\n${LineType.SIGNATURE_PRE_SEP}\\n${convertHtmlToPlainText(signatureValue)}`;\n};\n\n/**\n * Replaces the signature in a HTML message body.\n *\n * @param body - HTML message body\n * @param newSignature - content of the new signature\n */\nconst replaceSignatureOnHtmlBody = (body: string, newSignature: string): string => {\n\tconst doc = new DOMParser().parseFromString(body, 'text/html');\n\n\t// Get the element which wraps the signature\n\tconst signatureWrappers = doc.getElementsByClassName(LineType.SIGNATURE_CLASS);\n\n\tlet signatureWrapper = null;\n\n\t// Locate the separator\n\tconst separator = doc.getElementById(LineType.HTML_SEP_ID);\n\n\t// Locate the first signature. If no wrapper is found then the unchanged mail body is returned\n\tsignatureWrapper = signatureWrappers.item(0);\n\tif (signatureWrapper == null) {\n\t\treturn body;\n\t}\n\n\t/*\n\t * If a separator is present it should be located after the signature\n\t * (the content after the separator is quoted text which shouldn't be altered).\n\t * Otherwise the original body content is returned\n\t */\n\tif (\n\t\tseparator &&\n\t\tsignatureWrapper.compareDocumentPosition(separator) !== Node.DOCUMENT_POSITION_FOLLOWING\n\t) {\n\t\treturn body;\n\t}\n\n\tsignatureWrapper.innerHTML = newSignature;\n\treturn doc.documentElement.innerHTML;\n};\n\n/**\n * Replaces the signature in a plain text message body\n *\n * @param body - plain text message body\n * @param newSignature - signature content\n */\nconst replaceSignatureOnPlainTextBody = (body: string, newSignature: string): string => {\n\t// If no eligible signature is found the original body is returned\n\tif (!body.match(PLAINTEXT_SIGNATURE_REGEX)) {\n\t\treturn body;\n\t}\n\n\t// Locate the first quoted text separator\n\tconst quotedTextSeparatorPos = body.indexOf(LineType.PLAINTEXT_SEP);\n\n\tconst match = body.match(PLAINTEXT_SIGNATURE_REGEX);\n\n\t/*\n\t * If the body content doesn't match the regex or if it matches it\n\t * but after a quoted-text separator (= the target signature is\n\t * located inside the quoted text. This could happen when the user\n\t * will manually remove the preset signature inside the UNquoted text.\n\t */\n\tif (!match || (quotedTextSeparatorPos >= 0 && quotedTextSeparatorPos < (match.index ?? 0))) {\n\t\treturn body;\n\t}\n\n\t// Replace the target signature\n\treturn body.replace(PLAINTEXT_SIGNATURE_REGEX, `$1${newSignature}`);\n};\n\n/**\n * Composes the body of an email with signature of given signature id\n * @param text\n * @param signatureId\n */\nconst getMailBodyWithSignature = (text: EditorText, signatureId = ''): EditorText => {\n\tconst signatureValue = signatureId !== '' ? getSignatureValue(getUserAccount(), signatureId) : '';\n\tconst plainSignatureValue =\n\t\tsignatureValue !== '' ? `\\n${convertHtmlToPlainText(signatureValue)}\\n\\n` : '';\n\tconst richText = replaceSignatureOnHtmlBody(text.richText, signatureValue);\n\tconst plainText = replaceSignatureOnPlainTextBody(text.plainText, plainSignatureValue);\n\treturn { plainText, richText };\n};\n\nexport {\n\tNO_SIGNATURE_ID,\n\tNO_SIGNATURE_LABEL,\n\tgetSignatures,\n\tgetSignature,\n\tgetSignatureValue,\n\tcomposeMailBodyWithSignature,\n\treplaceSignatureOnPlainTextBody,\n\tgetMailBodyWithSignature\n};\n","export const FOREGROUND_COLOR = '#c2e7ff';\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, useCallback, useMemo, useState } from 'react';\n\nimport { Container, Text } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\nimport { isNil } from 'lodash';\n\nimport ModalFooter from '../../carbonio-ui-commons/components/modals/modal-footer';\nimport ModalHeader from '../../carbonio-ui-commons/components/modals/modal-header';\nimport type { Folder, RootFolder } from '../../carbonio-ui-commons/types/folder';\nimport { FolderSelector } from '../../views/sidebar/commons/folder-selector';\n\ntype SelectFolderModalProps = {\n\tfolder?: Folder | RootFolder;\n\tonClose: () => void;\n\theaderTitle: string;\n\tactionLabel: string;\n\tactionTooltip?: string;\n\tdisabledActionTooltip?: string;\n\tinputLabel: string;\n\tconfirmAction: (\n\t\tfolder: Folder | undefined,\n\t\tsetFolder: (_folder: Folder | undefined) => void,\n\t\tonClose: () => void\n\t) => void;\n\tshowSharedAccounts: boolean;\n\tshowTrashFolder: boolean;\n\tshowSpamFolder: boolean;\n\tallowRootSelection: boolean;\n\tallowFolderCreation: boolean;\n};\n\nexport const SelectFolderModal: FC<SelectFolderModalProps> = ({\n\tfolder,\n\tonClose,\n\theaderTitle,\n\tactionLabel,\n\tactionTooltip,\n\tdisabledActionTooltip,\n\tinputLabel,\n\tconfirmAction,\n\tshowSharedAccounts,\n\tshowTrashFolder,\n\tshowSpamFolder,\n\tallowFolderCreation,\n\tallowRootSelection\n}) => {\n\tconst [folderDestination, setFolderDestination] = useState<Folder | undefined>(folder);\n\n\tconst onConfirm = useCallback(() => {\n\t\tconfirmAction(folderDestination, setFolderDestination, onClose);\n\t}, [confirmAction, folderDestination, onClose]);\n\n\tconst isConfirmDisabled = useMemo(\n\t\t() => isNil(folderDestination) || folderDestination?.id === folder?.l,\n\t\t[folder?.l, folderDestination]\n\t);\n\n\tconst confirmActionTooltip = isConfirmDisabled\n\t\t? disabledActionTooltip ??\n\t\t\tt('label.folder_not_valid_destination', 'The selected folder is not a valid destination')\n\t\t: actionTooltip;\n\n\treturn (\n\t\t<Container\n\t\t\tpadding={{ all: 'large' }}\n\t\t\tmainAlignment=\"center\"\n\t\t\tcrossAlignment=\"flex-start\"\n\t\t\theight=\"fit\"\n\t\t\tstyle={{\n\t\t\t\toverflowY: 'auto'\n\t\t\t}}\n\t\t>\n\t\t\t<ModalHeader onClose={onClose} title={headerTitle} />\n\t\t\t<Container\n\t\t\t\tdata-testid=\"select-folder-modal\"\n\t\t\t\tpadding={{ all: 'small' }}\n\t\t\t\tmainAlignment=\"center\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\theight=\"fit\"\n\t\t\t\tstyle={{\n\t\t\t\t\toverflowY: 'auto'\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Container padding={{ all: 'small' }} mainAlignment=\"center\" crossAlignment=\"flex-start\">\n\t\t\t\t\t<Text overflow=\"break-word\">{inputLabel}</Text>\n\t\t\t\t</Container>\n\t\t\t\t<FolderSelector\n\t\t\t\t\tselectedFolderId={folderDestination?.id}\n\t\t\t\t\tonFolderSelected={setFolderDestination}\n\t\t\t\t\tshowTrashFolder={showTrashFolder}\n\t\t\t\t\tshowSpamFolder={showSpamFolder}\n\t\t\t\t\tallowFolderCreation={allowFolderCreation}\n\t\t\t\t\tallowRootSelection={allowRootSelection}\n\t\t\t\t\tshowSharedAccounts={showSharedAccounts}\n\t\t\t\t/>\n\t\t\t\t<ModalFooter\n\t\t\t\t\ttooltip={confirmActionTooltip}\n\t\t\t\t\tonConfirm={onConfirm}\n\t\t\t\t\tsecondaryAction={onClose}\n\t\t\t\t\tlabel={actionLabel}\n\t\t\t\t\tsecondaryLabel={t('label.cancel', 'Cancel')}\n\t\t\t\t\tdisabled={isConfirmDisabled}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</Container>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n/* eslint-disable no-nested-ternary */\nimport { t } from '@zextras/carbonio-shell-ui';\nimport { filter, find, isEqual, isObject, map, reduce, transform } from 'lodash';\n\nimport { NO_SIGNATURE_ID } from '../../../helpers/signatures';\n\nexport const differenceObject = (object, base) => {\n\t// eslint-disable-next-line no-shadow\n\tfunction changes(object, base) {\n\t\treturn transform(object, (result, value, key) => {\n\t\t\tif (!isEqual(value, base[key])) {\n\t\t\t\tif (key === 'zimbraPrefMailTrustedSenderList') {\n\t\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\t\tresult[key] = value;\n\t\t\t\t} else {\n\t\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\t\tresult[key] = isObject(value) && isObject(base[key]) ? changes(value, base[key]) : value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\treturn changes(object, base);\n};\n\nexport const differenceIdentities = (original, modified) => {\n\tconst matched = [];\n\tmap(modified, (acc) => {\n\t\tif (!isEqual(acc, find(original, ['id', acc.id]))) {\n\t\t\tmatched.push({\n\t\t\t\tid: acc.id,\n\t\t\t\tname: acc.name,\n\t\t\t\tprefs: {\n\t\t\t\t\tzimbraPrefDefaultSignatureId: acc._attrs.zimbraPrefDefaultSignatureId\n\t\t\t\t\t\t? acc._attrs.zimbraPrefDefaultSignatureId\n\t\t\t\t\t\t: NO_SIGNATURE_ID,\n\t\t\t\t\tzimbraPrefForwardReplySignatureId: acc._attrs.zimbraPrefForwardReplySignatureId\n\t\t\t\t\t\t? acc._attrs.zimbraPrefForwardReplySignatureId\n\t\t\t\t\t\t: NO_SIGNATURE_ID\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n\treturn matched;\n};\n\nexport const getPropsDiff = (original, modified) =>\n\treduce(\n\t\tObject.keys(modified),\n\t\t(acc, v) => {\n\t\t\tif (original?.[v]?.value === modified?.[v]?.value) {\n\t\t\t\treturn acc;\n\t\t\t}\n\t\t\treturn { ...acc, [v]: modified[v] };\n\t\t},\n\t\t{}\n\t);\n\nexport const CheckNewMailOptions = (isSecondsFormat, isMinutesFormat) => [\n\t{\n\t\tlabel: t('settings.new_mail_optn.manually', 'Manually'),\n\t\tvalue: isMinutesFormat ? '31536000' : isSecondsFormat ? '31536000s' : '31536000'\n\t},\n\t{\n\t\tlabel: t('settings.new_mail_optn.when_arrive', 'As new e-mail arrives'),\n\t\tvalue: isMinutesFormat ? '500' : isSecondsFormat ? '500s' : '500'\n\t},\n\t{\n\t\tlabel: t('settings.new_mail_optn.minute', {\n\t\t\tcount: 1,\n\t\t\tdefaultValue: '{{count}} minute',\n\t\t\tdefaultValue_plural: '{{count}} minutes'\n\t\t}),\n\t\tvalue: isMinutesFormat ? '1m' : isSecondsFormat ? '60s' : '60'\n\t},\n\t{\n\t\tlabel: t('settings.new_mail_optn.minute', {\n\t\t\tcount: 2,\n\t\t\tdefaultValue: '{{count}} minute',\n\t\t\tdefaultValue_plural: '{{count}} minutes'\n\t\t}),\n\t\tvalue: isMinutesFormat ? '2m' : isSecondsFormat ? '120s' : '120'\n\t},\n\t{\n\t\tlabel: t('settings.new_mail_optn.minute', {\n\t\t\tcount: 3,\n\t\t\tdefaultValue: '{{count}} minute',\n\t\t\tdefaultValue_plural: '{{count}} minutes'\n\t\t}),\n\t\tvalue: isMinutesFormat ? '3m' : isSecondsFormat ? '180s' : '180'\n\t},\n\t{\n\t\tlabel: t('settings.new_mail_optn.minute', {\n\t\t\tcount: 4,\n\t\t\tdefaultValue: '{{count}} minute',\n\t\t\tdefaultValue_plural: '{{count}} minutes'\n\t\t}),\n\t\tvalue: isMinutesFormat ? '4m' : isSecondsFormat ? '240s' : '240'\n\t},\n\t{\n\t\tlabel: t('settings.new_mail_optn.minute', {\n\t\t\tcount: 5,\n\t\t\tdefaultValue: '{{count}} minute',\n\t\t\tdefaultValue_plural: '{{count}} minutes'\n\t\t}),\n\t\tvalue: isMinutesFormat ? '5m' : isSecondsFormat ? '300s' : '300'\n\t},\n\t{\n\t\tlabel: t('settings.new_mail_optn.minute', {\n\t\t\tcount: 6,\n\t\t\tdefaultValue: '{{count}} minute',\n\t\t\tdefaultValue_plural: '{{count}} minutes'\n\t\t}),\n\t\tvalue: isMinutesFormat ? '6m' : isSecondsFormat ? '360s' : '360'\n\t},\n\t{\n\t\tlabel: t('settings.new_mail_optn.minute', {\n\t\t\tcount: 7,\n\t\t\tdefaultValue: '{{count}} minute',\n\t\t\tdefaultValue_plural: '{{count}} minutes'\n\t\t}),\n\t\tvalue: isMinutesFormat ? '7m' : isSecondsFormat ? '420s' : '420'\n\t},\n\t{\n\t\tlabel: t('settings.new_mail_optn.minute', {\n\t\t\tcount: 8,\n\t\t\tdefaultValue: '{{count}} minute',\n\t\t\tdefaultValue_plural: '{{count}} minutes'\n\t\t}),\n\t\tvalue: isMinutesFormat ? '8m' : isSecondsFormat ? '480s' : '480'\n\t},\n\t{\n\t\tlabel: t('settings.new_mail_optn.minute', {\n\t\t\tcount: 9,\n\t\t\tdefaultValue: '{{count}} minute',\n\t\t\tdefaultValue_plural: '{{count}} minutes'\n\t\t}),\n\t\tvalue: isMinutesFormat ? '9m' : isSecondsFormat ? '540s' : '540'\n\t},\n\t{\n\t\tlabel: t('settings.new_mail_optn.minute', {\n\t\t\tcount: 10,\n\t\t\tdefaultValue: '{{count}} minute',\n\t\t\tdefaultValue_plural: '{{count}} minutes'\n\t\t}),\n\t\tvalue: isMinutesFormat ? '10m' : isSecondsFormat ? '600s' : '600'\n\t},\n\t{\n\t\tlabel: t('settings.new_mail_optn.minute', {\n\t\t\tcount: 15,\n\t\t\tdefaultValue: '{{count}} minute',\n\t\t\tdefaultValue_plural: '{{count}} minutes'\n\t\t}),\n\t\tvalue: isMinutesFormat ? '15m' : isSecondsFormat ? '900s' : '900'\n\t}\n];\nexport const DisplayMailOptions = () => [\n\t{ label: t('settings.display_mail_options.html', 'As HTML(When Possible)'), value: 'TRUE' },\n\t{ label: t('settings.display_mail_options.text', 'As text'), value: 'FALSE' }\n];\n\nexport const MessageSelectionOptions = () => [\n\t{\n\t\tlabel: t(\n\t\t\t'settings.msg_selection_optn.below_deleted',\n\t\t\t'Select message below the deleted or moved message'\n\t\t),\n\t\tvalue: 'next'\n\t},\n\t{\n\t\tlabel: t(\n\t\t\t'settings.msg_selection_optn.above_deleted',\n\t\t\t'Select message above the deleted or moved message'\n\t\t),\n\t\tvalue: 'previous'\n\t},\n\t{\n\t\tlabel: t(\n\t\t\t'settings.msg_selection_optn.based_on_previous',\n\t\t\t'Select next message based on previous selections'\n\t\t),\n\t\tvalue: 'adaptive'\n\t}\n];\n\nexport const NotifyFolderOpts = () => [\n\t{\n\t\tlabel: t(\n\t\t\t'settings.notify_folder_optn.new_message_inbox',\n\t\t\t'Display notifications for new messages that arrive in inbox'\n\t\t),\n\t\tvalue: 'FALSE'\n\t},\n\t{\n\t\tlabel: t(\n\t\t\t'settings.notify_folder_optn.new_message_folder',\n\t\t\t'Display notifications for new messages that arrive in any folder'\n\t\t),\n\t\tvalue: 'TRUE'\n\t}\n];\n\nexport const ReadReceiptOpts = () => [\n\t{ label: t('settings.read_rcpt_optn.never', 'Never send a read reciept'), value: 'never' },\n\t{ label: t('settings.read_rcpt_optn.always', 'Always send a read reciept'), value: 'always' },\n\t{ label: t('settings.read_rcpt_optn.ask_me', 'Ask me'), value: 'prompt' }\n];\n\nexport const MsgsFromMeOpts = () => [\n\t{ label: t('settings.msg_from_optn.inbox', 'Place in inbox'), value: 'dedupeNone' },\n\t{\n\t\tlabel: t('settings.msg_from_optn.inbox_if_cc', \"Place in inbox if I'm in To: or Cc:\"),\n\t\tvalue: 'secondCopyifOnToOrCC'\n\t},\n\t{\n\t\tlabel: t('settings.msg_from_optn.discard', 'Discard message automatically'),\n\t\tvalue: 'dedupeAll'\n\t}\n];\n\nexport const ReadSignatureSettings = () => [\n\t{ label: t('settings.msg_from_optn.inbox', 'Place in inbox'), value: 'dedupeNone' },\n\t{\n\t\tlabel: t('settings.msg_from_optn.inbox_if_cc', \"Place in inbox if I'm in To: or Cc:\"),\n\t\tvalue: 'secondCopyifOnToOrCC'\n\t},\n\t{\n\t\tlabel: t('settings.msg_from_optn.discard', 'Discard message automatically'),\n\t\tvalue: 'dedupeAll'\n\t}\n];\n\nexport const getFontSizesOptions = () => [\n\t{\n\t\tlabel: t('settings.font_size', {\n\t\t\tcount: '8',\n\t\t\tdefaultValue: '{{count}} pt'\n\t\t}),\n\t\tvalue: '8pt'\n\t},\n\t{\n\t\tlabel: t('settings.font_size', {\n\t\t\tcount: '9',\n\t\t\tdefaultValue: '{{count}} pt'\n\t\t}),\n\t\tvalue: '9pt'\n\t},\n\t{\n\t\tlabel: t('settings.font_size', {\n\t\t\tcount: '10',\n\t\t\tdefaultValue: '{{count}} pt'\n\t\t}),\n\t\tvalue: '10pt'\n\t},\n\t{\n\t\tlabel: t('settings.font_size', {\n\t\t\tcount: '11',\n\t\t\tdefaultValue: '{{count}} pt'\n\t\t}),\n\t\tvalue: '11pt'\n\t},\n\t{\n\t\tlabel: t('settings.font_size', {\n\t\t\tcount: '12',\n\t\t\tdefaultValue: '{{count}} pt'\n\t\t}),\n\t\tvalue: '12pt'\n\t},\n\t{\n\t\tlabel: t('settings.font_size', {\n\t\t\tcount: '13',\n\t\t\tdefaultValue: '{{count}} pt'\n\t\t}),\n\t\tvalue: '13pt'\n\t},\n\t{\n\t\tlabel: t('settings.font_size', {\n\t\t\tcount: '14',\n\t\t\tdefaultValue: '{{count}} pt'\n\t\t}),\n\t\tvalue: '14pt'\n\t},\n\t{\n\t\tlabel: t('settings.font_size', {\n\t\t\tcount: '16',\n\t\t\tdefaultValue: '{{count}} pt'\n\t\t}),\n\t\tvalue: '16pt'\n\t},\n\t{\n\t\tlabel: t('settings.font_size', {\n\t\t\tcount: '18',\n\t\t\tdefaultValue: '{{count}} pt'\n\t\t}),\n\t\tvalue: '18pt'\n\t},\n\t{\n\t\tlabel: t('settings.font_size', {\n\t\t\tcount: '24',\n\t\t\tdefaultValue: '{{count}} pt'\n\t\t}),\n\t\tvalue: '24pt'\n\t},\n\t{\n\t\tlabel: t('settings.font_size', {\n\t\t\tcount: '36',\n\t\t\tdefaultValue: '{{count}} pt'\n\t\t}),\n\t\tvalue: '36pt'\n\t},\n\t{\n\t\tlabel: t('settings.font_size', {\n\t\t\tcount: '48',\n\t\t\tdefaultValue: '{{count}} pt'\n\t\t}),\n\t\tvalue: '48pt'\n\t}\n];\n\nexport const getFonts = () => [\n\t{\n\t\tlabel: t('settings.fonts.sans_serif', 'Sans Serif'),\n\t\tvalue: 'arial,helvetica,sans-serif'\n\t},\n\t{\n\t\tlabel: t('settings.fonts.serif', 'Serif'),\n\t\tvalue: 'times new roman,new york,times,serif'\n\t},\n\t{\n\t\tlabel: t('settings.fonts.wide_block', 'Wide Block'),\n\t\tvalue: 'arial black,avant garde'\n\t},\n\t{\n\t\tlabel: t('settings.fonts.monospaced', 'Monospaced'),\n\t\tvalue: 'courier new,courier,monaco,monospace,sans-serif'\n\t},\n\t{\n\t\tlabel: t('settings.fonts.comic', 'Comic'),\n\t\tvalue: 'comic sans ms,comic sans,sans-serif'\n\t},\n\t{\n\t\tlabel: t('settings.fonts.console', 'Console'),\n\t\tvalue: 'lucida console,sans-serif'\n\t},\n\t{\n\t\tlabel: t('settings.fonts.garamond', 'Garamond'),\n\t\tvalue: 'garamond,new york,times,serif'\n\t},\n\t{\n\t\tlabel: t('settings.fonts.elegant', 'Elegant'),\n\t\tvalue: 'georgia,serif'\n\t},\n\t{\n\t\tlabel: t('settings.fonts.professional', 'Professional'),\n\t\tvalue: 'tahoma,new york,times,serif'\n\t},\n\t{\n\t\tlabel: t('settings.fonts.terminal', 'Terminal'),\n\t\tvalue: 'terminal,monaco'\n\t},\n\t{\n\t\tlabel: t('settings.fonts.modern', 'Modern'),\n\t\tvalue: 'trebuchet ms,sans-serif'\n\t},\n\t{\n\t\tlabel: t('settings.fonts.wide', 'Wide'),\n\t\tvalue: 'verdana,helvetica,sans-serif'\n\t}\n];\nexport const ConversationSortingSettings = () => [\n\t{ label: t('settings.conv_sort_option.desc', 'From new to old'), value: 'dateDesc' },\n\t{ label: t('settings.conv_sort_option.asc', 'From old to new'), value: 'dateAsc' }\n];\n\nexport const findLabel = (list, value) => filter(list, (item) => item.value === value)[0]?.label;\n\nexport const UnsendTimeOptions = () => [\n\t{\n\t\tlabel: t('settings.mail_unsend_time.no_delay', 'No delay'),\n\t\tvalue: '0'\n\t},\n\t{\n\t\tlabel: t('settings.mail_unsend_time.second', {\n\t\t\tcount: 3,\n\t\t\tdefaultValue: '{{count}} second',\n\t\t\tdefaultValue_plural: '{{count}} seconds'\n\t\t}),\n\t\tvalue: '3'\n\t},\n\t{\n\t\tlabel: t('settings.mail_unsend_time.second', {\n\t\t\tcount: 5,\n\t\t\tdefaultValue: '{{count}} second',\n\t\t\tdefaultValue_plural: '{{count}} seconds'\n\t\t}),\n\t\tvalue: '5'\n\t},\n\t{\n\t\tlabel: t('settings.mail_unsend_time.second', {\n\t\t\tcount: 10,\n\t\t\tdefaultValue: '{{count}} second',\n\t\t\tdefaultValue_plural: '{{count}} seconds'\n\t\t}),\n\t\tvalue: '10'\n\t},\n\t{\n\t\tlabel: t('settings.mail_unsend_time.second', {\n\t\t\tcount: 20,\n\t\t\tdefaultValue: '{{count}} second',\n\t\t\tdefaultValue_plural: '{{count}} seconds'\n\t\t}),\n\t\tvalue: '20'\n\t}\n];\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC } from 'react';\nimport { Padding, Row, Text } from '@zextras/carbonio-design-system';\n\nconst Heading: FC<{\n\ttitle: string;\n\tsize?: 'extrasmall' | 'small' | 'medium' | 'large' | 'extralarge';\n}> = ({ title, size = 'large' }) => (\n\t<>\n\t\t<Padding top=\"medium\" />\n\t\t<Row\n\t\t\tpadding={{ right: 'small' }}\n\t\t\tmainAlignment=\"baseline\"\n\t\t\tcrossAlignment=\"baseline\"\n\t\t\twidth=\"100%\"\n\t\t>\n\t\t\t<Text size={size} weight=\"bold\">\n\t\t\t\t{title}\n\t\t\t</Text>\n\t\t</Row>\n\n\t\t<Padding bottom=\"medium\" />\n\t</>\n);\n\nexport default Heading;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useMemo } from 'react';\nimport { Row, Select, Text, Padding, Icon, Container } from '@zextras/carbonio-design-system';\nimport { map } from 'lodash';\nimport {\n\tColorContainer,\n\tTextUpperCase\n} from '../../../../integrations/shared-invite-reply/parts/styled-components';\n\ntype LabelFactoryPropsType = {\n\tselected: Array<{ label: string; value: string }>;\n\tlabel?: string;\n\topen: boolean;\n\tfocus: boolean;\n\tdisabled: boolean;\n};\nconst LabelFactory: FC<LabelFactoryPropsType> = ({\n\tselected,\n\tlabel,\n\topen,\n\tfocus,\n\tdisabled\n}): ReactElement => (\n\t<ColorContainer\n\t\torientation=\"horizontal\"\n\t\twidth=\"fill\"\n\t\tcrossAlignment=\"center\"\n\t\tmainAlignment=\"space-between\"\n\t\tborderRadius=\"half\"\n\t\tbackground=\"gray5\"\n\t\tpadding={{\n\t\t\tall: 'extrasmall'\n\t\t}}\n\t\tdisabled={disabled}\n\t\tminHeight=\"3rem\"\n\t>\n\t\t<Row width=\"100%\" takeAvailableSpace mainAlignment=\"space-between\">\n\t\t\t<Row\n\t\t\t\torientation=\"vertical\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\tpadding={{ left: 'small' }}\n\t\t\t>\n\t\t\t\t<Text\n\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t// eslint-disable-next-line no-nested-ternary\n\t\t\t\t\tcolor={open || focus ? 'primary' : disabled ? 'gray2' : 'secondary'}\n\t\t\t\t>\n\t\t\t\t\t{label}\n\t\t\t\t</Text>\n\t\t\t\t<TextUpperCase color={disabled ? 'gray2' : 'text'}>{selected?.[0]?.label}</TextUpperCase>\n\t\t\t</Row>\n\t\t</Row>\n\t\t<Icon\n\t\t\tsize=\"large\"\n\t\t\ticon={open ? 'ChevronUpOutline' : 'ChevronDownOutline'}\n\t\t\tcolor={open || focus ? 'primary' : 'secondary'}\n\t\t\tstyle={{ alignSelf: 'center' }}\n\t\t/>\n\t</ColorContainer>\n);\n\ntype GetItemsReturnType = Array<{ label: string; value: any; customComponent: ReactElement }>;\nconst getItems = (items: Array<{ label: string; value: any }>): GetItemsReturnType =>\n\tmap(items, (el) => ({\n\t\tlabel: el?.label,\n\t\tvalue: el?.value,\n\t\tcustomComponent: (\n\t\t\t<Container width=\"100%\" mainAlignment=\"space-between\" orientation=\"horizontal\" height=\"fit\">\n\t\t\t\t<Padding left=\"small\">\n\t\t\t\t\t<TextUpperCase>{el?.label}</TextUpperCase>\n\t\t\t\t</Padding>\n\t\t\t</Container>\n\t\t)\n\t}));\n\nconst CustomSelect: FC<{\n\tonChange: (arg: any) => void;\n\tdefaultSelection: { label: string; value: any };\n\tlabel: string;\n\titems: Array<{ label: string; value: any }>;\n\tbackground?: string;\n\tdisabled?: boolean;\n}> = ({ onChange, defaultSelection, label, items, disabled = false }) => {\n\tconst newItems = useMemo(() => getItems(items), [items]);\n\n\treturn (\n\t\t<Select\n\t\t\tlabel={label}\n\t\t\tbackground=\"white\"\n\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\tdisabled={disabled}\n\t\t\tonChange={onChange}\n\t\t\titems={newItems}\n\t\t\tdefaultSelection={defaultSelection}\n\t\t\tLabelFactory={LabelFactory}\n\t\t\tmaxHeight=\"20vh\"\n\t\t\tdropdownWidth=\"auto\"\n\t\t\tdata-testid=\"field-select\"\n\t\t/>\n\t);\n};\n\nexport default CustomSelect;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { RefObject, useEffect } from 'react';\n\ntype StartedWhenMounted = null | boolean | HTMLInputElement;\ntype StartedInside = null | boolean;\n\nconst useClickOutside = (ref: RefObject<HTMLInputElement>, handler: (arg: any) => void): void => {\n\tuseEffect(() => {\n\t\tlet startedInside: StartedInside = false;\n\t\tlet startedWhenMounted: StartedWhenMounted = false;\n\n\t\tconst listener = (event: any): void => {\n\t\t\t// Do nothing if `mousedown` or `touchstart` started inside ref element\n\t\t\tif (startedInside || !startedWhenMounted) return;\n\t\t\t// Do nothing if clicking ref's element or descendent elements\n\t\t\tif (!ref.current || ref.current.contains(event.target)) return;\n\n\t\t\thandler(event);\n\t\t};\n\n\t\tconst validateEventStart = (event: any): void => {\n\t\t\tstartedWhenMounted = ref.current;\n\t\t\tstartedInside = ref.current && ref.current.contains(event.target);\n\t\t};\n\n\t\tdocument.addEventListener('mousedown', validateEventStart);\n\t\tdocument.addEventListener('touchstart', validateEventStart);\n\t\tdocument.addEventListener('click', listener);\n\n\t\treturn (): void => {\n\t\t\tdocument.removeEventListener('mousedown', validateEventStart);\n\t\t\tdocument.removeEventListener('touchstart', validateEventStart);\n\t\t\tdocument.removeEventListener('click', listener);\n\t\t};\n\t}, [ref, handler]);\n};\n\nexport default useClickOutside;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, useCallback, useRef, useState } from 'react';\nimport { HexColorPicker } from 'react-colorful';\nimport styled from 'styled-components';\nimport { Container, ContainerProps, Icon } from '@zextras/carbonio-design-system';\nimport useClickOutside from '../hooks/use-click-outside-picker';\nimport { ColorContainer } from '../integrations/shared-invite-reply/parts/styled-components';\n\nconst ColorBox = styled(Container)<ContainerProps & { disabled: boolean; color: string }>`\n\twidth: 1.75rem;\n\theight: 1.75rem;\n\tborder-radius: 0.5rem;\n\tborder: 0.1875rem solid #fff;\n\tbox-shadow:\n\t\t0 0 0 0.0625rem rgba(0, 0, 0, 0.1),\n\t\tinset 0 0 0 0.0625rem rgba(0, 0, 0, 0.1);\n\tcursor: ${({ disabled }): string => (disabled ? 'no-drop' : 'pointer')};\n\tbackground-color: ${({ color }): string => color};\n\topacity: ${({ disabled }): string => (disabled ? '0.5' : '1')};\n`;\n\nconst PopOver = styled(Container)`\n\tposition: absolute;\n\ttop: calc(100% + 0.125rem);\n\tleft: 0;\n\twidth: 12.5rem;\n\theight: 12.5rem;\n\tborder-radius: 0.5625rem;\n\tbox-shadow: 0 0.375rem 0.75rem rgba(0, 0, 0, 0.15);\n`;\n\nexport const ColorPicker: FC<{\n\tcolor: string;\n\tonChange: (arg: string) => void;\n\tdisabled?: boolean;\n}> = ({ color, onChange, disabled = false }) => {\n\tconst popover = useRef(null);\n\tconst [isOpen, setIsOpen] = useState(false);\n\n\tconst close = useCallback(() => setIsOpen(false), []);\n\tuseClickOutside(popover, close);\n\n\treturn (\n\t\t<ColorContainer\n\t\t\torientation=\"horizontal\"\n\t\t\twidth=\"fit\"\n\t\t\tborderRadius=\"half\"\n\t\t\tbackground=\"gray5\"\n\t\t\tpadding={{\n\t\t\t\tall: 'small'\n\t\t\t}}\n\t\t\tstyle={{ cursor: disabled ? 'no-drop' : 'pointer' }}\n\t\t\tonClick={(): void | null => (disabled ? null : setIsOpen(true))}\n\t\t\theight=\"3rem\"\n\t\t>\n\t\t\t<Container style={{ position: 'relative' }} orientation=\"horizontal\" width=\"fit\">\n\t\t\t\t<ColorBox color={color} disabled={disabled} />\n\t\t\t\t{isOpen && (\n\t\t\t\t\t<PopOver ref={popover}>\n\t\t\t\t\t\t<HexColorPicker color={color} onChange={onChange} />\n\t\t\t\t\t</PopOver>\n\t\t\t\t)}\n\t\t\t\t<Icon\n\t\t\t\t\tsize=\"large\"\n\t\t\t\t\ticon={isOpen ? 'ChevronUpOutline' : 'ChevronDownOutline'}\n\t\t\t\t\tcolor={isOpen ? 'primary' : 'secondary'}\n\t\t\t\t\tstyle={{ alignSelf: 'center' }}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</ColorContainer>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React, { FC, useCallback, useMemo, useState } from 'react';\n\nimport { Container, FormSubSection, RadioGroup, Radio } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\n\nimport Heading from './components/settings-heading';\nimport { getFontSizesOptions, findLabel, getFonts } from './components/utils';\nimport CustomSelect from './filters/parts/custom-select';\nimport { composingMsgSubSection } from './subsections';\nimport { ColorPicker } from '../../commons/color-picker';\n\ntype UpdateSettingsProps = {\n\ttarget: {\n\t\tname: string;\n\t\tvalue: string;\n\t};\n};\n\ntype ComposeMessagesProps = {\n\tsettingsObj: Record<string, string>;\n\tupdateSettings: (arg: UpdateSettingsProps) => void;\n};\n\nconst ComposeMessage: FC<ComposeMessagesProps> = ({ settingsObj, updateSettings }) => {\n\tconst [color, setColor] = useState(\n\t\tsettingsObj?.zimbraPrefHtmlEditorDefaultFontColor ?? '#aabbcc'\n\t);\n\n\tconst sectionTitle = useMemo(() => composingMsgSubSection(), []);\n\tconst fontSizesOptions = useMemo(() => getFontSizesOptions(), []);\n\tconst fontsOptions = useMemo(() => getFonts(), []);\n\n\tconst onColorChange = useCallback(\n\t\t(value) => {\n\t\t\tsetColor(value);\n\t\t\tupdateSettings({ target: { name: 'zimbraPrefHtmlEditorDefaultFontColor', value } });\n\t\t},\n\t\t[updateSettings]\n\t);\n\n\tconst defaultSelectionFontSize = useMemo(\n\t\t() => ({\n\t\t\tlabel: findLabel(fontSizesOptions, settingsObj.zimbraPrefHtmlEditorDefaultFontSize),\n\t\t\tvalue: settingsObj.zimbraPrefHtmlEditorDefaultFontSize\n\t\t}),\n\t\t[fontSizesOptions, settingsObj.zimbraPrefHtmlEditorDefaultFontSize]\n\t);\n\n\tconst defaultSelectionFont = useMemo(\n\t\t() => ({\n\t\t\tlabel: findLabel(fontsOptions, settingsObj.zimbraPrefHtmlEditorDefaultFontFamily),\n\t\t\tvalue: settingsObj.zimbraPrefHtmlEditorDefaultFontFamily\n\t\t}),\n\t\t[fontsOptions, settingsObj.zimbraPrefHtmlEditorDefaultFontFamily]\n\t);\n\tconst isDisabled = useMemo(\n\t\t() => settingsObj?.zimbraPrefComposeFormat === 'text',\n\t\t[settingsObj?.zimbraPrefComposeFormat]\n\t);\n\treturn (\n\t\t<FormSubSection id={sectionTitle.id} label={sectionTitle.label} padding={{ all: 'medium' }}>\n\t\t\t<Container\n\t\t\t\tcrossAlignment=\"baseline\"\n\t\t\t\tpadding={{ horizontal: 'small', bottom: 'small', top: 'medium' }}\n\t\t\t>\n\t\t\t\t<Container orientation=\"horizontal\" crossAlignment=\"flex-start\" mainAlignment=\"flex-start\">\n\t\t\t\t\t<Container\n\t\t\t\t\t\twidth=\"fit\"\n\t\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Heading title={t('labels.compose_colin', 'Compose :')} size=\"small\" />{' '}\n\t\t\t\t\t\t<RadioGroup\n\t\t\t\t\t\t\tstyle={{ width: '100%' }}\n\t\t\t\t\t\t\tvalue={settingsObj?.zimbraPrefComposeFormat}\n\t\t\t\t\t\t\tonChange={(newValue): void => {\n\t\t\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\t\t\ttarget: { name: 'zimbraPrefComposeFormat', value: newValue as string }\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Radio width=\"100%\" label={t('label.as_html', 'As HTML')} value=\"html\" />\n\t\t\t\t\t\t\t<Radio width=\"100%\" label={t('label.as_text', 'As Text')} value=\"text\" />\n\t\t\t\t\t\t</RadioGroup>\n\t\t\t\t\t</Container>\n\t\t\t\t\t<Container\n\t\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\t\tmainAlignment=\"space-between\"\n\t\t\t\t\t\tpadding={{ left: 'medium' }}\n\t\t\t\t\t\tmaxWidth=\"40vw\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Container padding={{ right: 'small' }} minWidth=\"5.9375rem\">\n\t\t\t\t\t\t\t<CustomSelect\n\t\t\t\t\t\t\t\titems={fontsOptions}\n\t\t\t\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\t\t\t\tdisabled={isDisabled}\n\t\t\t\t\t\t\t\tlabel={t('settings.font', 'Font')}\n\t\t\t\t\t\t\t\tonChange={(value: string): void =>\n\t\t\t\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\t\t\t\ttarget: { name: 'zimbraPrefHtmlEditorDefaultFontFamily', value }\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdefaultSelection={defaultSelectionFont}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Container>\n\n\t\t\t\t\t\t<Container padding={{ right: 'small' }} minWidth=\"6.25rem\">\n\t\t\t\t\t\t\t<CustomSelect\n\t\t\t\t\t\t\t\titems={fontSizesOptions}\n\t\t\t\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\t\t\t\tlabel={t('label.size', 'Size')}\n\t\t\t\t\t\t\t\tdefaultSelection={defaultSelectionFontSize}\n\t\t\t\t\t\t\t\tdisabled={isDisabled}\n\t\t\t\t\t\t\t\tonChange={(size: string): void =>\n\t\t\t\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\t\t\t\ttarget: { name: 'zimbraPrefHtmlEditorDefaultFontSize', value: size }\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Container>\n\t\t\t\t\t\t<Container padding={{ right: 'small' }} crossAlignment=\"flex-start\">\n\t\t\t\t\t\t\t<ColorPicker color={color} onChange={onColorChange} disabled={isDisabled} />\n\t\t\t\t\t\t</Container>\n\t\t\t\t\t</Container>\n\t\t\t\t</Container>\n\t\t\t</Container>\n\t\t</FormSubSection>\n\t);\n};\n\nexport default ComposeMessage;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React, { ChangeEvent, FC, useCallback, useMemo } from 'react';\n\nimport {\n\tContainer,\n\tRow,\n\tFormSubSection,\n\tSelect,\n\tInput,\n\tPadding,\n\tRadioGroup,\n\tRadio,\n\tSelectItem,\n\tIcon,\n\tText\n} from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\n\nimport Heading from './components/settings-heading';\nimport {\n\tCheckNewMailOptions,\n\tDisplayMailOptions,\n\tMessageSelectionOptions,\n\tfindLabel,\n\tConversationSortingSettings,\n\tUnsendTimeOptions\n} from './components/utils';\nimport { displayingMessagesSubSection } from './subsections';\nimport { MAIL_APP_ID } from '../../constants';\nimport type { DisplayingMessagesSettingsProps } from '../../types';\n\nconst DisplayingMessagesSettings: FC<DisplayingMessagesSettingsProps> = ({\n\tsettingsObj,\n\tupdateSettings,\n\tupdateProps,\n\tupdatedProps\n}) => {\n\tconst checkNewMailOptions = useMemo(\n\t\t() =>\n\t\t\tCheckNewMailOptions(\n\t\t\t\tsettingsObj.zimbraPrefMailPollingInterval.includes('s'),\n\t\t\t\tsettingsObj.zimbraPrefMailPollingInterval.includes('m')\n\t\t\t),\n\t\t[settingsObj?.zimbraPrefMailPollingInterval]\n\t);\n\tconst displayMailOptions = useMemo(() => DisplayMailOptions(), []);\n\tconst messageSelectionOptions = useMemo(() => MessageSelectionOptions(), []);\n\tconst conversationSortingSettings = useMemo(() => ConversationSortingSettings(), []);\n\tconst unsendTimeOptions = useMemo(() => UnsendTimeOptions(), []);\n\n\tconst sectionTitle = useMemo(() => displayingMessagesSubSection(), []);\n\n\tconst onChangeSorting = useCallback(\n\t\t(view: SelectItem[] | string | null): void =>\n\t\t\tupdateSettings({\n\t\t\t\ttarget: { name: 'zimbraPrefConversationOrder', value: (view as string) ?? '' }\n\t\t\t}),\n\t\t[updateSettings]\n\t);\n\n\tconst defaultSelectionSorting = useMemo(\n\t\t() => ({\n\t\t\tlabel: findLabel(conversationSortingSettings, settingsObj.zimbraPrefConversationOrder),\n\t\t\tvalue: settingsObj.zimbraPrefConversationOrder\n\t\t}),\n\t\t[conversationSortingSettings, settingsObj.zimbraPrefConversationOrder]\n\t);\n\tconst defaultUnsendTime = useMemo(\n\t\t() => ({\n\t\t\tlabel: findLabel(unsendTimeOptions, updatedProps?.mails_snackbar_delay?.value as string),\n\t\t\tvalue: updatedProps?.mails_snackbar_delay?.value\n\t\t}),\n\t\t[unsendTimeOptions, updatedProps?.mails_snackbar_delay]\n\t);\n\n\treturn (\n\t\t<FormSubSection id={sectionTitle.id} label={sectionTitle.label} padding={{ all: 'medium' }}>\n\t\t\t<Row width=\"100%\" padding={{ horizontal: 'small', vertical: 'small' }}>\n\t\t\t\t<Select\n\t\t\t\t\tlabel={t('settings.label.conversation_ordering', 'Conversation ordering')}\n\t\t\t\t\titems={conversationSortingSettings}\n\t\t\t\t\tonChange={onChangeSorting}\n\t\t\t\t\tdefaultSelection={defaultSelectionSorting}\n\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\t\t/>\n\t\t\t</Row>\n\t\t\t<Row width=\"100%\" padding={{ horizontal: 'small', bottom: 'small' }}>\n\t\t\t\t<Select\n\t\t\t\t\tlabel={t('settings.label.check_new_mail', 'Check new e-mail')}\n\t\t\t\t\titems={checkNewMailOptions}\n\t\t\t\t\tonChange={(view: SelectItem[] | string | null): void =>\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: { name: 'zimbraPrefMailPollingInterval', value: (view as string) ?? '' }\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tdefaultSelection={{\n\t\t\t\t\t\tlabel: findLabel(checkNewMailOptions, settingsObj.zimbraPrefMailPollingInterval),\n\t\t\t\t\t\tvalue: settingsObj.zimbraPrefMailPollingInterval\n\t\t\t\t\t}}\n\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\t\t/>\n\t\t\t</Row>\n\n\t\t\t<Row width=\"100%\" padding={{ horizontal: 'small' }}>\n\t\t\t\t<Select\n\t\t\t\t\tlabel={t('settings.label.display_mail', 'Display mail')}\n\t\t\t\t\titems={displayMailOptions}\n\t\t\t\t\tonChange={(view: SelectItem[] | string | null): void =>\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: { name: 'zimbraPrefMessageViewHtmlPreferred', value: (view as string) ?? '' }\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tdefaultSelection={{\n\t\t\t\t\t\tlabel: findLabel(displayMailOptions, settingsObj.zimbraPrefMessageViewHtmlPreferred),\n\t\t\t\t\t\tvalue: settingsObj.zimbraPrefMessageViewHtmlPreferred\n\t\t\t\t\t}}\n\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\t\t/>\n\t\t\t</Row>\n\t\t\t{/* Will be Implemented in starting months of 2022 */}\n\t\t\t{/* <Container crossAlignment=\"baseline\">\n\t\t\t\t<Heading title={t('settings.label.message_preview_title', 'Message preview and Images')} />\n\t\t\t\t<Padding bottom=\"small\" />\n\t\t\t\t<Checkbox\n\t\t\t\t\tlabel={t(\n\t\t\t\t\t\t'settings.label.display_external_images',\n\t\t\t\t\t\t'Automatically display external images in HTML e-mail'\n\t\t\t\t\t)}\n\t\t\t\t\tvalue={settingsObj.zimbraPrefDisplayExternalImages === 'TRUE'}\n\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\t\tname: 'zimbraPrefDisplayExternalImages',\n\t\t\t\t\t\t\t\tvalue: settingsObj.zimbraPrefDisplayExternalImages === 'TRUE' ? 'FALSE' : 'TRUE'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t</Container> */}\n\t\t\t<Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t<Heading title={t('settings.label.message_selection', 'Message Selection')} />\n\t\t\t\t<Select\n\t\t\t\t\titems={messageSelectionOptions}\n\t\t\t\t\tonChange={(view: SelectItem[] | string | null): void =>\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: { name: 'zimbraPrefMailSelectAfterDelete', value: (view as string) ?? '' }\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tdefaultSelection={{\n\t\t\t\t\t\tlabel: findLabel(messageSelectionOptions, settingsObj.zimbraPrefMailSelectAfterDelete),\n\t\t\t\t\t\tvalue: settingsObj.zimbraPrefMailSelectAfterDelete\n\t\t\t\t\t}}\n\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\t\t/>\n\t\t\t</Container>\n\n\t\t\t<Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t<Heading title={t('settings.label.unsend_time', 'Set send time')} />\n\t\t\t\t<Select\n\t\t\t\t\tlabel={t('settings.label.unsend_time', 'Set send time')}\n\t\t\t\t\titems={unsendTimeOptions}\n\t\t\t\t\tonChange={(view: SelectItem[] | string | null): void =>\n\t\t\t\t\t\tupdateProps({\n\t\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\t\tname: 'mails_snackbar_delay',\n\t\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\t\t\tapp: MAIL_APP_ID,\n\t\t\t\t\t\t\t\t\tvalue: (view as string) ?? ''\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tdefaultSelection={defaultUnsendTime}\n\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\t\t/>\n\t\t\t</Container>\n\n\t\t\t{/* <Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t<Heading title={t('settings.label.message_color', 'Message Color')} />\n\t\t\t\t<Checkbox\n\t\t\t\t\tlabel={t(\n\t\t\t\t\t\t'settings.label.set_message_color',\n\t\t\t\t\t\t'Set color of messages and conversations according to tag color.'\n\t\t\t\t\t)}\n\t\t\t\t\tvalue={settingsObj.zimbraPrefColorMessagesEnabled === 'TRUE'}\n\t\t\t\t\tonClick={(): void =>\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\t\tname: 'zimbraPrefColorMessagesEnabled',\n\t\t\t\t\t\t\t\tvalue: settingsObj.zimbraPrefColorMessagesEnabled === 'TRUE' ? 'FALSE' : 'TRUE'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t</Container> */}\n\t\t\t<Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t<Heading title={t('settings.label.visualization_options', 'Visualization Options')} />\n\t\t\t\t<RadioGroup\n\t\t\t\t\tstyle={{ width: '100%' }}\n\t\t\t\t\tvalue={settingsObj.zimbraPrefGroupMailBy}\n\t\t\t\t\tonChange={(newValue): void => {\n\t\t\t\t\t\tupdateSettings({ target: { name: 'zimbraPrefGroupMailBy', value: newValue } });\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Radio\n\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\tlabel={t('label.by_conversation', 'By Conversation')}\n\t\t\t\t\t\tvalue=\"conversation\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Radio width=\"100%\" label={t('label.by_message', 'By Message')} value=\"message\" />\n\t\t\t\t</RadioGroup>\n\t\t\t</Container>\n\t\t\t<Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t<Heading title={t('settings.label.default_mail_search', 'Default Mail Search')} />\n\t\t\t\t<Input\n\t\t\t\t\tlabel={t('settings.label.search_query', 'Default query')}\n\t\t\t\t\tvalue={settingsObj.zimbraPrefMailInitialSearch}\n\t\t\t\t\tonChange={(e: ChangeEvent<HTMLInputElement>): void =>\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\t\tname: 'zimbraPrefMailInitialSearch',\n\t\t\t\t\t\t\t\tvalue: e.target.value\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t{/* Read after N seconds option managed as a read immediately */}\n\t\t\t<Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t<Heading title={t('settings.label.mark_reading_panel', 'Mark as read')} />\n\t\t\t\t<RadioGroup\n\t\t\t\t\tstyle={{ width: '100%' }}\n\t\t\t\t\tvalue={settingsObj.zimbraPrefMarkMsgRead === '-1' ? '-1' : '0'}\n\t\t\t\t\tonChange={(newValue): void => {\n\t\t\t\t\t\tupdateSettings({ target: { name: 'zimbraPrefMarkMsgRead', value: newValue } });\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Radio\n\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t<Row orientation=\"column\" crossAlignment=\"flex-start\">\n\t\t\t\t\t\t\t\t<Text weight=\"bold\">{t('settings.label.default', 'Default')}</Text>\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalue=\"0\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Padding left=\"2rem\" bottom=\"0.5rem\">\n\t\t\t\t\t\t<Text>\n\t\t\t\t\t\t\t{t('label.mark_read_message_immediately', 'Mark as read when opening the message')}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</Padding>\n\t\t\t\t\t<Radio\n\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\tlabel={<Text weight=\"bold\">{t('settings.label.mark_manually', 'Mark Manually')}</Text>}\n\t\t\t\t\t\tvalue=\"-1\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Row padding={{ left: '2rem' }} display=\"inline-flex\">\n\t\t\t\t\t\t<Text>\n\t\t\t\t\t\t\t{t('label.mark_read_message_manually', 'Manually mark as read by clicking this icon')}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t<Padding left=\"small\">\n\t\t\t\t\t\t\t<Icon size=\"medium\" icon=\"EmailReadOutline\" />\n\t\t\t\t\t\t</Padding>\n\t\t\t\t\t</Row>\n\t\t\t\t</RadioGroup>\n\t\t\t</Container>\n\t\t</FormSubSection>\n\t);\n};\n\nexport default DisplayingMessagesSettings;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createContext } from 'react';\n\ntype FilterContextType = {\n\tincomingFilters: Record<string, any> | Array<any>;\n\tincomingLoading: boolean;\n\toutgoingFilters: Record<string, any> | Array<any>;\n\toutgoingLoading: boolean;\n\tsetFetchIncomingFilters?: (arg: boolean) => void;\n\tmoveUp?: (index: number, list: Array<any>, listSetter: (arg2: any) => void) => void;\n\tsetIncomingFilters?: (arg: any) => void;\n\tsetOutgoingFilters?: (arg: any) => void;\n\tsetFetchOutgoingFilters?: (arg: boolean) => void;\n};\nexport const FilterContext = createContext<FilterContextType>({\n\tincomingFilters: {},\n\tincomingLoading: true,\n\toutgoingFilters: {},\n\toutgoingLoading: true\n});\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useCallback, useMemo, useState } from 'react';\nimport { Container, Text, Row, Icon, Padding } from '@zextras/carbonio-design-system';\nimport styled from 'styled-components';\nimport { indexOf } from 'lodash';\nimport type { ListPropsType } from '../../../../types';\n\nconst ContainerEl = styled(Container)``;\n\nconst Filter = styled(Row)`\n\tborder-bottom: 0.0625rem solid ${({ theme }): string => theme.palette.gray2.regular};\n\tdisplay: block;\n\tborder-radius: 0;\n\tcursor: pointer;\n\n\t&:hover {\n\t\tbackground-color: ${({ theme }): string => theme.palette.gray6.focus};\n\t}\n`;\n\nconst ButtonEl = styled(Icon)`\n\tborder: 0.0625rem solid\n\t\t${({ theme, disabled }): string =>\n\t\t\tdisabled ? theme.palette.primary.disabled : theme.palette.primary.regular};\n`;\n\ntype Item = {\n\tactive: boolean;\n\tfilterActions: Array<any>;\n\tfilterTests: Array<any>;\n\tid: string;\n\tname: string;\n};\ntype ComponentProps = {\n\tselected: boolean;\n\tunSelect: () => void;\n\titem: Item;\n\tlistProps: ListPropsType;\n};\n// // TODO remove the any type after the Accordion refactor in the DS\nconst FilterItem: FC<any> = ({ item, selected, unSelect, listProps }): ReactElement => {\n\tconst { toggle, list, moveDown, moveUp } = listProps;\n\tconst _onClick = useCallback(() => {\n\t\tunSelect();\n\t\ttoggle(item.id);\n\t}, [item.id, toggle, unSelect]);\n\tconst background = useMemo(() => (selected ? 'highlight' : ''), [selected]);\n\tconst index = useMemo(() => indexOf(list, item), [list, item]);\n\tconst disableMoveUp = useMemo(() => index === 0, [index]);\n\tconst disableMoveDown = useMemo(() => index === list.length - 1, [index, list.length]);\n\tconst [hovered, setHovered] = useState(false);\n\tconst onMouseEnter = useCallback(() => setHovered(true), []);\n\tconst onMouseLeave = useCallback(() => setHovered(false), []);\n\n\tconst onMoveUp = useCallback(() => moveUp(index), [index, moveUp]);\n\tconst onMoveDown = useCallback(() => moveDown(index), [index, moveDown]);\n\n\treturn (\n\t\t<Filter\n\t\t\tonClick={_onClick}\n\t\t\theight=\"fit\"\n\t\t\tbackground={background}\n\t\t\torientation=\"horizontal\"\n\t\t\tonMouseEnter={onMouseEnter}\n\t\t\tonMouseLeave={onMouseLeave}\n\t\t>\n\t\t\t<Row height=\"2.5rem\" padding={{ all: 'small' }}>\n\t\t\t\t<ContainerEl width=\"80%\" crossAlignment=\"flex-start\">\n\t\t\t\t\t<Text size=\"small\">{item?.name}</Text>\n\t\t\t\t</ContainerEl>\n\n\t\t\t\t<Container width=\"20%\" orientation=\"horizontal\" mainAlignment=\"flex-end\">\n\t\t\t\t\t{hovered && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<ButtonEl\n\t\t\t\t\t\t\t\ticon=\"ArrowheadUpOutline\"\n\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\tdisabled={disableMoveUp}\n\t\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\t\tonClick={onMoveUp}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Padding right=\"small\" />\n\t\t\t\t\t\t\t<ButtonEl\n\t\t\t\t\t\t\t\ticon=\"ArrowheadDownOutline\"\n\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\tdisabled={disableMoveDown}\n\t\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\t\tonClick={onMoveDown}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t</Container>\n\t\t\t</Row>\n\t\t</Filter>\n\t);\n};\n\nexport default FilterItem;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { useCallback } from 'react';\n\nimport { TFunction } from 'i18next';\nimport { concat, filter, findIndex } from 'lodash';\n\nimport { useUiUtilities } from '../../../../hooks/use-ui-utilities';\nimport { FilterListType } from '../../../../types';\n\nexport type ListType = {\n\tisSelecting: boolean;\n\tlist: Array<FilterListType>;\n\tmoveDown: (arg: number) => void;\n\tmoveUp: (arg: number) => void;\n\tselected: Record<string, boolean>;\n\ttoggle: (arg: string) => void;\n\tunSelect: () => void;\n};\n\nexport type CompProps = {\n\tt: TFunction;\n\tavailableList: ListType;\n\tactiveList: ListType;\n\tsetFilters: (arg: Array<FilterListType>) => void;\n\tsetFetchFilters: (arg: boolean) => void;\n\tmodifierFunc: (arg: FilterListType[]) => Promise<void>;\n};\n\nexport type DeleteFilterCompProps = CompProps & {\n\tonClose: () => void;\n\tselectedFilter: FilterListType;\n\tincomingFilters: FilterListType[];\n};\n\nexport type DeleteOutgoingFilterCompProps = CompProps & {\n\tonClose: () => void;\n\tselectedFilter: FilterListType;\n\toutgoingFilters: FilterListType[];\n};\n\nexport const useRemoveFilter = (): ((arg: CompProps) => void) => {\n\tconst { createSnackbar } = useUiUtilities();\n\n\treturn useCallback(\n\t\t({\n\t\t\tt,\n\t\t\tactiveList,\n\t\t\tavailableList,\n\t\t\tsetFilters,\n\t\t\tsetFetchFilters,\n\t\t\tmodifierFunc\n\t\t}: CompProps): void => {\n\t\t\tconst activeFiltersCopy = activeList?.list?.slice();\n\t\t\tconst availableFiltersCopy = availableList?.list?.slice();\n\t\t\tconst activeFilter = filter(activeFiltersCopy, { id: Object.keys(activeList.selected)[0] });\n\t\t\tconst activeIndex = findIndex(activeFiltersCopy, activeFilter[0]);\n\t\t\tactiveFiltersCopy.splice(activeIndex, 1);\n\t\t\tavailableFiltersCopy.push({ ...activeFilter[0], active: false });\n\t\t\tconst newFilters = concat(activeFiltersCopy, availableFiltersCopy);\n\t\t\tsetFilters(newFilters);\n\t\t\tactiveList.unSelect();\n\n\t\t\tmodifierFunc(newFilters)\n\t\t\t\t.then(() => {\n\t\t\t\t\tsetFetchFilters(true);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `share`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\thideButton: true,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\terror?.message ||\n\t\t\t\t\t\t\tt('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\tautoHideTimeout: 5000\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t},\n\t\t[createSnackbar]\n\t);\n};\n\nexport const useAddFilter = (): ((arg: CompProps) => void) => {\n\tconst { createSnackbar } = useUiUtilities();\n\treturn useCallback(\n\t\t({\n\t\t\tt,\n\t\t\tactiveList,\n\t\t\tavailableList,\n\t\t\tsetFilters,\n\t\t\tsetFetchFilters,\n\t\t\tmodifierFunc\n\t\t}: CompProps): void => {\n\t\t\tconst activeFiltersCopy = activeList?.list?.slice();\n\t\t\tconst availableFiltersCopy = availableList?.list?.slice();\n\t\t\tconst activeFilter = filter(availableFiltersCopy, {\n\t\t\t\tid: Object.keys(availableList.selected)[0]\n\t\t\t});\n\t\t\tconst activeIndex = findIndex(availableFiltersCopy, activeFilter[0]);\n\t\t\tavailableFiltersCopy.splice(activeIndex, 1);\n\t\t\tactiveFiltersCopy.push({ ...activeFilter[0], active: true });\n\t\t\tconst newFilters = concat(activeFiltersCopy, availableFiltersCopy);\n\t\t\tsetFilters(newFilters);\n\t\t\tavailableList.unSelect();\n\t\t\tmodifierFunc(newFilters)\n\t\t\t\t.then(() => {\n\t\t\t\t\tsetFetchFilters(true);\n\t\t\t\t})\n\t\t\t\t.catch((error: { message: string }) => {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: 'filter-delete-error',\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\terror.message || t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t},\n\t\t[createSnackbar]\n\t);\n};\n\nexport const useDeleteOutgoingFilter = (): ((args: DeleteOutgoingFilterCompProps) => void) => {\n\tconst { createSnackbar } = useUiUtilities();\n\treturn useCallback(\n\t\t({\n\t\t\tt,\n\t\t\tsetFetchFilters,\n\t\t\tmodifierFunc,\n\t\t\tonClose,\n\t\t\tselectedFilter,\n\t\t\toutgoingFilters\n\t\t}: DeleteOutgoingFilterCompProps): void => {\n\t\t\tconst newFilters = filter(outgoingFilters, (f) => f.name !== selectedFilter.name);\n\t\t\tmodifierFunc(newFilters)\n\t\t\t\t.then(() => {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: 'filter-delete-success',\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\tlabel: t('settings.filter_deleted', 'Filter successfully deleted'),\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t\tsetFetchFilters(true);\n\t\t\t\t})\n\t\t\t\t.catch((error: { message: any }) => {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: 'filter-delete-error',\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\terror.message || t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\tonClose();\n\t\t},\n\t\t[createSnackbar]\n\t);\n};\n\nexport const useDeleteFilter = (): ((args: DeleteFilterCompProps) => void) => {\n\tconst { createSnackbar } = useUiUtilities();\n\treturn useCallback(\n\t\t({\n\t\t\tt,\n\t\t\tsetFetchFilters,\n\t\t\tmodifierFunc,\n\t\t\tonClose,\n\t\t\tselectedFilter,\n\t\t\tincomingFilters\n\t\t}: DeleteFilterCompProps): void => {\n\t\t\tconst newFilters = filter(incomingFilters, (f) => f.name !== selectedFilter.name);\n\t\t\tmodifierFunc(newFilters)\n\t\t\t\t.then(() => {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: 'filter-delete-success',\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\tlabel: t('settings.filter_deleted', 'Filter successfully deleted'),\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t\tsetFetchFilters(true);\n\t\t\t\t})\n\t\t\t\t.catch((error: { message: string }) => {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: 'filter-delete-error',\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\terror.message || t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\tonClose();\n\t\t},\n\t\t[createSnackbar]\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createContext } from 'react';\n\nexport type CreateFilterContextType = {\n\tnewFilters: Array<any>;\n\tsetNewFilters: (arg: any) => void;\n};\n\nexport const CreateFilterContext = createContext<CreateFilterContextType>({\n\tnewFilters: [],\n\tsetNewFilters: (arg) => {\n\t\t/* default implementation */\n\t}\n});\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n/* eslint-disable @typescript-eslint/ban-ts-comment */\n/* eslint-disable import/extensions */\n\nimport React, { FC, ReactElement } from 'react';\n\nimport {\n\tContainer,\n\tButton,\n\tPadding,\n\tDivider,\n\tCheckbox,\n\tTooltip\n} from '@zextras/carbonio-design-system';\n\ntype ModalFooterProps = {\n\tonConfirm: () => void;\n\tlabel: string;\n\ttoolTipText: string;\n\tdisabled: boolean;\n\tcheckboxLabel: string;\n\tonSecondaryAction: () => void;\n\tchecked: boolean;\n};\n\nconst ModalFooter: FC<ModalFooterProps> = ({\n\tonConfirm,\n\tlabel,\n\ttoolTipText,\n\tdisabled,\n\tcheckboxLabel,\n\tchecked,\n\tonSecondaryAction\n}): ReactElement => (\n\t<Container mainAlignment=\"center\" crossAlignment=\"center\" padding={{ top: 'large' }}>\n\t\t<Divider />\n\t\t<Container orientation=\"horizontal\" padding={{ top: 'medium' }} mainAlignment=\"space-between\">\n\t\t\t<Checkbox value={checked} onClick={onSecondaryAction} label={checkboxLabel} />\n\t\t\t<Tooltip label={toolTipText}>\n\t\t\t\t<Padding left=\"small\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tonClick={onConfirm}\n\t\t\t\t\t\tlabel={label}\n\t\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\t\tdata-testid=\"create-button\"\n\t\t\t\t\t/>\n\t\t\t\t</Padding>\n\t\t\t</Tooltip>\n\t\t</Container>\n\t</Container>\n);\nexport default ModalFooter;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { find, forEach } from 'lodash';\n\nexport const domainOptions = (t) => [\n\t{ label: t('label.all', 'all'), value: 'all' },\n\t{ label: t('settings.localpart', 'localpart'), value: 'localpart' },\n\t{ label: t('settings.domain', 'domain'), value: 'domain' }\n];\nexport const getConditionStatements = (t) => [\n\t{\n\t\tlabel: t('settings.matches_exactly', 'matches exactly'),\n\t\tvalue: { stringComparison: 'is' }\n\t},\n\t{\n\t\tlabel: t('settings.does_not_match_exactly', 'does not match exactly'),\n\t\tvalue: { stringComparison: 'is', negative: '1' }\n\t},\n\t{\n\t\tlabel: t('settings.contains', 'contains'),\n\t\tvalue: { stringComparison: 'contains' }\n\t},\n\t{\n\t\tlabel: t('settings.does_not_contain', 'does not contain'),\n\t\tvalue: { negative: '1', stringComparison: 'contains' }\n\t},\n\t{\n\t\tlabel: t('settings.matches_wildcard_condition', 'matches wildcard condition'),\n\t\tvalue: { stringComparison: 'matches' }\n\t},\n\t{\n\t\tlabel: t('settings.does_not_match_wildcard_condition', 'does not match wildcard condition'),\n\t\tvalue: { stringComparison: 'matches', negative: '1' }\n\t}\n];\n\nexport const getFieldOptions = (t) => [\n\t{\n\t\tlabel: t('label.any', 'any'),\n\t\tvalue: 'anyof'\n\t},\n\t{\n\t\tlabel: t('label.all', 'all'),\n\t\tvalue: 'allof'\n\t}\n];\n\nexport const getHeaderConditionStatements = (t) => [\n\t...getConditionStatements(t),\n\t{\n\t\tlabel: t('settings.does_not_match_wildcard_condition', 'does not match wildcard condition'),\n\t\tvalue: 'does not matche wildcard condition'\n\t},\n\t{\n\t\tlabel: t('settings.exists', 'exists'),\n\t\tvalue: 'exists'\n\t},\n\t{\n\t\tlabel: t('settings.does_not_exists', 'does not exist'),\n\t\tvalue: 'does not exist'\n\t}\n];\n\nexport const getIsOptions = (t) => [\n\t{\n\t\tlabel: t('settings.is', 'is'),\n\t\tvalue: 'TRUE'\n\t},\n\t{\n\t\tlabel: t('settings.is_not', 'is not'),\n\t\tvalue: 'FALSE'\n\t}\n];\n\nexport const getMessageOptions = (t) => [\n\t{\n\t\tlabel: t('settings.conv_is_started', 'in conversation I started'),\n\t\tvalue: { value: { where: 'started' }, key: 'conversationTest' }\n\t},\n\t{\n\t\tlabel: t('settings.conv_is_participated', 'in conversations I participated'),\n\t\tvalue: { value: { where: 'participated' }, key: 'conversationTest' }\n\t},\n\t{\n\t\tlabel: t('settings.mass_marketing', 'mass marketing (bulk)'),\n\t\tvalue: { key: 'bulkTest', value: {} }\n\t},\n\t{\n\t\tlabel: t('settings.from_distribution_list', 'from distribution list'),\n\t\tvalue: { key: 'listTest', value: {} }\n\t},\n\t{\n\t\tlabel: t('label.flagged', 'flagged'),\n\t\tvalue: { value: { flagName: 'flagged' }, key: 'flaggedTest' }\n\t}\n];\n\nexport const getSizeOptions = (t) => [\n\t{ label: t('settings.under', 'under'), value: { numberComparison: 'under' } },\n\t{\n\t\tlabel: t('settings.not_under', 'not under'),\n\t\tvalue: { numberComparison: 'under', negative: '1' }\n\t},\n\t{ label: t('settings.over', 'over'), value: { numberComparison: 'over' } },\n\t{\n\t\tlabel: t('settings.not_over', 'not over'),\n\t\tvalue: { numberComparison: 'over', negative: '1' }\n\t}\n];\n\nexport const getSizeUnit = (t) => [\n\t{ label: t('settings.b', 'B'), value: '' },\n\t{\n\t\tlabel: t('settings.kb', 'KB'),\n\t\tvalue: 'K'\n\t},\n\t{ label: t('settings.mb', 'MB'), value: 'M' },\n\t{\n\t\tlabel: t('settings.gb', 'GB'),\n\t\tvalue: 'G'\n\t}\n];\n\nexport const getDateOptions = (t) => [\n\t{ label: t('settings.before', 'before'), value: { dateComparison: 'before' } },\n\t{\n\t\tlabel: t('settings.not_before', 'not before'),\n\t\tvalue: { dateComparison: 'before', negative: '1' }\n\t},\n\t{ label: t('settings.after', 'after'), value: { dateComparison: 'after' } },\n\t{\n\t\tlabel: t('settings.not_after', 'not after'),\n\t\tvalue: { dateComparison: 'after', negative: '1' }\n\t}\n];\n\nexport const getBodyOptions = (t) => [\n\t{ label: t('settings.contains', 'contains'), value: {} },\n\t{\n\t\tlabel: t('settings.does_not_contain', 'does not contain'),\n\t\tvalue: { negative: '1' }\n\t}\n];\n\nexport const getExistOptions = (t) => [\n\t{\n\t\tlabel: t('settings.exists', 'exists'),\n\t\tvalue: {}\n\t},\n\t{\n\t\tlabel: t('settings.does_not_exists', 'does not exist'),\n\t\tvalue: { negative: '1' }\n\t}\n];\n\nexport const getReadReceiptOptions = (t) => [\n\t{\n\t\tlabel: t('settings.exists', 'exists'),\n\t\tvalue: {\n\t\t\theader: 'Content-Type',\n\t\t\tstringComparison: 'Contains',\n\t\t\tvalue: 'message/disposition-notification'\n\t\t}\n\t},\n\t{\n\t\tlabel: t('settings.does_not_exists', 'does not exist'),\n\t\tvalue: {\n\t\t\tnegative: '1',\n\t\t\theader: 'Content-Type',\n\t\t\tstringComparison: 'Contains',\n\t\t\tvalue: 'message/disposition-notification'\n\t\t}\n\t}\n];\nexport const getFromOptions = (t) => [\n\t{\n\t\tlabel: t('label.from', 'From'),\n\t\tvalue: 'FROM'\n\t},\n\t{\n\t\tlabel: t('label.to', 'To'),\n\t\tvalue: 'TO'\n\t},\n\t{\n\t\tlabel: t('label.cc', 'CC'),\n\t\tvalue: 'CC'\n\t},\n\t{\n\t\tlabel: t('settings.to_cc', 'To or Cc'),\n\t\tvalue: 'TO,CC'\n\t}\n];\n\nexport const getInOptions = (t) => [\n\t{\n\t\tlabel: t('settings.in', 'in'),\n\t\tvalue: { key: 'in', value: {} }\n\t},\n\t{\n\t\tlabel: t('settings.not_in', 'not in'),\n\t\tvalue: { key: 'in', value: { negative: '1' } }\n\t},\n\t{\n\t\tlabel: t('settings.is_me', 'is me'),\n\t\tvalue: { key: 'myTest', value: {} }\n\t},\n\t{\n\t\tlabel: t('settings.is_not_me', 'is not me'),\n\t\tvalue: { key: 'myTest', value: { negative: '1' } }\n\t}\n];\n\nexport const getFolderOptions = (t) => [\n\t{\n\t\tlabel: t('settings.contacts', 'contacts'),\n\t\tvalue: 'addressBookTest'\n\t},\n\t{\n\t\tlabel: t('settings.my_frequent_emails', 'my frequent e-mails'),\n\t\tvalue: 'contactRankingTest'\n\t}\n];\n\nexport const getInviteRspOptions = (t) => [\n\t{\n\t\tlabel: t('settings.invite_requested', 'invite is requested'),\n\t\tvalue: { method: [{ _content: 'anyrequest' }] }\n\t},\n\t{\n\t\tlabel: t('settings.invite_not_requested', 'invite is not requested'),\n\t\tvalue: { negative: '1', method: [{ _content: 'anyrequest' }] }\n\t},\n\t{\n\t\tlabel: t('settings.invite_replied', 'invite is replied'),\n\t\tvalue: { method: [{ _content: 'anyreply' }] }\n\t},\n\t{\n\t\tlabel: t('settings.invite_not_replied', 'invite is not replied '),\n\t\tvalue: { negative: '1', method: [{ _content: 'anyreply' }] }\n\t}\n];\n\nexport const getSocialOptions = (t) => [\n\t{\n\t\tlabel: t('settings.linkedin_msg', 'LinkedIn messages and connections'),\n\t\tvalue: { linkedinTest: [{}] }\n\t},\n\t{\n\t\tlabel: t('settings.twitter_notification', 'Twitter notifications'),\n\t\tvalue: { twitterTest: [{}] }\n\t},\n\t{\n\t\tlabel: t('settings.facebook_notification', 'Facebook notification'),\n\t\tvalue: { facebookTest: [{}] }\n\t}\n];\n\nconst getConditionAction = (t, zimbraFeatureMailForwardingInFiltersEnabled) => {\n\tif (zimbraFeatureMailForwardingInFiltersEnabled === 'TRUE') {\n\t\treturn [\n\t\t\t{\n\t\t\t\tlabel: t('settings.redirect_to_address', 'Redirect to address'),\n\t\t\t\tvalue: 'redirectToAddress'\n\t\t\t}\n\t\t];\n\t}\n\treturn [];\n};\n\nexport const getActionOptions = (\n\tt,\n\tzimbraFeatureMailForwardingInFiltersEnabled,\n\tisIncoming = true\n) => [\n\t{\n\t\tlabel: isIncoming\n\t\t\t? t('settings.keep_in_inbox', 'Keep in Inbox')\n\t\t\t: t('settings.keep_in_sent', 'Keep in Sent'),\n\t\tvalue: isIncoming ? 'inbox' : 'sent'\n\t},\n\t{\n\t\tlabel: t('settings.discard', 'Discard'),\n\t\tvalue: 'discard'\n\t},\n\t{\n\t\tlabel: t('settings.move_into_folder', 'Move Into Folder'),\n\t\tvalue: 'moveIntoFolder'\n\t},\n\t{\n\t\tlabel: t('settings.tag_with', 'Tag with'),\n\t\tvalue: 'tagWith'\n\t},\n\t{\n\t\tlabel: t('settings.mark_as', 'Mark as'),\n\t\tvalue: 'markAs'\n\t},\n\t...getConditionAction(t, zimbraFeatureMailForwardingInFiltersEnabled)\n];\n\nexport const getMarkAsOptions = (t) => [\n\t{\n\t\tlabel: t('label.read', 'Read'),\n\t\tvalue: { actionFlag: [{ flagName: 'read' }] }\n\t},\n\t{\n\t\tlabel: t('label.flagged', 'Flagged'),\n\t\tvalue: { actionFlag: [{ flagName: 'flagged' }] }\n\t}\n];\nexport const getDomainOptions = (t) => [\n\t{ label: t('label.all', 'all'), value: 'all' },\n\t{ label: t('settings.localpart', 'localpart'), value: 'localpart' },\n\t{ label: t('settings.domain', 'domain'), value: 'domain' }\n];\n\nexport const getStatusOptions = (t) => [\n\t{\n\t\tlabel: t('label.from', 'From'),\n\t\tvalue: 'from'\n\t},\n\t{\n\t\tlabel: t('label.to', 'To'),\n\t\tvalue: 'to'\n\t},\n\t{\n\t\tlabel: t('label.cc', 'CC'),\n\t\tvalue: 'cc'\n\t},\n\t{\n\t\tlabel: t('settings.to_cc', 'To or CC'),\n\t\tvalue: 'to,cc'\n\t},\n\t{\n\t\tlabel: t('label.subject', 'Subject'),\n\t\tvalue: 'subject'\n\t},\n\t{\n\t\tlabel: t('settings.message', 'Message'),\n\t\tvalue: 'message'\n\t},\n\t{\n\t\tlabel: t('label.size', 'Size'),\n\t\tvalue: 'size'\n\t},\n\t{ label: t('settings.date', 'Date'), value: 'date' },\n\t{ label: t('settings.body', 'Body'), value: 'body' },\n\t{\n\t\tlabel: t('label.attachment', 'Attachment'),\n\t\tvalue: 'attachment'\n\t},\n\t{\n\t\tlabel: t('settings.read_receipt', 'Read Receipt'),\n\t\tvalue: 'read receipt'\n\t},\n\t{\n\t\tlabel: t('settings.address_in', 'Address In'),\n\t\tvalue: 'address in',\n\t\tkeyName: 'addressBookTest'\n\t},\n\t{ label: t('settings.calendar', 'Calendar'), value: 'calendar' },\n\t{ label: t('settings.social', 'Social'), value: 'social' },\n\t{\n\t\tlabel: t('settings.header_name', 'Header Named'),\n\t\tvalue: 'header named'\n\t}\n];\n\nexport const findDefaultValue = (list, key) => find(list, { value: key });\nexport const findDefaultObjectValue = (list, key) => find(list, { value: key });\n\nexport const getButtonInfo = (filterName, filters, t, isCreate = true) => {\n\tconst keys = Object.keys(filters.filterActions[0]);\n\tconst actions = filters.filterActions[0];\n\tif (filterName.length === 0) {\n\t\treturn [true, t('settings.label.filter_name_required', 'Filter name is required')];\n\t}\n\tif (keys.includes('actionTag')) {\n\t\tlet isEmpty = false;\n\t\tforEach(actions.actionTag, (action) => {\n\t\t\tif (action.tagName === '') isEmpty = true;\n\t\t});\n\t\tif (isEmpty) {\n\t\t\treturn [\n\t\t\t\ttrue,\n\t\t\t\tt(\n\t\t\t\t\t'settings.tag_name_required',\n\t\t\t\t\t'Fill in the \"Tag\" field in order to complete the action \"Tag with\".'\n\t\t\t\t)\n\t\t\t];\n\t\t}\n\t}\n\tif (keys.includes('actionFileInto')) {\n\t\tlet isEmpty = false;\n\t\tforEach(actions.actionFileInto, (files) => {\n\t\t\tif (files.folderPath === '') isEmpty = true;\n\t\t});\n\t\tif (isEmpty) {\n\t\t\treturn [\n\t\t\t\ttrue,\n\t\t\t\tt(\n\t\t\t\t\t'settings.folder_path_required',\n\t\t\t\t\t'Select a destination folder in order to complete the action \"Move into folder\".'\n\t\t\t\t)\n\t\t\t];\n\t\t}\n\t}\n\tif (keys.includes('actionRedirect')) {\n\t\tlet isEmpty = false;\n\t\tforEach(actions.actionRedirect, (address) => {\n\t\t\tif (address.a === '') isEmpty = true;\n\t\t});\n\t\tif (isEmpty) {\n\t\t\treturn [\n\t\t\t\ttrue,\n\t\t\t\tt(\n\t\t\t\t\t'settings.address_required',\n\t\t\t\t\t'Fill in the \"Address\" field in order to complete the action \"Redirect to Address\".'\n\t\t\t\t)\n\t\t\t];\n\t\t}\n\t}\n\treturn [false, isCreate ? t('label.create', 'Create') : t('label.save', 'Save')];\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseMemo,\n\tuseContext,\n\tuseCallback,\n\tuseState,\n\tuseEffect\n} from 'react';\nimport { Input, Container } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport CustomSelect from '../custom-select';\nimport { getConditionStatements, findDefaultValue } from '../utils';\nimport { CreateFilterContext } from '../create-filter-context';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tactiveIndex: number;\n\tdefaultValue?: any;\n};\n\nconst DefaultCondition: FC<ComponentProps> = ({ t, activeIndex, defaultValue }): ReactElement => {\n\tconst conditionStatementsOptions = useMemo(() => getConditionStatements(t), [t]);\n\tconst [loadData, setLoadData] = useState(false);\n\tconst [value, setValue] = useState('');\n\tconst [selectValue, setSelectValue] = useState({ stringComparison: 'contains' });\n\tconst { newFilters, setNewFilters } = useContext(CreateFilterContext);\n\n\tuseEffect(() => {\n\t\tif (loadData) {\n\t\t\tconst tmpFilters = newFilters.slice();\n\n\t\t\ttmpFilters[activeIndex] = {\n\t\t\t\t...tmpFilters[activeIndex],\n\t\t\t\tfilterTests: [\n\t\t\t\t\t{\n\t\t\t\t\t\t...tmpFilters?.[activeIndex]?.filterTests?.[0],\n\t\t\t\t\t\theaderTest: [{ header: 'subject', ...selectValue, value }]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\t\t\tsetNewFilters(tmpFilters);\n\t\t\tsetLoadData(false);\n\t\t}\n\t}, [selectValue, activeIndex, newFilters, setNewFilters, value, loadData]);\n\tuseEffect(() => {\n\t\tif (defaultValue && defaultValue?.headerTest) {\n\t\t\tsetValue(defaultValue?.headerTest?.[0]?.value);\n\t\t}\n\t}, [defaultValue]);\n\tconst handleStatementChange = useCallback((arg) => {\n\t\tsetSelectValue(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst handleValueChange = useCallback((ev) => {\n\t\tsetValue(ev.target.value);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst previousOption = useMemo(\n\t\t() =>\n\t\t\tdefaultValue?.headerTest?.[0].negative\n\t\t\t\t? { stringComparison: defaultValue?.headerTest?.[0]?.stringComparison, negative: '1' }\n\t\t\t\t: { stringComparison: defaultValue?.headerTest?.[0].stringComparison },\n\t\t[defaultValue]\n\t);\n\n\tconst defaultSelection = useMemo(\n\t\t() =>\n\t\t\tdefaultValue\n\t\t\t\t? findDefaultValue(conditionStatementsOptions, previousOption)\n\t\t\t\t: conditionStatementsOptions[2],\n\t\t[conditionStatementsOptions, defaultValue, previousOption]\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<Container minWidth=\"40%\" maxWidth=\"40%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={conditionStatementsOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleStatementChange}\n\t\t\t\t\tdefaultSelection={defaultSelection}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t<Input\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t\tvalue={value}\n\t\t\t\t\tplaceholder={t('settings.keyword', 'Keyword')}\n\t\t\t\t\tonChange={handleValueChange}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default DefaultCondition;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseMemo,\n\tuseContext,\n\tuseCallback,\n\tuseEffect,\n\tuseState\n} from 'react';\nimport { Container } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport CustomSelect from '../custom-select';\nimport { getIsOptions, getMessageOptions } from '../utils';\nimport { CreateFilterContext } from '../create-filter-context';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tactiveIndex: number;\n\tdefaultValue?: any;\n};\n\nconst MessageCondition: FC<ComponentProps> = ({ t, activeIndex, defaultValue }): ReactElement => {\n\tconst isOptions = useMemo(() => getIsOptions(t), [t]);\n\tconst msgOptions = useMemo(() => getMessageOptions(t), [t]);\n\n\tconst [loadData, setLoadData] = useState(false);\n\tconst [is, setIs] = useState('TRUE');\n\n\tconst [selectValue, setSelectValue] = useState({\n\t\tvalue: { where: 'started' },\n\t\tkey: 'conversationTest'\n\t});\n\tconst { newFilters, setNewFilters } = useContext(CreateFilterContext);\n\n\tuseEffect(() => {\n\t\tif (loadData) {\n\t\t\tconst previousTemp: any = {};\n\t\t\tswitch (selectValue.key) {\n\t\t\t\tcase 'conversationTest':\n\t\t\t\t\tpreviousTemp.conversationTest = [\n\t\t\t\t\t\tis === 'FALSE' ? { ...selectValue.value, negative: '1' } : selectValue.value\n\t\t\t\t\t];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'bulkTest':\n\t\t\t\t\tpreviousTemp.bulkTest = [is === 'FALSE' ? { negative: '1' } : {}];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'listTest':\n\t\t\t\t\tpreviousTemp.listTest = [is === 'FALSE' ? { negative: '1' } : {}];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'flaggedTest':\n\t\t\t\t\tpreviousTemp.flaggedTest = [\n\t\t\t\t\t\tis === 'FALSE' ? { negative: '1', flagName: 'flagged' } : { flagName: 'flagged' }\n\t\t\t\t\t];\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tpreviousTemp.conversationTest = [{ where: 'started' }];\n\t\t\t}\n\t\t\tconst tmpFilters = newFilters.slice();\n\t\t\ttmpFilters[activeIndex] = {\n\t\t\t\t...tmpFilters[activeIndex],\n\t\t\t\tfilterTests: [{ ...previousTemp }]\n\t\t\t};\n\n\t\t\tsetNewFilters(tmpFilters);\n\t\t\tsetLoadData(false);\n\t\t}\n\t}, [selectValue, activeIndex, newFilters, setNewFilters, loadData, is]);\n\n\tconst handleIsChange = useCallback((arg) => {\n\t\tsetIs(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst handleOptionChange = useCallback((arg) => {\n\t\tsetSelectValue(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst defaultIsOption = useMemo(() => {\n\t\tif (defaultValue) {\n\t\t\tconst test = Object.keys(defaultValue)[0];\n\t\t\treturn defaultValue[test][0]?.negative ? isOptions[1] : isOptions[0];\n\t\t}\n\t\treturn isOptions[0];\n\t}, [defaultValue, isOptions]);\n\tconst defaultMsgOption = useMemo(() => {\n\t\tif (defaultValue) {\n\t\t\tconst test = Object.keys(defaultValue)[0];\n\t\t\tswitch (test) {\n\t\t\t\tcase 'conversationTest': {\n\t\t\t\t\treturn defaultValue[test][0]?.where === 'started' ? msgOptions[0] : msgOptions[1];\n\t\t\t\t}\n\t\t\t\tcase 'bulkTest': {\n\t\t\t\t\treturn msgOptions[2];\n\t\t\t\t}\n\t\t\t\tcase 'listTest': {\n\t\t\t\t\treturn msgOptions[3];\n\t\t\t\t}\n\t\t\t\tcase 'flaggedTest': {\n\t\t\t\t\treturn msgOptions[4];\n\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\treturn msgOptions[0];\n\t\t\t}\n\t\t}\n\t\treturn msgOptions[0];\n\t}, [defaultValue, msgOptions]);\n\n\treturn (\n\t\t<>\n\t\t\t<Container minWidth=\"30%\" maxWidth=\"30%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={isOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleIsChange}\n\t\t\t\t\tdefaultSelection={defaultIsOption}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container minWidth=\"30%\" maxWidth=\"30%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={msgOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleOptionChange}\n\t\t\t\t\tdefaultSelection={defaultMsgOption}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default MessageCondition;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseMemo,\n\tuseContext,\n\tuseState,\n\tuseCallback,\n\tuseEffect\n} from 'react';\nimport { Input, Container } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport CustomSelect from '../custom-select';\nimport { getConditionStatements, findDefaultValue, getDomainOptions } from '../utils';\nimport { CreateFilterContext } from '../create-filter-context';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tactiveIndex: number;\n\tdefaultValue?: any;\n};\n\nconst FromToCondition: FC<ComponentProps> = ({ t, activeIndex, defaultValue }): ReactElement => {\n\tconst conditionStatementsOptions = useMemo(() => getConditionStatements(t), [t]);\n\tconst domainOptions = useMemo(() => getDomainOptions(t), [t]);\n\n\tconst [loadData, setLoadData] = useState(false);\n\tconst [value, setValue] = useState('');\n\tconst [part, setPart] = useState('all');\n\tconst [selectValue, setSelectValue] = useState({ stringComparison: 'contains' });\n\tconst { newFilters, setNewFilters } = useContext(CreateFilterContext);\n\tuseEffect(() => {\n\t\tif (defaultValue && defaultValue?.addressTest) {\n\t\t\tsetValue(defaultValue?.addressTest?.[0]?.value);\n\t\t}\n\t}, [defaultValue]);\n\tuseEffect(() => {\n\t\tif (loadData) {\n\t\t\tconst tmpFilters = newFilters.slice();\n\n\t\t\ttmpFilters[activeIndex] = {\n\t\t\t\t...tmpFilters[activeIndex],\n\t\t\t\tfilterTests: [\n\t\t\t\t\t{\n\t\t\t\t\t\t...tmpFilters[activeIndex].filterTests[0],\n\t\t\t\t\t\taddressTest: [{ header: tmpFilters[activeIndex].key, ...selectValue, value, part }]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\t\t\tsetNewFilters(tmpFilters);\n\t\t\tsetLoadData(false);\n\t\t}\n\t}, [selectValue, activeIndex, newFilters, setNewFilters, value, loadData, part]);\n\n\tconst handleStatementChange = useCallback((arg) => {\n\t\tsetSelectValue(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst handleValueChange = useCallback((ev) => {\n\t\tsetValue(ev.target.value);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst handelPartChange = useCallback((arg) => {\n\t\tsetPart(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\tconst defaultSelection = useMemo(\n\t\t() =>\n\t\t\tdefaultValue\n\t\t\t\t? findDefaultValue(\n\t\t\t\t\t\tconditionStatementsOptions,\n\t\t\t\t\t\tdefaultValue.addressTest?.[0]?.negative\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\tstringComparison: defaultValue?.addressTest?.[0]?.stringComparison,\n\t\t\t\t\t\t\t\t\tnegative: '1'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t: { stringComparison: defaultValue?.addressTest?.[0]?.stringComparison }\n\t\t\t\t\t)\n\t\t\t\t: conditionStatementsOptions[2],\n\t\t[conditionStatementsOptions, defaultValue]\n\t);\n\n\tconst defaultDomain = useMemo(\n\t\t() =>\n\t\t\tdefaultValue\n\t\t\t\t? findDefaultValue(domainOptions, defaultValue.addressTest[0].part)\n\t\t\t\t: domainOptions[0],\n\t\t[domainOptions, defaultValue]\n\t);\n\treturn (\n\t\t<>\n\t\t\t<Container minWidth=\"30%\" maxWidth=\"30%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={conditionStatementsOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleStatementChange}\n\t\t\t\t\tdefaultSelection={defaultSelection}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container minWidth=\"10%\" maxWidth=\"10%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={domainOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handelPartChange}\n\t\t\t\t\tdefaultSelection={defaultDomain}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t<Input\n\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t\tvalue={value}\n\t\t\t\t\tonChange={handleValueChange}\n\t\t\t\t\tplaceholder={t('settings.keyword', 'Keyword')}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default FromToCondition;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseMemo,\n\tuseContext,\n\tuseState,\n\tuseEffect,\n\tuseCallback\n} from 'react';\nimport { Input, Container } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport { includes } from 'lodash';\nimport CustomSelect from '../custom-select';\nimport { getSizeOptions, getSizeUnit, findDefaultValue } from '../utils';\nimport { CreateFilterContext } from '../create-filter-context';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tactiveIndex: number;\n\tdefaultValue?: any;\n};\n\nconst SizeCondition: FC<ComponentProps> = ({ t, activeIndex, defaultValue }): ReactElement => {\n\tconst sizeOptions = useMemo(() => getSizeOptions(t), [t]);\n\tconst sizeUnitsOptions = useMemo(() => getSizeUnit(t), [t]);\n\tconst [query, setQuery] = useState({ numberComparison: 'under' });\n\tconst [sizeUnit, setSizeUnit] = useState('');\n\tconst [size, setSize] = useState('');\n\tconst [loadData, setLoadData] = useState(false);\n\tconst { newFilters, setNewFilters } = useContext(CreateFilterContext);\n\n\tuseEffect(() => {\n\t\tif (loadData) {\n\t\t\tconst tmpFilters = newFilters.slice();\n\t\t\ttmpFilters[activeIndex] = {\n\t\t\t\t...tmpFilters[activeIndex],\n\t\t\t\tfilterTests: [\n\t\t\t\t\t{\n\t\t\t\t\t\tsizeTest: [{ ...query, s: `${size}${sizeUnit}` }]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tsetNewFilters(tmpFilters);\n\t\t\tsetLoadData(false);\n\t\t}\n\t}, [activeIndex, newFilters, setNewFilters, loadData, query, size, sizeUnit]);\n\n\tconst handleQueryChange = useCallback((arg) => {\n\t\tsetQuery(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst handleSizeUnitChange = useCallback((arg) => {\n\t\tsetSizeUnit(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst handleSizeChange = useCallback((ev) => {\n\t\tsetSize(ev.target.value);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst defaultSizeOption = useMemo(\n\t\t() =>\n\t\t\tdefaultValue\n\t\t\t\t? findDefaultValue(\n\t\t\t\t\t\tsizeOptions,\n\t\t\t\t\t\tdefaultValue?.sizeTest?.[0]?.negative\n\t\t\t\t\t\t\t? { numberComparison: defaultValue?.sizeTest?.[0]?.numberComparison, negative: '1' }\n\t\t\t\t\t\t\t: { numberComparison: defaultValue?.sizeTest?.[0]?.numberComparison }\n\t\t\t\t\t)\n\t\t\t\t: sizeOptions[0],\n\t\t[defaultValue, sizeOptions]\n\t);\n\tconst defaultSizeUnitOption = useMemo(() => {\n\t\tif (defaultValue) {\n\t\t\tconst sizeArray = defaultValue?.sizeTest?.[0]?.s?.split('');\n\t\t\tconst unit = sizeArray.pop();\n\t\t\tif (includes(['M', 'G', 'K'], unit)) {\n\t\t\t\treturn findDefaultValue(sizeUnitsOptions, unit);\n\t\t\t}\n\t\t\treturn findDefaultValue(sizeUnitsOptions, '');\n\t\t}\n\t\treturn sizeUnitsOptions[0];\n\t}, [defaultValue, sizeUnitsOptions]);\n\n\tuseEffect(() => {\n\t\tif (defaultValue && defaultValue?.sizeTest) {\n\t\t\tconst sizeArray = defaultValue?.sizeTest?.[0]?.s?.split('');\n\t\t\tconst unit = sizeArray.pop();\n\t\t\tif (includes(['M', 'G', 'K'], unit)) {\n\t\t\t\tsetSize(sizeArray.join(''));\n\t\t\t} else setSize(defaultValue?.sizeTest?.[0]?.s);\n\t\t}\n\t}, [defaultValue]);\n\treturn (\n\t\t<>\n\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={sizeOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleQueryChange}\n\t\t\t\t\tdefaultSelection={defaultSizeOption}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t<Input\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\tonChange={handleSizeChange}\n\t\t\t\t\tvalue={size}\n\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t\tplaceholder=\"0\"\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={sizeUnitsOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleSizeUnitChange}\n\t\t\t\t\tdefaultSelection={defaultSizeUnitOption}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default SizeCondition;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseMemo,\n\tuseContext,\n\tuseState,\n\tuseEffect,\n\tuseCallback\n} from 'react';\nimport { Container, DateTimePicker } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport moment from 'moment';\nimport CustomSelect from '../custom-select';\nimport { getDateOptions, findDefaultValue } from '../utils';\nimport { CreateFilterContext } from '../create-filter-context';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tactiveIndex: number;\n\tdefaultValue?: any;\n};\n\nconst DateCondition: FC<ComponentProps> = ({ t, activeIndex, defaultValue }): ReactElement => {\n\tconst dateOptions = useMemo(() => getDateOptions(t), [t]);\n\tconst [query, setQuery] = useState({ dateComparison: 'before' });\n\tconst [date, setDate] = useState(moment().format('X'));\n\tconst [loadData, setLoadData] = useState(false);\n\tconst { newFilters, setNewFilters } = useContext(CreateFilterContext);\n\tuseEffect(() => {\n\t\tif (loadData) {\n\t\t\tconst tmpFilters = newFilters.slice();\n\t\t\ttmpFilters[activeIndex] = {\n\t\t\t\t...tmpFilters[activeIndex],\n\t\t\t\tfilterTests: [\n\t\t\t\t\t{\n\t\t\t\t\t\tdateTest: [{ ...query, d: `${date}` }]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tsetNewFilters(tmpFilters);\n\t\t\tsetLoadData(false);\n\t\t}\n\t}, [activeIndex, newFilters, setNewFilters, loadData, query, date]);\n\n\tconst handleQueryChange = useCallback((arg) => {\n\t\tsetQuery(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst handleDateChange = useCallback((arg) => {\n\t\tsetDate(`${moment(arg).format('X')}`);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst defaultSelection = useMemo(\n\t\t() =>\n\t\t\tdefaultValue\n\t\t\t\t? findDefaultValue(\n\t\t\t\t\t\tdateOptions,\n\t\t\t\t\t\tdefaultValue?.dateTest?.[0].negative\n\t\t\t\t\t\t\t? { dateComparison: defaultValue?.dateTest?.[0]?.dateComparison, negative: '1' }\n\t\t\t\t\t\t\t: { dateComparison: defaultValue?.dateTest?.[0]?.dateComparison }\n\t\t\t\t\t)\n\t\t\t\t: dateOptions[0],\n\t\t[dateOptions, defaultValue]\n\t);\n\n\tconst defaultDate = useMemo(\n\t\t() =>\n\t\t\tdefaultValue?.dateTest?.[0]?.d\n\t\t\t\t? new Date((defaultValue?.dateTest?.[0]?.d ?? 1) * 1000)\n\t\t\t\t: new Date(),\n\t\t[defaultValue]\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<Container minWidth=\"40%\" maxWidth=\"40%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={dateOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleQueryChange}\n\t\t\t\t\tdefaultSelection={defaultSelection}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t<DateTimePicker\n\t\t\t\t\tincludeTime={false}\n\t\t\t\t\tdefaultValue={defaultDate}\n\t\t\t\t\tlabel={t('settings.choose_date', 'Choose Date')}\n\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t\tonChange={handleDateChange}\n\t\t\t\t\tdateFormat=\"d/M/yyyy\"\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default DateCondition;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { Container, Input } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport React, {\n\tFC,\n\tReactElement,\n\tuseCallback,\n\tuseContext,\n\tuseEffect,\n\tuseMemo,\n\tuseState\n} from 'react';\nimport { CreateFilterContext } from '../create-filter-context';\nimport CustomSelect from '../custom-select';\nimport { getBodyOptions } from '../utils';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tactiveIndex: number;\n\tdefaultValue?: any;\n};\n\nconst BodyCondition: FC<ComponentProps> = ({ t, activeIndex, defaultValue }): ReactElement => {\n\tconst bodyOptions = useMemo(() => getBodyOptions(t), [t]);\n\tconst [query, setQuery] = useState({ value: '' });\n\tconst [value, setValue] = useState('');\n\tconst [loadData, setLoadData] = useState(false);\n\tconst { newFilters, setNewFilters } = useContext(CreateFilterContext);\n\tuseEffect(() => {\n\t\tif (loadData) {\n\t\t\tconst tmpFilters = newFilters.slice();\n\t\t\ttmpFilters[activeIndex] = {\n\t\t\t\t...tmpFilters[activeIndex],\n\t\t\t\tfilterTests: [\n\t\t\t\t\t{\n\t\t\t\t\t\tbodyTest: [{ ...query, value }]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tsetNewFilters(tmpFilters);\n\t\t\tsetLoadData(false);\n\t\t}\n\t}, [activeIndex, newFilters, setNewFilters, loadData, query, value]);\n\n\tuseEffect(() => {\n\t\tif (defaultValue && defaultValue.bodyTest) {\n\t\t\tsetValue(defaultValue.bodyTest[0].value);\n\t\t}\n\t}, [defaultValue]);\n\tconst handleQueryChange = useCallback((arg) => {\n\t\tsetQuery(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst handleValueChange = useCallback((ev) => {\n\t\tsetValue(ev.target.value);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst defaultBodyOption = useMemo(() => {\n\t\tif (defaultValue && defaultValue.bodyTest[0].negative) {\n\t\t\treturn bodyOptions[1];\n\t\t}\n\t\treturn bodyOptions[0];\n\t}, [defaultValue, bodyOptions]);\n\treturn (\n\t\t<>\n\t\t\t<Container minWidth=\"30%\" maxWidth=\"30%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={bodyOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleQueryChange}\n\t\t\t\t\tdefaultSelection={defaultBodyOption}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container minWidth=\"30%\" padding={{ right: 'small' }}>\n\t\t\t\t<Input\n\t\t\t\t\tonChange={handleValueChange}\n\t\t\t\t\tplaceholder={t('settings.keyword', 'Keyword') as string}\n\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t\tvalue={value}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default BodyCondition;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseMemo,\n\tuseContext,\n\tuseState,\n\tuseEffect,\n\tuseCallback\n} from 'react';\nimport { Container } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport CustomSelect from '../custom-select';\nimport { getExistOptions } from '../utils';\nimport { CreateFilterContext } from '../create-filter-context';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tactiveIndex: number;\n\tdefaultValue?: any;\n};\n\nconst AttachmentCondition: FC<ComponentProps> = ({\n\tt,\n\tactiveIndex,\n\tdefaultValue\n}): ReactElement => {\n\tconst existsOptions = useMemo(() => getExistOptions(t), [t]);\n\tconst [query, setQuery] = useState({});\n\tconst [loadData, setLoadData] = useState(false);\n\tconst { newFilters, setNewFilters } = useContext(CreateFilterContext);\n\n\tconst defaultOption = useMemo(() => {\n\t\tif (defaultValue && defaultValue.attachmentTest[0].negative) {\n\t\t\treturn existsOptions[1];\n\t\t}\n\t\treturn existsOptions[0];\n\t}, [defaultValue, existsOptions]);\n\n\tuseEffect(() => {\n\t\tif (loadData) {\n\t\t\tconst tmpFilters = newFilters.slice();\n\t\t\ttmpFilters[activeIndex] = {\n\t\t\t\t...tmpFilters[activeIndex],\n\t\t\t\tfilterTests: [\n\t\t\t\t\t{\n\t\t\t\t\t\tattachmentTest: [query]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tsetNewFilters(tmpFilters);\n\t\t\tsetLoadData(false);\n\t\t}\n\t}, [activeIndex, newFilters, setNewFilters, loadData, query]);\n\n\tconst handleQueryChange = useCallback((arg) => {\n\t\tsetQuery(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\treturn (\n\t\t<>\n\t\t\t<Container minWidth=\"60%\" maxWidth=\"60%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={existsOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleQueryChange}\n\t\t\t\t\tdefaultSelection={defaultOption}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default AttachmentCondition;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseMemo,\n\tuseContext,\n\tuseState,\n\tuseCallback,\n\tuseEffect\n} from 'react';\nimport { Container } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport CustomSelect from '../custom-select';\nimport { getReadReceiptOptions } from '../utils';\nimport { CreateFilterContext } from '../create-filter-context';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tactiveIndex: number;\n\tdefaultValue?: any;\n};\n\nconst ReadReceiptCondition: FC<ComponentProps> = ({\n\tt,\n\tactiveIndex,\n\tdefaultValue\n}): ReactElement => {\n\tconst existsOptions = useMemo(() => getReadReceiptOptions(t), [t]);\n\tconst [query, setQuery] = useState({\n\t\theader: 'Content-Type',\n\t\tstringComparison: 'Contains',\n\t\tvalue: 'message/disposition-notification'\n\t});\n\tconst [loadData, setLoadData] = useState(false);\n\tconst { newFilters, setNewFilters } = useContext(CreateFilterContext);\n\n\tuseEffect(() => {\n\t\tif (loadData) {\n\t\t\tconst tmpFilters = newFilters.slice();\n\t\t\ttmpFilters[activeIndex] = {\n\t\t\t\t...tmpFilters[activeIndex],\n\t\t\t\tfilterTests: [\n\t\t\t\t\t{\n\t\t\t\t\t\tmimeHeaderTest: [query]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tsetNewFilters(tmpFilters);\n\t\t\tsetLoadData(false);\n\t\t}\n\t}, [activeIndex, newFilters, setNewFilters, loadData, query]);\n\n\tconst handleQueryChange = useCallback((arg) => {\n\t\tsetQuery(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst defaultSelection = useMemo(() => {\n\t\tif (defaultValue) {\n\t\t\treturn defaultValue?.dateTest?.[0].negative ? existsOptions[0] : existsOptions[1];\n\t\t}\n\t\treturn existsOptions[0];\n\t}, [existsOptions, defaultValue]);\n\treturn (\n\t\t<>\n\t\t\t<Container minWidth=\"60%\" maxWidth=\"60%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={existsOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleQueryChange}\n\t\t\t\t\tdefaultSelection={defaultSelection}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default ReadReceiptCondition;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseMemo,\n\tuseContext,\n\tuseCallback,\n\tuseState,\n\tuseEffect\n} from 'react';\nimport { Container } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport CustomSelect from '../custom-select';\nimport { getFromOptions, getInOptions, getFolderOptions, findDefaultValue } from '../utils';\nimport { CreateFilterContext } from '../create-filter-context';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tactiveIndex: number;\n\tdefaultValue?: any;\n};\n\nconst AddressInCondition: FC<ComponentProps> = ({ t, activeIndex, defaultValue }): ReactElement => {\n\tconst fromOptions = useMemo(() => getFromOptions(t), [t]);\n\tconst inOptions = useMemo(() => getInOptions(t), [t]);\n\tconst folderOptions = useMemo(() => getFolderOptions(t), [t]);\n\tconst [query, setQuery] = useState({ header: 'from' });\n\tconst [header, setHeader] = useState('FROM');\n\tconst [sender, setSender] = useState({ key: '', value: {} });\n\tconst [type, setType] = useState('addressBookTest');\n\tconst [loadData, setLoadData] = useState(false);\n\n\tconst { newFilters, setNewFilters } = useContext(CreateFilterContext);\n\tuseEffect(() => {\n\t\tif (loadData) {\n\t\t\tconst tmpFilters = newFilters.slice();\n\n\t\t\ttmpFilters[activeIndex] = {\n\t\t\t\t...tmpFilters[activeIndex],\n\t\t\t\tfilterTests: [\n\t\t\t\t\tsender.key === 'in'\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\taddressBookTest: [{ header, type: 'contacts', ...sender.value }]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\tcontactRankingTest: [{ header, type: 'contacts', ...sender.value }]\n\t\t\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\t\t\tsetNewFilters(tmpFilters);\n\t\t\tsetLoadData(false);\n\t\t}\n\t}, [activeIndex, newFilters, setNewFilters, loadData, query, header, sender]);\n\n\tconst handleFromChange = useCallback((arg) => {\n\t\tsetHeader(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst handleSenderChange = useCallback((arg) => {\n\t\tsetSender(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst handleTypeChange = useCallback((arg) => {\n\t\tsetType(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst defaultFromOption = useMemo(() => {\n\t\tif (defaultValue) {\n\t\t\treturn findDefaultValue(fromOptions, defaultValue[Object.keys(defaultValue)[0]][0].header);\n\t\t}\n\t\treturn fromOptions[0];\n\t}, [fromOptions, defaultValue]);\n\n\tconst defaultInOption = useMemo(() => {\n\t\tif (defaultValue) {\n\t\t\tconst test = Object.keys(defaultValue)[0];\n\t\t\tif (test === 'meTest') {\n\t\t\t\treturn defaultValue[Object.keys(defaultValue)[0]][0].negative ? inOptions[3] : inOptions[2];\n\t\t\t}\n\t\t\treturn defaultValue[Object.keys(defaultValue)[0]][0].negative ? inOptions[1] : inOptions[0];\n\t\t}\n\t\treturn inOptions[0];\n\t}, [inOptions, defaultValue]);\n\n\tconst showFolderOption = useMemo(() => {\n\t\tif (defaultValue) {\n\t\t\tconst test = Object.keys(defaultValue)[0];\n\t\t\tif (test === 'meTest' || sender.key === 'myTest') return false;\n\t\t\treturn true;\n\t\t}\n\t\treturn sender.key !== 'myTest';\n\t}, [defaultValue, sender]);\n\n\tconst defaultFolderOption = useMemo(() => {\n\t\tif (defaultValue) {\n\t\t\tconst test = Object.keys(defaultValue)[0];\n\t\t\treturn test === 'contactRankingTest' ? folderOptions[1] : folderOptions[0];\n\t\t}\n\t\treturn folderOptions[0];\n\t}, [folderOptions, defaultValue]);\n\treturn (\n\t\t<>\n\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={fromOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleFromChange}\n\t\t\t\t\tdefaultSelection={defaultFromOption}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={inOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleSenderChange}\n\t\t\t\t\tdefaultSelection={defaultInOption}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t{showFolderOption && (\n\t\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t\t<CustomSelect\n\t\t\t\t\t\titems={folderOptions}\n\t\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\t\tlabel=\"\"\n\t\t\t\t\t\tonChange={handleTypeChange}\n\t\t\t\t\t\tdefaultSelection={defaultFolderOption}\n\t\t\t\t\t/>\n\t\t\t\t</Container>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default AddressInCondition;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseMemo,\n\tuseContext,\n\tuseCallback,\n\tuseEffect,\n\tuseState\n} from 'react';\nimport { Container } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport CustomSelect from '../custom-select';\nimport { getInviteRspOptions } from '../utils';\nimport { CreateFilterContext } from '../create-filter-context';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tactiveIndex: number;\n\tdefaultValue?: any;\n};\n\nconst CalendarCondition: FC<ComponentProps> = ({ t, activeIndex, defaultValue }): ReactElement => {\n\tconst inviteRspOptions = useMemo(() => getInviteRspOptions(t), [t]);\n\tconst [query, setQuery] = useState({ method: [{ _content: 'anyreply' }] });\n\tconst [loadData, setLoadData] = useState(false);\n\tconst { newFilters, setNewFilters } = useContext(CreateFilterContext);\n\n\tuseEffect(() => {\n\t\tif (loadData) {\n\t\t\tconst tmpFilters = newFilters.slice();\n\t\t\ttmpFilters[activeIndex] = {\n\t\t\t\t...tmpFilters[activeIndex],\n\t\t\t\tfilterTests: [\n\t\t\t\t\t{\n\t\t\t\t\t\tinviteTest: [query]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tsetNewFilters(tmpFilters);\n\t\t\tsetLoadData(false);\n\t\t}\n\t}, [activeIndex, newFilters, setNewFilters, loadData, query]);\n\n\tconst handleQueryChange = useCallback((arg) => {\n\t\tsetQuery(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst defaultOption = useMemo(() => {\n\t\tif (defaultValue) {\n\t\t\tif (defaultValue.inviteTest[0].method[0]._content === 'anyrequest') {\n\t\t\t\treturn defaultValue.inviteTest[0].negative ? inviteRspOptions[1] : inviteRspOptions[0];\n\t\t\t}\n\t\t\treturn defaultValue.inviteTest[0].negative ? inviteRspOptions[3] : inviteRspOptions[2];\n\t\t}\n\t\treturn inviteRspOptions[2];\n\t}, [defaultValue, inviteRspOptions]);\n\n\treturn (\n\t\t<>\n\t\t\t<Container minWidth=\"60%\" maxWidth=\"60%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={inviteRspOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleQueryChange}\n\t\t\t\t\tdefaultSelection={defaultOption}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default CalendarCondition;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseMemo,\n\tuseContext,\n\tuseCallback,\n\tuseEffect,\n\tuseState\n} from 'react';\nimport { Input, Container } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport CustomSelect from '../custom-select';\nimport { getConditionStatements } from '../utils';\nimport { CreateFilterContext } from '../create-filter-context';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tactiveIndex: number;\n};\n\nconst HeaderCondition: FC<ComponentProps> = ({ t, activeIndex }): ReactElement => {\n\tconst conditionStatementsOptions = useMemo(() => getConditionStatements(t), [t]);\n\n\tconst [loadData, setLoadData] = useState(false);\n\tconst [query, setQuery] = useState({ stringComparison: 'contains' });\n\tconst [header, setHeader] = useState('header');\n\tconst [value, setValue] = useState('');\n\n\tconst { newFilters, setNewFilters } = useContext(CreateFilterContext);\n\n\tuseEffect(() => {\n\t\tif (loadData) {\n\t\t\tconst tmpFilters = newFilters.slice();\n\n\t\t\ttmpFilters[activeIndex] = {\n\t\t\t\t...tmpFilters[activeIndex],\n\t\t\t\tfilterTests: [\n\t\t\t\t\t{\n\t\t\t\t\t\theaderTest: [{ header, ...query, value }]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\t\t\tsetNewFilters(tmpFilters);\n\t\t\tsetLoadData(false);\n\t\t}\n\t}, [activeIndex, newFilters, setNewFilters, value, loadData, header, query]);\n\n\tconst handleQueryChange = useCallback((arg) => {\n\t\tsetQuery(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst handleValueChange = useCallback((ev) => {\n\t\tsetValue(ev.target.value);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst handleHeaderChange = useCallback((ev) => {\n\t\tsetHeader(ev.target.value);\n\t\tsetLoadData(true);\n\t}, []);\n\n\treturn (\n\t\t<>\n\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t<Input backgroundColor=\"gray5\" defaultValue=\"header\" onChange={handleHeaderChange} />\n\t\t\t</Container>\n\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={conditionStatementsOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleQueryChange}\n\t\t\t\t\tdefaultSelection={conditionStatementsOptions[2]}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t<Input backgroundColor=\"gray5\" onChange={handleValueChange} />\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default HeaderCondition;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseMemo,\n\tuseContext,\n\tuseState,\n\tuseEffect,\n\tuseCallback\n} from 'react';\nimport { Container } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport CustomSelect from '../custom-select';\nimport { getSocialOptions } from '../utils';\nimport { CreateFilterContext } from '../create-filter-context';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tactiveIndex: number;\n\tdefaultValue?: any;\n};\n\nconst SocialCondition: FC<ComponentProps> = ({ t, activeIndex, defaultValue }): ReactElement => {\n\tconst socialOptions = useMemo(() => getSocialOptions(t), [t]);\n\tconst [query, setQuery] = useState({ linkedinTest: [{}] });\n\tconst [loadData, setLoadData] = useState(false);\n\tconst { newFilters, setNewFilters } = useContext(CreateFilterContext);\n\n\tuseEffect(() => {\n\t\tif (loadData) {\n\t\t\tconst tmpFilters = newFilters.slice();\n\t\t\ttmpFilters[activeIndex] = {\n\t\t\t\t...tmpFilters[activeIndex],\n\t\t\t\tfilterTests: [{ ...query }]\n\t\t\t};\n\t\t\tsetNewFilters(tmpFilters);\n\t\t\tsetLoadData(false);\n\t\t}\n\t}, [activeIndex, newFilters, setNewFilters, loadData, query]);\n\n\tconst handleQueryChange = useCallback((arg) => {\n\t\tsetQuery(arg);\n\t\tsetLoadData(true);\n\t}, []);\n\n\tconst defaultSelection = useMemo(() => {\n\t\tif (defaultValue) {\n\t\t\tswitch (Object.keys(defaultValue)[0]) {\n\t\t\t\tcase 'linkedinTest':\n\t\t\t\t\treturn socialOptions[0];\n\t\t\t\tcase 'twitterTest':\n\t\t\t\t\treturn socialOptions[1];\n\t\t\t\tdefault:\n\t\t\t\t\treturn socialOptions[2];\n\t\t\t}\n\t\t}\n\t\treturn socialOptions[0];\n\t}, [defaultValue, socialOptions]);\n\n\treturn (\n\t\t<>\n\t\t\t<Container minWidth=\"60%\" maxWidth=\"60%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={socialOptions}\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={handleQueryChange}\n\t\t\t\t\tdefaultSelection={defaultSelection}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default SocialCondition;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React from 'react';\nimport type { TFunction } from 'i18next';\nimport MessageCondition from './create-filters-conditions/message';\nimport FromToCondition from './create-filters-conditions/from-to';\nimport SizeCondition from './create-filters-conditions/size';\nimport DateCondition from './create-filters-conditions/date';\nimport BodyCondition from './create-filters-conditions/body';\nimport AttachmentCondition from './create-filters-conditions/attachment';\nimport ReadReceiptCondition from './create-filters-conditions/read-receipt';\nimport AddressInCondition from './create-filters-conditions/address-in';\nimport CalendarCondition from './create-filters-conditions/calendar';\nimport HeaderCondition from './create-filters-conditions/header';\nimport SocialCondition from './create-filters-conditions/social';\nimport DefaultCondition from './create-filters-conditions/default';\nimport { capitalise } from '../../../sidebar/utils';\n\ntype GetRowProps = {\n\tindex: number;\n\tsetNewFilters: (arg: any) => void;\n\tnewFilters: Array<any>;\n\tt: TFunction;\n\tcondition: string;\n};\nexport const getRowFunc =\n\t({ index, setNewFilters, newFilters, t, condition }: GetRowProps): any =>\n\t(str: string): void => {\n\t\tlet temp;\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t// @ts-ignore\n\t\tlet tests = [];\n\t\tconst previousNewFilters = newFilters.slice();\n\t\tswitch (str) {\n\t\t\tcase 'from':\n\t\t\tcase 'to':\n\t\t\tcase 'cc':\n\t\t\tcase 'to,cc': {\n\t\t\t\ttemp = <FromToCondition t={t} activeIndex={index} />;\n\t\t\t\ttests = [\n\t\t\t\t\t{\n\t\t\t\t\t\tcondition,\n\t\t\t\t\t\taddressTest: [{ header: 'from', part: 'all', stringComparison: 'contains', value: '' }]\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'message': {\n\t\t\t\ttemp = <MessageCondition t={t} activeIndex={index} />;\n\t\t\t\ttests = [\n\t\t\t\t\t{\n\t\t\t\t\t\tcondition,\n\t\t\t\t\t\tconversationTest: [{ where: 'started' }]\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'size': {\n\t\t\t\ttemp = <SizeCondition t={t} activeIndex={index} />;\n\t\t\t\ttests = [{ condition, sizeTest: [{ numberComparison: 'under', s: '' }] }];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'date': {\n\t\t\t\ttemp = <DateCondition t={t} activeIndex={index} />;\n\t\t\t\ttests = [{ condition, dateTest: [{ dateComparison: 'before', d: '' }] }];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'body': {\n\t\t\t\ttemp = <BodyCondition t={t} activeIndex={index} />;\n\t\t\t\ttests = [{ condition, bodyTest: [{ value: '' }] }];\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'attachment': {\n\t\t\t\ttemp = <AttachmentCondition t={t} activeIndex={index} />;\n\t\t\t\ttests = [{ condition, attachmentTest: [{}] }];\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'read receipt': {\n\t\t\t\ttemp = <ReadReceiptCondition t={t} activeIndex={index} />;\n\t\t\t\ttests = [\n\t\t\t\t\t{\n\t\t\t\t\t\tcondition,\n\t\t\t\t\t\tmimeHeaderTest: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\theader: 'Content-Type',\n\t\t\t\t\t\t\t\tstringComparison: 'Contains',\n\t\t\t\t\t\t\t\tvalue: 'message/disposition-notification'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'address in': {\n\t\t\t\ttemp = <AddressInCondition t={t} activeIndex={index} />;\n\t\t\t\ttests = [{ condition }];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'calendar': {\n\t\t\t\ttemp = <CalendarCondition t={t} activeIndex={index} />;\n\t\t\t\ttests = [{ condition, inviteTest: [{ method: [{ _content: 'anyreply' }] }] }];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'header named': {\n\t\t\t\ttemp = <HeaderCondition t={t} activeIndex={index} />;\n\t\t\t\ttests = [\n\t\t\t\t\t{\n\t\t\t\t\t\tcondition,\n\t\t\t\t\t\theaderTest: [{ header: 'header', stringComparison: 'contains', value: '' }]\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'social': {\n\t\t\t\ttemp = <SocialCondition t={t} activeIndex={index} />;\n\t\t\t\ttests = [{ condition, linkedinTest: [{}] }];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\ttemp = <DefaultCondition t={t} activeIndex={index} />;\n\t\t\t\ttests = [\n\t\t\t\t\t{\n\t\t\t\t\t\tcondition,\n\t\t\t\t\t\theaderTest: [{ header: 'subject', stringComparison: 'contains', value: '' }]\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\t\tpreviousNewFilters[index] = {\n\t\t\t...previousNewFilters[index],\n\t\t\tcomp: temp,\n\t\t\tkey: str,\n\t\t\tlabel: capitalise(str),\n\t\t\tindex,\n\t\t\tfilterTests: tests\n\t\t};\n\t\tsetNewFilters(previousNewFilters);\n\t};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useMemo, useCallback } from 'react';\nimport { Container, Padding, IconButton, Tooltip, getColor } from '@zextras/carbonio-design-system';\n\nimport styled from 'styled-components';\nimport { getStatusOptions, findDefaultValue } from './utils';\nimport DefaultCondition from './create-filters-conditions/default';\nimport CustomSelect from './custom-select';\nimport { getRowFunc } from './get-row';\n\nexport const StyledIconButton = styled(IconButton)`\n\tborder: 0.0625rem solid\n\t\t${({ theme, disabled, iconColor = 'primary' }): string =>\n\t\t\tdisabled ? theme.palette.gray2.regular : getColor(String(iconColor), theme)};\n\tsvg {\n\t\tborder: none !important;\n\t}\n`;\n\ntype FilterTestRowProps = {\n\ttmpFilter: {\n\t\tfilterActions: Array<any>;\n\t\tactive: boolean;\n\t\tname: string;\n\t\tkey: string;\n\t\tlabel: string;\n\t\tindex: number;\n\t\tfilterTests: Array<any>;\n\t\tcomp: ReactElement;\n\t};\n\tindex: string;\n\tcompProps: any;\n};\n\nconst FilterTestRows: FC<FilterTestRowProps> = ({ tmpFilter, index, compProps }): ReactElement => {\n\tconst { t, newFilters, setNewFilters, condition, activeFilter, filterName } = compProps;\n\tconst statusOptions = useMemo(() => getStatusOptions(t), [t]);\n\n\tconst addFilterCondition = useCallback(() => {\n\t\tconst previousNewFilters = newFilters.slice();\n\t\tpreviousNewFilters.push({\n\t\t\tfilterActions: [{ actionKeep: [{}], actionStop: [{}] }],\n\t\t\tactive: activeFilter,\n\t\t\tname: filterName,\n\t\t\tkey: 'subject',\n\t\t\tlabel: 'Subject',\n\t\t\tindex: newFilters.length,\n\t\t\tfilterTests: [{}],\n\t\t\tcomp: <DefaultCondition t={t} activeIndex={newFilters.length} />\n\t\t});\n\t\tsetNewFilters(previousNewFilters);\n\t}, [newFilters, t, activeFilter, filterName, setNewFilters]);\n\n\tconst removeFilterCondition = useCallback(\n\t\t(indexToRemove) => (): void => {\n\t\t\tconst previousNewFilters = newFilters.slice();\n\t\t\tpreviousNewFilters.splice(indexToRemove, 1);\n\t\t\tsetNewFilters(previousNewFilters);\n\t\t},\n\t\t[newFilters, setNewFilters]\n\t);\n\n\tconst disableRemove = useMemo(() => newFilters.length === 1, [newFilters]);\n\n\tconst getRow = useCallback(\n\t\t(indexToGet) => getRowFunc({ index: indexToGet, setNewFilters, newFilters, t, condition }),\n\t\t[setNewFilters, newFilters, t, condition]\n\t);\n\n\tconst defaultSelection = useMemo(\n\t\t() => findDefaultValue(statusOptions, tmpFilter.key),\n\t\t[tmpFilter, statusOptions]\n\t);\n\n\tconst onRemove = useMemo(\n\t\t() => (disableRemove ? (): null => null : removeFilterCondition(index)),\n\t\t[disableRemove, removeFilterCondition, index]\n\t);\n\n\treturn (\n\t\t<Container orientation=\"horizontal\" padding={{ top: 'small' }}>\n\t\t\t<Container minWidth=\"20%\" maxWidth=\"20%\" padding={{ right: 'small' }}>\n\t\t\t\t<CustomSelect\n\t\t\t\t\titems={statusOptions}\n\t\t\t\t\tlabel=\"\"\n\t\t\t\t\tonChange={getRow(index)}\n\t\t\t\t\tdefaultSelection={defaultSelection}\n\t\t\t\t/>\n\t\t\t</Container>\n\n\t\t\t{tmpFilter.comp && tmpFilter.comp}\n\n\t\t\t<Container orientation=\"horizontal\" mainAlignment=\"flex-end\">\n\t\t\t\t<Tooltip label={t('settings.add_condition', 'Add new condition')} placement=\"top\">\n\t\t\t\t\t<StyledIconButton icon=\"PlusOutline\" onClick={addFilterCondition} iconColor=\"primary\" />\n\t\t\t\t</Tooltip>\n\t\t\t\t<Padding left=\"small\">\n\t\t\t\t\t<Tooltip label={t('settings.remove_condition', 'Remove this condition')} placement=\"top\">\n\t\t\t\t\t\t<StyledIconButton\n\t\t\t\t\t\t\tdisabled={disableRemove}\n\t\t\t\t\t\t\ticon=\"MinusOutline\"\n\t\t\t\t\t\t\tonClick={onRemove}\n\t\t\t\t\t\t\ticonColor=\"secondary\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</Padding>\n\t\t\t</Container>\n\t\t</Container>\n\t);\n};\n\nexport default FilterTestRows;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useMemo } from 'react';\nimport { Container, Padding, Row, Text } from '@zextras/carbonio-design-system';\nimport { map } from 'lodash';\nimport Heading from '../../components/settings-heading';\nimport CustomSelect from './custom-select';\nimport { getFieldOptions, findDefaultValue } from './utils';\nimport FilterTestRows from './filter-test-rows';\n\ntype FilterTestConditionRowProps = any;\n\nconst FilterTestConditionRow: FC<FilterTestConditionRowProps> = ({ compProps }): ReactElement => {\n\tconst { t, newFilters, setCondition, selectedFilter } = compProps;\n\tconst fieldOptions = useMemo(() => getFieldOptions(t), [t]);\n\n\tconst defaultSelection = useMemo(\n\t\t() =>\n\t\t\tfindDefaultValue(fieldOptions, selectedFilter?.filterTests?.[0]?.condition) ||\n\t\t\tfieldOptions[0],\n\t\t[fieldOptions, selectedFilter]\n\t);\n\n\treturn (\n\t\t<Container height=\"fit\" maxHeight=\"100%\" crossAlignment=\"flex-start\" mainAlignment=\"flex-start\">\n\t\t\t<Container\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\theight=\"fit\"\n\t\t\t\tmaxHeight=\"100%\"\n\t\t\t>\n\t\t\t\t<Heading title={t('settings.conditions', 'Conditions')} size=\"medium\" />\n\t\t\t\t<Row>\n\t\t\t\t\t<Row padding={{ right: 'small' }}>\n\t\t\t\t\t\t<Text>{t('settings.if', 'If')}</Text>\n\t\t\t\t\t</Row>\n\t\t\t\t\t<Row padding={{ right: 'small' }} minWidth=\"5.9375rem\">\n\t\t\t\t\t\t<CustomSelect\n\t\t\t\t\t\t\titems={fieldOptions}\n\t\t\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\t\t\tlabel={t('settings.field', 'Field')}\n\t\t\t\t\t\t\tonChange={setCondition}\n\t\t\t\t\t\t\tdefaultSelection={defaultSelection}\n\t\t\t\t\t\t\tdata-testid={'filter-field'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Row>\n\t\t\t\t\t<Row padding={{ right: 'small' }}>\n\t\t\t\t\t\t<Text>{t('settings.condition_met', 'of the following conditions are met:')}</Text>\n\t\t\t\t\t</Row>\n\t\t\t\t</Row>\n\t\t\t</Container>\n\n\t\t\t<Padding top=\"small\" />\n\t\t\t<Container padding={{ top: 'small' }}>\n\t\t\t\t{map(newFilters, (tmpFilter, index) => (\n\t\t\t\t\t<FilterTestRows\n\t\t\t\t\t\tkey={`tmp-filter-${tmpFilter.key}-${index}`}\n\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\ttmpFilter={tmpFilter}\n\t\t\t\t\t\tcompProps={compProps}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</Container>\n\t\t</Container>\n\t);\n};\nexport default FilterTestConditionRow;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useCallback, useMemo, useState } from 'react';\n\nimport {\n\tButton,\n\tChipInput,\n\tChipItem,\n\tContainer,\n\tCustomModal,\n\tIconButton,\n\tInput,\n\tPadding,\n\tRow,\n\tText,\n\tTooltip,\n\tgetColor\n} from '@zextras/carbonio-design-system';\nimport { ZIMBRA_STANDARD_COLORS, useIntegratedComponent } from '@zextras/carbonio-shell-ui';\nimport { filter, omit } from 'lodash';\nimport styled from 'styled-components';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport CustomSelect from './custom-select';\nimport { getActionOptions, getMarkAsOptions } from './utils';\nimport { SelectFolderModal } from '../../../../ui-actions/modals/select-folder-modal';\n\nexport const StyledIconButton = styled(IconButton)`\n\tborder: 0.0625rem solid\n\t\t${({ theme, disabled, iconColor = 'primary' }): string =>\n\t\t\tdisabled ? theme.palette.gray2.regular : getColor(String(iconColor), theme)};\n\tsvg {\n\t\tborder: none !important;\n\t}\n`;\n\ntype FilterActionRowProps = {\n\ttmpFilter: any;\n\tindex: number;\n\tcompProps: any;\n\ttagOptions?: Array<any>;\n};\n\ntype ContactType = {\n\tcompany?: string;\n\temail: string;\n\tfirstName?: string;\n\tfullName?: string;\n\tid?: string;\n\tlabel?: string;\n\tlastName?: string;\n};\n\nconst FilterActionRows: FC<FilterActionRowProps> = ({\n\ttmpFilter,\n\tindex,\n\tcompProps,\n\ttagOptions\n}): ReactElement => {\n\tconst {\n\t\tt,\n\t\tisIncoming,\n\t\ttempActions,\n\t\tsetTempActions,\n\t\tzimbraFeatureMailForwardingInFiltersEnabled\n\t} = compProps;\n\tconst [open, setOpen] = useState(false);\n\tconst [activeIndex, setActiveIndex] = useState(0);\n\tconst [destination, setDestination] = useState<{ name?: string }>({});\n\tconst [isRedirectToActionRemoved, setIsRedirectToActionRemoved] = useState(false);\n\n\tconst actionOptions = useMemo(\n\t\t() => getActionOptions(t, zimbraFeatureMailForwardingInFiltersEnabled, isIncoming ?? false),\n\t\t[t, zimbraFeatureMailForwardingInFiltersEnabled, isIncoming]\n\t);\n\tconst markAsOptions = useMemo(() => getMarkAsOptions(t), [t]);\n\tconst [tag, setTag] = useState<Array<any>>([]);\n\n\tconst addFilterCondition = useCallback(() => {\n\t\tconst previousTempActions = tempActions.slice();\n\t\tpreviousTempActions.push({ actionKeep: [{}], actionStop: [{}], id: uuidv4() });\n\t\tsetTempActions(previousTempActions);\n\t}, [tempActions, setTempActions]);\n\n\tconst [activeActionOption, setActiveActionOption] = useState('inbox');\n\tconst showMarksAsBtn = useMemo(() => activeActionOption === 'markAs', [activeActionOption]);\n\tconst showRedirectToAddrsInput = useMemo(\n\t\t() => activeActionOption === 'redirectToAddress',\n\t\t[activeActionOption]\n\t);\n\tconst [contacts, setContacts] = useState<ContactType[]>([]);\n\tconst [ContactInput, integrationAvailable] = useIntegratedComponent('contact-input');\n\tconst onChange = useCallback(\n\t\t(users) => {\n\t\t\tconst previous = tempActions.slice();\n\t\t\tconst email = users.length > 0 && users[0].email !== '' ? users[0].email : '';\n\t\t\tprevious[index] = {\n\t\t\t\tactionRedirect: [{ a: email }],\n\t\t\t\tid: uuidv4()\n\t\t\t};\n\t\t\tsetContacts([{ email }]);\n\t\t\tsetTempActions(previous);\n\t\t},\n\t\t[index, setTempActions, tempActions]\n\t);\n\n\tconst onModalClose = useCallback(() => {\n\t\tsetDestination({});\n\t\tsetOpen(false);\n\t}, []);\n\n\tconst defaultValue = useMemo(() => {\n\t\tconst action = Object.keys(omit(tmpFilter, 'id'))[0];\n\t\tif (action === 'actionRedirect' && zimbraFeatureMailForwardingInFiltersEnabled === 'FALSE') {\n\t\t\tsetIsRedirectToActionRemoved(true);\n\t\t\tconst previous = tempActions.slice();\n\t\t\tprevious[index] = { actionKeep: [{}], id: previous[index].id };\n\t\t\tsetTempActions(previous);\n\t\t\treturn actionOptions[0];\n\t\t}\n\t\tswitch (action) {\n\t\t\tcase 'actionDiscard': {\n\t\t\t\treturn actionOptions[1];\n\t\t\t}\n\t\t\tcase 'actionKeep': {\n\t\t\t\treturn actionOptions[0];\n\t\t\t}\n\t\t\tcase 'actionFileInto': {\n\t\t\t\tsetActiveActionOption('moveIntoFolder');\n\t\t\t\tsetDestination({ name: tmpFilter[action][0].folderPath });\n\t\t\t\treturn actionOptions[2];\n\t\t\t}\n\t\t\tcase 'actionFlag': {\n\t\t\t\tsetActiveActionOption('markAs');\n\t\t\t\treturn actionOptions[4];\n\t\t\t}\n\t\t\tcase 'actionTag': {\n\t\t\t\tsetActiveActionOption('tagWith');\n\t\t\t\tconst chipBg = filter(tagOptions, { label: tmpFilter[action][0].tagName })[0];\n\t\t\t\tsetTag(\n\t\t\t\t\ttmpFilter[action][0].tagName\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: `${tmpFilter[action][0].tagName}`,\n\t\t\t\t\t\t\t\t\thasAvatar: true,\n\t\t\t\t\t\t\t\t\tavatarIcon: 'Tag',\n\t\t\t\t\t\t\t\t\tbackground: 'gray2',\n\t\t\t\t\t\t\t\t\tavatarBackground: ZIMBRA_STANDARD_COLORS[chipBg?.color]?.hex\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t: []\n\t\t\t\t);\n\t\t\t\treturn actionOptions[3];\n\t\t\t}\n\t\t\tcase 'actionRedirect': {\n\t\t\t\tsetActiveActionOption('redirectToAddress');\n\t\t\t\tif (tmpFilter[action][0].a) {\n\t\t\t\t\tsetContacts([{ email: tmpFilter[action][0].a }]);\n\t\t\t\t} else {\n\t\t\t\t\tsetContacts([]);\n\t\t\t\t}\n\t\t\t\treturn actionOptions[5];\n\t\t\t}\n\t\t\tdefault:\n\t\t\t\treturn actionOptions[0];\n\t\t}\n\t}, [\n\t\ttmpFilter,\n\t\tzimbraFeatureMailForwardingInFiltersEnabled,\n\t\ttempActions,\n\t\tindex,\n\t\tsetTempActions,\n\t\tactionOptions,\n\t\ttagOptions\n\t]);\n\n\tconst defaultMarkAsOption = useMemo(() => {\n\t\tconst action = Object.keys(omit(tmpFilter, 'id'))[0];\n\t\treturn tmpFilter[action][0].flagName === 'flagged' ? markAsOptions[1] : markAsOptions[0];\n\t}, [tmpFilter, markAsOptions]);\n\n\tconst showBrowseBtn = useMemo(\n\t\t() => activeActionOption === 'moveIntoFolder',\n\t\t[activeActionOption]\n\t);\n\n\tconst removeFilterCondition = useCallback(\n\t\t(indexToRemove) => (): void => {\n\t\t\tconst previousTempActions = tempActions.slice();\n\t\t\tpreviousTempActions.splice(indexToRemove, 1);\n\t\t\tsetTempActions(previousTempActions);\n\t\t},\n\t\t[tempActions, setTempActions]\n\t);\n\n\tconst disableRemove = useMemo(() => tempActions.length === 1, [tempActions]);\n\tconst onRemove = useMemo(\n\t\t() => (disableRemove ? (): null => null : removeFilterCondition(index)),\n\t\t[disableRemove, removeFilterCondition, index]\n\t);\n\tconst onActionOptionChange = useCallback(\n\t\t(str) => {\n\t\t\tswitch (str) {\n\t\t\t\tcase 'discard': {\n\t\t\t\t\tconst previous = tempActions.slice();\n\t\t\t\t\tprevious[index] = { id: previous[index].id, actionDiscard: [{}] };\n\t\t\t\t\tsetTempActions(previous);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'inbox': {\n\t\t\t\t\tconst previous = tempActions.slice();\n\t\t\t\t\tprevious[index] = { actionKeep: [{}], id: previous[index].id };\n\t\t\t\t\tsetTempActions(previous);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'tagWith': {\n\t\t\t\t\tconst previous = tempActions.slice();\n\t\t\t\t\tlet tagDetails;\n\t\t\t\t\tif (!previous[index].actionTag) {\n\t\t\t\t\t\ttagDetails = [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: previous[index]?.id,\n\t\t\t\t\t\t\t\tactionTag: [{ tagName: '' }]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t];\n\t\t\t\t\t\tprevious[index] = {\n\t\t\t\t\t\t\tid: previous[index]?.id,\n\t\t\t\t\t\t\tactionTag: [{ tagName: '' }]\n\t\t\t\t\t\t};\n\t\t\t\t\t\tsetTempActions(previous);\n\t\t\t\t\t\tsetTag(tagDetails);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'moveIntoFolder': {\n\t\t\t\t\tconst previous = tempActions.slice();\n\t\t\t\t\tlet folderDetail = [{}];\n\t\t\t\t\tif (!previous[index].actionFileInto) {\n\t\t\t\t\t\tfolderDetail = [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: ''\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t];\n\t\t\t\t\t\tprevious[index] = {\n\t\t\t\t\t\t\tid: previous[index]?.id,\n\t\t\t\t\t\t\tactionFileInto: [{ folderPath: '' }]\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tsetTempActions(previous);\n\t\t\t\t\tsetDestination(folderDetail[0]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'redirectToAddress': {\n\t\t\t\t\tconst previous = tempActions.slice();\n\t\t\t\t\tif (!previous[index].actionRedirect) {\n\t\t\t\t\t\tprevious[index] = {\n\t\t\t\t\t\t\tid: previous[index]?.id,\n\t\t\t\t\t\t\tactionRedirect: [{ a: '' }]\n\t\t\t\t\t\t};\n\t\t\t\t\t\tsetContacts([{ email: '' }]);\n\t\t\t\t\t}\n\t\t\t\t\tsetTempActions(previous);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t}\n\t\t\tif (isRedirectToActionRemoved) {\n\t\t\t\tsetIsRedirectToActionRemoved(false);\n\t\t\t}\n\t\t\tsetActiveActionOption(str);\n\t\t},\n\t\t[index, isRedirectToActionRemoved, setTempActions, tempActions]\n\t);\n\tconst openFolderModalDisabled = useMemo(\n\t\t() => activeActionOption !== 'moveIntoFolder',\n\t\t[activeActionOption]\n\t);\n\n\tconst showTagOptions = useMemo(() => activeActionOption === 'tagWith', [activeActionOption]);\n\n\tconst tagChipOnAdd = useCallback(\n\t\t(label: unknown): ChipItem => {\n\t\t\tconst chipBg = filter(tagOptions, { label })[0];\n\t\t\treturn {\n\t\t\t\tlabel: `${label}`,\n\t\t\t\thasAvatar: true,\n\t\t\t\tavatarIcon: 'Tag',\n\t\t\t\tbackground: 'gray2',\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tavatarBackground: ZIMBRA_STANDARD_COLORS[chipBg.color].hex\n\t\t\t};\n\t\t},\n\t\t[tagOptions]\n\t);\n\tconst openModal = useCallback(() => {\n\t\tsetActiveIndex(index);\n\t\tsetOpen(true);\n\t}, [setOpen, setActiveIndex, index]);\n\n\tconst onTagChange = useCallback(\n\t\t(chip) => {\n\t\t\tconst previous = tempActions.slice();\n\t\t\tif (chip.length > 0) {\n\t\t\t\tconst requiredTag = chip.length > 1 ? chip[1] : chip[0];\n\t\t\t\tsetTag([requiredTag]);\n\t\t\t\tprevious[index] = { id: previous[index]?.id, actionTag: [{ tagName: requiredTag.label }] };\n\t\t\t\tsetTempActions(previous);\n\t\t\t} else {\n\t\t\t\tprevious[index] = { id: previous[index]?.id, actionTag: [{ tagName: '' }] };\n\t\t\t\tsetTag([]);\n\t\t\t}\n\t\t\tsetTempActions(previous);\n\t\t},\n\t\t[setTag, tempActions, setTempActions, index]\n\t);\n\n\tconst handleMarkAsOptionChange = useCallback(\n\t\t(option) => {\n\t\t\tconst previous = tempActions.slice();\n\t\t\tprevious[index] = option;\n\t\t\tsetTempActions(previous);\n\t\t},\n\t\t[tempActions, index, setTempActions]\n\t);\n\n\tconst confirmAction = useCallback(\n\t\t(folderDestination, setFolderDestination, _onModalClose) => {\n\t\t\tconst previous = tempActions.slice();\n\t\t\tprevious[activeIndex] = {\n\t\t\t\tid: previous[activeIndex]?.id,\n\t\t\t\tactionFileInto: [{ folderPath: `${folderDestination.absFolderPath}` }]\n\t\t\t};\n\t\t\tsetTempActions(previous);\n\t\t\tsetDestination({ name: folderDestination.name });\n\t\t\tsetOpen(false);\n\t\t},\n\t\t[tempActions, activeIndex, setTempActions, setDestination, setOpen]\n\t);\n\n\tconst headerTitle = t('label.choose_folder', 'Choose Folder');\n\tconst actionLabel = t('settings.choose', 'Choose');\n\tconst inputLabel = t('settings.filter_folder_message', 'Select a folder to apply your filter:');\n\n\treturn (\n\t\t<Container\n\t\t\tmainAlignment=\"space-between\"\n\t\t\tcrossAlignment=\"center\"\n\t\t\torientation=\"horizontal\"\n\t\t\tpadding={{ top: 'small' }}\n\t\t>\n\t\t\t<Row>\n\t\t\t\t<Row padding={{ right: 'small' }} minWidth=\"12.5rem\">\n\t\t\t\t\t<CustomSelect\n\t\t\t\t\t\titems={actionOptions}\n\t\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\t\tlabel={t('settings.actions', 'Actions')}\n\t\t\t\t\t\tonChange={onActionOptionChange}\n\t\t\t\t\t\tdefaultSelection={defaultValue}\n\t\t\t\t\t/>\n\t\t\t\t</Row>\n\t\t\t\t{isRedirectToActionRemoved &&\n\t\t\t\t\t(defaultValue.value === 'inbox' || defaultValue.value === 'sent') && (\n\t\t\t\t\t\t<Row padding={{ right: 'small' }} minWidth=\"12.5rem\">\n\t\t\t\t\t\t\t<Text size=\"medium\" color=\"info\">\n\t\t\t\t\t\t\t\t{t('label.admin_disabled_action', 'The Admin disabled the redirect action')}\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t)}\n\t\t\t\t{showBrowseBtn && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t{destination && Object.keys(destination).length > 0 && destination?.name !== '' && (\n\t\t\t\t\t\t\t<Row padding={{ right: 'small' }}>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\tlabel={t('label.destination_folder', 'Destination Folder')}\n\t\t\t\t\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t\t\t\t\t\tvalue={destination?.name}\n\t\t\t\t\t\t\t\t\tdisabled\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<Row>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tdisabled={openFolderModalDisabled}\n\t\t\t\t\t\t\t\tlabel={t('settings.browse', 'Browse')}\n\t\t\t\t\t\t\t\ttype=\"outlined\"\n\t\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/explicit-function-return-type\n\t\t\t\t\t\t\t\tonClick={openModal}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t\t{showMarksAsBtn && (\n\t\t\t\t\t<Row padding={{ right: 'small' }} minWidth=\"12.5rem\">\n\t\t\t\t\t\t<CustomSelect\n\t\t\t\t\t\t\titems={markAsOptions}\n\t\t\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\t\t\tlabel=\"\"\n\t\t\t\t\t\t\tonChange={handleMarkAsOptionChange}\n\t\t\t\t\t\t\tdefaultSelection={defaultMarkAsOption}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Row>\n\t\t\t\t)}\n\n\t\t\t\t{showRedirectToAddrsInput && (\n\t\t\t\t\t<Row padding={{ right: 'small' }} minWidth=\"22rem\">\n\t\t\t\t\t\t{integrationAvailable ? (\n\t\t\t\t\t\t\t<ContactInput\n\t\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\t\tplaceholder={t('settings.address', 'Address')}\n\t\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\t\tdefaultValue={contacts}\n\t\t\t\t\t\t\t\tdisablePortal\n\t\t\t\t\t\t\t\tmaxChips={1}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<ChipInput\n\t\t\t\t\t\t\t\tplaceholder={t('settings.address', 'Address')}\n\t\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\t\tdefaultValue={contacts}\n\t\t\t\t\t\t\t\tmaxChips={1}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Row>\n\t\t\t\t)}\n\n\t\t\t\t{showTagOptions && (\n\t\t\t\t\t<Row padding={{ right: 'small' }} minWidth=\"12.5rem\">\n\t\t\t\t\t\t<ChipInput\n\t\t\t\t\t\t\tplaceholder={t('label.tag', 'Tag')}\n\t\t\t\t\t\t\tbackground=\"gray4\"\n\t\t\t\t\t\t\tdefaultValue={[]}\n\t\t\t\t\t\t\toptions={tagOptions}\n\t\t\t\t\t\t\tvalue={tag}\n\t\t\t\t\t\t\tsingleSelection\n\t\t\t\t\t\t\tonChange={onTagChange}\n\t\t\t\t\t\t\tonAdd={tagChipOnAdd}\n\t\t\t\t\t\t\tdisableOptions={false}\n\t\t\t\t\t\t\tdisabled\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Row>\n\t\t\t\t)}\n\t\t\t</Row>\n\t\t\t<Container orientation=\"horizontal\" mainAlignment=\"flex-end\" width=\"auto\">\n\t\t\t\t<Tooltip label={t('settings.add_action', 'Add new action')} placement=\"top\">\n\t\t\t\t\t<StyledIconButton icon=\"PlusOutline\" onClick={addFilterCondition} iconColor=\"primary\" />\n\t\t\t\t</Tooltip>\n\t\t\t\t<Padding left=\"small\">\n\t\t\t\t\t<Tooltip label={t('settings.remove_action', 'Remove this action')} placement=\"top\">\n\t\t\t\t\t\t<StyledIconButton\n\t\t\t\t\t\t\ticon=\"MinusOutline\"\n\t\t\t\t\t\t\tdisabled={disableRemove}\n\t\t\t\t\t\t\tonClick={onRemove}\n\t\t\t\t\t\t\ticonColor=\"secondary\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</Padding>\n\t\t\t</Container>\n\t\t\t<CustomModal open={open} onClose={onModalClose} maxHeight=\"90vh\" size=\"medium\">\n\t\t\t\t<SelectFolderModal\n\t\t\t\t\tonClose={onModalClose}\n\t\t\t\t\theaderTitle={headerTitle}\n\t\t\t\t\tactionLabel={actionLabel}\n\t\t\t\t\tinputLabel={inputLabel}\n\t\t\t\t\tconfirmAction={confirmAction}\n\t\t\t\t\tshowSharedAccounts={false}\n\t\t\t\t\tshowSpamFolder={false}\n\t\t\t\t\tshowTrashFolder\n\t\t\t\t\tallowFolderCreation={false}\n\t\t\t\t\tallowRootSelection={false}\n\t\t\t\t/>\n\t\t\t</CustomModal>\n\t\t</Container>\n\t);\n};\n\nexport default FilterActionRows;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useMemo } from 'react';\nimport { Container, Text, Icon, Row, Padding } from '@zextras/carbonio-design-system';\nimport { map } from 'lodash';\n\nimport { getTags, ZIMBRA_STANDARD_COLORS } from '@zextras/carbonio-shell-ui';\nimport Heading from '../../components/settings-heading';\nimport FilterActionRows from './filter-action-rows';\n\ntype ComponentProps = any;\n\nconst FilterActionConditions: FC<ComponentProps> = ({ compProps }): ReactElement => {\n\tconst { t, tempActions } = compProps;\n\tconst tagOptions = useMemo(\n\t\t() =>\n\t\t\tmap(getTags(), (item) => ({\n\t\t\t\t...item,\n\t\t\t\tlabel: item.name,\n\t\t\t\tcustomComponent: (\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Icon icon=\"Tag\" customColor={ZIMBRA_STANDARD_COLORS[item.color ?? 0].hex} />\n\t\t\t\t\t\t<Padding left=\"small\">\n\t\t\t\t\t\t\t<Text>{item.name}</Text>\n\t\t\t\t\t\t</Padding>\n\t\t\t\t\t</Row>\n\t\t\t\t)\n\t\t\t})),\n\t\t[]\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<Container padding={{ top: 'medium' }} crossAlignment=\"flex-start\" mainAlignment=\"flex-start\">\n\t\t\t\t<Heading title={t('settings.actions', 'Actions')} size=\"medium\" />\n\t\t\t\t<Text>{t('settings.perform_following_action', 'Perform the following actions:')}</Text>\n\t\t\t\t<Container padding={{ top: 'small' }} mainAlignment=\"flex-start\">\n\t\t\t\t\t{map(tempActions, (tempAction, index: number) => (\n\t\t\t\t\t\t<FilterActionRows\n\t\t\t\t\t\t\tkey={tempAction.id}\n\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\ttmpFilter={tempAction}\n\t\t\t\t\t\t\tcompProps={compProps}\n\t\t\t\t\t\t\ttagOptions={tagOptions}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))}\n\t\t\t\t</Container>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default FilterActionConditions;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\n\nexport const modifyFilterRules = async (newRules: Array<any>): Promise<any> => {\n\tconst res = await soapFetch('ModifyFilterRules', {\n\t\tfilterRules: [{ filterRule: newRules }],\n\t\t_jsns: 'urn:zimbraMail'\n\t});\n\treturn res;\n};\n\nexport const modifyOutgoingFilterRules = async (newRules: Array<any>): Promise<any> => {\n\tconst res = await soapFetch('ModifyOutgoingFilterRules', {\n\t\tfilterRules: [{ filterRule: newRules }],\n\t\t_jsns: 'urn:zimbraMail'\n\t});\n\treturn res;\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useCallback, useMemo, useState } from 'react';\n\nimport { Input, Container, Checkbox, Padding, Divider, Row } from '@zextras/carbonio-design-system';\nimport { useUserSettings } from '@zextras/carbonio-shell-ui';\nimport type { TFunction } from 'i18next';\nimport { map, omit, reduce } from 'lodash';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { CreateFilterContext } from './create-filter-context';\nimport ModalFooter from './create-filter-modal-footer';\nimport DefaultCondition from './create-filters-conditions/default';\nimport FilterTestConditionRow from './filter-test-condition-row';\nimport FilterActionConditions from './new-filter-action-conditions';\nimport { getButtonInfo } from './utils';\nimport ModalHeader from '../../../../carbonio-ui-commons/components/modals/modal-header';\nimport { modifyFilterRules } from '../../../../store/actions/modify-filter-rules';\nimport type { FilterActions } from '../../../../types';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tonClose: () => void;\n\tincomingFilters?: any;\n\tsetFetchIncomingFilters?: (arg: boolean) => void;\n\tsetIncomingFilters?: (arg: any) => void;\n};\n\nconst CreateFilterModal: FC<ComponentProps> = ({\n\tt,\n\tonClose,\n\tincomingFilters,\n\tsetFetchIncomingFilters,\n\tsetIncomingFilters\n}): ReactElement => {\n\tconst [filterName, setFilterName] = useState('');\n\tconst [activeFilter, setActiveFilter] = useState(false);\n\tconst [condition, setCondition] = useState('anyof');\n\tconst [dontProcessAddFilters, setDontProcessAddFilters] = useState(true);\n\tconst [tempActions, setTempActions] = useState([{ actionKeep: [{}], id: uuidv4() }]);\n\tconst { zimbraFeatureMailForwardingInFiltersEnabled } = useUserSettings().attrs;\n\tconst finalActions = useMemo(\n\t\t() =>\n\t\t\treduce(\n\t\t\t\ttempActions,\n\t\t\t\t(acc, i) => {\n\t\t\t\t\tconst firstKey = Object.keys(omit(i, 'id'))[0];\n\t\t\t\t\tif (Object.keys(acc).includes(firstKey)) {\n\t\t\t\t\t\tconst accWithoutId = omit(acc, 'id');\n\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\treturn { ...accWithoutId, [firstKey]: [...accWithoutId[firstKey], ...i[firstKey]] };\n\t\t\t\t\t}\n\t\t\t\t\treturn { ...acc, ...i };\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t),\n\t\t[tempActions]\n\t);\n\n\tconst [newFilters, setNewFilters] = useState([\n\t\t{\n\t\t\tfilterActions: [{ actionKeep: [{}], actionStop: [{}] }],\n\t\t\tactive: activeFilter,\n\t\t\tname: filterName,\n\t\t\tkey: 'subject',\n\t\t\tlabel: 'Subject',\n\t\t\tfilterTests: [{}],\n\t\t\tindex: 0,\n\t\t\tcomp: <DefaultCondition t={t} activeIndex={0} />\n\t\t}\n\t]);\n\n\tconst toggleActiveFilter = useCallback(() => setActiveFilter(!activeFilter), [activeFilter]);\n\tconst onFilterNameChange = useCallback((ev) => setFilterName(ev.target.value), []);\n\tconst modalTitle = useMemo(() => t('settings.create_new_filter', 'Create new Filter'), [t]);\n\tconst inputLabel = useMemo(() => `${t('settings.filter_name', 'Filter Name')}*`, [t]);\n\tconst activeFilterLabel = useMemo(() => t('settings.active_filter', 'Active filter'), [t]);\n\n\tconst requiredFilterTest = useMemo(() => {\n\t\tconst allTest = map(newFilters, (f) => f.filterTests[0]);\n\n\t\treturn reduce(\n\t\t\tallTest,\n\t\t\t(a, i) => {\n\t\t\t\tconst firstKey = Object.keys(omit(i, ['condition']))[0];\n\t\t\t\tif (Object.keys(a).includes(firstKey)) {\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\treturn { ...a, [firstKey]: [...a[firstKey], ...i[firstKey]] };\n\t\t\t\t}\n\t\t\t\treturn { ...a, ...i };\n\t\t\t},\n\t\t\t{}\n\t\t);\n\t}, [newFilters]);\n\tconst requiredFilters = useMemo(\n\t\t() => ({\n\t\t\tfilterActions: dontProcessAddFilters\n\t\t\t\t? ([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...omit(finalActions, 'id'),\n\t\t\t\t\t\t\tactionStop: [{}]\n\t\t\t\t\t\t}\n\t\t\t\t\t] as FilterActions[])\n\t\t\t\t: ([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...omit(finalActions, 'id')\n\t\t\t\t\t\t}\n\t\t\t\t\t] as FilterActions[]),\n\t\t\tactive: activeFilter,\n\t\t\tname: filterName,\n\t\t\tfilterTests: [\n\t\t\t\t{\n\t\t\t\t\t...requiredFilterTest,\n\t\t\t\t\tcondition\n\t\t\t\t}\n\t\t\t]\n\t\t}),\n\t\t[activeFilter, filterName, condition, requiredFilterTest, finalActions, dontProcessAddFilters]\n\t);\n\n\tconst [createFilterDisabled, buttonTooltip] = useMemo(\n\t\t() => getButtonInfo(filterName, requiredFilters, t),\n\t\t[filterName, requiredFilters, t]\n\t);\n\n\tconst incomingFiltersCopy = useMemo(() => incomingFilters?.slice() || [], [incomingFilters]);\n\tconst onConfirm = useCallback(() => {\n\t\tconst toSend = [...incomingFiltersCopy, requiredFilters];\n\t\tsetIncomingFilters?.(toSend);\n\t\tmodifyFilterRules(toSend).then(() => {\n\t\t\tsetFetchIncomingFilters?.(true);\n\t\t});\n\t\tonClose();\n\t}, [incomingFiltersCopy, onClose, requiredFilters, setFetchIncomingFilters, setIncomingFilters]);\n\n\tconst toggleCheckBox = useCallback(() => {\n\t\tsetDontProcessAddFilters(!dontProcessAddFilters);\n\t}, [dontProcessAddFilters]);\n\n\tconst filterActionProps = useMemo(\n\t\t() => ({\n\t\t\tt,\n\t\t\tactiveFilter,\n\t\t\tfilterName,\n\t\t\tisIncoming: true,\n\t\t\ttempActions,\n\t\t\tsetTempActions,\n\t\t\tzimbraFeatureMailForwardingInFiltersEnabled\n\t\t}),\n\t\t[t, activeFilter, filterName, tempActions, zimbraFeatureMailForwardingInFiltersEnabled]\n\t);\n\tconst filterTestConditionRowProps = useMemo(\n\t\t() => ({ t, newFilters, setNewFilters, condition, setCondition, activeFilter, filterName }),\n\t\t[t, newFilters, setNewFilters, condition, setCondition, activeFilter, filterName]\n\t);\n\treturn (\n\t\t<CreateFilterContext.Provider value={{ newFilters, setNewFilters }}>\n\t\t\t<Container\n\t\t\t\tpadding={{ bottom: 'medium' }}\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\tmaxHeight=\"100%\"\n\t\t\t\tstyle={{ overflowY: 'scroll', overflowX: 'hidden' }}\n\t\t\t>\n\t\t\t\t<ModalHeader title={modalTitle} onClose={onClose} />\n\t\t\t\t<Input\n\t\t\t\t\tlabel={inputLabel}\n\t\t\t\t\tvalue={filterName}\n\t\t\t\t\tonChange={onFilterNameChange}\n\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t\tdata-testid=\"filter-name\"\n\t\t\t\t/>\n\t\t\t\t<Padding top=\"small\" />\n\t\t\t\t<Checkbox\n\t\t\t\t\tvalue={activeFilter}\n\t\t\t\t\tonClick={toggleActiveFilter}\n\t\t\t\t\tlabel={activeFilterLabel}\n\t\t\t\t\tdata-testid={'active-filter'}\n\t\t\t\t/>\n\t\t\t\t<Row\n\t\t\t\t\tpadding={{ vertical: 'medium' }}\n\t\t\t\t\theight=\"fit\"\n\t\t\t\t\tmaxHeight=\"100%\"\n\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\t\tstyle={{ overflowY: 'scroll', overflowX: 'hidden' }}\n\t\t\t\t\tdisplay=\"block\"\n\t\t\t\t\tmaxWidth=\"100%\"\n\t\t\t\t\twidth=\"100%\"\n\t\t\t\t>\n\t\t\t\t\t<FilterTestConditionRow compProps={filterTestConditionRowProps} />\n\t\t\t\t\t<Padding top=\"medium\" />\n\t\t\t\t\t<Divider />\n\t\t\t\t\t<FilterActionConditions compProps={filterActionProps} />\n\t\t\t\t</Row>\n\t\t\t\t<ModalFooter\n\t\t\t\t\tlabel={t('label.create', 'Create')}\n\t\t\t\t\ttoolTipText={buttonTooltip}\n\t\t\t\t\tonConfirm={onConfirm}\n\t\t\t\t\tdisabled={createFilterDisabled}\n\t\t\t\t\tonSecondaryAction={toggleCheckBox}\n\t\t\t\t\tchecked={dontProcessAddFilters}\n\t\t\t\t\tcheckboxLabel={t(\n\t\t\t\t\t\t'settings.do_not_process_additional_filters',\n\t\t\t\t\t\t'Do not process additional filters'\n\t\t\t\t\t)}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</CreateFilterContext.Provider>\n\t);\n};\n\nexport default CreateFilterModal;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useCallback, useMemo } from 'react';\n\nimport { Container, Text } from '@zextras/carbonio-design-system';\nimport { TFunction } from 'i18next';\n\nimport { useDeleteFilter } from './actions';\nimport ModalFooter from '../../../../carbonio-ui-commons/components/modals/modal-footer';\nimport ModalHeader from '../../../../carbonio-ui-commons/components/modals/modal-header';\nimport type { FilterListType } from '../../../../types';\n\ntype ListType = {\n\tisSelecting: boolean;\n\tlist: Array<FilterListType>;\n\tmoveDown: (arg: number) => void;\n\tmoveUp: (arg: number) => void;\n\tselected: Record<string, boolean>;\n\ttoggle: (arg: string) => void;\n\tunSelect: () => void;\n};\n\ntype ComponentProps = {\n\tt: TFunction;\n\tonClose: () => void;\n\tavailableList: ListType;\n\tactiveList: ListType;\n\tsetFilters: (arg: Array<FilterListType>) => void;\n\tsetFetchFilters: (arg: boolean) => void;\n\tmodifierFunc: (arg: FilterListType[]) => Promise<void>;\n\tselectedFilter: any;\n\tincomingFilters: any;\n};\n\nconst DeleteFilterModal: FC<ComponentProps> = ({\n\tt,\n\tonClose,\n\tavailableList,\n\tactiveList,\n\tsetFilters,\n\tsetFetchFilters,\n\tmodifierFunc,\n\tselectedFilter,\n\tincomingFilters\n}): ReactElement => {\n\tconst modalTitle = useMemo(() => t('settings.delete_filter', 'Delete filter'), [t]);\n\n\tconst deleteFilter = useDeleteFilter();\n\tconst onConfirmDelete = useCallback(() => {\n\t\tdeleteFilter({\n\t\t\tt,\n\t\t\tonClose,\n\t\t\tavailableList,\n\t\t\tactiveList,\n\t\t\tsetFilters,\n\t\t\tsetFetchFilters,\n\t\t\tmodifierFunc,\n\t\t\tselectedFilter,\n\t\t\tincomingFilters\n\t\t});\n\t}, [\n\t\tactiveList,\n\t\tavailableList,\n\t\tdeleteFilter,\n\t\tincomingFilters,\n\t\tmodifierFunc,\n\t\tonClose,\n\t\tselectedFilter,\n\t\tsetFetchFilters,\n\t\tsetFilters,\n\t\tt\n\t]);\n\treturn (\n\t\t<>\n\t\t\t<Container padding={{ bottom: 'medium' }}>\n\t\t\t\t<ModalHeader title={modalTitle} onClose={onClose} />\n\t\t\t\t<Container orientation=\"horizontal\" padding={{ all: 'medium' }}>\n\t\t\t\t\t<Text overflow=\"break-word\">\n\t\t\t\t\t\t{t('settings.delete_filter_text', 'Are you sure to delete filter ')}\n\t\t\t\t\t</Text>\n\t\t\t\t\t<Text weight=\"bold\" style={{ paddingLeft: '0.3125rem', paddingRight: '0.3125rem' }}>\n\t\t\t\t\t\t{`\"${selectedFilter?.name}\" ?`}\n\t\t\t\t\t</Text>\n\t\t\t\t</Container>\n\t\t\t\t<ModalFooter\n\t\t\t\t\tonConfirm={onConfirmDelete}\n\t\t\t\t\tlabel={t('label.delete', 'Delete')}\n\t\t\t\t\tbackground=\"error\"\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default DeleteFilterModal;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { ReactElement } from 'react';\nimport type { TFunction } from 'i18next';\nimport MessageCondition from './create-filters-conditions/message';\nimport FromToCondition from './create-filters-conditions/from-to';\nimport SizeCondition from './create-filters-conditions/size';\nimport DateCondition from './create-filters-conditions/date';\nimport BodyCondition from './create-filters-conditions/body';\nimport AttachmentCondition from './create-filters-conditions/attachment';\nimport ReadReceiptCondition from './create-filters-conditions/read-receipt';\nimport AddressInCondition from './create-filters-conditions/address-in';\nimport CalendarCondition from './create-filters-conditions/calendar';\nimport SocialCondition from './create-filters-conditions/social';\nimport DefaultCondition from './create-filters-conditions/default';\n\ntype GetTestComponent = { name: string; index: number; test: any; t: TFunction };\n\nexport const getTestComponent = ({ name, index, test, t }: GetTestComponent): ReactElement => {\n\tswitch (name) {\n\t\tcase 'addressTest': {\n\t\t\treturn (\n\t\t\t\t<FromToCondition\n\t\t\t\t\tt={t}\n\t\t\t\t\tactiveIndex={index}\n\t\t\t\t\tdefaultValue={test}\n\t\t\t\t\tkey={`tmp-filter-${name}-${new Date().valueOf()}`}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tcase 'bulkTest':\n\t\tcase 'listTest':\n\t\tcase 'flaggedTest':\n\t\tcase 'conversationTest': {\n\t\t\treturn (\n\t\t\t\t<MessageCondition\n\t\t\t\t\tt={t}\n\t\t\t\t\tactiveIndex={index}\n\t\t\t\t\tdefaultValue={test}\n\t\t\t\t\tkey={`tmp-filter-${name}-${new Date().valueOf()}`}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tcase 'sizeTest': {\n\t\t\treturn (\n\t\t\t\t<SizeCondition\n\t\t\t\t\tt={t}\n\t\t\t\t\tactiveIndex={index}\n\t\t\t\t\tdefaultValue={test}\n\t\t\t\t\tkey={`tmp-filter-${name}-${new Date().valueOf()}`}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tcase 'dateTest': {\n\t\t\treturn (\n\t\t\t\t<DateCondition\n\t\t\t\t\tt={t}\n\t\t\t\t\tactiveIndex={index}\n\t\t\t\t\tdefaultValue={test}\n\t\t\t\t\tkey={`tmp-filter-${name}-${new Date().valueOf()}`}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tcase 'bodyTest': {\n\t\t\treturn (\n\t\t\t\t<BodyCondition\n\t\t\t\t\tt={t}\n\t\t\t\t\tactiveIndex={index}\n\t\t\t\t\tdefaultValue={test}\n\t\t\t\t\tkey={`tmp-filter-${name}-${new Date().valueOf()}`}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\tcase 'attachmentTest': {\n\t\t\treturn (\n\t\t\t\t<AttachmentCondition\n\t\t\t\t\tt={t}\n\t\t\t\t\tactiveIndex={index}\n\t\t\t\t\tdefaultValue={test}\n\t\t\t\t\tkey={`tmp-filter-${name}-${new Date().valueOf()}`}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\tcase 'mimeHeaderTest': {\n\t\t\treturn (\n\t\t\t\t<ReadReceiptCondition\n\t\t\t\t\tt={t}\n\t\t\t\t\tactiveIndex={index}\n\t\t\t\t\tdefaultValue={test}\n\t\t\t\t\tkey={`tmp-filter-${name}-${new Date().valueOf()}`}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tcase 'contactRankingTest':\n\t\tcase 'meTest':\n\t\tcase 'addressBookTest': {\n\t\t\treturn (\n\t\t\t\t<AddressInCondition\n\t\t\t\t\tt={t}\n\t\t\t\t\tactiveIndex={index}\n\t\t\t\t\tdefaultValue={test}\n\t\t\t\t\tkey={`tmp-filter-${name}-${new Date().valueOf()}`}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tcase 'inviteTest': {\n\t\t\treturn (\n\t\t\t\t<CalendarCondition\n\t\t\t\t\tt={t}\n\t\t\t\t\tactiveIndex={index}\n\t\t\t\t\tdefaultValue={test}\n\t\t\t\t\tkey={`tmp-filter-${name}-${new Date().valueOf()}`}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\tcase 'linkedinTest':\n\t\tcase 'facebookTest':\n\t\tcase 'twitterTest': {\n\t\t\treturn (\n\t\t\t\t<SocialCondition\n\t\t\t\t\tt={t}\n\t\t\t\t\tactiveIndex={index}\n\t\t\t\t\tdefaultValue={test}\n\t\t\t\t\tkey={`tmp-filter-${name}-${new Date().valueOf()}`}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\tdefault: {\n\t\t\treturn (\n\t\t\t\t<DefaultCondition\n\t\t\t\t\tt={t}\n\t\t\t\t\tactiveIndex={index}\n\t\t\t\t\tdefaultValue={test}\n\t\t\t\t\tkey={`tmp-filter-${name}-${new Date().valueOf()}`}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t}\n};\n\nexport const findRowKey = ({ name, test }: { name: string; test: any }): string => {\n\tswitch (name) {\n\t\tcase 'bodyTest':\n\t\t\treturn 'body';\n\n\t\tcase 'addressTest':\n\t\tcase 'headerTest':\n\t\t\treturn test.header;\n\n\t\tcase 'sizeTest':\n\t\t\treturn 'size';\n\n\t\tcase 'attachmentTest':\n\t\t\treturn 'attachment';\n\t\tcase 'bulkTest':\n\t\tcase 'listTest':\n\t\tcase 'flaggedTest':\n\t\tcase 'conversationTest':\n\t\t\treturn 'message';\n\n\t\tcase 'dateTest':\n\t\t\treturn 'date';\n\n\t\tcase 'mimeHeaderTest':\n\t\t\treturn 'read receipt';\n\n\t\tcase 'addressBookTest':\n\t\tcase 'contactRankingTest':\n\t\tcase 'meTest':\n\t\t\treturn 'address in';\n\n\t\tcase 'inviteTest':\n\t\t\treturn 'calendar';\n\n\t\tcase 'linkedinTest':\n\t\tcase 'facebookTest':\n\t\tcase 'twitterTest':\n\t\t\treturn 'social';\n\n\t\tdefault:\n\t\t\treturn 'subject';\n\t}\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseCallback,\n\tuseEffect,\n\tuseLayoutEffect,\n\tuseMemo,\n\tuseState\n} from 'react';\n\nimport { Checkbox, Container, Divider, Input, Padding, Row } from '@zextras/carbonio-design-system';\nimport { useUserSettings } from '@zextras/carbonio-shell-ui';\nimport { TFunction } from 'i18next';\nimport { findIndex, forEach, isEqual, map, omit, reduce } from 'lodash';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport ModalHeader from '../../../../../carbonio-ui-commons/components/modals/modal-header';\nimport { useUiUtilities } from '../../../../../hooks/use-ui-utilities';\nimport { modifyFilterRules } from '../../../../../store/actions/modify-filter-rules';\nimport type { FilterActions } from '../../../../../types';\nimport { capitalise } from '../../../../sidebar/utils';\nimport { CreateFilterContext } from '../create-filter-context';\nimport ModalFooter from '../create-filter-modal-footer';\nimport DefaultCondition from '../create-filters-conditions/default';\nimport FilterTestConditionRow from '../filter-test-condition-row';\nimport { findRowKey, getTestComponent } from '../get-test-component';\nimport FilterActionConditions from '../new-filter-action-conditions';\nimport { getButtonInfo } from '../utils';\n\ntype FilterType = {\n\tactive: boolean;\n\tfilterActions: Array<any>;\n\tfilterTests: Array<Record<string, any>>;\n\tid: string;\n\tname: string;\n};\ntype ComponentProps = {\n\tt: TFunction;\n\tonClose: () => void;\n\tincomingFilters?: any;\n\tsetFetchIncomingFilters: (arg: boolean) => void;\n\tsetIncomingFilters: (arg: any) => void;\n\tselectedFilter: FilterType | any;\n};\n\nconst ModifyFilterModal: FC<ComponentProps> = ({\n\tt,\n\tonClose,\n\tincomingFilters,\n\tsetFetchIncomingFilters,\n\tsetIncomingFilters,\n\tselectedFilter\n}): ReactElement => {\n\tconst [filterName, setFilterName] = useState('');\n\tconst [activeFilter, setActiveFilter] = useState(false);\n\tconst [condition, setCondition] = useState('anyof');\n\tconst [dontProcessAddFilters, setDontProcessAddFilters] = useState(true);\n\tconst [tempActions, setTempActions] = useState([{ actionKeep: [{}], id: uuidv4() }]);\n\tconst [copyRequiredFilters, setCopyRequiredFilters] = useState({});\n\tconst [reFetch, setReFetch] = useState(false);\n\tconst [updateRequiredFilters, setUpdateRequiredFilters] = useState(true);\n\tconst { zimbraFeatureMailForwardingInFiltersEnabled } = useUserSettings().attrs;\n\tconst { createSnackbar } = useUiUtilities();\n\n\tconst [newFilters, setNewFilters] = useState([\n\t\t{\n\t\t\tfilterActions: [{ actionKeep: [{}], actionStop: [{}] }],\n\t\t\tactive: activeFilter,\n\t\t\tname: filterName,\n\t\t\tkey: 'subject',\n\t\t\tlabel: 'Subject',\n\t\t\tfilterTests: [{}],\n\t\t\tindex: 0,\n\t\t\tcomp: <DefaultCondition t={t} activeIndex={0} />\n\t\t}\n\t]);\n\n\tconst toggleActiveFilter = useCallback(() => setActiveFilter(!activeFilter), [activeFilter]);\n\tconst onFilterNameChange = useCallback((ev) => setFilterName(ev.target.value), []);\n\tconst modalTitle = useMemo(\n\t\t() => `${t('label.edit', 'Edit')} ${selectedFilter?.name}`,\n\t\t[t, selectedFilter?.name]\n\t);\n\tconst inputLabel = useMemo(() => `${t('settings.filter_name', 'Filter Name')}*`, [t]);\n\tconst activeFilterLabel = useMemo(() => t('settings.active_filter', 'Active filter'), [t]);\n\n\tconst requiredFilterTest = useMemo(() => {\n\t\tconst allTest = map(newFilters, (f) => f.filterTests[0]);\n\n\t\treturn reduce(\n\t\t\tallTest,\n\t\t\t(a, i) => {\n\t\t\t\tconst firstKey = Object.keys(omit(i, ['condition']))[0];\n\t\t\t\tif (Object.keys(a).includes(firstKey)) {\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\treturn { ...a, [firstKey]: [...a[firstKey], ...i[firstKey]] };\n\t\t\t\t}\n\t\t\t\treturn { ...a, ...i };\n\t\t\t},\n\t\t\t{}\n\t\t);\n\t}, [newFilters]);\n\n\tconst finalActions = useMemo(\n\t\t() =>\n\t\t\treduce(\n\t\t\t\ttempActions,\n\t\t\t\t(acc, i) => {\n\t\t\t\t\tconst firstKey = Object.keys(omit(i, 'id'))[0];\n\t\t\t\t\tif (Object.keys(acc).includes(firstKey)) {\n\t\t\t\t\t\tconst accWithoutId = omit(acc, 'id');\n\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\treturn { ...accWithoutId, [firstKey]: [...accWithoutId[firstKey], ...i[firstKey]] };\n\t\t\t\t\t}\n\t\t\t\t\treturn { ...acc, ...i };\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t),\n\t\t[tempActions]\n\t);\n\n\tconst requiredFilters = useMemo(\n\t\t() => ({\n\t\t\tfilterActions: dontProcessAddFilters\n\t\t\t\t? ([{ ...omit(finalActions, 'id'), actionStop: [{}] }] as FilterActions[])\n\t\t\t\t: ([{ ...omit(finalActions, 'id') }] as FilterActions[]),\n\t\t\tactive: activeFilter,\n\t\t\tname: filterName,\n\t\t\tfilterTests: [\n\t\t\t\t{\n\t\t\t\t\t...requiredFilterTest,\n\t\t\t\t\tcondition\n\t\t\t\t}\n\t\t\t]\n\t\t}),\n\t\t[activeFilter, filterName, condition, requiredFilterTest, dontProcessAddFilters, finalActions]\n\t);\n\n\tconst [createFilterDisabled, buttonTooltip] = useMemo(() => {\n\t\tif (isEqual(copyRequiredFilters, requiredFilters)) {\n\t\t\treturn [true, t('settings.label.not_changed_anything', 'No change was made')];\n\t\t}\n\t\treturn getButtonInfo(filterName, requiredFilters, t, false);\n\t}, [copyRequiredFilters, filterName, requiredFilters, t]);\n\n\tconst incomingFiltersCopy = useMemo(() => incomingFilters?.slice(), [incomingFilters]);\n\n\tconst toggleCheckBox = useCallback(() => {\n\t\tsetDontProcessAddFilters((prev) => !prev);\n\t}, []);\n\n\tuseLayoutEffect(() => {\n\t\tsetDontProcessAddFilters(!!selectedFilter.filterActions[0]?.actionStop);\n\t}, [selectedFilter.filterActions]);\n\n\tconst filterActionProps = useMemo(\n\t\t() => ({\n\t\t\tt,\n\t\t\tactiveFilter,\n\t\t\tfilterName,\n\t\t\tisIncoming: true,\n\t\t\ttempActions,\n\t\t\tsetTempActions,\n\t\t\tzimbraFeatureMailForwardingInFiltersEnabled\n\t\t}),\n\t\t[t, activeFilter, filterName, tempActions, zimbraFeatureMailForwardingInFiltersEnabled]\n\t);\n\tconst filterTestConditionRowProps = useMemo(\n\t\t() => ({\n\t\t\tt,\n\t\t\tnewFilters,\n\t\t\tsetNewFilters,\n\t\t\tcondition,\n\t\t\tsetCondition,\n\t\t\tactiveFilter,\n\t\t\tfilterName,\n\t\t\tselectedFilter\n\t\t}),\n\t\t[\n\t\t\tt,\n\t\t\tnewFilters,\n\t\t\tsetNewFilters,\n\t\t\tcondition,\n\t\t\tsetCondition,\n\t\t\tactiveFilter,\n\t\t\tfilterName,\n\t\t\tselectedFilter\n\t\t]\n\t);\n\n\tuseEffect(() => {\n\t\tif (selectedFilter) {\n\t\t\tsetFilterName(selectedFilter?.name);\n\t\t\tsetActiveFilter(selectedFilter?.active);\n\t\t\tsetCondition(selectedFilter?.filterTests?.[0]?.condition);\n\t\t\tconst previousActions = (): Array<any> => {\n\t\t\t\tconst actions: Array<any> = [];\n\t\t\t\tforEach(selectedFilter?.filterActions?.[0], (value, key) => {\n\t\t\t\t\tif (key !== 'actionStop') {\n\t\t\t\t\t\tforEach(value, (val) => {\n\t\t\t\t\t\t\tactions.push({ [key]: [{ ...omit(val, 'index') }], id: uuidv4() });\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn actions;\n\t\t\t};\n\t\t\tsetTempActions(previousActions);\n\t\t}\n\t}, [selectedFilter]);\n\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tconst setCopyOfFilter = (): void => {\n\t\tsetCopyRequiredFilters(requiredFilters);\n\t};\n\tuseEffect(() => {\n\t\tif (selectedFilter) {\n\t\t\tif (updateRequiredFilters) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tsetUpdateRequiredFilters(false);\n\t\t\t\t\tsetCopyOfFilter();\n\t\t\t\t}, 10);\n\t\t\t}\n\t\t}\n\t}, [selectedFilter, setCopyOfFilter, updateRequiredFilters]);\n\n\tconst previousFilterTests = useMemo(() => {\n\t\tconst tempTests: Array<any> = [];\n\t\tforEach(selectedFilter?.filterTests?.[0], (value, key) => {\n\t\t\tif (key !== 'condition') {\n\t\t\t\tmap(value, (test) => {\n\t\t\t\t\ttempTests.push({ ...test, testName: key });\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn tempTests;\n\t}, [selectedFilter]);\n\n\tconst modifiedNewFilters = useMemo(\n\t\t() =>\n\t\t\tmap(previousFilterTests, (test, index) => {\n\t\t\t\tif (index === previousFilterTests.length - 1) setReFetch(true);\n\t\t\t\treturn {\n\t\t\t\t\tfilterActions: [{ actionKeep: [{}], actionStop: [{}] }],\n\t\t\t\t\tactive: false,\n\t\t\t\t\tname: '',\n\t\t\t\t\tkey: findRowKey({ name: test.testName, test }),\n\t\t\t\t\tlabel: capitalise(findRowKey({ name: test.testName, test })),\n\t\t\t\t\tfilterTests: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...{ [test.testName]: [test] },\n\t\t\t\t\t\t\tcondition: selectedFilter?.filterTests?.[0]?.condition\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tindex: 0,\n\t\t\t\t\tcomp: getTestComponent({\n\t\t\t\t\t\tname: test.testName,\n\t\t\t\t\t\ttest: { [test.testName]: [test] },\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tt\n\t\t\t\t\t})\n\t\t\t\t};\n\t\t\t}),\n\n\t\t[previousFilterTests, t, selectedFilter]\n\t);\n\n\tuseEffect(() => {\n\t\tsetNewFilters(modifiedNewFilters);\n\t\tif (reFetch) setReFetch(false);\n\t}, [modifiedNewFilters, reFetch]);\n\n\tconst onConfirm = useCallback(() => {\n\t\tconst selectedFilterIndex = findIndex(\n\t\t\tincomingFiltersCopy,\n\t\t\t(filterCopy: any) => filterCopy.name === selectedFilter?.name\n\t\t);\n\t\tconst toSend = incomingFiltersCopy.slice();\n\t\ttoSend[selectedFilterIndex] = requiredFilters;\n\t\tsetIncomingFilters(toSend);\n\n\t\tmodifyFilterRules(toSend)\n\t\t\t.then(() => {\n\t\t\t\tsetFetchIncomingFilters(true);\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `share`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\thideButton: true,\n\t\t\t\t\ttype: 'info',\n\t\t\t\t\tlabel: t('label.filter_modified', 'Filter modified succesfully'),\n\t\t\t\t\tautoHideTimeout: 5000\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `share`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\thideButton: true,\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\tlabel:\n\t\t\t\t\t\terror?.message || t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\tautoHideTimeout: 5000\n\t\t\t\t});\n\t\t\t});\n\t\tonClose();\n\t}, [\n\t\tincomingFiltersCopy,\n\t\trequiredFilters,\n\t\tsetIncomingFilters,\n\t\tonClose,\n\t\tselectedFilter?.name,\n\t\tsetFetchIncomingFilters,\n\t\tcreateSnackbar,\n\t\tt\n\t]);\n\n\treturn (\n\t\t<CreateFilterContext.Provider value={{ newFilters, setNewFilters }}>\n\t\t\t<Container\n\t\t\t\tpadding={{ bottom: 'medium' }}\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\tmaxHeight=\"100%\"\n\t\t\t\tstyle={{ overflowY: 'scroll', overflowX: 'hidden' }}\n\t\t\t>\n\t\t\t\t<ModalHeader title={modalTitle} onClose={onClose} />\n\t\t\t\t<Input\n\t\t\t\t\tlabel={inputLabel}\n\t\t\t\t\tvalue={filterName}\n\t\t\t\t\tonChange={onFilterNameChange}\n\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t/>\n\t\t\t\t<Padding top=\"small\" />\n\t\t\t\t<Checkbox value={activeFilter} onClick={toggleActiveFilter} label={activeFilterLabel} />\n\t\t\t\t<Row\n\t\t\t\t\tpadding={{ vertical: 'medium' }}\n\t\t\t\t\theight=\"fit\"\n\t\t\t\t\tmaxHeight=\"100%\"\n\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\t\tstyle={{ overflowY: 'scroll' }}\n\t\t\t\t\tdisplay=\"block\"\n\t\t\t\t\tmaxWidth=\"100%\"\n\t\t\t\t\twidth=\"100%\"\n\t\t\t\t>\n\t\t\t\t\t<FilterTestConditionRow compProps={filterTestConditionRowProps} />\n\t\t\t\t\t<Padding top=\"medium\" />\n\t\t\t\t\t<Divider />\n\t\t\t\t\t<FilterActionConditions compProps={filterActionProps} />\n\t\t\t\t</Row>\n\t\t\t\t<ModalFooter\n\t\t\t\t\tlabel={t('label.save', 'Save')}\n\t\t\t\t\ttoolTipText={buttonTooltip}\n\t\t\t\t\tonConfirm={onConfirm}\n\t\t\t\t\tdisabled={createFilterDisabled}\n\t\t\t\t\tonSecondaryAction={toggleCheckBox}\n\t\t\t\t\tchecked={dontProcessAddFilters}\n\t\t\t\t\tcheckboxLabel={t(\n\t\t\t\t\t\t'settings.do_not_process_additional_filters',\n\t\t\t\t\t\t'Do not process additional filters'\n\t\t\t\t\t)}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</CreateFilterContext.Provider>\n\t);\n};\n\nexport default ModifyFilterModal;\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { ErrorSoapBodyResponse, soapFetch } from '@zextras/carbonio-shell-ui';\n\n/**\n * Describes the portion of the SOAP request that\n * contains the list of the messages id on which\n * the filters will be run\n */\nexport type ApplyFilterRulesSoapMessagesCriteria = {\n\tids: string;\n};\n\n/**\n * Describes the portion of the SOAP request that\n * contains the query to search the messages which\n * the filters will be run\n */\nexport type ApplyFilterRulesSoapQueryCriteria = {\n\t_content: string;\n};\n\n/**\n * Describes the SOAP request for the ApplyFilterRules API\n */\nexport type ApplyFilterRulesSoapRequest = {\n\tfilterRules: Array<{ filterRule: { name: string } }>;\n\tm?: ApplyFilterRulesSoapMessagesCriteria;\n\tquery?: ApplyFilterRulesSoapQueryCriteria;\n\t_jsns: string;\n};\n\n/**\n * Describes the possible responses from the API\n */\nexport type ApplyFilterRulesSoapResponse =\n\t| {\n\t\t\tm?: Array<{\n\t\t\t\tids: string;\n\t\t\t}>;\n\t  }\n\t| ErrorSoapBodyResponse;\n\n/**\n * Describes the input params of the applyFilterRules function\n */\nexport type ApplyFilterRulesParams = {\n\truleName: string;\n\tmessagesId?: Array<string>;\n\tfoldersId?: Array<string>;\n};\n\n/**\n * Describes the output result of the applyFilterRules function\n */\nexport type ApplyFilterRulesResult = {\n\tmessagesId: Array<string>;\n};\n\n/**\n * Compose the messages id criteria portion for the SOAP request\n * @param messagesId\n */\nexport const composeMessagesIdSoapCriteria = (\n\tmessagesId: Array<string> | undefined\n): ApplyFilterRulesSoapMessagesCriteria | undefined => {\n\tif (!messagesId || !messagesId.length) {\n\t\treturn undefined;\n\t}\n\n\treturn {\n\t\tids: messagesId.join(',')\n\t};\n};\n\n/**\n * Compose the folders id criteria portion for the SOAP request\n * @param messagesId\n */\nexport const composeFoldersIdSoapCriteria = (\n\tfoldersId: Array<string> | undefined\n): ApplyFilterRulesSoapQueryCriteria | undefined => {\n\tif (!foldersId || !foldersId.length) {\n\t\treturn undefined;\n\t}\n\n\tconst inCriteriaArray = foldersId.map((folderId): string => `inid:\"${folderId}\"`);\n\n\treturn {\n\t\t_content: `(${inCriteriaArray.join(' OR ')})`\n\t};\n};\n\n/**\n * Tells if the given response contains an error\n * @param response\n */\nconst isSoapError = (response: ApplyFilterRulesSoapResponse): response is ErrorSoapBodyResponse =>\n\t'Fault' in response;\n\n/**\n * Returns, as an array, the list of messages id returned by the API\n */\nexport const extractMessagesIdFromSoapResponse = (\n\tresponse: ApplyFilterRulesSoapResponse\n): Array<string> => {\n\tif (!response || isSoapError(response) || !response.m?.[0].ids) {\n\t\treturn [];\n\t}\n\n\treturn response.m[0].ids.split(',');\n};\n\n/**\n * Invokes the ApplyFilterRules API function for the given rule.\n * The messages id list and the folders id list are mutually exclusive since the API cannot accept both of them.\n * If both are specified, only the folders id is considered\n *\n * @param ruleName\n * @param messagesId\n * @param foldersId\n */\nexport const applyFilterRules = async ({\n\truleName,\n\tmessagesId,\n\tfoldersId\n}: ApplyFilterRulesParams): Promise<ApplyFilterRulesResult> => {\n\tconst folderCriteria = composeFoldersIdSoapCriteria(foldersId);\n\tconst messagesCriteria =\n\t\tfolderCriteria === undefined ? composeMessagesIdSoapCriteria(messagesId) : undefined;\n\n\tconst soapResult = await soapFetch<ApplyFilterRulesSoapRequest, ApplyFilterRulesSoapResponse>(\n\t\t'ApplyFilterRules',\n\t\t{\n\t\t\tfilterRules: [\n\t\t\t\t{\n\t\t\t\t\tfilterRule: {\n\t\t\t\t\t\tname: ruleName\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t],\n\t\t\t...(messagesCriteria && { m: messagesCriteria }),\n\t\t\t...(folderCriteria && { query: folderCriteria }),\n\t\t\t_jsns: 'urn:zimbraMail'\n\t\t}\n\t);\n\n\tif (isSoapError(soapResult)) {\n\t\treturn Promise.reject(soapResult.Fault.Reason.Text);\n\t}\n\n\tconst ids = extractMessagesIdFromSoapResponse(soapResult);\n\treturn Promise.resolve<ApplyFilterRulesResult>({ messagesId: ids });\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { HTMLAttributes } from 'react';\n\nimport styled, { SimpleInterpolation } from 'styled-components';\n\n// TODO add supports for \titalic, strikethrough and underlined\nexport type TextStylerProps = HTMLAttributes<HTMLSpanElement> & {\n\tbold?: boolean;\n};\n\nconst StyledSpan = styled.span<TextStylerProps>`\n\tdisplay: inline-block;\n\tfont-weight: ${(props): SimpleInterpolation => props.bold && 'bold'};\n`;\n\nexport const TextStyler = React.forwardRef<HTMLSpanElement, TextStylerProps>(function TextStylerFn(\n\t{ children, ...rest },\n\tref\n) {\n\treturn (\n\t\t<StyledSpan ref={ref} {...rest}>\n\t\t\t{children}\n\t\t</StyledSpan>\n\t);\n});\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React from 'react';\n\nimport { CreateModalFn, ModalManager } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\n\nimport { SelectFolderModal } from './modals/select-folder-modal';\nimport { Folder } from '../carbonio-ui-commons/types/folder';\nimport { GenericActionDescriptors } from '../constants';\nimport { UIAction, UIActionExecutionParams } from '../types';\n\nexport type SelectFoldersUIActionExecutionConfig = {\n\tshowSharedAccounts: boolean;\n\tshowThrashFolder: boolean;\n\tshowSpamFolder: boolean;\n\tallowRootSelection: boolean;\n\tallowFolderCreation: boolean;\n\ttitle: string;\n\thintText: string;\n\tconfirmActionLabel: string;\n\tconfirmActionTooltip: string;\n\tdisabledConfirmActionTooltip: string;\n\tselectedFolder?: Folder;\n};\n\nexport interface SelectFoldersUIActionExecutionParams extends UIActionExecutionParams<Folder> {\n\tconfig: Partial<SelectFoldersUIActionExecutionConfig>;\n\tuiUtilities: {\n\t\tcreateModal: CreateModalFn;\n\t};\n\tcallbacks: {\n\t\tonComplete: (folder: Folder) => void;\n\t\tonCancel?: () => void;\n\t};\n}\n\nconst defaultExecutionConfig: SelectFoldersUIActionExecutionConfig = {\n\tshowSharedAccounts: true,\n\tshowThrashFolder: false,\n\tshowSpamFolder: false,\n\tallowRootSelection: true,\n\tallowFolderCreation: false,\n\ttitle: t('label.select_folder', 'Select folder'),\n\thintText: '',\n\tconfirmActionLabel: t('label.select_folder', 'Select folder'),\n\tconfirmActionTooltip: '',\n\tdisabledConfirmActionTooltip: t('label.no_folder_selected', 'No folder is selected')\n};\n\nexport const mergeDefaultExecutionConfig = (\n\tconfig: Partial<SelectFoldersUIActionExecutionConfig>\n): SelectFoldersUIActionExecutionConfig => ({\n\t...defaultExecutionConfig,\n\t...config\n});\n\nexport const getSelectFoldersUIAction = (): UIAction<SelectFoldersUIActionExecutionParams> => {\n\tconst descriptor = GenericActionDescriptors.SELECT_FOLDERS;\n\treturn {\n\t\tid: descriptor.id,\n\t\ticon: 'FolderOutline',\n\t\tlabel: t('action.select_folders', 'Select folders'),\n\t\topenModal: (params): void => {\n\t\t\tconst { uiUtilities, callbacks } = params;\n\t\t\tconst config = mergeDefaultExecutionConfig(params.config);\n\t\t\tconst closeModal = uiUtilities.createModal(\n\t\t\t\t{\n\t\t\t\t\tsize: 'medium',\n\t\t\t\t\tchildren: (\n\t\t\t\t\t\t<ModalManager>\n\t\t\t\t\t\t\t<SelectFolderModal\n\t\t\t\t\t\t\t\tfolder={config.selectedFolder}\n\t\t\t\t\t\t\t\tonClose={(): void => {\n\t\t\t\t\t\t\t\t\tcloseModal();\n\t\t\t\t\t\t\t\t\tcallbacks.onCancel && callbacks.onCancel();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\theaderTitle={config.title}\n\t\t\t\t\t\t\t\tinputLabel={config.hintText}\n\t\t\t\t\t\t\t\tactionLabel={config.confirmActionLabel}\n\t\t\t\t\t\t\t\tconfirmAction={(folder): void => {\n\t\t\t\t\t\t\t\t\tif (!folder) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcloseModal();\n\t\t\t\t\t\t\t\t\tcallbacks.onComplete && callbacks.onComplete(folder);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tactionTooltip={config.confirmActionTooltip}\n\t\t\t\t\t\t\t\tdisabledActionTooltip={config.disabledConfirmActionTooltip}\n\t\t\t\t\t\t\t\tallowRootSelection={config.allowRootSelection}\n\t\t\t\t\t\t\t\tallowFolderCreation={config.allowFolderCreation}\n\t\t\t\t\t\t\t\tshowSharedAccounts={config.showSharedAccounts}\n\t\t\t\t\t\t\t\tshowTrashFolder={config.showThrashFolder}\n\t\t\t\t\t\t\t\tshowSpamFolder={config.showSpamFolder}\n\t\t\t\t\t\t\t></SelectFolderModal>\n\t\t\t\t\t\t</ModalManager>\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t};\n};\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, useCallback, useMemo, useState } from 'react';\n\nimport {\n\tChipInput,\n\tChipItem,\n\tCloseModalFn,\n\tDivider,\n\tModalFooter,\n\tModalHeader,\n\tText,\n\tuseModal,\n\tuseSnackbar\n} from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\nimport { Trans } from 'react-i18next';\n\nimport { applyFilterRules } from '../../api/apply-filter-rules';\nimport { Folder } from '../../carbonio-ui-commons/types/folder';\nimport { GapContainer } from '../../commons/gap-container';\nimport { TextStyler } from '../../commons/text-styler';\nimport { TIMEOUTS } from '../../constants';\nimport { getFolderIconColor } from '../../views/sidebar/utils';\nimport type { ApplyFilterUIActionExecutionParams } from '../apply-filter';\nimport { getSelectFoldersUIAction } from '../select-folders';\n\nexport type ApplyFilterModalProps = {\n\tcriteria: ApplyFilterUIActionExecutionParams['criteria'];\n\tcloseModal: CloseModalFn;\n};\n\nexport const ApplyFilterModal: FC<ApplyFilterModalProps> = ({ criteria, closeModal }) => {\n\tconst createModal = useModal();\n\tconst createSnackbar = useSnackbar();\n\tconst [folder, setFolder] = useState<Folder>();\n\n\tconst involvedMessagesCount = folder?.n ?? 0;\n\tconst confirmEnabled = useMemo<boolean>(() => !!folder, [folder]);\n\n\tconst title = t('modals.apply_filters.title', {\n\t\tfilterName: criteria.filterName,\n\t\tdefaultValue: 'Application filter {{filterName}}'\n\t});\n\n\tconst confirmActionLabel = t('modals.apply_filters.button_apply', 'Apply');\n\tconst secondaryActionLabel = t('label.cancel', 'Cancel');\n\tconst onConfirmAction = useCallback((): void => {\n\t\tif (!folder) {\n\t\t\treturn;\n\t\t}\n\t\tapplyFilterRules({\n\t\t\truleName: criteria.filterName,\n\t\t\tfoldersId: [folder?.id]\n\t\t})\n\t\t\t.then((serviceResult) => {\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `applyFilter-${criteria.filterName}-completed`,\n\t\t\t\t\ttype: 'success',\n\t\t\t\t\tlabel: t('messages.snackbar.apply_filter_rules_completed', {\n\t\t\t\t\t\tfilterName: criteria.filterName,\n\t\t\t\t\t\tinvolvedMessagesCount: serviceResult.messagesId.length,\n\t\t\t\t\t\tfolderPath: folder.absFolderPath,\n\t\t\t\t\t\tdefaultValue:\n\t\t\t\t\t\t\t\"Filter '{{filterName}}'successfully applied to {{involvedMessagesCount}} messages of the folder '{{folderPath}}'\"\n\t\t\t\t\t}),\n\t\t\t\t\treplace: true,\n\t\t\t\t\tautoHideTimeout: TIMEOUTS.SNACKBAR_DEFAULT_TIMEOUT,\n\t\t\t\t\thideButton: true\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `applyFilter-${criteria.filterName}-error`,\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\tlabel: t('messages.snackbar.apply_filter_rules_error', {\n\t\t\t\t\t\tfilterName: criteria.filterName,\n\t\t\t\t\t\tdefaultValue: \"An error occurred while applying the filter '{{filterName}}'\"\n\t\t\t\t\t}),\n\t\t\t\t\treplace: true,\n\t\t\t\t\tautoHideTimeout: TIMEOUTS.SNACKBAR_DEFAULT_TIMEOUT,\n\t\t\t\t\thideButton: true\n\t\t\t\t});\n\t\t\t});\n\n\t\tcreateSnackbar({\n\t\t\tkey: `applyFilter-${criteria.filterName}-started`,\n\t\t\ttype: 'info',\n\t\t\tlabel: t('messages.snackbar.apply_filter_rules_started', {\n\t\t\t\tfilterName: criteria.filterName,\n\t\t\t\tfolderPath: folder.absFolderPath,\n\t\t\t\tdefaultValue:\n\t\t\t\t\t\"Filter '{{filterName}}' is being applied to the messages of the folder '{{folderPath}}'\"\n\t\t\t}),\n\t\t\treplace: true,\n\t\t\tautoHideTimeout: TIMEOUTS.SNACKBAR_DEFAULT_TIMEOUT,\n\t\t\thideButton: true\n\t\t});\n\t\tcloseModal();\n\t}, [closeModal, createSnackbar, criteria.filterName, folder]);\n\n\tconst onCancelAction = useCallback(() => closeModal(), [closeModal]);\n\n\tconst onAddFolder = (): void => {\n\t\tconst action = getSelectFoldersUIAction();\n\t\taction?.openModal?.({\n\t\t\tconfig: {\n\t\t\t\tallowRootSelection: false,\n\t\t\t\tshowSharedAccounts: false,\n\t\t\t\tallowFolderCreation: false,\n\t\t\t\tshowThrashFolder: true,\n\t\t\t\tshowSpamFolder: true\n\t\t\t},\n\t\t\tuiUtilities: {\n\t\t\t\tcreateModal\n\t\t\t},\n\t\t\tcallbacks: {\n\t\t\t\tonComplete: setFolder\n\t\t\t}\n\t\t});\n\t};\n\n\tconst folderChips = useMemo<Array<ChipItem>>(\n\t\t() =>\n\t\t\tfolder\n\t\t\t\t? [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: folder.absFolderPath,\n\t\t\t\t\t\t\thasAvatar: true,\n\t\t\t\t\t\t\tmaxWidth: '12.5rem',\n\t\t\t\t\t\t\tbackground: 'gray2',\n\t\t\t\t\t\t\tavatarBackground: getFolderIconColor(folder),\n\t\t\t\t\t\t\tavatarIcon: 'FolderOutline',\n\t\t\t\t\t\t\tvalue: folder.id\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t: [],\n\t\t[folder]\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<ModalHeader onClose={onCancelAction} title={title} showCloseIcon></ModalHeader>\n\t\t\t<Divider />\n\t\t\t<GapContainer\n\t\t\t\tgap={'medium'}\n\t\t\t\tmainAlignment={'flex-start'}\n\t\t\t\tcrossAlignment={'flex-start'}\n\t\t\t\tminHeight={'13.63rem'}\n\t\t\t\tpadding={{ top: 'small' }}\n\t\t\t>\n\t\t\t\t<Text>{t('settings.filter_folder_message', 'Select a folder to apply your filter:')}</Text>\n\t\t\t\t<ChipInput\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\ticon=\"FolderOutline\"\n\t\t\t\t\tplaceholder={t('label.select_folder', 'Is contained in')}\n\t\t\t\t\tvalue={folderChips}\n\t\t\t\t\tmaxChips={1}\n\t\t\t\t\tdisabled\n\t\t\t\t\ticonAction={(ev): void => onAddFolder()}\n\t\t\t\t\tonChange={(chips): void => {\n\t\t\t\t\t\t// TODO something better to handle the chip deletion, please...\n\t\t\t\t\t\tif (chips.length === 0) {\n\t\t\t\t\t\t\tsetFolder(undefined);\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\trequireUniqueChips\n\t\t\t\t/>\n\n\t\t\t\t{folder && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Text>\n\t\t\t\t\t\t\t<Trans\n\t\t\t\t\t\t\t\tt={t}\n\t\t\t\t\t\t\t\ti18nKey=\"modals.apply_filters.label_involved_messages\"\n\t\t\t\t\t\t\t\tinvolvedMessagesCount={involvedMessagesCount}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<TextStyler bold>{{ involvedMessagesCount }} messages</TextStyler> will be processed\n\t\t\t\t\t\t\t\tinside the selected folder.\n\t\t\t\t\t\t\t</Trans>\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t<Text>\n\t\t\t\t\t\t\t<Trans t={t} i18nKey=\"modals.apply_filters.label_confirm_request\">\n\t\t\t\t\t\t\t\tDo you want to apply the filter?\n\t\t\t\t\t\t\t</Trans>\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</GapContainer>\n\t\t\t<Divider />\n\t\t\t<ModalFooter\n\t\t\t\tconfirmLabel={confirmActionLabel}\n\t\t\t\tconfirmDisabled={!confirmEnabled}\n\t\t\t\tonConfirm={onConfirmAction}\n\t\t\t\tonSecondaryAction={onCancelAction}\n\t\t\t\tsecondaryActionLabel={secondaryActionLabel}\n\t\t\t\tonClose={onCancelAction}\n\t\t\t></ModalFooter>\n\t\t</>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useCallback, useContext, useMemo } from 'react';\n\nimport { Button, Padding, useModal } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport { find } from 'lodash';\n\nimport { useRemoveFilter, useAddFilter } from './actions';\nimport CreateFilterModal from './create-filter-modal';\nimport DeleteFilterModal from './delete-filter-modal';\nimport { FilterContext } from './filter-context';\nimport ModifyFilterModal from './modify-filter/modify-filter-modal';\nimport { modifyFilterRules } from '../../../../store/actions/modify-filter-rules';\nimport { StoreProvider } from '../../../../store/redux';\nimport {\n\tApplyFilterUIActionExecutionParams,\n\tgetApplyFilterUIAction\n} from '../../../../ui-actions/apply-filter';\n\ntype FilterListType = {\n\tactive: boolean;\n\tfilterActions: Array<any>;\n\tfilterTests: Array<any>;\n\tid?: string;\n\tname: string;\n};\n\ntype ListType = {\n\tisSelecting: boolean;\n\tlist: Array<FilterListType>;\n\tmoveDown: (arg: number) => void;\n\tmoveUp: (arg: number) => void;\n\tselected: Record<string, boolean>;\n\ttoggle: (arg: string) => void;\n\tunSelect: () => void;\n};\n\ntype ComponentProps = {\n\tcompProps: {\n\t\tt: TFunction;\n\t\tavailableList: ListType;\n\t\tactiveList: ListType;\n\t\tincomingFilters: ListType;\n\t};\n};\n\nconst IncomingFilterActions: FC<ComponentProps> = ({ compProps }): ReactElement => {\n\tconst { t, availableList, activeList, incomingFilters } = compProps;\n\tconst { setFetchIncomingFilters, setIncomingFilters } = useContext(FilterContext);\n\tconst createModal = useModal();\n\n\tconst isAvailableFilterSelected = useMemo(\n\t\t() => Object.keys(availableList.selected).length > 0,\n\t\t[availableList.selected]\n\t);\n\n\tconst isActiveFilterSelected = useMemo(\n\t\t() => Object.keys(activeList.selected).length > 0,\n\t\t[activeList.selected]\n\t);\n\n\tconst disableAdd = !isAvailableFilterSelected;\n\tconst disableRemove = !isActiveFilterSelected;\n\tconst disableEdit = !isAvailableFilterSelected && !isActiveFilterSelected;\n\tconst disableDelete = !isAvailableFilterSelected && !isActiveFilterSelected;\n\tconst disableApply = !isActiveFilterSelected;\n\n\tconst selectedActiveFilterName = useMemo(\n\t\t() => Object.keys(activeList.selected)[0],\n\t\t[activeList.selected]\n\t);\n\n\tconst selectedAvailableFilterName = useMemo(\n\t\t() => Object.keys(availableList.selected)[0],\n\t\t[availableList.selected]\n\t);\n\n\tconst selectedFilterName = selectedActiveFilterName || selectedAvailableFilterName;\n\n\tconst selectedFilter = useMemo(\n\t\t() =>\n\t\t\tfind(availableList.list, { name: Object.keys(availableList.selected)[0] }) ||\n\t\t\tfind(activeList.list, { name: Object.keys(activeList.selected)[0] }),\n\t\t[availableList, activeList]\n\t);\n\n\tconst applySelectedFilter = useCallback((): void => {\n\t\tif (!selectedActiveFilterName) {\n\t\t\treturn;\n\t\t}\n\t\tconst action = getApplyFilterUIAction();\n\t\tconst executionParams: ApplyFilterUIActionExecutionParams = {\n\t\t\tuiUtilities: {\n\t\t\t\tcreateModal\n\t\t\t},\n\t\t\tcriteria: {\n\t\t\t\tfilterName: selectedActiveFilterName\n\t\t\t}\n\t\t};\n\t\taction?.openModal?.(executionParams);\n\t}, [createModal, selectedActiveFilterName]);\n\n\tconst openCreateModal = useCallback(() => {\n\t\tconst closeModal = createModal(\n\t\t\t{\n\t\t\t\tsize: 'large',\n\t\t\t\tmaxHeight: '80vh',\n\t\t\t\tchildren: (\n\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t<CreateFilterModal\n\t\t\t\t\t\t\tt={t}\n\t\t\t\t\t\t\tonClose={(): void => closeModal()}\n\t\t\t\t\t\t\tincomingFilters={incomingFilters}\n\t\t\t\t\t\t\tsetFetchIncomingFilters={setFetchIncomingFilters}\n\t\t\t\t\t\t\tsetIncomingFilters={setIncomingFilters}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</StoreProvider>\n\t\t\t\t)\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}, [createModal, t, incomingFilters, setIncomingFilters, setFetchIncomingFilters]);\n\n\tconst openDeleteModal = useCallback(() => {\n\t\tconst closeModal = createModal(\n\t\t\t{\n\t\t\t\tsize: 'small',\n\t\t\t\tchildren: (\n\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t<DeleteFilterModal\n\t\t\t\t\t\t\tonClose={(): void => closeModal()}\n\t\t\t\t\t\t\tt={t}\n\t\t\t\t\t\t\tavailableList={availableList}\n\t\t\t\t\t\t\tactiveList={activeList}\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tsetFilters={setIncomingFilters}\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tsetFetchFilters={setFetchIncomingFilters}\n\t\t\t\t\t\t\tmodifierFunc={modifyFilterRules}\n\t\t\t\t\t\t\tfilterName={selectedFilterName}\n\t\t\t\t\t\t\tselectedFilter={selectedFilter}\n\t\t\t\t\t\t\tincomingFilters={incomingFilters}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</StoreProvider>\n\t\t\t\t)\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}, [\n\t\tactiveList,\n\t\tavailableList,\n\t\tcreateModal,\n\t\tincomingFilters,\n\t\tselectedFilter,\n\t\tselectedFilterName,\n\t\tsetFetchIncomingFilters,\n\t\tsetIncomingFilters,\n\t\tt\n\t]);\n\n\tconst removeFilter = useRemoveFilter();\n\tconst onRemove = useCallback(\n\t\t() =>\n\t\t\tremoveFilter({\n\t\t\t\tt,\n\t\t\t\tavailableList,\n\t\t\t\tactiveList,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tsetFilters: setIncomingFilters,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tsetFetchFilters: setFetchIncomingFilters,\n\t\t\t\tmodifierFunc: modifyFilterRules\n\t\t\t}),\n\t\t[removeFilter, t, availableList, activeList, setIncomingFilters, setFetchIncomingFilters]\n\t);\n\n\tconst addFilter = useAddFilter();\n\tconst onAdd = useCallback(\n\t\t() =>\n\t\t\taddFilter({\n\t\t\t\tt,\n\t\t\t\tavailableList,\n\t\t\t\tactiveList,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tsetFilters: setIncomingFilters,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tsetFetchFilters: setFetchIncomingFilters,\n\t\t\t\tmodifierFunc: modifyFilterRules\n\t\t\t}),\n\t\t[addFilter, t, availableList, activeList, setIncomingFilters, setFetchIncomingFilters]\n\t);\n\n\tconst openFilterModifyModal = useCallback(() => {\n\t\tconst closeModal = createModal(\n\t\t\t{\n\t\t\t\tsize: 'large',\n\t\t\t\tmaxHeight: '80vh',\n\t\t\t\tchildren: (\n\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t<ModifyFilterModal\n\t\t\t\t\t\t\tt={t}\n\t\t\t\t\t\t\tselectedFilter={selectedFilter}\n\t\t\t\t\t\t\tonClose={(): void => closeModal()}\n\t\t\t\t\t\t\tincomingFilters={incomingFilters}\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tsetFetchIncomingFilters={setFetchIncomingFilters}\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tsetIncomingFilters={setIncomingFilters}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</StoreProvider>\n\t\t\t\t)\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}, [\n\t\tcreateModal,\n\t\tt,\n\t\tincomingFilters,\n\t\tsetIncomingFilters,\n\t\tsetFetchIncomingFilters,\n\t\tselectedFilter\n\t]);\n\n\treturn (\n\t\t<>\n\t\t\t<Padding top=\"medium\" />\n\t\t\t<Button\n\t\t\t\tlabel={t('label.add', 'Add')}\n\t\t\t\ttype=\"outlined\"\n\t\t\t\ticon=\"ArrowheadLeftOutline\"\n\t\t\t\ticonPlacement=\"left\"\n\t\t\t\tdisabled={disableAdd}\n\t\t\t\tonClick={onAdd}\n\t\t\t\twidth=\"fill\"\n\t\t\t/>\n\t\t\t<Padding bottom=\"medium\" />\n\t\t\t<Button\n\t\t\t\tlabel={t('label.remove_one', 'Remove')}\n\t\t\t\ttype=\"outlined\"\n\t\t\t\tcolor=\"error\"\n\t\t\t\ticon=\"ArrowheadRightOutline\"\n\t\t\t\tdisabled={disableRemove}\n\t\t\t\tonClick={onRemove}\n\t\t\t\twidth=\"fill\"\n\t\t\t/>\n\t\t\t<Padding bottom=\"medium\" />\n\t\t\t<Button\n\t\t\t\tlabel={t('label.edit', 'Edit')}\n\t\t\t\ttype=\"outlined\"\n\t\t\t\tdisabled={disableEdit}\n\t\t\t\twidth=\"fill\"\n\t\t\t\tonClick={openFilterModifyModal}\n\t\t\t/>\n\t\t\t<Padding bottom=\"medium\" />\n\t\t\t<Button\n\t\t\t\tlabel={t('filters.apply', 'Apply')}\n\t\t\t\ttype=\"outlined\"\n\t\t\t\tdisabled={disableApply}\n\t\t\t\twidth=\"fill\"\n\t\t\t\tonClick={applySelectedFilter}\n\t\t\t/>\n\t\t\t<Padding bottom=\"medium\" />\n\t\t\t<Button\n\t\t\t\tlabel={t('label.delete', 'Delete')}\n\t\t\t\ttype=\"outlined\"\n\t\t\t\tcolor=\"error\"\n\t\t\t\tonClick={openDeleteModal}\n\t\t\t\tdisabled={disableDelete}\n\t\t\t\twidth=\"fill\"\n\t\t\t/>\n\t\t\t<Padding bottom=\"medium\" />\n\t\t\t<Button\n\t\t\t\tlabel={t('label.create', 'Create')}\n\t\t\t\ttype=\"outlined\"\n\t\t\t\twidth=\"fill\"\n\t\t\t\tonClick={openCreateModal}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default IncomingFilterActions;\n","/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React from 'react';\n\nimport { CreateModalFn, ModalManager } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\n\nimport { ApplyFilterModal } from './modals/apply-filter-modal';\nimport { FilterActionsDescriptors } from '../constants';\nimport { UIAction } from '../types';\n\nexport type ApplyFilterUIActionExecutionParams = {\n\tcriteria: {\n\t\tfilterName: string;\n\t};\n\tuiUtilities: {\n\t\tcreateModal: CreateModalFn;\n\t};\n};\n\nexport const getApplyFilterUIAction = (): UIAction<ApplyFilterUIActionExecutionParams> => ({\n\tid: FilterActionsDescriptors.APPLY.id,\n\ticon: 'QuestionMarkOutline',\n\tlabel: t('action.apply_filter_on_folder', 'Apply filter on folder'),\n\topenModal: ({ criteria, uiUtilities }: ApplyFilterUIActionExecutionParams): void => {\n\t\tconst closeModal = uiUtilities.createModal(\n\t\t\t{\n\t\t\t\tsize: 'medium',\n\t\t\t\tchildren: (\n\t\t\t\t\t<ModalManager>\n\t\t\t\t\t\t<ApplyFilterModal\n\t\t\t\t\t\t\tcriteria={criteria}\n\t\t\t\t\t\t\tcloseModal={(): void => closeModal()}\n\t\t\t\t\t\t></ApplyFilterModal>\n\t\t\t\t\t</ModalManager>\n\t\t\t\t)\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n});\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement } from 'react';\nimport { Container, Shimmer } from '@zextras/carbonio-design-system';\n\nconst LoadingShimmer: FC = (): ReactElement => (\n\t<Container\n\t\torientation=\"horizontal\"\n\t\tmainAlignment=\"flex-start\"\n\t\twidth=\"fill\"\n\t\tcrossAlignment=\"flex-start\"\n\t>\n\t\t<Shimmer.FormSection>\n\t\t\t<Shimmer.FormSubSection />\n\t\t</Shimmer.FormSection>\n\t</Container>\n);\n\nexport default LoadingShimmer;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { useCallback, useEffect, useState } from 'react';\nimport { cloneDeep, concat, isEmpty, map, omit } from 'lodash';\n\nexport const useFilterSelection = (firstList, setFetchFilters, modifyFunc, secondList) => {\n\tconst [selected, setSelected] = useState({});\n\tconst [isSelecting, setIsSelecting] = useState(false);\n\tconst [list, setList] = useState(firstList);\n\n\tuseEffect(() => {\n\t\tsetIsSelecting(!isEmpty(selected));\n\t}, [selected]);\n\n\tuseEffect(() => {\n\t\tsetList(firstList);\n\t}, [firstList]);\n\n\tconst unSelect = useCallback(() => {\n\t\tsetSelected({});\n\t}, []);\n\n\tconst selectItem = useCallback((id) => {\n\t\tsetSelected({ [id]: true });\n\t}, []);\n\n\tconst moveDown = useCallback(\n\t\t(index) => {\n\t\t\tconst tmp = list.slice();\n\t\t\tif (index === tmp.length - 1) return;\n\t\t\tconst index2 = index + 1;\n\t\t\tconst itemBelow = cloneDeep(tmp[index2]);\n\t\t\ttmp[index + 1] = cloneDeep(tmp[index]);\n\t\t\ttmp[index] = itemBelow;\n\t\t\tsetList(tmp);\n\t\t\tsetSelected(tmp[index + 1].id);\n\t\t\tconst toSend = concat(\n\t\t\t\tmap(tmp, (t) => omit(t, 'id')),\n\t\t\t\tsecondList\n\t\t\t);\n\t\t\tmodifyFunc(toSend).then(() => {\n\t\t\t\tsetFetchFilters(true);\n\t\t\t});\n\t\t},\n\t\t[list, secondList, modifyFunc, setFetchFilters]\n\t);\n\tconst moveUp = useCallback(\n\t\t(index) => {\n\t\t\tconst tmp = list.slice();\n\t\t\tconst index2 = index - 1;\n\t\t\tconst itemAbove = cloneDeep(tmp[index2]);\n\t\t\ttmp[index - 1] = cloneDeep(tmp[index]);\n\t\t\ttmp[index] = itemAbove;\n\t\t\tsetList(tmp);\n\t\t\tsetSelected(tmp[index - 1].id);\n\n\t\t\tconst toSend = concat(\n\t\t\t\tmap(tmp, (t) => omit(t, 'id')),\n\t\t\t\tsecondList\n\t\t\t);\n\n\t\t\tmodifyFunc(toSend).then(() => {\n\t\t\t\tsetFetchFilters(true);\n\t\t\t});\n\t\t},\n\t\t[list, secondList, modifyFunc, setFetchFilters]\n\t);\n\n\treturn { selected, isSelecting, toggle: selectItem, unSelect, moveDown, moveUp, list };\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useContext, useMemo } from 'react';\n\nimport { List, Container } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport { filter, map } from 'lodash';\n\nimport { FilterContext } from './filter-context';\nimport FilterItem from './filter-item';\nimport IncomingFilterActions from './incoming-filters-actions';\nimport LoadingShimmer from './loading-shimmer';\nimport { useFilterSelection } from './use-filter-selection';\nimport { modifyFilterRules } from '../../../../store/actions/modify-filter-rules';\nimport Heading from '../../components/settings-heading';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tselectedFilterType: string;\n};\n\nconst IncomingMsgFilterTab: FC<ComponentProps> = ({ t, selectedFilterType }): ReactElement => {\n\tconst { incomingFilters, incomingLoading, setFetchIncomingFilters } = useContext(FilterContext);\n\n\tconst incomingFiltersCopy = useMemo(() => incomingFilters?.slice(), [incomingFilters]);\n\tconst [active, available] = useMemo(\n\t\t() => [\n\t\t\tmap(filter(incomingFiltersCopy, { active: true }), (f) => ({ ...f, id: f.name })),\n\t\t\tmap(filter(incomingFiltersCopy, { active: false }), (f) => ({ ...f, id: f.name }))\n\t\t],\n\t\t[incomingFiltersCopy]\n\t);\n\n\tconst activeList = useFilterSelection(\n\t\tactive,\n\t\tsetFetchIncomingFilters,\n\t\tmodifyFilterRules,\n\t\tavailable\n\t);\n\n\tconst availableList = useFilterSelection(\n\t\tavailable,\n\t\tsetFetchIncomingFilters,\n\t\tmodifyFilterRules,\n\t\tactive\n\t);\n\n\tconst actionButtonsProps = useMemo(\n\t\t() => ({\n\t\t\tt,\n\t\t\tavailableList,\n\t\t\tactiveList,\n\t\t\tselectedFilterType,\n\t\t\tincomingFilters: incomingFiltersCopy,\n\t\t\tsetFetchIncomingFilters\n\t\t}),\n\t\t[t, availableList, activeList, selectedFilterType, incomingFiltersCopy, setFetchIncomingFilters]\n\t);\n\n\treturn (\n\t\t<Container crossAlignment=\"flex-start\" mainAlignment=\"flex-start\" orientation=\"horizontal\">\n\t\t\t<Container width=\"43%\" minHeight=\"30vh\" mainAlignment=\"flex-start\">\n\t\t\t\t<Heading title={t('filters.active_filters', 'Active Filters')} size=\"small\" />\n\t\t\t\t<Container>\n\t\t\t\t\t{incomingLoading ? (\n\t\t\t\t\t\t<LoadingShimmer />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<List\n\t\t\t\t\t\t\titems={activeList.list}\n\t\t\t\t\t\t\tselected={activeList.selected}\n\t\t\t\t\t\t\tItemComponent={FilterItem}\n\t\t\t\t\t\t\titemProps={{\n\t\t\t\t\t\t\t\tlistProps: activeList,\n\t\t\t\t\t\t\t\tunSelect: availableList.unSelect\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</Container>\n\t\t\t</Container>\n\t\t\t<Container width=\"14%\" padding={{ all: 'large' }} mainAlignment=\"space-between\">\n\t\t\t\t<IncomingFilterActions compProps={actionButtonsProps} />\n\t\t\t</Container>\n\t\t\t<Container width=\"43%\" mainAlignment=\"flex-start\">\n\t\t\t\t<Heading title={t('filters.available_filters', 'Available Filters')} size=\"small\" />\n\n\t\t\t\t<Container>\n\t\t\t\t\t{incomingLoading ? (\n\t\t\t\t\t\t<LoadingShimmer />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<List\n\t\t\t\t\t\t\titems={availableList.list}\n\t\t\t\t\t\t\tselected={availableList.selected}\n\t\t\t\t\t\t\tItemComponent={FilterItem}\n\t\t\t\t\t\t\titemProps={{\n\t\t\t\t\t\t\t\tlistProps: availableList,\n\t\t\t\t\t\t\t\tunSelect: activeList.unSelect\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</Container>\n\t\t\t</Container>\n\t\t</Container>\n\t);\n};\n\nexport default IncomingMsgFilterTab;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useCallback, useMemo, useState } from 'react';\n\nimport { Checkbox, Container, Divider, Input, Padding, Row } from '@zextras/carbonio-design-system';\nimport { useUserSettings } from '@zextras/carbonio-shell-ui';\nimport { TFunction } from 'i18next';\nimport { map, omit, reduce } from 'lodash';\n\nimport { CreateFilterContext } from './create-filter-context';\nimport ModalFooter from './create-filter-modal-footer';\nimport DefaultCondition from './create-filters-conditions/default';\nimport FilterTestConditionRow from './filter-test-condition-row';\nimport FilterActionConditions from './new-filter-action-conditions';\nimport { getButtonInfo } from './utils';\nimport ModalHeader from '../../../../carbonio-ui-commons/components/modals/modal-header';\nimport { useUiUtilities } from '../../../../hooks/use-ui-utilities';\nimport { modifyOutgoingFilterRules } from '../../../../store/actions/modify-filter-rules';\nimport type { FilterActions } from '../../../../types';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tonClose: () => void;\n\toutgoingFilters?: any;\n\tsetFetchOutgoingFilters: (arg: boolean) => void;\n\tsetOutgoingFilters: (arg: any) => void;\n};\n\nconst CreateOutgoingFilterModal: FC<ComponentProps> = ({\n\tt,\n\tonClose,\n\toutgoingFilters,\n\tsetFetchOutgoingFilters,\n\tsetOutgoingFilters\n}): ReactElement => {\n\tconst { createSnackbar } = useUiUtilities();\n\tconst [filterName, setFilterName] = useState('');\n\tconst [activeFilter, setActiveFilter] = useState(false);\n\tconst [condition, setCondition] = useState('anyof');\n\tconst [dontProcessAddFilters, setDontProcessAddFilters] = useState(true);\n\tconst [tempActions, setTempActions] = useState([{ actionKeep: [{}] }]);\n\tconst { zimbraFeatureMailForwardingInFiltersEnabled } = useUserSettings().attrs;\n\n\tconst finalActions = useMemo(\n\t\t() =>\n\t\t\treduce(\n\t\t\t\ttempActions,\n\t\t\t\t(a, i) => {\n\t\t\t\t\tconst firstKey = Object.keys(omit(i, 'id'))[0];\n\t\t\t\t\tif (Object.keys(a).includes(firstKey)) {\n\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\treturn { ...a, [firstKey]: [...a[firstKey], ...i[firstKey]] };\n\t\t\t\t\t}\n\t\t\t\t\treturn { ...a, ...i };\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t),\n\t\t[tempActions]\n\t);\n\tconst [newFilters, setNewFilters] = useState([\n\t\t{\n\t\t\tfilterActions: [{ actionKeep: [{}], actionStop: [{}] }],\n\t\t\tactive: activeFilter,\n\t\t\tname: filterName,\n\t\t\tkey: 'subject',\n\t\t\tlabel: 'Subject',\n\t\t\tfilterTests: [{}],\n\t\t\tindex: 0,\n\t\t\tcomp: <DefaultCondition t={t} activeIndex={0} />\n\t\t}\n\t]);\n\n\tconst toggleActiveFilter = useCallback(() => setActiveFilter(!activeFilter), [activeFilter]);\n\tconst onFilterNameChange = useCallback((ev) => setFilterName(ev.target.value), []);\n\tconst modalTitle = useMemo(() => t('settings.create_new_filter', 'Create new Filter'), [t]);\n\tconst inputLabel = useMemo(() => `${t('settings.filter_name', 'Filter Name')}*`, [t]);\n\tconst activeFilterLabel = useMemo(() => t('settings.active_filter', 'Active filter'), [t]);\n\n\tconst requiredFilterTest = useMemo(() => {\n\t\tconst allTest = map(newFilters, (f) => f.filterTests[0]);\n\n\t\treturn reduce(\n\t\t\tallTest,\n\t\t\t(a, i) => {\n\t\t\t\tconst firstKey = Object.keys(omit(i, ['condition']))[0];\n\t\t\t\tif (Object.keys(a).includes(firstKey)) {\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\treturn { ...a, [firstKey]: [...a[firstKey], ...i[firstKey]] };\n\t\t\t\t}\n\t\t\t\treturn { ...a, ...i };\n\t\t\t},\n\t\t\t{}\n\t\t);\n\t}, [newFilters]);\n\n\tconst requiredFilters = useMemo(\n\t\t() => ({\n\t\t\tfilterActions: dontProcessAddFilters\n\t\t\t\t? ([{ ...finalActions, actionStop: [{}] }] as FilterActions[])\n\t\t\t\t: ([{ ...finalActions }] as FilterActions[]),\n\t\t\tactive: activeFilter,\n\t\t\tname: filterName,\n\t\t\tfilterTests: [\n\t\t\t\t{\n\t\t\t\t\t...requiredFilterTest,\n\t\t\t\t\tcondition\n\t\t\t\t}\n\t\t\t]\n\t\t}),\n\t\t[activeFilter, filterName, condition, requiredFilterTest, finalActions, dontProcessAddFilters]\n\t);\n\n\tconst [createFilterDisabled, buttonTooltip] = useMemo(\n\t\t() => getButtonInfo(filterName, requiredFilters, t),\n\t\t[filterName, requiredFilters, t]\n\t);\n\n\tconst outgoingFiltersCopy = useMemo(() => outgoingFilters?.slice() || [], [outgoingFilters]);\n\tconst onConfirm = useCallback(() => {\n\t\tconst toSend = [...outgoingFiltersCopy, requiredFilters];\n\t\tsetOutgoingFilters(toSend);\n\t\tmodifyOutgoingFilterRules(toSend)\n\t\t\t.then(() => {\n\t\t\t\tsetFetchOutgoingFilters(true);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `share`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\thideButton: true,\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\tlabel:\n\t\t\t\t\t\terror?.message || t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\tautoHideTimeout: 5000\n\t\t\t\t});\n\t\t\t});\n\t\tonClose();\n\t}, [\n\t\toutgoingFiltersCopy,\n\t\trequiredFilters,\n\t\tsetOutgoingFilters,\n\t\tonClose,\n\t\tsetFetchOutgoingFilters,\n\t\tcreateSnackbar,\n\t\tt\n\t]);\n\n\tconst toggleCheckBox = useCallback(() => {\n\t\tsetDontProcessAddFilters(!dontProcessAddFilters);\n\t}, [dontProcessAddFilters]);\n\n\tconst filterActionProps = useMemo(\n\t\t() => ({\n\t\t\tt,\n\t\t\tactiveFilter,\n\t\t\tfilterName,\n\t\t\tisIncoming: false,\n\t\t\ttempActions,\n\t\t\tsetTempActions,\n\t\t\tzimbraFeatureMailForwardingInFiltersEnabled\n\t\t}),\n\t\t[t, activeFilter, filterName, tempActions, zimbraFeatureMailForwardingInFiltersEnabled]\n\t);\n\tconst filterTestConditionRowProps = useMemo(\n\t\t() => ({ t, newFilters, setNewFilters, condition, setCondition, activeFilter, filterName }),\n\t\t[t, newFilters, setNewFilters, condition, setCondition, activeFilter, filterName]\n\t);\n\treturn (\n\t\t<CreateFilterContext.Provider value={{ newFilters, setNewFilters }}>\n\t\t\t<Container\n\t\t\t\tpadding={{ bottom: 'medium' }}\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\tmaxHeight=\"100%\"\n\t\t\t\tstyle={{ overflowY: 'scroll', overflowX: 'hidden' }}\n\t\t\t>\n\t\t\t\t<ModalHeader title={modalTitle} onClose={onClose} />\n\t\t\t\t<Input\n\t\t\t\t\tlabel={inputLabel}\n\t\t\t\t\tvalue={filterName}\n\t\t\t\t\tonChange={onFilterNameChange}\n\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t/>\n\t\t\t\t<Padding top=\"small\" />\n\t\t\t\t<Checkbox value={activeFilter} onClick={toggleActiveFilter} label={activeFilterLabel} />\n\n\t\t\t\t<Row\n\t\t\t\t\tpadding={{ vertical: 'medium' }}\n\t\t\t\t\theight=\"fit\"\n\t\t\t\t\tmaxHeight=\"100%\"\n\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\t\tstyle={{ overflowY: 'scroll', overflowX: 'hidden' }}\n\t\t\t\t\tdisplay=\"block\"\n\t\t\t\t\tmaxWidth=\"100%\"\n\t\t\t\t\twidth=\"100%\"\n\t\t\t\t>\n\t\t\t\t\t<FilterTestConditionRow compProps={filterTestConditionRowProps} />\n\t\t\t\t\t<Padding top=\"medium\" />\n\t\t\t\t\t<Divider />\n\t\t\t\t\t<FilterActionConditions compProps={filterActionProps} />\n\t\t\t\t</Row>\n\n\t\t\t\t<ModalFooter\n\t\t\t\t\tlabel={t('label.create', 'Create')}\n\t\t\t\t\ttoolTipText={buttonTooltip}\n\t\t\t\t\tonConfirm={onConfirm}\n\t\t\t\t\tdisabled={createFilterDisabled}\n\t\t\t\t\tonSecondaryAction={toggleCheckBox}\n\t\t\t\t\tchecked={dontProcessAddFilters}\n\t\t\t\t\tcheckboxLabel={t(\n\t\t\t\t\t\t'settings.do_not_process_additional_filters',\n\t\t\t\t\t\t'Do not process additional filters'\n\t\t\t\t\t)}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</CreateFilterContext.Provider>\n\t);\n};\n\nexport default CreateOutgoingFilterModal;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useCallback, useMemo } from 'react';\n\nimport { Container, Text } from '@zextras/carbonio-design-system';\nimport { TFunction } from 'i18next';\n\nimport { useDeleteOutgoingFilter } from './actions';\nimport ModalFooter from '../../../../carbonio-ui-commons/components/modals/modal-footer';\nimport ModalHeader from '../../../../carbonio-ui-commons/components/modals/modal-header';\nimport type { FilterListType } from '../../../../types';\n\ntype ListType = {\n\tisSelecting: boolean;\n\tlist: Array<FilterListType>;\n\tmoveDown: (arg: number) => void;\n\tmoveUp: (arg: number) => void;\n\tselected: Record<string, boolean>;\n\ttoggle: (arg: string) => void;\n\tunSelect: () => void;\n};\n\ntype ComponentProps = {\n\tt: TFunction;\n\tonClose: () => void;\n\tavailableList: ListType;\n\tactiveList: ListType;\n\tsetFilters: (arg: Array<FilterListType>) => void;\n\tsetFetchFilters: (arg: boolean) => void;\n\tmodifierFunc: (arg: FilterListType[]) => Promise<void>;\n\tselectedFilter: any;\n\toutgoingFilters: any;\n};\n\nconst DeleteOutgoingFilterModal: FC<ComponentProps> = ({\n\tt,\n\tonClose,\n\tavailableList,\n\tactiveList,\n\tsetFilters,\n\tsetFetchFilters,\n\tmodifierFunc,\n\tselectedFilter,\n\toutgoingFilters\n}): ReactElement => {\n\tconst modalTitle = useMemo(() => t('settings.delete_filter', 'Delete filter'), [t]);\n\tconst deleteOutgoingFilter = useDeleteOutgoingFilter();\n\tconst onConfirmDelete = useCallback(() => {\n\t\tdeleteOutgoingFilter({\n\t\t\tt,\n\t\t\tonClose,\n\t\t\tavailableList,\n\t\t\tactiveList,\n\t\t\tsetFilters,\n\t\t\tsetFetchFilters,\n\t\t\tmodifierFunc,\n\t\t\tselectedFilter,\n\t\t\toutgoingFilters\n\t\t});\n\t}, [\n\t\tdeleteOutgoingFilter,\n\t\tt,\n\t\tonClose,\n\t\tavailableList,\n\t\tactiveList,\n\t\tsetFilters,\n\t\tsetFetchFilters,\n\t\tmodifierFunc,\n\t\tselectedFilter,\n\t\toutgoingFilters\n\t]);\n\treturn (\n\t\t<>\n\t\t\t<Container padding={{ bottom: 'medium' }}>\n\t\t\t\t<ModalHeader title={modalTitle} onClose={onClose} />\n\t\t\t\t<Container orientation=\"horizontal\" padding={{ all: 'medium' }}>\n\t\t\t\t\t<Text overflow=\"break-word\">\n\t\t\t\t\t\t{t('settings.delete_filter_text', 'Are you sure to delete filter ')}\n\t\t\t\t\t</Text>\n\t\t\t\t\t<Text weight=\"bold\" style={{ paddingLeft: '0.3125rem', paddingRight: '0.3125rem' }}>\n\t\t\t\t\t\t{`\"${selectedFilter?.name}\" ?`}\n\t\t\t\t\t</Text>\n\t\t\t\t</Container>\n\t\t\t\t<ModalFooter\n\t\t\t\t\tonConfirm={onConfirmDelete}\n\t\t\t\t\tlabel={t('label.delete', 'Delete')}\n\t\t\t\t\tbackground=\"error\"\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default DeleteOutgoingFilterModal;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, {\n\tFC,\n\tReactElement,\n\tuseCallback,\n\tuseEffect,\n\tuseLayoutEffect,\n\tuseMemo,\n\tuseState\n} from 'react';\n\nimport { Checkbox, Container, Divider, Input, Padding, Row } from '@zextras/carbonio-design-system';\nimport { useUserSettings } from '@zextras/carbonio-shell-ui';\nimport { TFunction } from 'i18next';\nimport { findIndex, forEach, isEqual, map, omit, reduce } from 'lodash';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport ModalHeader from '../../../../../carbonio-ui-commons/components/modals/modal-header';\nimport { useUiUtilities } from '../../../../../hooks/use-ui-utilities';\nimport { modifyOutgoingFilterRules } from '../../../../../store/actions/modify-filter-rules';\nimport type { FilterActions } from '../../../../../types';\nimport { capitalise } from '../../../../sidebar/utils';\nimport { CreateFilterContext } from '../create-filter-context';\nimport ModalFooter from '../create-filter-modal-footer';\nimport DefaultCondition from '../create-filters-conditions/default';\nimport FilterTestConditionRow from '../filter-test-condition-row';\nimport { findRowKey, getTestComponent } from '../get-test-component';\nimport FilterActionConditions from '../new-filter-action-conditions';\nimport { getButtonInfo } from '../utils';\n\ntype FilterType = {\n\tactive: boolean;\n\tfilterActions: Array<any>;\n\tfilterTests: Array<Record<string, any>>;\n\tid: string;\n\tname: string;\n};\ntype ComponentProps = {\n\tt: TFunction;\n\tonClose: () => void;\n\toutgoingFilters?: any;\n\tsetFetchOutgoingFilters: (arg: boolean) => void;\n\tsetOutgoingFilters: (arg: any) => void;\n\tselectedFilter: FilterType | any;\n};\n\nconst ModifyOutgoingFilterModal: FC<ComponentProps> = ({\n\tt,\n\tonClose,\n\toutgoingFilters,\n\tsetFetchOutgoingFilters,\n\tsetOutgoingFilters,\n\tselectedFilter\n}): ReactElement => {\n\tconst { createSnackbar } = useUiUtilities();\n\tconst [filterName, setFilterName] = useState('');\n\tconst [activeFilter, setActiveFilter] = useState(false);\n\tconst [condition, setCondition] = useState('anyof');\n\tconst [dontProcessAddFilters, setDontProcessAddFilters] = useState(true);\n\tconst [tempActions, setTempActions] = useState([{ actionKeep: [{}], id: uuidv4() }]);\n\tconst [copyRequiredFilters, setCopyRequiredFilters] = useState({});\n\tconst [updateRequiredFilters, setUpdateRequiredFilters] = useState(true);\n\tconst [reFetch, setReFetch] = useState(false);\n\tconst { zimbraFeatureMailForwardingInFiltersEnabled } = useUserSettings().attrs;\n\n\tconst [newFilters, setNewFilters] = useState([\n\t\t{\n\t\t\tfilterActions: [{ actionKeep: [{}], actionStop: [{}] }],\n\t\t\tactive: activeFilter,\n\t\t\tname: filterName,\n\t\t\tkey: 'subject',\n\t\t\tlabel: 'Subject',\n\t\t\tfilterTests: [{}],\n\t\t\tindex: 0,\n\t\t\tcomp: <DefaultCondition t={t} activeIndex={0} />\n\t\t}\n\t]);\n\n\tconst toggleActiveFilter = useCallback(() => setActiveFilter(!activeFilter), [activeFilter]);\n\tconst onFilterNameChange = useCallback((ev) => setFilterName(ev.target.value), []);\n\tconst modalTitle = useMemo(\n\t\t() => `${t('label.edit', 'Edit')} ${selectedFilter?.name}`,\n\t\t[t, selectedFilter?.name]\n\t);\n\tconst inputLabel = useMemo(() => `${t('settings.filter_name', 'Filter Name')}*`, [t]);\n\tconst activeFilterLabel = useMemo(() => t('settings.active_filter', 'Active filter'), [t]);\n\n\tconst requiredFilterTest = useMemo(() => {\n\t\tconst allTest = map(newFilters, (f) => f.filterTests[0]);\n\t\treturn reduce(\n\t\t\tallTest,\n\t\t\t(a, i) => {\n\t\t\t\tconst firstKey = Object.keys(omit(i, ['condition']))[0];\n\t\t\t\tif (Object.keys(a).includes(firstKey)) {\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\treturn { ...a, [firstKey]: [...a[firstKey], ...i[firstKey]] };\n\t\t\t\t}\n\t\t\t\treturn { ...a, ...i };\n\t\t\t},\n\t\t\t{}\n\t\t);\n\t}, [newFilters]);\n\n\tconst finalActions = useMemo(\n\t\t() =>\n\t\t\treduce(\n\t\t\t\ttempActions,\n\t\t\t\t(acc, i) => {\n\t\t\t\t\tconst firstKey = Object.keys(omit(i, 'id'))[0];\n\t\t\t\t\tif (Object.keys(acc).includes(firstKey)) {\n\t\t\t\t\t\tconst accWithoutId = omit(acc, 'id');\n\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\treturn { ...accWithoutId, [firstKey]: [...accWithoutId[firstKey], ...i[firstKey]] };\n\t\t\t\t\t}\n\t\t\t\t\treturn { ...acc, ...i };\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t),\n\t\t[tempActions]\n\t);\n\n\tconst requiredFilters = useMemo(\n\t\t() => ({\n\t\t\tfilterActions: dontProcessAddFilters\n\t\t\t\t? ([{ ...omit(finalActions, 'id'), actionStop: [{}] }] as FilterActions[])\n\t\t\t\t: ([{ ...omit(finalActions, 'id') }] as FilterActions[]),\n\t\t\tactive: activeFilter,\n\t\t\tname: filterName,\n\t\t\tfilterTests: [\n\t\t\t\t{\n\t\t\t\t\t...requiredFilterTest,\n\t\t\t\t\tcondition\n\t\t\t\t}\n\t\t\t]\n\t\t}),\n\t\t[activeFilter, filterName, condition, requiredFilterTest, dontProcessAddFilters, finalActions]\n\t);\n\n\tconst [createFilterDisabled, buttonTooltip] = useMemo(() => {\n\t\tif (isEqual(copyRequiredFilters, requiredFilters)) {\n\t\t\treturn [true, t('settings.label.not_changed_anything', 'No change was made')];\n\t\t}\n\t\treturn getButtonInfo(filterName, requiredFilters, t, false);\n\t}, [copyRequiredFilters, filterName, requiredFilters, t]);\n\n\tconst outgoingFiltersCopy = useMemo(() => outgoingFilters?.slice(), [outgoingFilters]);\n\n\tconst toggleCheckBox = useCallback(() => {\n\t\tsetDontProcessAddFilters((prev) => !prev);\n\t}, []);\n\n\tuseLayoutEffect(() => {\n\t\tsetDontProcessAddFilters(!!selectedFilter.filterActions[0]?.actionStop);\n\t}, [selectedFilter.filterActions]);\n\n\tconst filterActionProps = useMemo(\n\t\t() => ({\n\t\t\tt,\n\t\t\tactiveFilter,\n\t\t\tfilterName,\n\t\t\ttempActions,\n\t\t\tsetTempActions,\n\t\t\tzimbraFeatureMailForwardingInFiltersEnabled\n\t\t}),\n\t\t[t, activeFilter, filterName, tempActions, zimbraFeatureMailForwardingInFiltersEnabled]\n\t);\n\tconst filterTestConditionRowProps = useMemo(\n\t\t() => ({\n\t\t\tt,\n\t\t\tnewFilters,\n\t\t\tsetNewFilters,\n\t\t\tcondition,\n\t\t\tsetCondition,\n\t\t\tactiveFilter,\n\t\t\tfilterName,\n\t\t\tselectedFilter\n\t\t}),\n\t\t[\n\t\t\tt,\n\t\t\tnewFilters,\n\t\t\tsetNewFilters,\n\t\t\tcondition,\n\t\t\tsetCondition,\n\t\t\tactiveFilter,\n\t\t\tfilterName,\n\t\t\tselectedFilter\n\t\t]\n\t);\n\n\tuseEffect(() => {\n\t\tif (selectedFilter) {\n\t\t\tsetFilterName(selectedFilter?.name);\n\t\t\tsetActiveFilter(selectedFilter?.active);\n\t\t\tsetCondition(selectedFilter?.filterTests?.[0]?.condition);\n\t\t\tconst previousActions = (): Array<any> => {\n\t\t\t\tconst actions: Array<any> = [];\n\t\t\t\tforEach(selectedFilter?.filterActions?.[0], (value, key) => {\n\t\t\t\t\tif (key !== 'actionStop') {\n\t\t\t\t\t\tforEach(value, (val) => {\n\t\t\t\t\t\t\tactions.push({ [key]: [{ ...omit(val, 'index') }], id: uuidv4() });\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn actions;\n\t\t\t};\n\t\t\tsetTempActions(previousActions);\n\t\t}\n\t}, [selectedFilter]);\n\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tconst setCopyOfFilter = (): void => {\n\t\tsetCopyRequiredFilters(requiredFilters);\n\t};\n\n\tuseEffect(() => {\n\t\tif (selectedFilter) {\n\t\t\tif (updateRequiredFilters) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tsetUpdateRequiredFilters(false);\n\t\t\t\t\tsetCopyOfFilter();\n\t\t\t\t}, 10);\n\t\t\t}\n\t\t}\n\t}, [selectedFilter, setCopyOfFilter, updateRequiredFilters]);\n\n\tconst previousFilterTests = useMemo(() => {\n\t\tconst tempTests: Array<any> = [];\n\t\tforEach(selectedFilter?.filterTests?.[0], (value, key) => {\n\t\t\tif (key !== 'condition') {\n\t\t\t\tmap(value, (test) => {\n\t\t\t\t\ttempTests.push({ ...test, testName: key });\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn tempTests;\n\t}, [selectedFilter]);\n\n\tconst modifiedNewFilters = useMemo(\n\t\t() =>\n\t\t\tmap(previousFilterTests, (test, index) => {\n\t\t\t\tif (index === previousFilterTests.length - 1) setReFetch(true);\n\t\t\t\treturn {\n\t\t\t\t\tfilterActions: [{ actionKeep: [{}], actionStop: [{}] }],\n\t\t\t\t\tactive: false,\n\t\t\t\t\tname: '',\n\t\t\t\t\tkey: findRowKey({ name: test.testName, test }),\n\t\t\t\t\tlabel: capitalise(findRowKey({ name: test.testName, test })),\n\t\t\t\t\tfilterTests: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...{ [test.testName]: [test] },\n\t\t\t\t\t\t\tcondition: selectedFilter?.filterTests?.[0]?.condition\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tindex: 0,\n\t\t\t\t\tcomp: getTestComponent({\n\t\t\t\t\t\tname: test.testName,\n\t\t\t\t\t\ttest: { [test.testName]: [test] },\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tt\n\t\t\t\t\t})\n\t\t\t\t};\n\t\t\t}),\n\n\t\t[previousFilterTests, t, selectedFilter]\n\t);\n\n\tuseEffect(() => {\n\t\tsetNewFilters(modifiedNewFilters);\n\t\tif (reFetch) setReFetch(false);\n\t}, [modifiedNewFilters, reFetch]);\n\n\tconst onConfirm = useCallback(() => {\n\t\tconst selectedFilterIndex = findIndex(\n\t\t\toutgoingFiltersCopy,\n\t\t\t(filterCopy: any) => filterCopy.name === selectedFilter?.name\n\t\t);\n\t\tconst toSend = outgoingFiltersCopy.slice();\n\t\ttoSend[selectedFilterIndex] = requiredFilters;\n\t\tsetOutgoingFilters(toSend);\n\t\tmodifyOutgoingFilterRules(toSend)\n\t\t\t.then(() => {\n\t\t\t\tsetFetchOutgoingFilters(true);\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `share`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\thideButton: true,\n\t\t\t\t\ttype: 'info',\n\t\t\t\t\tlabel: t('label.filter_modified', 'Filter modified succesfully'),\n\t\t\t\t\tautoHideTimeout: 5000\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `share`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\thideButton: true,\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\tlabel:\n\t\t\t\t\t\terror?.message || t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\tautoHideTimeout: 5000\n\t\t\t\t});\n\t\t\t});\n\t\tonClose();\n\t}, [\n\t\toutgoingFiltersCopy,\n\t\trequiredFilters,\n\t\tsetOutgoingFilters,\n\t\tonClose,\n\t\tselectedFilter?.name,\n\t\tsetFetchOutgoingFilters,\n\t\tcreateSnackbar,\n\t\tt\n\t]);\n\n\treturn (\n\t\t<CreateFilterContext.Provider value={{ newFilters, setNewFilters }}>\n\t\t\t<Container\n\t\t\t\tpadding={{ bottom: 'medium' }}\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\tstyle={{ overflow: 'scroll' }}\n\t\t\t>\n\t\t\t\t<ModalHeader title={modalTitle} onClose={onClose} />\n\t\t\t\t<Input\n\t\t\t\t\tlabel={inputLabel}\n\t\t\t\t\tvalue={filterName}\n\t\t\t\t\tonChange={onFilterNameChange}\n\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t/>\n\t\t\t\t<Padding top=\"small\" />\n\t\t\t\t<Checkbox value={activeFilter} onClick={toggleActiveFilter} label={activeFilterLabel} />\n\n\t\t\t\t<Row\n\t\t\t\t\tpadding={{ vertical: 'medium' }}\n\t\t\t\t\theight=\"fit\"\n\t\t\t\t\tmaxHeight=\"100%\"\n\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\t\tstyle={{ overflowY: 'scroll', overflowX: 'hidden' }}\n\t\t\t\t\tdisplay=\"block\"\n\t\t\t\t\tmaxWidth=\"100%\"\n\t\t\t\t\twidth=\"100%\"\n\t\t\t\t>\n\t\t\t\t\t<FilterTestConditionRow compProps={filterTestConditionRowProps} />\n\t\t\t\t\t<Padding top=\"medium\" />\n\t\t\t\t\t<Divider />\n\t\t\t\t\t<FilterActionConditions compProps={filterActionProps} />\n\t\t\t\t</Row>\n\n\t\t\t\t<ModalFooter\n\t\t\t\t\tlabel={t('label.save', 'Save')}\n\t\t\t\t\ttoolTipText={buttonTooltip}\n\t\t\t\t\tonConfirm={onConfirm}\n\t\t\t\t\tdisabled={createFilterDisabled}\n\t\t\t\t\tonSecondaryAction={toggleCheckBox}\n\t\t\t\t\tchecked={dontProcessAddFilters}\n\t\t\t\t\tcheckboxLabel={t(\n\t\t\t\t\t\t'settings.do_not_process_additional_filters',\n\t\t\t\t\t\t'Do not process additional filters'\n\t\t\t\t\t)}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</CreateFilterContext.Provider>\n\t);\n};\n\nexport default ModifyOutgoingFilterModal;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useCallback, useContext, useMemo } from 'react';\n\nimport { Button, Padding, ModalManagerContext } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport { find } from 'lodash';\n\nimport { useRemoveFilter, useAddFilter } from './actions';\nimport CreateOutgoingFilterModal from './create-outgoing-filter-modal';\nimport DeleteOutgoingFilterModal from './delete-outgoing-filter-modal';\nimport { FilterContext } from './filter-context';\nimport ModifyOutgoingFilterModal from './modify-filter/modify-outgoing-filter-modal';\nimport { modifyOutgoingFilterRules } from '../../../../store/actions/modify-filter-rules';\nimport { StoreProvider } from '../../../../store/redux';\n\ntype FilterListType = {\n\tactive: boolean;\n\tfilterActions: Array<any>;\n\tfilterTests: Array<any>;\n\tid?: string;\n\tname: string;\n};\ntype ListType = {\n\tisSelecting: boolean;\n\tlist: Array<FilterListType>;\n\tmoveDown: (arg: number) => void;\n\tmoveUp: (arg: number) => void;\n\tselected: Record<string, boolean>;\n\ttoggle: (arg: string) => void;\n\tunSelect: () => void;\n};\ntype ComponentProps = {\n\tcompProps: {\n\t\tt: TFunction;\n\t\tavailableList: ListType;\n\t\tactiveList: ListType;\n\t\toutgoingFilters: ListType;\n\t};\n};\nconst OutgoingFilterActions: FC<ComponentProps> = ({ compProps }): ReactElement => {\n\tconst { t, availableList, activeList, outgoingFilters } = compProps;\n\tconst { setFetchOutgoingFilters, setOutgoingFilters } = useContext(FilterContext);\n\tconst disableAdd = useMemo(\n\t\t() => Object.keys(availableList.selected).length <= 0,\n\t\t[availableList.selected]\n\t);\n\tconst disableRemove = useMemo(\n\t\t() => Object.keys(activeList.selected).length <= 0,\n\t\t[activeList.selected]\n\t);\n\tconst selectedFilterName = useMemo(\n\t\t() => Object.keys(activeList.selected)[0] || Object.keys(availableList.selected)[0],\n\t\t[activeList.selected, availableList.selected]\n\t);\n\tconst selectedFilter = useMemo(\n\t\t() =>\n\t\t\tfind(availableList.list, { name: Object.keys(availableList.selected)[0] }) ||\n\t\t\tfind(activeList.list, { name: Object.keys(activeList.selected)[0] }),\n\t\t[availableList, activeList]\n\t);\n\n\tconst disableEdit = useMemo(\n\t\t() => !Object.keys(activeList.selected).length && !Object.keys(availableList.selected).length,\n\t\t[activeList.selected, availableList.selected]\n\t);\n\tconst disableRun = useMemo(() => true, []);\n\tconst disableDelete = useMemo(\n\t\t() => !Object.keys(activeList.selected).length && !Object.keys(availableList.selected).length,\n\t\t[activeList.selected, availableList.selected]\n\t);\n\tconst disablCreate = useMemo(() => false, []);\n\tconst createModal = useContext(ModalManagerContext);\n\tconst openCreateModal = useCallback(() => {\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t// @ts-ignore\n\t\tconst closeModal = createModal(\n\t\t\t{\n\t\t\t\tsize: 'large',\n\t\t\t\tmaxHeight: '80vh',\n\t\t\t\tchildren: (\n\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t<CreateOutgoingFilterModal\n\t\t\t\t\t\t\tt={t}\n\t\t\t\t\t\t\tonClose={(): void => closeModal()}\n\t\t\t\t\t\t\toutgoingFilters={outgoingFilters}\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tsetFetchOutgoingFilters={setFetchOutgoingFilters}\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tsetOutgoingFilters={setOutgoingFilters}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</StoreProvider>\n\t\t\t\t)\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}, [createModal, t, outgoingFilters, setOutgoingFilters, setFetchOutgoingFilters]);\n\n\tconst removeFilter = useRemoveFilter();\n\tconst onRemove = useCallback(\n\t\t() =>\n\t\t\tremoveFilter({\n\t\t\t\tt,\n\t\t\t\tavailableList,\n\t\t\t\tactiveList,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tsetFilters: setOutgoingFilters,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tsetFetchFilters: setFetchOutgoingFilters,\n\t\t\t\tmodifierFunc: modifyOutgoingFilterRules\n\t\t\t}),\n\t\t[removeFilter, t, availableList, activeList, setOutgoingFilters, setFetchOutgoingFilters]\n\t);\n\n\tconst addFilter = useAddFilter();\n\tconst onAdd = useCallback(\n\t\t() =>\n\t\t\taddFilter({\n\t\t\t\tt,\n\t\t\t\tavailableList,\n\t\t\t\tactiveList,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tsetFilters: setOutgoingFilters,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tsetFetchFilters: setFetchOutgoingFilters,\n\t\t\t\tmodifierFunc: modifyOutgoingFilterRules\n\t\t\t}),\n\t\t[addFilter, t, availableList, activeList, setOutgoingFilters, setFetchOutgoingFilters]\n\t);\n\n\tconst openDeleteModal = useCallback(() => {\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t// @ts-ignore\n\t\tconst closeModal = createModal(\n\t\t\t{\n\t\t\t\tsize: 'small',\n\t\t\t\tchildren: (\n\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t<DeleteOutgoingFilterModal\n\t\t\t\t\t\t\tonClose={(): void => closeModal()}\n\t\t\t\t\t\t\tt={t}\n\t\t\t\t\t\t\tavailableList={availableList}\n\t\t\t\t\t\t\tactiveList={activeList}\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tsetFilters={setOutgoingFilters}\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tsetFetchFilters={setFetchOutgoingFilters}\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tmodifierFunc={modifyOutgoingFilterRules}\n\t\t\t\t\t\t\tfilterName={selectedFilterName}\n\t\t\t\t\t\t\tselectedFilter={selectedFilter}\n\t\t\t\t\t\t\toutgoingFilters={outgoingFilters}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</StoreProvider>\n\t\t\t\t)\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}, [\n\t\tactiveList,\n\t\tavailableList,\n\t\tcreateModal,\n\t\toutgoingFilters,\n\t\tselectedFilter,\n\t\tselectedFilterName,\n\t\tsetFetchOutgoingFilters,\n\t\tsetOutgoingFilters,\n\t\tt\n\t]);\n\tconst openFilterModifyModal = useCallback(() => {\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t// @ts-ignore\n\t\tconst closeModal = createModal(\n\t\t\t{\n\t\t\t\tsize: 'large',\n\t\t\t\tmaxHeight: '80vh',\n\t\t\t\tchildren: (\n\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t<ModifyOutgoingFilterModal\n\t\t\t\t\t\t\tt={t}\n\t\t\t\t\t\t\tselectedFilter={selectedFilter}\n\t\t\t\t\t\t\tonClose={(): void => closeModal()}\n\t\t\t\t\t\t\toutgoingFilters={outgoingFilters}\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tsetFetchOutgoingFilters={setFetchOutgoingFilters}\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tsetOutgoingFilters={setOutgoingFilters}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</StoreProvider>\n\t\t\t\t)\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}, [\n\t\tcreateModal,\n\t\tt,\n\t\tselectedFilter,\n\t\toutgoingFilters,\n\t\tsetFetchOutgoingFilters,\n\t\tsetOutgoingFilters\n\t]);\n\treturn (\n\t\t<>\n\t\t\t<Padding top=\"medium\" />\n\t\t\t<Button\n\t\t\t\tlabel={t('label.add', 'Add')}\n\t\t\t\ttype=\"outlined\"\n\t\t\t\ticon=\"ArrowheadLeftOutline\"\n\t\t\t\ticonPlacement=\"left\"\n\t\t\t\tdisabled={disableAdd}\n\t\t\t\tonClick={onAdd}\n\t\t\t\twidth=\"fill\"\n\t\t\t/>\n\t\t\t<Padding bottom=\"medium\" />\n\t\t\t<Button\n\t\t\t\tlabel={t('label.remove_one', 'Remove')}\n\t\t\t\ttype=\"outlined\"\n\t\t\t\tcolor=\"error\"\n\t\t\t\ticon=\"ArrowheadRightOutline\"\n\t\t\t\tdisabled={disableRemove}\n\t\t\t\tonClick={onRemove}\n\t\t\t\twidth=\"fill\"\n\t\t\t/>\n\t\t\t<Padding bottom=\"medium\" />\n\t\t\t<Button\n\t\t\t\tlabel={t('label.edit', 'Edit')}\n\t\t\t\ttype=\"outlined\"\n\t\t\t\tdisabled={disableEdit}\n\t\t\t\twidth=\"fill\"\n\t\t\t\tonClick={openFilterModifyModal}\n\t\t\t/>\n\t\t\t<Padding bottom=\"medium\" />\n\t\t\t{/* <Button label={t('filters.run', 'Run')} type=\"outlined\" disabled={disableRun} size=\"fill\" /> */}\n\t\t\t<Padding bottom=\"medium\" />\n\t\t\t<Button\n\t\t\t\tlabel={t('label.delete', 'Delete')}\n\t\t\t\ttype=\"outlined\"\n\t\t\t\tcolor=\"error\"\n\t\t\t\tdisabled={disableDelete}\n\t\t\t\twidth=\"fill\"\n\t\t\t\tonClick={openDeleteModal}\n\t\t\t/>\n\t\t\t<Padding bottom=\"medium\" />\n\t\t\t<Button\n\t\t\t\tlabel={t('label.create', 'Create')}\n\t\t\t\ttype=\"outlined\"\n\t\t\t\tdisabled={disablCreate}\n\t\t\t\twidth=\"fill\"\n\t\t\t\tonClick={openCreateModal}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default OutgoingFilterActions;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useMemo, useContext } from 'react';\nimport { List, Container } from '@zextras/carbonio-design-system';\nimport type { TFunction } from 'i18next';\nimport { filter, map } from 'lodash';\nimport FilterItem from './filter-item';\nimport { useFilterSelection } from './use-filter-selection';\nimport Heading from '../../components/settings-heading';\nimport LoadingShimmer from './loading-shimmer';\nimport { FilterContext } from './filter-context';\nimport { modifyOutgoingFilterRules } from '../../../../store/actions/modify-filter-rules';\nimport OutgoingFilterActions from './outgoing-filters-actions';\n\ntype ComponentProps = {\n\tt: TFunction;\n\tselectedFilterType: string;\n};\nconst OutgoingMsgFilterTab: FC<ComponentProps> = ({ t, selectedFilterType }): ReactElement => {\n\tconst { outgoingFilters, outgoingLoading, setFetchOutgoingFilters } = useContext(FilterContext);\n\tconst outgoingFiltersCopy = useMemo(() => outgoingFilters?.slice(), [outgoingFilters]);\n\n\tconst [active, available] = useMemo(\n\t\t() => [\n\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t// @ts-ignore\n\t\t\tmap(filter(outgoingFiltersCopy, { active: true }), (f) => ({ ...f, id: f.name })),\n\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t// @ts-ignore\n\t\t\tmap(filter(outgoingFiltersCopy, { active: false }), (f) => ({ ...f, id: f.name }))\n\t\t],\n\t\t[outgoingFiltersCopy]\n\t);\n\tconst activeList = useFilterSelection(\n\t\tactive,\n\t\tsetFetchOutgoingFilters,\n\t\tmodifyOutgoingFilterRules,\n\t\tavailable\n\t);\n\tconst availableList = useFilterSelection(\n\t\tavailable,\n\t\tsetFetchOutgoingFilters,\n\t\tmodifyOutgoingFilterRules,\n\t\tactive\n\t);\n\n\tconst actionButtonsProps = useMemo(\n\t\t() => ({\n\t\t\tt,\n\t\t\tavailableList,\n\t\t\tactiveList,\n\t\t\tselectedFilterType,\n\t\t\toutgoingFilters: outgoingFiltersCopy,\n\t\t\tsetFetchOutgoingFilters\n\t\t}),\n\t\t[t, availableList, activeList, selectedFilterType, outgoingFiltersCopy, setFetchOutgoingFilters]\n\t);\n\treturn (\n\t\t<Container crossAlignment=\"flex-start\" mainAlignment=\"flex-start\" orientation=\"horizontal\">\n\t\t\t<Container width=\"43%\" minHeight=\"30vh\" mainAlignment=\"flex-start\">\n\t\t\t\t<Heading title={t('filters.active_filters', 'Active Filters')} size=\"small\" />\n\t\t\t\t<Container>\n\t\t\t\t\t{outgoingLoading ? (\n\t\t\t\t\t\t<LoadingShimmer />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<List\n\t\t\t\t\t\t\titems={activeList.list}\n\t\t\t\t\t\t\tselected={activeList.selected}\n\t\t\t\t\t\t\tItemComponent={FilterItem}\n\t\t\t\t\t\t\titemProps={{\n\t\t\t\t\t\t\t\tlistProps: activeList,\n\t\t\t\t\t\t\t\tunSelect: availableList.unSelect\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</Container>\n\t\t\t</Container>\n\t\t\t<Container width=\"14%\" padding={{ all: 'large' }} mainAlignment=\"space-between\">\n\t\t\t\t<OutgoingFilterActions compProps={actionButtonsProps} />\n\t\t\t</Container>\n\t\t\t<Container width=\"43%\" mainAlignment=\"flex-start\">\n\t\t\t\t<Heading title={t('filters.available_filters', 'Available Filters')} size=\"small\" />\n\t\t\t\t<Container>\n\t\t\t\t\t{outgoingLoading ? (\n\t\t\t\t\t\t<LoadingShimmer />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<List\n\t\t\t\t\t\t\titems={availableList.list}\n\t\t\t\t\t\t\tselected={availableList.selected}\n\t\t\t\t\t\t\tItemComponent={FilterItem}\n\t\t\t\t\t\t\titemProps={{\n\t\t\t\t\t\t\t\tlistProps: availableList,\n\t\t\t\t\t\t\t\tunSelect: activeList.unSelect\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</Container>\n\t\t\t</Container>\n\t\t</Container>\n\t);\n};\nexport default OutgoingMsgFilterTab;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\nimport type { FilterRules } from '../../types';\n\nexport const getOutgoingFilters = createAsyncThunk(\n\t'filters/get_filters',\n\tasync (): Promise<any> => {\n\t\tconst { filterRules } = (await soapFetch('GetOutgoingFilterRules', {\n\t\t\t_jsns: 'urn:zimbraMail'\n\t\t})) as { filterRules: FilterRules };\n\t\treturn { filterRules };\n\t}\n);\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, ReactElement, useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { Container, Divider, Padding, TabBar, TabBarProps } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\n\nimport { FilterContext } from './filter-context';\nimport IncomingMessageFilterTab from './incoming-message-filter-tab';\nimport OutgoingMessageFilterTab from './outgoing-message-filter-tab';\nimport { useAppDispatch } from '../../../../hooks/redux';\nimport { useUiUtilities } from '../../../../hooks/use-ui-utilities';\nimport { getIncomingFilters } from '../../../../store/actions/get-incoming-filters';\nimport { getOutgoingFilters } from '../../../../store/actions/get-outgoing-filters';\n\ntype Item = {\n\tactive: boolean;\n\tfilterActions: Array<any>;\n\tfilterTests: Array<any>;\n\tid?: string;\n\tname: string;\n};\n\nconst FilterTabs: FC = (): ReactElement => {\n\tconst [selectedFilterType, setSelectedFilterType] = useState('incoming-messages');\n\tconst tabs = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\tid: 'incoming-messages',\n\t\t\t\tlabel: t('filters.incoming_msg_filters', 'Incoming Message Filters')\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'outgoing-messages',\n\t\t\t\tlabel: t('filters.outgoing_message_filters', 'Outgoing Message Filters')\n\t\t\t}\n\t\t],\n\t\t[]\n\t);\n\tconst onChange = useCallback<TabBarProps['onChange']>((ev, selectedId) => {\n\t\tsetSelectedFilterType(selectedId);\n\t}, []);\n\tconst dispatch = useAppDispatch();\n\tconst [incomingFilters, setIncomingFilters] = useState<Array<Item>>([]);\n\tconst [incomingLoading, setIncomingLoading] = useState(true);\n\tconst [outgoingLoading, setOutgoingLoading] = useState(true);\n\tconst [outgoingFilters, setOutgoingFilters] = useState<Array<Item>>([]);\n\tconst [fetchIncomingFilters, setFetchIncomingFilters] = useState(true);\n\tconst [fetchOutgoingFilters, setFetchOutgoingFilters] = useState(true);\n\tconst { createSnackbar } = useUiUtilities();\n\n\tuseEffect(() => {\n\t\tif (fetchIncomingFilters) {\n\t\t\tgetIncomingFilters()\n\t\t\t\t.then(({ filterRules }) => {\n\t\t\t\t\tsetIncomingLoading(false);\n\t\t\t\t\tsetIncomingFilters(filterRules?.[0]?.filterRule);\n\t\t\t\t\tsetFetchIncomingFilters(false);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `share`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\thideButton: true,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\terror?.message ||\n\t\t\t\t\t\t\tt('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\tautoHideTimeout: 5000\n\t\t\t\t\t});\n\t\t\t\t\tsetIncomingLoading(false);\n\t\t\t\t\tsetFetchIncomingFilters(false);\n\t\t\t\t});\n\t\t}\n\t}, [createSnackbar, dispatch, fetchIncomingFilters]);\n\n\tuseEffect(() => {\n\t\tif (fetchOutgoingFilters) {\n\t\t\tdispatch(getOutgoingFilters()).then((res) => {\n\t\t\t\tsetOutgoingLoading(false);\n\t\t\t\tsetOutgoingFilters(res?.payload?.filterRules?.[0]?.filterRule);\n\t\t\t\tsetFetchOutgoingFilters(false);\n\t\t\t});\n\t\t}\n\t}, [dispatch, fetchOutgoingFilters]);\n\n\tconst moveUp = useCallback((index, list, listSetter) => {\n\t\tconst tmp = list.slice();\n\n\t\tif (index === tmp.length - 1) return;\n\t\tconst index2 = index + 1;\n\t\tconst itemBelow = tmp[index2];\n\t\ttmp[index + 1] = tmp[index];\n\t\ttmp[index] = itemBelow;\n\t\tlistSetter(tmp);\n\t}, []);\n\n\treturn (\n\t\t<Container crossAlignment=\"baseline\" padding={{ top: 'medium' }}>\n\t\t\t<FilterContext.Provider\n\t\t\t\tvalue={{\n\t\t\t\t\tincomingFilters,\n\t\t\t\t\tincomingLoading,\n\t\t\t\t\tsetFetchIncomingFilters,\n\t\t\t\t\toutgoingFilters,\n\t\t\t\t\toutgoingLoading,\n\t\t\t\t\tmoveUp,\n\t\t\t\t\tsetIncomingFilters,\n\t\t\t\t\tsetOutgoingFilters,\n\t\t\t\t\tsetFetchOutgoingFilters\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<TabBar\n\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\titems={tabs}\n\t\t\t\t\tselected={selectedFilterType}\n\t\t\t\t\theight=\"3.75rem\"\n\t\t\t\t\tonChange={onChange}\n\t\t\t\t/>\n\t\t\t\t<Container crossAlignment=\"flex-start\" padding={{ top: 'small' }}>\n\t\t\t\t\t{selectedFilterType === 'incoming-messages' && (\n\t\t\t\t\t\t<IncomingMessageFilterTab selectedFilterType={selectedFilterType} t={t} />\n\t\t\t\t\t)}\n\t\t\t\t\t{selectedFilterType === 'outgoing-messages' && (\n\t\t\t\t\t\t<OutgoingMessageFilterTab selectedFilterType={selectedFilterType} t={t} />\n\t\t\t\t\t)}\n\t\t\t\t</Container>\n\n\t\t\t\t<Padding top=\"medium\" />\n\t\t\t\t<Divider />\n\t\t\t</FilterContext.Provider>\n\t\t</Container>\n\t);\n};\n\nexport default FilterTabs;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\nimport { normalizeFilterRulesFromSoap } from '../../normalizations/normalize-filter-rules';\nimport type { FilterRules } from '../../types';\n\nexport const getIncomingFilters = async (): Promise<any> => {\n\tconst { filterRules } = (await soapFetch('GetFilterRules', {\n\t\t_jsns: 'urn:zimbraMail'\n\t})) as { filterRules: FilterRules };\n\tconst normalizedFilterRules = normalizeFilterRulesFromSoap(filterRules);\n\treturn normalizedFilterRules;\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { map, omit, reduce } from 'lodash';\nimport type { FilterRules, FilterTest } from '../types';\n\nexport const normalizeFilterTests = (filterTests: FilterTest): FilterTest =>\n\treduce(\n\t\tObject.keys(filterTests),\n\t\t(acc, testKey) => {\n\t\t\tif (testKey !== 'condition') {\n\t\t\t\treturn {\n\t\t\t\t\t...acc,\n\t\t\t\t\t[testKey]: map(filterTests[testKey], (filterTest) => omit(filterTest, 'index'))\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...acc,\n\t\t\t\tcondition: filterTests.condition\n\t\t\t};\n\t\t},\n\t\t{}\n\t);\n\nexport const normalizeFilterRulesFromSoap = (\n\tfilterRules: FilterRules\n): { filterRules: FilterRules } => {\n\tconst filterRule = map(filterRules?.[0]?.filterRule, (f) => ({\n\t\t...f,\n\t\tfilterTests: [normalizeFilterTests(f.filterTests[0])]\n\t}));\n\treturn { filterRules: [{ filterRule }] };\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { t } from '@zextras/carbonio-shell-ui';\nimport React, { FC, ReactElement, useMemo } from 'react';\nimport { Container, Text, Divider } from '@zextras/carbonio-design-system';\nimport FilterTabs from './parts/filter-tabs';\nimport Heading from '../components/settings-heading';\nimport { filtersSubSection } from '../subsections';\n\nconst FilterModule: FC = (): ReactElement => {\n\tconst sectionTitle = useMemo(() => filtersSubSection(), []);\n\treturn (\n\t\t<Container background=\"gray6\" padding={{ horizontal: 'medium', bottom: 'large' }}>\n\t\t\t<Container\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\tpadding={{ horizontal: 'medium', top: 'medium' }}\n\t\t\t\tmainAlignment=\"space-between\"\n\t\t\t>\n\t\t\t\t<Container width=\"50%\" id={sectionTitle.id}>\n\t\t\t\t\t<Heading title={sectionTitle.label} size=\"medium\" />\n\t\t\t\t</Container>\n\t\t\t\t<Container width=\"50%\" crossAlignment=\"flex-end\">\n\t\t\t\t\t<Text size=\"extrasmall\">\n\t\t\t\t\t\t{t('filters.filter_note', 'Note: changes to filter rules are saved immediately')}\n\t\t\t\t\t</Text>\n\t\t\t\t</Container>\n\t\t\t</Container>\n\t\t\t<Divider />\n\t\t\t<Container padding={{ all: 'medium', bottom: 'small' }}>\n\t\t\t\t<FilterTabs />\n\t\t\t</Container>\n\t\t</Container>\n\t);\n};\n\nexport default FilterModule;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, useMemo } from 'react';\nimport {\n\tContainer,\n\tFormSubSection,\n\tSelect,\n\tInput,\n\tCheckbox,\n\tPadding\n} from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\nimport { isNil } from 'lodash';\nimport Heading from './components/settings-heading';\nimport { NotifyFolderOpts, ReadReceiptOpts, MsgsFromMeOpts, findLabel } from './components/utils';\nimport { receivingMessagesSubSection } from './subsections';\nimport { MAIL_APP_ID } from '../../constants';\nimport type { ReceivingMessagesSettingsType } from '../../types';\n\nconst ReceivingMessagesSettings: FC<ReceivingMessagesSettingsType> = ({\n\tsettingsObj,\n\tupdateSettings,\n\tupdatedProps,\n\tupdateProps\n}) => {\n\tconst notifyFolderOptn = useMemo(() => NotifyFolderOpts(), []);\n\tconst readReceiptOptn = useMemo(() => ReadReceiptOpts(), []);\n\tconst msgsFromMeOpts = useMemo(() => MsgsFromMeOpts(), []);\n\tconst sectionTitle = useMemo(() => receivingMessagesSubSection(), []);\n\n\tconst mailNotificationSoundDefault = useMemo(\n\t\t() =>\n\t\t\tisNil(updatedProps?.mailNotificationSound?.value)\n\t\t\t\t? true\n\t\t\t\t: updatedProps?.mailNotificationSound?.value === 'TRUE',\n\t\t[updatedProps?.mailNotificationSound?.value]\n\t);\n\n\treturn (\n\t\t<FormSubSection label={sectionTitle.label} id={sectionTitle.id}>\n\t\t\t<Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t<Heading title={t('label.message_arrival', 'Message Arrival')} />\n\t\t\t\t<Input\n\t\t\t\t\tlabel={t('label.send_notification', 'Send a notification message to')}\n\t\t\t\t\tvalue={settingsObj.zimbraPrefNewMailNotificationAddress}\n\t\t\t\t\tonChange={(e: React.ChangeEvent<HTMLInputElement>): void => {\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\t\tname: 'zimbraPrefNewMailNotificationAddress',\n\t\t\t\t\t\t\t\tvalue: e.target.value\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}}\n\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t<Heading title={t('label.arrival_notifications', 'Arrival Notifications')} />\n\t\t\t\t<Checkbox\n\t\t\t\t\tlabel={t('label.show_popup', 'Show a popup notification')}\n\t\t\t\t\tvalue={settingsObj.zimbraPrefMailToasterEnabled === 'TRUE'}\n\t\t\t\t\tonClick={(): void =>\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\t\tname: 'zimbraPrefMailToasterEnabled',\n\t\t\t\t\t\t\t\tvalue: settingsObj.zimbraPrefMailToasterEnabled === 'TRUE' ? 'FALSE' : 'TRUE'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t\t{/* todo: disabled because unsupported yet\n\t\t\t\t<Padding bottom=\"small\" />\n\t\t\t\t<Checkbox\n\t\t\t\t\tlabel={t('label.highlight_tab', 'Highlight the Mail tab')}\n\t\t\t\t\tvalue={settingsObj.zimbraPrefMailFlashIcon === 'TRUE'}\n\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\t\tname: 'zimbraPrefMailFlashIcon',\n\t\t\t\t\t\t\t\tvalue: settingsObj.zimbraPrefMailFlashIcon === 'TRUE' ? 'FALSE' : 'TRUE'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t\t<Padding bottom=\"small\" />\n\t\t\t\t<Checkbox\n\t\t\t\t\tlabel={t('label.flash_browser_title', 'Flash the browser title')}\n\t\t\t\t\tvalue={settingsObj.zimbraPrefMailFlashTitle === 'TRUE'}\n\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\t\tname: 'zimbraPrefMailFlashTitle',\n\t\t\t\t\t\t\t\tvalue: settingsObj.zimbraPrefMailFlashTitle === 'TRUE' ? 'FALSE' : 'TRUE'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t/> */}\n\t\t\t\t<Padding bottom=\"small\" />\n\t\t\t\t<Checkbox\n\t\t\t\t\tlabel={t('label.notification_audio', 'Play audio hint when new notification appears')}\n\t\t\t\t\tvalue={mailNotificationSoundDefault}\n\t\t\t\t\tonClick={(): void => {\n\t\t\t\t\t\tupdateProps({\n\t\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\t\tname: 'mailNotificationSound',\n\t\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\t\t\tapp: MAIL_APP_ID,\n\t\t\t\t\t\t\t\t\tvalue: mailNotificationSoundDefault ? 'FALSE' : 'TRUE'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t<Heading title={t('label.notification_folders', 'Notification Folders')} />\n\t\t\t\t<Select\n\t\t\t\t\tlabel={t('label.select_folder', 'Select folder')}\n\t\t\t\t\titems={notifyFolderOptn}\n\t\t\t\t\tonChange={(view: any): void =>\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: { name: 'zimbraPrefShowAllNewMailNotifications', value: view }\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tdefaultSelection={{\n\t\t\t\t\t\tlabel: findLabel(notifyFolderOptn, settingsObj.zimbraPrefShowAllNewMailNotifications),\n\t\t\t\t\t\tvalue: settingsObj.zimbraPrefShowAllNewMailNotifications\n\t\t\t\t\t}}\n\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t<Heading title={t('label.read_receipt', 'Read Receipt')} />\n\t\t\t\t<Select\n\t\t\t\t\titems={readReceiptOptn}\n\t\t\t\t\tonChange={(view: any): void =>\n\t\t\t\t\t\tupdateSettings({ target: { name: 'zimbraPrefMailSendReadReceipts', value: view } })\n\t\t\t\t\t}\n\t\t\t\t\tdefaultSelection={{\n\t\t\t\t\t\tlabel: findLabel(readReceiptOptn, settingsObj.zimbraPrefMailSendReadReceipts),\n\t\t\t\t\t\tvalue: settingsObj.zimbraPrefMailSendReadReceipts\n\t\t\t\t\t}}\n\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t<Heading title={t('label.message_from_me', 'Messages from me')} />\n\t\t\t\t<Select\n\t\t\t\t\titems={msgsFromMeOpts}\n\t\t\t\t\tonChange={(view: any): void =>\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: { name: 'zimbraPrefDedupeMessagesSentToSelf', value: view }\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tdefaultSelection={{\n\t\t\t\t\t\tlabel: findLabel(msgsFromMeOpts, settingsObj.zimbraPrefDedupeMessagesSentToSelf),\n\t\t\t\t\t\tvalue: settingsObj.zimbraPrefDedupeMessagesSentToSelf\n\t\t\t\t\t}}\n\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t<Heading title={t('label.duplicate_messages', 'Duplicate Messages')} />\n\t\t\t\t<Checkbox\n\t\t\t\t\tlabel={t(\n\t\t\t\t\t\t'label.automatically_delete_duplicates',\n\t\t\t\t\t\t'Automatically delete duplicate copies of the same message when received'\n\t\t\t\t\t)}\n\t\t\t\t\tvalue={settingsObj.zimbraPrefMessageIdDedupingEnabled === 'TRUE'}\n\t\t\t\t\tonClick={(): void =>\n\t\t\t\t\t\tupdateSettings({\n\t\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\t\tname: 'zimbraPrefMessageIdDedupingEnabled',\n\t\t\t\t\t\t\t\tvalue: settingsObj.zimbraPrefMessageIdDedupingEnabled === 'TRUE' ? 'FALSE' : 'TRUE'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</FormSubSection>\n\t);\n};\n\nexport default ReceivingMessagesSettings;\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React from 'react';\n\nimport { Container, Text } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\n\nimport { AnimatedLoader } from '../../../assets/animated-loader';\nimport ModalFooter from '../../../carbonio-ui-commons/components/modals/modal-footer';\nimport ModalHeader from '../../../carbonio-ui-commons/components/modals/modal-header';\nimport { BACKUP_SEARCH_STATUS } from '../../../constants';\nimport { useBackupSearchStore } from '../../../store/zustand/backup-search/store';\n\ntype RecoverMessagesModalPropType = {\n\tonConfirm: () => void;\n\tonClose: () => void;\n};\nexport const RecoverMessagesModal = ({\n\tonConfirm,\n\tonClose\n}: RecoverMessagesModalPropType): React.JSX.Element => {\n\tconst isLoading = useBackupSearchStore().status === BACKUP_SEARCH_STATUS.loading;\n\tconst modalHeaderTitle = isLoading\n\t\t? t('label.searching_recover_emails', 'Searching for e-mails to recover')\n\t\t: t('label.search_recover_emails', 'Search e-mails to recover');\n\tconst modalFooterLabel = isLoading\n\t\t? t('label.loading_results', 'Loading results...')\n\t\t: t('label.start_search', 'Start Search');\n\tconst loadingSubText = ` ${t('label.want_to_continue', 'Do you want to continue?')}`;\n\n\treturn (\n\t\t<Container\n\t\t\tpadding={{ all: 'large' }}\n\t\t\tmainAlignment=\"center\"\n\t\t\tcrossAlignment=\"flex-start\"\n\t\t\theight=\"fit\"\n\t\t>\n\t\t\t<ModalHeader onClose={onClose} title={modalHeaderTitle} showCloseIcon={!isLoading} />\n\t\t\t<Container\n\t\t\t\tpadding={{ all: 'small' }}\n\t\t\t\tmainAlignment=\"center\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\theight=\"fit\"\n\t\t\t>\n\t\t\t\t<Text style={{ whiteSpace: 'pre-line' }}>\n\t\t\t\t\t{t(\n\t\t\t\t\t\t'messages.searching_deleted_emails',\n\t\t\t\t\t\t'Searching deleted e-mails from Trash may take some time. Once the operation is completed, you will be directed to the results.'\n\t\t\t\t\t)}\n\t\t\t\t</Text>\n\t\t\t\t{!isLoading && <Text>{loadingSubText}</Text>}\n\t\t\t\t<ModalFooter\n\t\t\t\t\tdisabled={isLoading}\n\t\t\t\t\tonConfirm={onConfirm}\n\t\t\t\t\tlabel={modalFooterLabel}\n\t\t\t\t\tprimaryButtonIcon={isLoading && AnimatedLoader}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</Container>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { useCallback, useState } from 'react';\n\nimport {\n\tText,\n\tButton,\n\tFormSubSection,\n\tPadding,\n\tuseModal,\n\tCloseModalFn,\n\tuseSnackbar,\n\tRow,\n\tInput,\n\tContainer,\n\tDateTimePicker\n} from '@zextras/carbonio-design-system';\nimport { replaceHistory, t, useUserSettings } from '@zextras/carbonio-shell-ui';\nimport { isEmpty } from 'lodash';\n\nimport { RecoverMessagesModal } from './components/recover-messages-modal';\nimport { recoverMessagesSubSection } from './subsections';\nimport { searchBackupDeletedMessagesAPI } from '../../api/search-backup-deleted-messages';\nimport {\n\tBACKUP_SEARCH_ROUTE,\n\tBACKUP_SEARCH_STATUS,\n\tRECOVER_MESSAGES_INTERVAL\n} from '../../constants';\nimport { StoreProvider } from '../../store/redux';\nimport { useAdvancedAccountStore } from '../../store/zustand/advanced-account/store';\nimport { useBackupSearchStore } from '../../store/zustand/backup-search/store';\n\nfunction calculateInterval(recoverDate: Date | null): { startDate?: Date; endDate?: Date } {\n\tif (!recoverDate) return {};\n\n\tconst startDate = new Date(recoverDate);\n\tconst endDate = new Date(recoverDate);\n\n\tstartDate.setUTCDate(recoverDate.getUTCDate() - RECOVER_MESSAGES_INTERVAL);\n\tendDate.setUTCDate(recoverDate.getUTCDate() + RECOVER_MESSAGES_INTERVAL + 1);\n\tendDate.setMilliseconds(endDate.getMilliseconds() - 1);\n\n\treturn { startDate, endDate };\n}\n\nexport const RecoverMessages = (): React.JSX.Element => {\n\tconst createModal = useModal();\n\tconst createSnackbar = useSnackbar();\n\tconst { zimbraPrefLocale } = useUserSettings().prefs;\n\tconst [searchString, setSearchString] = useState('');\n\tconst [recoverDay, setRecoverDay] = useState<Date | null>(null);\n\n\tconst restoreMessages = useCallback(\n\t\tasync (closeModal: CloseModalFn) => {\n\t\t\tif (!recoverDay && !searchString) return;\n\t\t\tconst backupSearchStoreState = useBackupSearchStore.getState();\n\n\t\t\tbackupSearchStoreState.setStatus(BACKUP_SEARCH_STATUS.loading);\n\t\t\tconst interval = calculateInterval(recoverDay);\n\t\t\tconst searchParams = {\n\t\t\t\t...interval,\n\t\t\t\t...(searchString === '' ? {} : { searchString })\n\t\t\t};\n\t\t\tconst response = await searchBackupDeletedMessagesAPI(searchParams);\n\t\t\tcloseModal();\n\n\t\t\tif ('error' in response) {\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `recover-messages-error`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\thideButton: true\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tbackupSearchStoreState.setStatus(BACKUP_SEARCH_STATUS.completed);\n\t\t\tbackupSearchStoreState.setMessages(response.data.messages);\n\t\t\tbackupSearchStoreState.setSearchParams(searchParams);\n\t\t\tsetRecoverDay(null);\n\t\t\tsetSearchString('');\n\n\t\t\tif (isEmpty(response.data.messages)) {\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `recover-no-messages-error`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\ttype: 'info',\n\t\t\t\t\tlabel: t('label.error_no_backup_messages', 'Your search did not find any message'),\n\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\thideButton: true\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treplaceHistory({ route: BACKUP_SEARCH_ROUTE, path: '/' });\n\t\t},\n\t\t[createSnackbar, recoverDay, searchString]\n\t);\n\n\tconst informativeText = t(\n\t\t'settings.label.recover_messages_infotext',\n\t\t`Recover e-mails deleted from the Trash by typing a keyword included within the first 100 characters of the message or by selecting a date.\\n\n        The selected date will include emails deleted 3 days before and 3 days after.\\n\n        Once the search is completed you will be redirected to the results page where you can choose which items to restore.`\n\t);\n\tconst buttonLabel = t('label.search_emails', 'SEARCH E-MAILS');\n\tconst datePickerLabel = t('label.select_recovery_date', 'Select recovery date');\n\tconst sectionTitle = recoverMessagesSubSection();\n\tconst { backupSelfUndeleteAllowed } = useAdvancedAccountStore();\n\n\tconst handleModalConfirmOnClick = useCallback(() => {\n\t\tconst closeModal = createModal(\n\t\t\t{\n\t\t\t\tchildren: (\n\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t<RecoverMessagesModal\n\t\t\t\t\t\t\tonClose={(): void => closeModal()}\n\t\t\t\t\t\t\tonConfirm={(): Promise<void> => restoreMessages(closeModal)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</StoreProvider>\n\t\t\t\t)\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}, [createModal, restoreMessages]);\n\n\tconst onDateTimePickerChange = useCallback((value) => {\n\t\tsetRecoverDay(value);\n\t}, []);\n\n\tconst handleTextFilterValueChange = useCallback((ev) => {\n\t\tsetSearchString(ev.target.value);\n\t}, []);\n\n\treturn backupSelfUndeleteAllowed ? (\n\t\t<FormSubSection\n\t\t\tid={sectionTitle.id}\n\t\t\tdata-testid=\"recover-messages-form\"\n\t\t\tlabel={sectionTitle.label}\n\t\t\tpadding={{ all: 'medium' }}\n\t\t>\n\t\t\t<Padding top=\"large\" />\n\t\t\t<Text style={{ whiteSpace: 'pre-line' }}>{informativeText}</Text>\n\t\t\t<Padding top=\"large\" />\n\t\t\t<Container width=\"100%\" crossAlignment=\"flex-start\">\n\t\t\t\t<Row width=\"30%\" mainAlignment=\"flex-start\">\n\t\t\t\t\t<Input\n\t\t\t\t\t\tvalue={searchString}\n\t\t\t\t\t\tonChange={handleTextFilterValueChange}\n\t\t\t\t\t\tlabel={t('settings.keyword', 'Keyword')}\n\t\t\t\t\t/>\n\t\t\t\t</Row>\n\t\t\t\t<Padding top=\"large\" />\n\t\t\t\t<Row width=\"30%\" mainAlignment=\"flex-start\">\n\t\t\t\t\t<DateTimePicker\n\t\t\t\t\t\tlabel={datePickerLabel}\n\t\t\t\t\t\tisClearable\n\t\t\t\t\t\twidth=\"fill\"\n\t\t\t\t\t\tonChange={onDateTimePickerChange}\n\t\t\t\t\t\ttimeCaption={t('label.time', 'Time')}\n\t\t\t\t\t\tincludeTime={false}\n\t\t\t\t\t\tlocale={zimbraPrefLocale}\n\t\t\t\t\t\tdateFormat=\"P\"\n\t\t\t\t\t/>\n\t\t\t\t</Row>\n\t\t\t\t<Padding top=\"large\" />\n\t\t\t\t<Row width=\"30%\" mainAlignment=\"flex-start\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\ttype={'outlined'}\n\t\t\t\t\t\tonClick={handleModalConfirmOnClick}\n\t\t\t\t\t\tlabel={buttonLabel}\n\t\t\t\t\t\tdisabled={!recoverDay && !searchString}\n\t\t\t\t\t/>\n\t\t\t\t</Row>\n\t\t\t</Container>\n\t\t</FormSubSection>\n\t) : (\n\t\t<></>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { apiWrapper } from '../carbonio-ui-commons/helpers/api-wrapper';\nimport type {\n\tSearchBackupDeletedMessagesResponse,\n\tSearchBackupDeletedMessagesAPIProps\n} from '../types';\n\nexport async function searchBackupDeletedMessagesAPI({\n\tstartDate,\n\tendDate,\n\tsearchString\n}: SearchBackupDeletedMessagesAPIProps): Promise<\n\t| {\n\t\t\tdata: SearchBackupDeletedMessagesResponse;\n\t  }\n\t| { error: unknown }\n> {\n\tconst searchURL = '/zx/backup/v1/searchDeleted';\n\tconst searchParams = new URLSearchParams();\n\tif (startDate) {\n\t\tsearchParams.set('after', startDate.toISOString());\n\t}\n\tif (endDate) {\n\t\tsearchParams.set('before', endDate.toISOString());\n\t}\n\tif (searchString) {\n\t\tsearchParams.set('searchString', searchString);\n\t}\n\n\tconst apiCall = fetch(`${searchURL}?${searchParams}`, {\n\t\tmethod: 'GET',\n\t\tcredentials: 'same-origin'\n\t});\n\n\treturn apiWrapper(apiCall);\n}\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React, { FC, ReactElement, useCallback, useMemo } from 'react';\nimport { Container, Text, Row, Select, SelectItem } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\nimport { find } from 'lodash';\nimport { NO_SIGNATURE_ID, NO_SIGNATURE_LABEL } from '../../../helpers/signatures';\nimport type { AccountIdentity, IdentityProps, SignItemType } from '../../../types';\n\ntype SelectIdentitySignProps = {\n\tacc: AccountIdentity;\n\tsignatures: SignItemType[];\n\tsignatureSelectItems: SelectItem[];\n\tupdateIdentities: (arg: { _attrs: IdentityProps }) => void;\n};\n\n// TODO remove the any after the DS\nconst SelectIdentitySignature: FC<SelectIdentitySignProps> = ({\n\tacc,\n\tsignatures,\n\tsignatureSelectItems,\n\tupdateIdentities\n}): ReactElement => {\n\tconst getSignature = useCallback(\n\t\t(id: string, fallbackOnFirst = false) => {\n\t\t\tconst result = find(signatures, ['id', id]);\n\t\t\tif (!result && fallbackOnFirst && signatures.length > 0) {\n\t\t\t\treturn signatures[0];\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\t[signatures]\n\t);\n\n\t// Create the fake signature for the \"no signature\"\n\tconst noSignature: SignItemType = useMemo(\n\t\t() => ({\n\t\t\tlabel: t('label.no_signature', NO_SIGNATURE_LABEL),\n\t\t\tname: 'no signature',\n\t\t\tdescription: '',\n\t\t\tid: NO_SIGNATURE_ID\n\t\t}),\n\t\t[]\n\t);\n\n\t// Get the selected signatures for the new message and for the replies\n\tconst [signatureNewMessage, signatureRepliesForwards] = useMemo<[SignItemType, SignItemType]>(\n\t\t() => [\n\t\t\tgetSignature(acc._attrs?.zimbraPrefDefaultSignatureId ?? '') ?? noSignature,\n\t\t\tgetSignature(String(acc._attrs?.zimbraPrefForwardReplySignatureId)) ?? noSignature\n\t\t],\n\t\t[\n\t\t\tacc._attrs?.zimbraPrefDefaultSignatureId,\n\t\t\tacc._attrs?.zimbraPrefForwardReplySignatureId,\n\t\t\tgetSignature,\n\t\t\tnoSignature\n\t\t]\n\t);\n\n\treturn (\n\t\t<Row width=\"100%\" padding={{ horizontal: 'small', vertical: 'small' }}>\n\t\t\t<Container\n\t\t\t\twidth=\"20%\"\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\tpadding={{ right: 'medium' }}\n\t\t\t>\n\t\t\t\t<Text>{acc.name}</Text>\n\t\t\t</Container>\n\t\t\t<Container width=\"40%\" padding={{ right: 'medium' }}>\n\t\t\t\t<Select\n\t\t\t\t\titems={signatureSelectItems}\n\t\t\t\t\tlabel={t('title.new_messages', 'New Messages')}\n\t\t\t\t\tselection={\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: signatureNewMessage?.label,\n\t\t\t\t\t\t\tvalue: signatureNewMessage?.id\n\t\t\t\t\t\t} as SelectItem\n\t\t\t\t\t}\n\t\t\t\t\tonChange={(selectedId: any): void => {\n\t\t\t\t\t\tif (selectedId === signatureNewMessage?.id) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tupdateIdentities({\n\t\t\t\t\t\t\t...acc,\n\t\t\t\t\t\t\t_attrs: { ...acc._attrs, zimbraPrefDefaultSignatureId: selectedId }\n\t\t\t\t\t\t});\n\t\t\t\t\t}}\n\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container width=\"40%\">\n\t\t\t\t<Select\n\t\t\t\t\titems={signatureSelectItems}\n\t\t\t\t\tlabel={t('title.replies_forwards', 'Replies & Forwards')}\n\t\t\t\t\tselection={\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: signatureRepliesForwards?.label,\n\t\t\t\t\t\t\tvalue: signatureRepliesForwards?.id\n\t\t\t\t\t\t} as SelectItem\n\t\t\t\t\t}\n\t\t\t\t\tonChange={(selectedId: any): void => {\n\t\t\t\t\t\tif (selectedId === signatureRepliesForwards?.id) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tupdateIdentities({\n\t\t\t\t\t\t\t...acc,\n\t\t\t\t\t\t\t_attrs: { ...acc._attrs, zimbraPrefForwardReplySignatureId: selectedId }\n\t\t\t\t\t\t});\n\t\t\t\t\t}}\n\t\t\t\t\tbackground=\"white\"\n\t\t\t\t\tstyle={{ border: '1px solid lightgray' }}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</Row>\n\t);\n};\n\nexport default SelectIdentitySignature;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\nimport { JSNS, soapFetch } from '@zextras/carbonio-shell-ui';\nimport { map, escape } from 'lodash';\n\nimport { SignItemType } from '../../types';\n\nexport type GetSignaturesRequest = {\n\t_jsns: typeof JSNS.account;\n};\n\nexport type GetSignaturesResponse = {\n\tsignature: Array<SignItemType>;\n\t_jsns: typeof JSNS.account;\n};\n\nexport const GetAllSignatures = (): Promise<GetSignaturesResponse> =>\n\tsoapFetch('GetSignatures', {\n\t\t_jsns: 'urn:zimbraAccount'\n\t});\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const SignatureRequest = createAsyncThunk('SignatureRequest', async (data: any) => {\n\tconst requests: any = {};\n\tconst { itemsAdd, itemsEdit, itemsDelete, account } = data;\n\tlet ItemsDeleteRequest = '';\n\tlet ItemsAddRequest = '';\n\tlet ItemsEditRequest = '';\n\tif (itemsDelete?.length) {\n\t\tItemsDeleteRequest = map(\n\t\t\titemsDelete,\n\t\t\t(sign) =>\n\t\t\t\t`<DeleteSignatureRequest xmlns=\"urn:zimbraAccount\" requestId='${sign.index}'><signature id='${sign.id}'/></DeleteSignatureRequest>`\n\t\t).join('');\n\t}\n\tif (itemsAdd?.length) {\n\t\tItemsAddRequest = map(\n\t\t\titemsAdd,\n\t\t\t(sign) =>\n\t\t\t\t`<CreateSignatureRequest  xmlns=\"urn:zimbraAccount\"><signature name='${\n\t\t\t\t\tsign.label\n\t\t\t\t}'><content type=\"text/html\">${escape(\n\t\t\t\t\tsign.description\n\t\t\t\t)}</content></signature></CreateSignatureRequest>`\n\t\t).join('');\n\t}\n\tif (itemsEdit?.length) {\n\t\tItemsEditRequest = map(\n\t\t\titemsEdit,\n\t\t\t(sign) => `<ModifySignatureRequest  xmlns=\"urn:zimbraAccount\"> \n\t\t\t<signature id='${sign.id}' name='${sign.label}'> \n\t\t\t\t<content type=\"text/html\">${escape(sign.description)}</content>\n\t\t\t</signature>\n\t\t</ModifySignatureRequest>`\n\t\t).join('');\n\t}\n\n\trequests.SignatureRequest = `<BatchRequest xmlns=\"urn:zimbra\" onerror=\"stop\">\n        ${ItemsDeleteRequest}    \n        ${ItemsAddRequest}    \n        ${ItemsEditRequest}    \n        </BatchRequest>`;\n\n\tconst res = await fetch('/service/soap/BatchRequest', {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'content-type': 'application/soap+xml'\n\t\t},\n\t\tbody: `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\t\t\t<soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\">\n\t\t\t\t<soap:Header>\n\t\t\t\t\t<context xmlns=\"urn:zimbra\">\n\t\t\t\t\t\t<account by=\"name\">${account.name}</account>\n\t\t\t\t\t\t<format type=\"js\"/>\n\t\t\t\t\t</context>\n\t\t\t\t</soap:Header>\n\t\t\t\t<soap:Body>\n\t\t\t\t\t${requests.SignatureRequest ?? ''}\t\t\t\t\n\t\t\t\t</soap:Body>\n\t\t\t</soap:Envelope>\n\t\t`\n\t});\n\tconst response = await res.json();\n\tif (response.Body.BatchResponse.Fault) {\n\t\tthrow new Error(response.Body.BatchResponse.Fault.Reason.Text);\n\t}\n\n\treturn { response };\n});\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { useMemo, useState, useEffect, useCallback, FC, ReactElement, useRef } from 'react';\n\nimport {\n\tContainer,\n\tFormSubSection,\n\tTextWithTooltip,\n\tInput,\n\tList,\n\tRow,\n\tPadding,\n\tSelectItem,\n\tButtonProps\n} from '@zextras/carbonio-design-system';\nimport { t, useIntegratedComponent } from '@zextras/carbonio-shell-ui';\nimport { map, unescape, reject, concat } from 'lodash';\nimport styled from 'styled-components';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport SelectIdentitySignature from './components/select-identity-signature';\nimport { signaturesSubSection, setDefaultSignaturesSubSection } from './subsections';\nimport { NO_SIGNATURE_ID, NO_SIGNATURE_LABEL } from '../../helpers/signatures';\nimport { GetAllSignatures } from '../../store/actions/signatures';\nimport type { SignatureSettingsPropsType, SignItemType } from '../../types';\nimport { FOREGROUND_COLOR } from '../../sruvi/EditedColors';\nimport { Button, IconButton } from '@mui/material';\nimport { Add, Delete } from '@mui/icons-material';\n\nconst DeleteButton = styled(Button)`\n\tdisplay: none;\n`;\n\nconst Signature = styled(Row)`\n\tborder-bottom: 0.0625rem solid ${({ theme }): string => theme.palette.gray2.regular};\n\tdisplay: block;\n\tborder-radius: 0;\n\tcursor: pointer;\n\n\t&:hover {\n\t\tbackground-color: ${({ theme }): string => theme.palette.gray6.focus};\n\n\t\t& ${DeleteButton} {\n\t\t\tdisplay: flex;\n\t\t}\n\t}\n`;\nconst EditorWrapper = styled.div`\n\twidth: 100%;\n\theight: 100%;\n\toverflow-y: auto;\n\tposition: relative;\n`;\n\n/**\n * Temporary type narrowed to the only properties/methods used in this context\n */\ntype EditorType = {\n\thasFocus: () => boolean;\n};\n\nconst SignatureSettings: FC<SignatureSettingsPropsType> = ({\n\tupdatedIdentities,\n\tupdateIdentities,\n\tsetDisabled,\n\tsignatures,\n\tsetSignatures,\n\tsetOriginalSignatures\n}): ReactElement => {\n\tconst [currentSignature, setCurrentSignature] = useState<SignItemType | undefined>(undefined);\n\tconst [Composer, composerIsAvailable] = useIntegratedComponent('composer');\n\tconst sectionTitleSignatures = useMemo(() => signaturesSubSection(), []);\n\tconst sectionTitleSetSignatures = useMemo(() => setDefaultSignaturesSubSection(), []);\n\tconst editorRef = useRef<{ editor: EditorType | undefined }>({\n\t\teditor: undefined\n\t});\n\n\tconst getEditor = (): EditorType | undefined => editorRef.current.editor;\n\n\tconst setEditor = (editor: EditorType): void => {\n\t\teditorRef.current.editor = editor;\n\t};\n\n\tconst onSignaturesLoaded = useCallback(\n\t\t(signs: Array<SignItemType>) => {\n\t\t\tconst signaturesItems = map(\n\t\t\t\tsigns,\n\t\t\t\t(item: SignItemType, idx) =>\n\t\t\t\t\t({\n\t\t\t\t\t\tlabel: item.name,\n\t\t\t\t\t\tname: item.name,\n\t\t\t\t\t\tid: item.id,\n\t\t\t\t\t\tdescription: unescape(item?.content?.[0]?._content)\n\t\t\t\t\t}) as SignItemType\n\t\t\t);\n\t\t\tsetSignatures(signaturesItems);\n\t\t\tsetOriginalSignatures(\n\t\t\t\tsignaturesItems.map((el) => ({\n\t\t\t\t\tid: el.id,\n\t\t\t\t\tname: el.label ?? '',\n\t\t\t\t\tlabel: el.label ?? '',\n\t\t\t\t\tdescription: el.description ?? ''\n\t\t\t\t}))\n\t\t\t);\n\t\t},\n\t\t[setOriginalSignatures, setSignatures]\n\t);\n\n\t// Fetches signatures from the BE\n\tuseEffect(() => {\n\t\tGetAllSignatures()\n\t\t\t.then(({ signature: signs }) => onSignaturesLoaded(signs))\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.error(err);\n\t\t\t});\n\t}, [onSignaturesLoaded]);\n\n\t// Set the default current signature if missing\n\tuseEffect(() => {\n\t\tif (signatures?.length && !currentSignature) {\n\t\t\tsetCurrentSignature(signatures[0]);\n\t\t}\n\t}, [currentSignature, setCurrentSignature, signatures]);\n\n\t// Creates an empty signature\n\tconst createEmptySignature = useCallback(\n\t\t(): SignItemType => ({\n\t\t\tid: uuidv4(),\n\t\t\tlabel: t('label.enter_name', 'Enter Name'),\n\t\t\tname: t('label.enter_name', 'Enter Name'),\n\t\t\tdescription: ''\n\t\t}),\n\t\t[]\n\t);\n\n\t// Creates and adds a new signature to the signatures list\n\tconst addNewSignature = useCallback((): void => {\n\t\tconst updatedSign = [...signatures];\n\t\tconst newSignature = createEmptySignature();\n\t\tupdatedSign.push(newSignature);\n\t\tsetSignatures(updatedSign);\n\t\tsetCurrentSignature(newSignature);\n\t}, [createEmptySignature, setSignatures, signatures]);\n\n\t// Create the fake signature for the \"no signature\"\n\tconst noSignature: SignItemType = useMemo(\n\t\t() => ({\n\t\t\tlabel: t('label.no_signature', NO_SIGNATURE_LABEL),\n\t\t\tname: 'no signature',\n\t\t\tdescription: '',\n\t\t\tid: NO_SIGNATURE_ID\n\t\t}),\n\t\t[]\n\t);\n\n\t// Composes the SelectItem array for the signature selects\n\tconst signatureSelectItems: SelectItem[] = useMemo(\n\t\t(): SelectItem[] =>\n\t\t\tconcat(noSignature, signatures).map((signature) => ({\n\t\t\t\tlabel: signature.label,\n\t\t\t\tvalue: signature.id\n\t\t\t})),\n\t\t[noSignature, signatures]\n\t);\n\n\tconst ListItem = ({ item }: { item: SignItemType }): ReactElement => {\n\t\tconst onSignatureClick = useCallback(\n\t\t\t(ev: React.MouseEvent & { target: { innerText?: string } }): void => {\n\t\t\t\tsetCurrentSignature({\n\t\t\t\t\tid: item.id,\n\t\t\t\t\tname: item.label ?? '',\n\t\t\t\t\tlabel: item.label ?? '',\n\t\t\t\t\tdescription: item.description ?? ''\n\t\t\t\t});\n\t\t\t},\n\t\t\t[item.description, item.id, item.label]\n\t\t);\n\n\t\tconst onDeleteButtonClick = useCallback(\n\t\t\t(ev: Parameters<ButtonProps['onClick']>[0]): void => {\n\t\t\t\tev.stopPropagation();\n\t\t\t\t// Create a new signature array copy without the deleted element\n\t\t\t\tconst updatedSignatureList = reject(signatures, ['id', item.id]);\n\t\t\t\tif (currentSignature?.id === item.id) {\n\t\t\t\t\tsetCurrentSignature(undefined);\n\t\t\t\t}\n\t\t\t\tsetSignatures(updatedSignatureList);\n\t\t\t\tsetDisabled(false);\n\t\t\t},\n\t\t\t[item.id]\n\t\t);\n\n\t\treturn (\n\t\t\t<Signature\n\t\t\t\theight=\"fit\"\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\tbackground={currentSignature?.id === item.id ? FOREGROUND_COLOR : ''}\n\t\t\t\tonClick={onSignatureClick}\n\t\t\t>\n\t\t\t\t<Row height=\"2.5rem\" padding={{ all: 'small' }}>\n\t\t\t\t\t<Container orientation=\"horizontal\" mainAlignment=\"space-between\">\n\t\t\t\t\t\t<TextWithTooltip weight=\"bold\">{item.label}</TextWithTooltip>\n\t\t\t\t\t\t<IconButton onClick={onDeleteButtonClick}>\n\t\t\t\t\t\t\t<Delete style={{ color: '#ff6600' }} />\n\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t</Container>\n\t\t\t\t</Row>\n\t\t\t</Signature>\n\t\t);\n\t};\n\n\tconst editingDisabled = useMemo<boolean>(\n\t\t(): boolean => currentSignature === undefined,\n\t\t[currentSignature]\n\t);\n\n\tconst onSignatureNameChange = useCallback(\n\t\t(ev: React.ChangeEvent<HTMLInputElement>): void => {\n\t\t\tif (!currentSignature) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst newName = ev.target.value;\n\t\t\tif (currentSignature?.name === newName) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetCurrentSignature(\n\t\t\t\t(current) =>\n\t\t\t\t\t({\n\t\t\t\t\t\t...current,\n\t\t\t\t\t\tname: newName,\n\t\t\t\t\t\tlabel: newName\n\t\t\t\t\t}) as SignItemType\n\t\t\t);\n\n\t\t\tconst updatedSignatures = signatures.map((signature) => {\n\t\t\t\tif (signature.id === currentSignature?.id) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...signature,\n\t\t\t\t\t\tlabel: newName,\n\t\t\t\t\t\tname: newName\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn signature;\n\t\t\t});\n\n\t\t\tsetDisabled(false);\n\t\t\tsetSignatures(updatedSignatures);\n\t\t},\n\t\t[currentSignature, setCurrentSignature, setDisabled, setSignatures, signatures]\n\t);\n\n\tconst onSignatureContentChange = useCallback(\n\t\t(ev: [string, string]): void => {\n\t\t\tif (!getEditor()?.hasFocus()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (currentSignature === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Rich text signature\n\t\t\tconst newDescription = ev[1];\n\n\t\t\tif (currentSignature?.description === newDescription) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsetCurrentSignature(\n\t\t\t\t(current) =>\n\t\t\t\t\t({\n\t\t\t\t\t\t...current,\n\t\t\t\t\t\tdescription: newDescription\n\t\t\t\t\t}) as SignItemType\n\t\t\t);\n\n\t\t\tconst updatedSign = signatures.map((signature) => {\n\t\t\t\tif (signature.id === currentSignature?.id && signature.description !== newDescription) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...signature,\n\t\t\t\t\t\tdescription: newDescription\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn signature;\n\t\t\t});\n\n\t\t\tsetDisabled(false);\n\t\t\tsetSignatures(updatedSign);\n\t\t},\n\t\t[currentSignature, setCurrentSignature, setDisabled, setSignatures, signatures]\n\t);\n\n\tconst onEditorInitialization = (editor: EditorType): void => {\n\t\tsetEditor(editor);\n\t};\n\n\tconst composerCustomOptions = {\n\t\tauto_focus: false,\n\t\tcontent_style: 'p { margin: 0; }',\n\t\tinit_instance_callback: onEditorInitialization\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<FormSubSection\n\t\t\t\tlabel={sectionTitleSignatures.label}\n\t\t\t\tid={sectionTitleSignatures.id}\n\t\t\t\tpadding={{ all: 'large' }}\n\t\t\t>\n\t\t\t\t<Container crossAlignment=\"flex-start\" orientation=\"horizontal\" padding={{ all: 'medium' }}>\n\t\t\t\t\t<Container width=\"25%\" padding={{ right: 'medium' }}>\n\t\t\t\t\t\t<Container mainAlignment=\"flex-start\">\n\t\t\t\t\t\t\t<Container>\n\t\t\t\t\t\t\t\t<DeleteButton\n\t\t\t\t\t\t\t\t\tstartIcon={<Add />}\n\t\t\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\t\t\tonClick={addNewSignature}\n\t\t\t\t\t\t\t\t\tdisabled={signatures?.length > 0 && !currentSignature?.name}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{t('signatures.add_signature', 'Add signature')}\n\t\t\t\t\t\t\t\t</DeleteButton>\n\t\t\t\t\t\t\t</Container>\n\t\t\t\t\t\t\t<Padding all=\"small\" />\n\n\t\t\t\t\t\t\t<Container height=\"31.25rem\">\n\t\t\t\t\t\t\t\t{signatures.length > 0 && (\n\t\t\t\t\t\t\t\t\t<List\n\t\t\t\t\t\t\t\t\t\tdata-testid={'signatures-list'}\n\t\t\t\t\t\t\t\t\t\titems={signatures ?? []}\n\t\t\t\t\t\t\t\t\t\tItemComponent={ListItem}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Container>\n\t\t\t\t\t\t</Container>\n\t\t\t\t\t</Container>\n\t\t\t\t\t<Container width=\"75%\" mainAlignment=\"flex-start\">\n\t\t\t\t\t\t<Container orientation=\"vertical\" mainAlignment=\"space-around\" width=\"100%\">\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tlabel={t('signatures.name', 'Name')}\n\t\t\t\t\t\t\t\tvalue={currentSignature?.name ?? ''}\n\t\t\t\t\t\t\t\tdisabled={editingDisabled}\n\t\t\t\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t\t\t\t\tonChange={onSignatureNameChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Container>\n\t\t\t\t\t\t<Padding all=\"small\" />\n\t\t\t\t\t\t{composerIsAvailable && (\n\t\t\t\t\t\t\t<EditorWrapper>\n\t\t\t\t\t\t\t\t<Composer\n\t\t\t\t\t\t\t\t\tdata-testid={'signature-editor'}\n\t\t\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\t\t\tvalue={currentSignature?.description ?? ''}\n\t\t\t\t\t\t\t\t\tcustomInitOptions={composerCustomOptions}\n\t\t\t\t\t\t\t\t\tdisabled={editingDisabled}\n\t\t\t\t\t\t\t\t\tonEditorChange={onSignatureContentChange}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</EditorWrapper>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Container>\n\t\t\t\t</Container>\n\t\t\t</FormSubSection>\n\t\t\t<FormSubSection\n\t\t\t\tlabel={sectionTitleSetSignatures.label}\n\t\t\t\tid={sectionTitleSetSignatures.id}\n\t\t\t\tpadding={{ all: 'large' }}\n\t\t\t>\n\t\t\t\t<Container crossAlignment=\"baseline\" padding={{ all: 'small' }}>\n\t\t\t\t\t{signatures.length > 0 &&\n\t\t\t\t\t\tmap(updatedIdentities, (acc) => (\n\t\t\t\t\t\t\t<SelectIdentitySignature\n\t\t\t\t\t\t\t\tacc={acc}\n\t\t\t\t\t\t\t\tsignatures={signatures}\n\t\t\t\t\t\t\t\tsignatureSelectItems={signatureSelectItems}\n\t\t\t\t\t\t\t\tupdateIdentities={updateIdentities}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t</Container>\n\t\t\t</FormSubSection>\n\t\t</>\n\t);\n};\n\nexport default SignatureSettings;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React, { FC, ReactElement, useCallback, useState } from 'react';\n\nimport { Container, Text, Row, Button } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\nimport styled from 'styled-components';\n\nconst ListItem = styled(Row)`\n\tborder-bottom: 0.0625rem solid ${({ theme }): string => theme.palette.gray2.regular};\n\tdisplay: block;\n\tborder-radius: 0;\n\tcursor: pointer;\n\tbackground-color: ${({ theme }): string => theme.palette.gray6.regular};\n\t&:hover {\n\t\tbackground-color: ${({ theme }): string => theme.palette.gray6.focus};\n\t}\n`;\n\n// TODO remove the any after the DS\nconst TrusteeListItem: FC<any> = ({ item, onRemove }): ReactElement => {\n\tconst [hovered, setHovered] = useState(false);\n\n\tconst onMouseEnter = useCallback(() => setHovered(true), []);\n\tconst onMouseLeave = useCallback(() => setHovered(false), []);\n\n\tconst onClick = useCallback(() => {\n\t\tonRemove(item.value);\n\t}, [item, onRemove]);\n\n\treturn (\n\t\t<ListItem\n\t\t\theight=\"fit\"\n\t\t\torientation=\"horizontal\"\n\t\t\tonMouseEnter={onMouseEnter}\n\t\t\tonMouseLeave={onMouseLeave}\n\t\t\tmainAlignment=\"center\"\n\t\t\tcrossAlignment=\"center\"\n\t\t>\n\t\t\t<Row height=\"2.5rem\" padding={{ all: 'small' }}>\n\t\t\t\t<Container width=\"80%\" crossAlignment=\"flex-start\">\n\t\t\t\t\t<Text size=\"small\">{item.value}</Text>\n\t\t\t\t</Container>\n\n\t\t\t\t<Container width=\"20%\" orientation=\"horizontal\" mainAlignment=\"flex-end\">\n\t\t\t\t\t{hovered && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\t\t\ttype=\"outlined\"\n\t\t\t\t\t\t\tlabel={t('label.remove_one', 'Remove')}\n\t\t\t\t\t\t\tonClick={onClick}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</Container>\n\t\t\t</Row>\n\t\t</ListItem>\n\t);\n};\n\nexport default TrusteeListItem;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { useMemo, useState, useCallback, useEffect } from 'react';\n\nimport {\n\tContainer,\n\tInput,\n\tPadding,\n\tDivider,\n\tButton,\n\tTooltip,\n\tList,\n\tTextWithTooltip,\n\tRow\n} from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\nimport { filter, find, map } from 'lodash';\n\nimport Heading from './components/settings-heading';\nimport TrusteeListItem from './components/trustee-list-item';\nimport LoadingShimmer from './filters/parts/loading-shimmer';\nimport { domainWhitelistSubSection } from './subsections';\nimport type { InputProps } from '../../types';\n\nconst NonSupportedCharacters = /[!#$%^&*()+=[\\]{};':\"\\\\|,<>/?|/^\\s*$/]+/;\nconst TrusteeAddresses = ({ settingsObj, updateSettings }: InputProps): React.JSX.Element => {\n\tconst [address, setAddress] = useState('');\n\tconst [isLoading, setIsLoading] = useState(true);\n\tconst [trusteeAddressesList, setTrusteeAddressList] = useState<string[]>([]);\n\tconst sectionTitle = useMemo(() => domainWhitelistSubSection(), []);\n\tconst message = useMemo(\n\t\t() =>\n\t\t\tt(\n\t\t\t\t'messages.trustee_addresses',\n\t\t\t\t'Mail from these addresses or domains will be considered trusted and images will automatically be displayed.'\n\t\t\t),\n\t\t[]\n\t);\n\n\tconst onRemove = useCallback(\n\t\t(item: string) => {\n\t\t\tconst newList = filter(trusteeAddressesList, (add) => add !== item);\n\n\t\t\tupdateSettings({\n\t\t\t\ttarget: {\n\t\t\t\t\tname: 'zimbraPrefMailTrustedSenderList',\n\t\t\t\t\tvalue: newList\n\t\t\t\t}\n\t\t\t});\n\t\t\tsetTrusteeAddressList(newList);\n\t\t},\n\t\t[trusteeAddressesList, updateSettings]\n\t);\n\n\tconst onAdd = useCallback(() => {\n\t\tupdateSettings({\n\t\t\ttarget: {\n\t\t\t\tname: 'zimbraPrefMailTrustedSenderList',\n\t\t\t\tvalue: [...trusteeAddressesList, address]\n\t\t\t}\n\t\t});\n\t\tsetTrusteeAddressList([...trusteeAddressesList, address]);\n\t\tsetAddress('');\n\t}, [address, trusteeAddressesList, updateSettings]);\n\n\tuseEffect(() => {\n\t\tconst trusteeList = settingsObj?.zimbraPrefMailTrustedSenderList;\n\t\tif (typeof trusteeList === 'string') setTrusteeAddressList([trusteeList]);\n\t\telse setTrusteeAddressList(trusteeList ?? []);\n\n\t\tsetIsLoading(false);\n\t}, [settingsObj?.zimbraPrefMailTrustedSenderList]);\n\n\tconst isInvalid = useMemo(\n\t\t() =>\n\t\t\t!!find(trusteeAddressesList, (ta) => ta === address) || NonSupportedCharacters.test(address),\n\t\t[address, trusteeAddressesList]\n\t);\n\n\tconst warningMessage = useMemo(\n\t\t() =>\n\t\t\tisInvalid\n\t\t\t\t? t('messages.invalid_trustee_address', 'Please enter only e-mail addresses or domains')\n\t\t\t\t: '',\n\t\t[isInvalid]\n\t);\n\n\tconst trusteeAddressesListItems = useMemo(\n\t\t() =>\n\t\t\tmap(trusteeAddressesList, (el) => ({\n\t\t\t\tid: el,\n\t\t\t\tvalue: el,\n\t\t\t\tlabel: el\n\t\t\t})),\n\t\t[trusteeAddressesList]\n\t);\n\n\treturn (\n\t\t<Container background=\"gray6\" padding={{ horizontal: 'medium', bottom: 'large' }}>\n\t\t\t<Container orientation=\"horizontal\" padding={{ horizontal: 'medium', top: 'medium' }}>\n\t\t\t\t<Container id={sectionTitle.id}>\n\t\t\t\t\t<Heading title={sectionTitle.label} size=\"medium\" />\n\t\t\t\t</Container>\n\t\t\t\t<Container width=\"auto\" crossAlignment=\"flex-end\">\n\t\t\t\t\t<TextWithTooltip size=\"extrasmall\">{message}</TextWithTooltip>\n\t\t\t\t</Container>\n\t\t\t</Container>\n\t\t\t<Divider />\n\t\t\t<Container\n\t\t\t\tpadding={{ all: 'medium', bottom: 'small' }}\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t>\n\t\t\t\t<Row mainAlignment=\"flex-start\" width=\"50vw\">\n\t\t\t\t\t<Input\n\t\t\t\t\t\tlabel={t('label.enter_email_address', 'Enter email address or domain')}\n\t\t\t\t\t\tvalue={address}\n\t\t\t\t\t\thasError={isInvalid}\n\t\t\t\t\t\tdescription={warningMessage}\n\t\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t\t\tonChange={(e: React.ChangeEvent<HTMLInputElement>): void => setAddress(e.target.value)}\n\t\t\t\t\t/>\n\t\t\t\t</Row>\n\t\t\t\t<Padding left=\"medium\">\n\t\t\t\t\t<Tooltip label={warningMessage} disabled={!isInvalid} maxWidth=\"100%\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tlabel={t('label.add', 'Add')}\n\t\t\t\t\t\t\ttype=\"outlined\"\n\t\t\t\t\t\t\tonClick={onAdd}\n\t\t\t\t\t\t\tdisabled={isInvalid}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</Padding>\n\t\t\t</Container>\n\t\t\t<Container\n\t\t\t\tpadding={{ horizontal: 'medium', bottom: 'small' }}\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t>\n\t\t\t\t{isLoading ? (\n\t\t\t\t\t<LoadingShimmer />\n\t\t\t\t) : (\n\t\t\t\t\t<List\n\t\t\t\t\t\titems={trusteeAddressesListItems}\n\t\t\t\t\t\tItemComponent={TrusteeListItem}\n\t\t\t\t\t\titemProps={{ onRemove }}\n\t\t\t\t\t\tdata-testid={'trustee-list'}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</Container>\n\t\t</Container>\n\t);\n};\n\nexport default TrusteeAddresses;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, useCallback, useMemo, useState } from 'react';\n\nimport { Container, FormSection } from '@zextras/carbonio-design-system';\nimport {\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\tSettingsHeader,\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\tSettingsHeaderProps,\n\teditSettings,\n\tt,\n\tuseUserAccount,\n\tuseUserSettings\n} from '@zextras/carbonio-shell-ui';\nimport { cloneDeep, filter, find, isEmpty, isEqual, map, reduce, remove } from 'lodash';\n\nimport { differenceIdentities, differenceObject, getPropsDiff } from './components/utils';\nimport ComposeMessage from './compose-msg-settings';\nimport DisplayMessagesSettings from './displaying-messages-settings';\nimport FilterModule from './filters';\nimport { useSignatureSettings } from './hooks/use-signature-settings';\nimport ReceivingMessagesSettings from './receiving-messages-settings';\nimport { RecoverMessages } from './recover-messages';\nimport SignatureSettings from './signature-settings';\nimport TrusteeAddresses from './trustee-addresses';\nimport { TIMEOUTS } from '../../constants';\nimport { NO_SIGNATURE_ID } from '../../helpers/signatures';\nimport { useAppDispatch } from '../../hooks/redux';\nimport { useUiUtilities } from '../../hooks/use-ui-utilities';\nimport { SignatureRequest } from '../../store/actions/signatures';\nimport type { AccountIdentity, PropsType, SignItemType } from '../../types';\nimport { Paper } from '@mui/material';\n\n/* to keep track of changes done to props we use 3 different values:\n * - originalProps is the status of the props when you open the settings for the first time\n * - currentProps is the current status of the props once saved successfully without refreshing the page\n * - updatedProps it is used to manipulate props settings values in controlled mode.\n * All of them will have originalProps as default value\n * To keep track of unsaved changes we compare updatedProps with currentProps\n *   */\nconst SettingsView: FC = () => {\n\tconst { prefs, props, attrs } = useUserSettings();\n\tconst account = useUserAccount();\n\tconst { identity } = cloneDeep(account.identities);\n\tconst defaultAccount = remove(identity, (acc: AccountIdentity) => acc.name === 'DEFAULT');\n\tconst identities = defaultAccount.concat(identity);\n\tconst { validate: validateSignatures } = useSignatureSettings();\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\tconst [settingsObj, setSettingsObj] = useState<AccountSettingsPrefs>({ ...prefs });\n\tconst [updatedSettings, setUpdatedSettings] = useState({});\n\tconst originalProps = useMemo(\n\t\t() =>\n\t\t\treduce(\n\t\t\t\tprops ?? {},\n\t\t\t\t(acc, v) => ({ ...acc, [v.name]: { app: v.zimlet, value: v._content } }),\n\t\t\t\t{}\n\t\t\t),\n\t\t[props]\n\t);\n\tconst [currentProps, setCurrentProps] = useState(originalProps);\n\tconst [updatedProps, setUpdatedProps] = useState<PropsType | Record<string, unknown>>(\n\t\toriginalProps\n\t);\n\n\tconst [currentIdentities, setCurrentIdentities] = useState(identities);\n\tconst [updatedIdentities, setUpdatedIdentities] = useState(identities);\n\tconst [signatures, setSignatures] = useState<SignItemType[]>(() => []);\n\tconst [originalSignatures, setOriginalSignatures] = useState(() => []);\n\tconst [disabled, setDisabled] = useState(true);\n\tconst [flag, setFlag] = useState(false);\n\n\tconst dispatch = useAppDispatch();\n\n\tconst { createSnackbar } = useUiUtilities();\n\n\tconst oldSettings = useMemo(() => {\n\t\tconst s = cloneDeep(prefs);\n\t\tif (s?.zimbraPrefNewMailNotificationAddress === undefined) {\n\t\t\ts.zimbraPrefNewMailNotificationAddress = '';\n\t\t}\n\t\tif (s?.zimbraPrefForwardReplySignatureId === undefined) {\n\t\t\ts.zimbraPrefForwardReplySignatureId = NO_SIGNATURE_ID;\n\t\t}\n\t\tif (s?.zimbraPrefDefaultSignatureId === undefined) {\n\t\t\ts.zimbraPrefDefaultSignatureId = NO_SIGNATURE_ID;\n\t\t}\n\t\treturn s;\n\t}, [prefs]);\n\n\tconst onClose = useCallback(() => {\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t// @ts-ignore\n\t\tsetSettingsObj({ ...prefs });\n\t\tsetUpdatedSettings({});\n\t\t// we discard only latest updates keeping successfully saved changes\n\t\tsetUpdatedProps(currentProps);\n\t\tsetUpdatedIdentities(identities);\n\t}, [currentProps, identities, prefs]);\n\n\tconst updateSettings = useCallback(\n\t\t(e) => {\n\t\t\tsetSettingsObj({ ...settingsObj, [e.target.name]: e.target.value });\n\t\t\tsetUpdatedSettings({ ...updatedSettings, [e.target.name]: e.target.value });\n\t\t},\n\t\t[settingsObj, updatedSettings]\n\t);\n\n\tconst updateProps = useCallback(\n\t\t(e) => {\n\t\t\tsetUpdatedProps({ ...updatedProps, [e.target.name]: e.target.value });\n\t\t},\n\t\t[updatedProps]\n\t);\n\n\tconst updateIdentities = useCallback(\n\t\t(e) => {\n\t\t\tconst data = map(updatedIdentities, (item: AccountIdentity) => {\n\t\t\t\tif (item.id === e.id) {\n\t\t\t\t\treturn e;\n\t\t\t\t}\n\t\t\t\treturn item;\n\t\t\t});\n\t\t\tsetUpdatedIdentities(data);\n\t\t},\n\t\t[updatedIdentities]\n\t);\n\n\tconst settingsToUpdate = useMemo(\n\t\t() => differenceObject(updatedSettings, oldSettings),\n\t\t[updatedSettings, oldSettings]\n\t);\n\n\tconst propsToUpdate = useMemo(\n\t\t() => getPropsDiff(currentProps, updatedProps),\n\t\t[currentProps, updatedProps]\n\t);\n\tconst identitiesToUpdate = useMemo(\n\t\t() => differenceIdentities(currentIdentities, updatedIdentities),\n\t\t[currentIdentities, updatedIdentities]\n\t);\n\n\tconst isDisabled = useMemo(\n\t\t() =>\n\t\t\tObject.keys(settingsToUpdate).length === 0 &&\n\t\t\tdisabled &&\n\t\t\tObject.keys(propsToUpdate).length === 0 &&\n\t\t\tObject.keys(identitiesToUpdate).length === 0,\n\t\t[settingsToUpdate, disabled, propsToUpdate, identitiesToUpdate]\n\t);\n\tconst setNewOrForwardSignatureId = useCallback(\n\t\t(itemsAdd, resp, oldSignatureId, isFowardSignature): void => {\n\t\t\tconst newOrForwardSignatureToSet = itemsAdd?.find(\n\t\t\t\t(item: SignItemType) => item.id === oldSignatureId\n\t\t\t);\n\t\t\tif (\n\t\t\t\t!!newOrForwardSignatureToSet &&\n\t\t\t\tresp?.payload?.response?.Body?.BatchResponse?.CreateSignatureResponse\n\t\t\t) {\n\t\t\t\tconst createdSignature =\n\t\t\t\t\tresp.payload.response.Body.BatchResponse.CreateSignatureResponse[0].signature;\n\t\t\t\tconst realSignatureId = createdSignature.find(\n\t\t\t\t\t(item: SignItemType) => item.name === newOrForwardSignatureToSet.label\n\t\t\t\t).id;\n\t\t\t\tconst signatureKey = isFowardSignature\n\t\t\t\t\t? 'zimbraPrefForwardReplySignatureId'\n\t\t\t\t\t: 'zimbraPrefDefaultSignatureId';\n\t\t\t\teditSettings({\n\t\t\t\t\tprefs: { [signatureKey]: realSignatureId }\n\t\t\t\t}).then(() => {\n\t\t\t\t\tsetUpdatedSettings({});\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t[]\n\t);\n\n\tconst saveChanges = useCallback<SettingsHeaderProps['onSave']>(() => {\n\t\tif (!isEqual(signatures, originalSignatures)) {\n\t\t\tconst validationResult = validateSignatures(signatures);\n\t\t\tif (validationResult.length) {\n\t\t\t\t// At the moment we show only the last error\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `signature-validation-error`,\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\tlabel: validationResult[validationResult.length - 1],\n\t\t\t\t\tautoHideTimeout: TIMEOUTS.SNACKBAR_DEFAULT_TIMEOUT,\n\t\t\t\t\thideButton: true,\n\t\t\t\t\treplace: true\n\t\t\t\t});\n\t\t\t\treturn Promise.allSettled([Promise.reject(new Error('Invalid signature'))]);\n\t\t\t}\n\n\t\t\tconst itemsDelete = filter(originalSignatures, (x: SignItemType) => {\n\t\t\t\tlet toggle = false;\n\t\t\t\tmap(signatures, (ele: SignItemType) => {\n\t\t\t\t\tif (x.id === ele?.id) toggle = true;\n\t\t\t\t});\n\t\t\t\treturn !toggle;\n\t\t\t});\n\n\t\t\tconst findNewSignatures = (\n\t\t\t\tupdated: Array<SignItemType>,\n\t\t\t\toriginal: Array<SignItemType>\n\t\t\t): Array<SignItemType> =>\n\t\t\t\tfilter(updated, (o1) => original.map((o2) => o2.id).indexOf(o1.id) === -1);\n\n\t\t\tconst itemsAdd = findNewSignatures(signatures, originalSignatures);\n\t\t\tconst itemsEdit = filter(signatures, (item: SignItemType) =>\n\t\t\t\tfind(\n\t\t\t\t\toriginalSignatures,\n\t\t\t\t\t(c: SignItemType): unknown =>\n\t\t\t\t\t\titem.id === c.id && (item.label !== c.label || item.description !== c.description)\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tconst isReplySignaturePrefisNew = settingsToUpdate.zimbraPrefForwardReplySignatureId;\n\t\t\tlet setForwardReplySignatureId = '';\n\t\t\tif (\n\t\t\t\tisReplySignaturePrefisNew &&\n\t\t\t\titemsAdd.length > 0 &&\n\t\t\t\titemsAdd.findIndex(\n\t\t\t\t\t(item: any) => item?.id === settingsToUpdate.zimbraPrefForwardReplySignatureId\n\t\t\t\t) !== -1\n\t\t\t) {\n\t\t\t\tsetForwardReplySignatureId = settingsToUpdate.zimbraPrefForwardReplySignatureId;\n\t\t\t\tdelete settingsToUpdate.zimbraPrefForwardReplySignatureId;\n\t\t\t}\n\n\t\t\tconst isDefaultSignaturePref = settingsToUpdate.zimbraPrefDefaultSignatureId;\n\t\t\tlet setDefaultSignatureId = '';\n\t\t\tif (\n\t\t\t\tisDefaultSignaturePref &&\n\t\t\t\titemsAdd.length > 0 &&\n\t\t\t\titemsAdd.findIndex(\n\t\t\t\t\t(item: any) => item.id === settingsToUpdate.zimbraPrefDefaultSignatureId\n\t\t\t\t) !== -1\n\t\t\t) {\n\t\t\t\tsetDefaultSignatureId = settingsToUpdate.zimbraPrefDefaultSignatureId;\n\t\t\t\tdelete settingsToUpdate.zimbraPrefDefaultSignatureId;\n\t\t\t}\n\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t// @ts-ignore\n\t\t\tdispatch(SignatureRequest({ itemsAdd, itemsEdit, itemsDelete, account })).then((resp) => {\n\t\t\t\t// setFetchSigns(true);\n\t\t\t\tif (setForwardReplySignatureId !== '') {\n\t\t\t\t\tsetNewOrForwardSignatureId(itemsAdd, resp, setForwardReplySignatureId, true);\n\t\t\t\t}\n\t\t\t\tif (setDefaultSignatureId !== '') {\n\t\t\t\t\tsetNewOrForwardSignatureId(itemsAdd, resp, setDefaultSignatureId, false);\n\t\t\t\t}\n\t\t\t\tif (resp.type.includes('fulfilled')) {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `new`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\tlabel: t('message.snackbar.settings_saved', 'Settings saved correctly'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t\tsetFlag(!flag);\n\t\t\t\t\tsetDisabled(true);\n\t\t\t\t} else {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `new`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tlet changes = {};\n\t\tif (Object.keys(settingsToUpdate).length > 0) {\n\t\t\tchanges = { ...changes, prefs: settingsToUpdate };\n\t\t}\n\t\tif (Object.keys(propsToUpdate).length > 0) {\n\t\t\tchanges = { ...changes, props: propsToUpdate };\n\t\t}\n\t\tif (Object.keys(identitiesToUpdate).length > 0) {\n\t\t\tchanges = { ...changes, identity: { modifyList: identitiesToUpdate } };\n\t\t}\n\t\tif (!isEmpty(changes)) {\n\t\t\tconst editResult = editSettings(changes).then((res) => {\n\t\t\t\tif (res.type.includes('fulfilled')) {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `new`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\tlabel: t('message.snackbar.settings_saved', 'Settings saved correctly'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t\t// saving new values only when request is performed successfully\n\t\t\t\t\tsetCurrentProps((a) => ({ ...a, ...propsToUpdate }));\n\t\t\t\t\t/* Update the current Identities with changes if identities updated\n\t\t\t\t\t\tand request is performed successfully\n\t\t\t\t\t*/\n\t\t\t\t\tif (Object.keys(identitiesToUpdate).length > 0) {\n\t\t\t\t\t\tsetCurrentIdentities(updatedIdentities);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `new`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn Promise.allSettled([editResult]);\n\t\t}\n\t\treturn Promise.allSettled([Promise.resolve()]);\n\t}, [\n\t\tsignatures,\n\t\toriginalSignatures,\n\t\tsettingsToUpdate,\n\t\tpropsToUpdate,\n\t\tidentitiesToUpdate,\n\t\tvalidateSignatures,\n\t\tdispatch,\n\t\taccount,\n\t\tcreateSnackbar,\n\t\tsetNewOrForwardSignatureId,\n\t\tflag,\n\t\tupdatedIdentities\n\t]);\n\n\tconst title = useMemo(() => t('label.mail_settings', 'Mails settings'), []);\n\treturn (\n\t\t<>\n\t\t\t<SettingsHeader onSave={saveChanges} onCancel={onClose} isDirty={!isDisabled} title={title} />\n\t\t\t<Container\n\t\t\t\torientation=\"vertical\"\n\t\t\t\tmainAlignment=\"baseline\"\n\t\t\t\tcrossAlignment=\"baseline\"\n\t\t\t\tbackground=\"white\"\n\t\t\t\tstyle={{ overflowY: 'auto' }}\n\t\t\t>\n\t\t\t\t<FormSection minWidth=\"calc(min(100%, 32rem))\">\n\t\t\t\t\t<Paper variant=\"outlined\" sx={{ padding: '1rem', width: '100%' }}>\n\t\t\t\t\t\t<DisplayMessagesSettings\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tsettingsObj={settingsObj}\n\t\t\t\t\t\t\tupdateSettings={updateSettings}\n\t\t\t\t\t\t\tupdatedProps={updatedProps}\n\t\t\t\t\t\t\tupdateProps={updateProps}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Paper>\n\t\t\t\t\t<Paper variant=\"outlined\" sx={{ padding: '1rem', width: '100%', marginTop: '16px' }}>\n\t\t\t\t\t\t<ReceivingMessagesSettings\n\t\t\t\t\t\t\tsettingsObj={settingsObj}\n\t\t\t\t\t\t\tupdateSettings={updateSettings}\n\t\t\t\t\t\t\tupdatedProps={updatedProps}\n\t\t\t\t\t\t\tupdateProps={updateProps}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Paper>\n\t\t\t\t\t<Paper variant=\"outlined\" sx={{ padding: '1rem', width: '100%', marginTop: '16px' }}>\n\t\t\t\t\t\t<RecoverMessages />\n\t\t\t\t\t\t<SignatureSettings\n\t\t\t\t\t\t\tsettingsObj={settingsObj}\n\t\t\t\t\t\t\tsetSignatures={setSignatures}\n\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tsetOriginalSignatures={setOriginalSignatures}\n\t\t\t\t\t\t\tupdateSettings={updateSettings}\n\t\t\t\t\t\t\tupdatedIdentities={updatedIdentities}\n\t\t\t\t\t\t\tupdateIdentities={updateIdentities}\n\t\t\t\t\t\t\tsetDisabled={setDisabled}\n\t\t\t\t\t\t\tsignatures={signatures}\n\t\t\t\t\t\t\tflag={flag}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Paper>\n\t\t\t\t\t{/* eslint-disable-next-line @typescript-eslint/ban-ts-comment */}\n\t\t\t\t\t{/* @ts-ignore */}\n\t\t\t\t\t<Paper variant=\"outlined\" sx={{ padding: '1rem', width: '100%', marginTop: '16px' }}>\n\t\t\t\t\t\t<ComposeMessage settingsObj={settingsObj} updateSettings={updateSettings} />\n\t\t\t\t\t</Paper>\n\t\t\t\t\t<Paper variant=\"outlined\" sx={{ padding: '1rem', width: '100%', marginTop: '16px' }}>\n\t\t\t\t\t\t<FilterModule />\n\t\t\t\t\t</Paper>\n\t\t\t\t\t<Paper variant=\"outlined\" sx={{ padding: '1rem', width: '100%', marginTop: '16px' }}>\n\t\t\t\t\t\t<TrusteeAddresses settingsObj={settingsObj} updateSettings={updateSettings} />\n\t\t\t\t\t</Paper>\n\t\t\t\t</FormSection>\n\t\t\t</Container>\n\t\t</>\n\t);\n};\n\nexport default SettingsView;\n","/*\n * SPDX-FileCopyrightText: 2024 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { useCallback } from 'react';\n\nimport { useUserSettings } from '@zextras/carbonio-shell-ui';\nimport { TFunction } from 'i18next';\nimport { useTranslation } from 'react-i18next';\n\nimport { SignItemType } from '../../../types';\n\nexport type UseSignatureSettingsResult = {\n\tvalidate: (signatures: Array<SignItemType>) => Array<string>;\n};\n\nexport const getNameLengthErrorMessageKey = (\n\tsignature: SignItemType,\n\tt: TFunction\n): string | null => {\n\tif (signature.name === undefined || signature.name.trim() === '') {\n\t\treturn t('label.signature_required', 'Signature information is required.');\n\t}\n\treturn null;\n};\n\nexport const getContentLengthErrorMessageKey = (\n\tsignature: SignItemType,\n\tlimit: number | undefined,\n\tt: TFunction\n): string | null => {\n\tif (!signature.description || signature.description.trim() === '') {\n\t\treturn t('label.signature_required', 'Signature information is required.');\n\t}\n\n\tif (!limit) {\n\t\treturn null;\n\t}\n\n\tif (signature.description.trim().length > limit) {\n\t\treturn t('label.signature_size_exceed', 'One or more signatures exceed the size limit.');\n\t}\n\treturn null;\n};\n\nexport const useSignatureSettings = (): UseSignatureSettingsResult => {\n\tconst { attrs } = useUserSettings();\n\tconst [t] = useTranslation();\n\n\tconst validate = useCallback(\n\t\t(signatures: Array<SignItemType>): Array<string> => {\n\t\t\tconst errors = new Set<string | null>();\n\t\t\tsignatures.forEach((signature) => {\n\t\t\t\terrors.add(getNameLengthErrorMessageKey(signature, t));\n\t\t\t\terrors.add(\n\t\t\t\t\tgetContentLengthErrorMessageKey(signature, Number(attrs.zimbraMailSignatureMaxLength), t)\n\t\t\t\t);\n\t\t\t});\n\n\t\t\treturn Array.from(errors).reduce<Array<string>>((result, error): Array<string> => {\n\t\t\t\tif (error !== null) {\n\t\t\t\t\tresult.push(error);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}, []);\n\t\t},\n\t\t[attrs.zimbraMailSignatureMaxLength, t]\n\t);\n\n\treturn { validate };\n};\n"],"names":["rotate","keyframes","AnimatedLoaderSvg","styled","withConfig","displayName","componentId","AnimatedLoader","props","React","_extends","id","xmlns","viewBox","shapeRendering","textRendering","fill","d","stroke","strokeWidth","transform","async","apiWrapper","promise","Promise","allSettled","then","result","status","responseBody","value","text","data","JSON","parse","error","reason","P_TAG","BR_TAG","DIV_TAG","SCRIPT_TAG","STYLE_TAG","convertHtmlToPlainText","html","replace","DOMParser","parseFromString","body","textContent","StyledGapContainer","Container","theme","gap","getPadding","StyledGapRow","Row","GapContainer","children","rest","ref","GapRow","NO_SIGNATURE_ID","NO_SIGNATURE_LABEL","PLAINTEXT_SIGNATURE_REGEX","RegExp","LineType","SIGNATURE_PRE_SEP","PLAINTEXT_SEP","getMailBodyWithSignature","signatureId","signatureValue","getSignatureValue","account","getSignature","fallbackOnFirst","signatures","signatureArray","label","description","map","signature","item","push","name","content","_content","getSignatures","find","undefined","getUserAccount","plainSignatureValue","richText","replaceSignatureOnHtmlBody","newSignature","doc","signatureWrappers","getElementsByClassName","SIGNATURE_CLASS","signatureWrapper","separator","getElementById","HTML_SEP_ID","compareDocumentPosition","Node","DOCUMENT_POSITION_FOLLOWING","innerHTML","documentElement","plainText","replaceSignatureOnPlainTextBody","match","quotedTextSeparatorPos","indexOf","index","FOREGROUND_COLOR","SelectFolderModal","folder","onClose","headerTitle","actionLabel","actionTooltip","disabledActionTooltip","inputLabel","confirmAction","showSharedAccounts","showTrashFolder","showSpamFolder","allowFolderCreation","allowRootSelection","folderDestination","setFolderDestination","useState","onConfirm","useCallback","isConfirmDisabled","useMemo","isNil","l","confirmActionTooltip","t","padding","all","mainAlignment","crossAlignment","height","style","overflowY","ModalHeader","title","Text","overflow","FolderSelector","selectedFolderId","onFolderSelected","ModalFooter","tooltip","secondaryAction","secondaryLabel","disabled","findLabel","list","filter","Heading","size","Padding","top","right","width","weight","bottom","LabelFactory","selected","open","focus","ColorContainer","orientation","borderRadius","background","minHeight","takeAvailableSpace","left","color","TextUpperCase","Icon","icon","alignSelf","CustomSelect","onChange","defaultSelection","items","newItems","el","customComponent","getItems","Select","border","maxHeight","dropdownWidth","ColorBox","PopOver","ColorPicker","popover","useRef","isOpen","setIsOpen","close","handler","useEffect","startedInside","startedWhenMounted","listener","event","current","contains","target","validateEventStart","document","addEventListener","removeEventListener","cursor","onClick","position","HexColorPicker","useClickOutside","ComposeMessage","settingsObj","updateSettings","setColor","zimbraPrefHtmlEditorDefaultFontColor","sectionTitle","composingMsgSubSection","fontSizesOptions","count","defaultValue","fontsOptions","onColorChange","defaultSelectionFontSize","zimbraPrefHtmlEditorDefaultFontSize","defaultSelectionFont","zimbraPrefHtmlEditorDefaultFontFamily","isDisabled","zimbraPrefComposeFormat","FormSubSection","horizontal","RadioGroup","newValue","Radio","maxWidth","minWidth","DisplayingMessagesSettings","updateProps","updatedProps","checkNewMailOptions","CheckNewMailOptions","isSecondsFormat","zimbraPrefMailPollingInterval","includes","isMinutesFormat","defaultValue_plural","displayMailOptions","messageSelectionOptions","conversationSortingSettings","unsendTimeOptions","displayingMessagesSubSection","onChangeSorting","view","defaultSelectionSorting","zimbraPrefConversationOrder","defaultUnsendTime","mails_snackbar_delay","vertical","zimbraPrefMessageViewHtmlPreferred","zimbraPrefMailSelectAfterDelete","app","MAIL_APP_ID","zimbraPrefGroupMailBy","Input","zimbraPrefMailInitialSearch","e","zimbraPrefMarkMsgRead","display","FilterContext","createContext","incomingFilters","incomingLoading","outgoingFilters","outgoingLoading","ContainerEl","Filter","palette","gray2","regular","gray6","ButtonEl","primary","FilterItem","unSelect","listProps","toggle","moveDown","moveUp","_onClick","disableMoveUp","disableMoveDown","length","hovered","setHovered","onMouseEnter","onMouseLeave","onMoveUp","onMoveDown","useRemoveFilter","createSnackbar","useUiUtilities","activeList","availableList","setFilters","setFetchFilters","modifierFunc","activeFiltersCopy","slice","availableFiltersCopy","activeFilter","Object","keys","activeIndex","findIndex","splice","active","newFilters","concat","catch","key","hideButton","type","message","autoHideTimeout","useAddFilter","CreateFilterContext","setNewFilters","arg","toolTipText","checkboxLabel","checked","onSecondaryAction","Divider","Checkbox","Tooltip","Button","getConditionStatements","stringComparison","negative","getConditionAction","zimbraFeatureMailForwardingInFiltersEnabled","findDefaultValue","getButtonInfo","filterName","filters","isCreate","filterActions","actions","isEmpty","forEach","actionTag","action","tagName","actionFileInto","files","folderPath","actionRedirect","address","a","DefaultCondition","conditionStatementsOptions","loadData","setLoadData","setValue","selectValue","setSelectValue","useContext","tmpFilters","filterTests","headerTest","header","handleStatementChange","handleValueChange","ev","previousOption","backgroundColor","placeholder","MessageCondition","isOptions","getIsOptions","msgOptions","where","flagName","getMessageOptions","is","setIs","previousTemp","conversationTest","bulkTest","listTest","flaggedTest","handleIsChange","handleOptionChange","defaultIsOption","test","defaultMsgOption","FromToCondition","domainOptions","getDomainOptions","part","setPart","addressTest","handelPartChange","defaultDomain","SizeCondition","sizeOptions","numberComparison","getSizeOptions","sizeUnitsOptions","getSizeUnit","query","setQuery","sizeUnit","setSizeUnit","setSize","sizeTest","s","handleQueryChange","handleSizeUnitChange","handleSizeChange","defaultSizeOption","defaultSizeUnitOption","sizeArray","split","unit","pop","join","DateCondition","dateOptions","dateComparison","getDateOptions","date","setDate","moment","format","dateTest","handleDateChange","defaultDate","Date","DateTimePicker","includeTime","dateFormat","BodyCondition","bodyOptions","getBodyOptions","bodyTest","defaultBodyOption","AttachmentCondition","existsOptions","getExistOptions","defaultOption","attachmentTest","ReadReceiptCondition","getReadReceiptOptions","mimeHeaderTest","AddressInCondition","fromOptions","getFromOptions","inOptions","getInOptions","folderOptions","getFolderOptions","setHeader","sender","setSender","setType","addressBookTest","contactRankingTest","handleFromChange","handleSenderChange","handleTypeChange","defaultFromOption","defaultInOption","showFolderOption","defaultFolderOption","CalendarCondition","inviteRspOptions","method","getInviteRspOptions","inviteTest","HeaderCondition","handleHeaderChange","SocialCondition","socialOptions","linkedinTest","twitterTest","facebookTest","getSocialOptions","StyledIconButton","IconButton","iconColor","getColor","String","FilterTestRows","tmpFilter","compProps","condition","statusOptions","keyName","getStatusOptions","addFilterCondition","previousNewFilters","actionKeep","actionStop","comp","removeFilterCondition","indexToRemove","disableRemove","getRow","indexToGet","getRowFunc","str","temp","tests","capitalise","onRemove","placement","FilterTestConditionRow","setCondition","selectedFilter","fieldOptions","getFieldOptions","FilterActionRows","tagOptions","isIncoming","tempActions","setTempActions","setOpen","setActiveIndex","destination","setDestination","isRedirectToActionRemoved","setIsRedirectToActionRemoved","actionOptions","getActionOptions","markAsOptions","actionFlag","getMarkAsOptions","tag","setTag","previousTempActions","uuidv4","activeActionOption","setActiveActionOption","showMarksAsBtn","showRedirectToAddrsInput","contacts","setContacts","ContactInput","integrationAvailable","useIntegratedComponent","users","previous","email","onModalClose","omit","chipBg","hasAvatar","avatarIcon","avatarBackground","ZIMBRA_STANDARD_COLORS","hex","defaultMarkAsOption","showBrowseBtn","onActionOptionChange","actionDiscard","tagDetails","folderDetail","openFolderModalDisabled","showTagOptions","tagChipOnAdd","openModal","onTagChange","chip","requiredTag","handleMarkAsOptionChange","option","_onModalClose","absFolderPath","disablePortal","maxChips","ChipInput","options","singleSelection","onAdd","disableOptions","CustomModal","FilterActionConditions","getTags","customColor","tempAction","modifyFilterRules","soapFetch","filterRules","filterRule","newRules","_jsns","modifyOutgoingFilterRules","CreateFilterModal","setFetchIncomingFilters","setIncomingFilters","setFilterName","setActiveFilter","dontProcessAddFilters","setDontProcessAddFilters","useUserSettings","attrs","finalActions","reduce","acc","i","firstKey","accWithoutId","toggleActiveFilter","onFilterNameChange","modalTitle","activeFilterLabel","requiredFilterTest","allTest","f","requiredFilters","createFilterDisabled","buttonTooltip","incomingFiltersCopy","toSend","toggleCheckBox","filterActionProps","filterTestConditionRowProps","Provider","overflowX","DeleteFilterModal","deleteFilter","useDeleteFilter","onConfirmDelete","paddingLeft","paddingRight","getTestComponent","valueOf","findRowKey","ModifyFilterModal","copyRequiredFilters","setCopyRequiredFilters","reFetch","setReFetch","updateRequiredFilters","setUpdateRequiredFilters","isEqual","prev","useLayoutEffect","previousActions","val","setCopyOfFilter","setTimeout","previousFilterTests","tempTests","testName","modifiedNewFilters","selectedFilterIndex","filterCopy","isSoapError","response","StyledSpan","bold","TextStyler","defaultExecutionConfig","showThrashFolder","hintText","confirmActionLabel","disabledConfirmActionTooltip","ApplyFilterModal","criteria","closeModal","createModal","useModal","useSnackbar","setFolder","involvedMessagesCount","n","confirmEnabled","secondaryActionLabel","onConfirmAction","ruleName","messagesId","foldersId","folderCriteria","folderId","composeFoldersIdSoapCriteria","messagesCriteria","ids","composeMessagesIdSoapCriteria","soapResult","m","reject","Fault","Reason","resolve","applyFilterRules","serviceResult","TIMEOUTS","SNACKBAR_DEFAULT_TIMEOUT","err","onCancelAction","folderChips","getFolderIconColor","showCloseIcon","iconAction","onAddFolder","GenericActionDescriptors","SELECT_FOLDERS","params","uiUtilities","callbacks","config","mergeDefaultExecutionConfig","ModalManager","selectedFolder","onCancel","onComplete","chips","requireUniqueChips","Trans","i18nKey","confirmLabel","confirmDisabled","IncomingFilterActions","isAvailableFilterSelected","isActiveFilterSelected","disableAdd","disableEdit","disableDelete","disableApply","selectedActiveFilterName","selectedAvailableFilterName","selectedFilterName","applySelectedFilter","FilterActionsDescriptors","APPLY","executionParams","openCreateModal","StoreProvider","openDeleteModal","removeFilter","addFilter","openFilterModifyModal","iconPlacement","LoadingShimmer","Shimmer","FormSection","useFilterSelection","firstList","modifyFunc","secondList","setSelected","isSelecting","setIsSelecting","setList","selectItem","tmp","index2","itemBelow","cloneDeep","itemAbove","IncomingMsgFilterTab","selectedFilterType","available","actionButtonsProps","List","ItemComponent","itemProps","CreateOutgoingFilterModal","setFetchOutgoingFilters","setOutgoingFilters","outgoingFiltersCopy","DeleteOutgoingFilterModal","deleteOutgoingFilter","useDeleteOutgoingFilter","ModifyOutgoingFilterModal","OutgoingFilterActions","disablCreate","ModalManagerContext","OutgoingMsgFilterTab","getOutgoingFilters","createAsyncThunk","FilterTabs","setSelectedFilterType","tabs","selectedId","dispatch","useAppDispatch","setIncomingLoading","setOutgoingLoading","fetchIncomingFilters","fetchOutgoingFilters","testKey","filterTest","normalizeFilterRulesFromSoap","getIncomingFilters","res","payload","listSetter","TabBar","IncomingMessageFilterTab","OutgoingMessageFilterTab","FilterModule","filtersSubSection","ReceivingMessagesSettings","notifyFolderOptn","readReceiptOptn","msgsFromMeOpts","receivingMessagesSubSection","mailNotificationSoundDefault","mailNotificationSound","zimbraPrefNewMailNotificationAddress","zimbraPrefMailToasterEnabled","zimbraPrefShowAllNewMailNotifications","zimbraPrefMailSendReadReceipts","zimbraPrefDedupeMessagesSentToSelf","zimbraPrefMessageIdDedupingEnabled","RecoverMessagesModal","isLoading","useBackupSearchStore","BACKUP_SEARCH_STATUS","loading","modalHeaderTitle","modalFooterLabel","loadingSubText","whiteSpace","primaryButtonIcon","RecoverMessages","zimbraPrefLocale","prefs","searchString","setSearchString","recoverDay","setRecoverDay","restoreMessages","backupSearchStoreState","getState","setStatus","searchParams","recoverDate","startDate","endDate","setUTCDate","getUTCDate","RECOVER_MESSAGES_INTERVAL","setMilliseconds","getMilliseconds","calculateInterval","URLSearchParams","set","toISOString","apiCall","fetch","credentials","searchBackupDeletedMessagesAPI","completed","setMessages","messages","setSearchParams","replaceHistory","route","BACKUP_SEARCH_ROUTE","path","informativeText","buttonLabel","datePickerLabel","recoverMessagesSubSection","backupSelfUndeleteAllowed","useAdvancedAccountStore","handleModalConfirmOnClick","onDateTimePickerChange","handleTextFilterValueChange","isClearable","timeCaption","locale","SelectIdentitySignature","signatureSelectItems","updateIdentities","noSignature","signatureNewMessage","signatureRepliesForwards","_attrs","zimbraPrefDefaultSignatureId","zimbraPrefForwardReplySignatureId","selection","SignatureRequest","requests","itemsAdd","itemsEdit","itemsDelete","ItemsDeleteRequest","ItemsAddRequest","ItemsEditRequest","sign","escape","headers","json","Body","BatchResponse","Error","DeleteButton","Signature","EditorWrapper","SignatureSettings","updatedIdentities","setDisabled","setSignatures","setOriginalSignatures","currentSignature","setCurrentSignature","Composer","composerIsAvailable","sectionTitleSignatures","signaturesSubSection","sectionTitleSetSignatures","setDefaultSignaturesSubSection","editorRef","editor","onSignaturesLoaded","signs","signaturesItems","idx","unescape","console","createEmptySignature","addNewSignature","updatedSign","editingDisabled","onSignatureNameChange","newName","updatedSignatures","onSignatureContentChange","hasFocus","newDescription","composerCustomOptions","auto_focus","content_style","init_instance_callback","setEditor","startIcon","Add","variant","ListItem","onSignatureClick","onDeleteButtonClick","stopPropagation","updatedSignatureList","TextWithTooltip","Delete","customInitOptions","onEditorChange","TrusteeListItem","NonSupportedCharacters","TrusteeAddresses","setAddress","setIsLoading","trusteeAddressesList","setTrusteeAddressList","domainWhitelistSubSection","newList","add","trusteeList","zimbraPrefMailTrustedSenderList","isInvalid","ta","warningMessage","trusteeAddressesListItems","hasError","SettingsView","useUserAccount","identity","identities","remove","validate","validateSignatures","useSignatureSettings","useTranslation","errors","Set","getNameLengthErrorMessageKey","trim","getContentLengthErrorMessageKey","limit","Number","zimbraMailSignatureMaxLength","Array","from","setSettingsObj","updatedSettings","setUpdatedSettings","originalProps","v","zimlet","currentProps","setCurrentProps","setUpdatedProps","currentIdentities","setCurrentIdentities","setUpdatedIdentities","originalSignatures","flag","setFlag","oldSettings","settingsToUpdate","changes","object","base","isObject","propsToUpdate","getPropsDiff","original","modified","identitiesToUpdate","differenceIdentities","matched","setNewOrForwardSignatureId","resp","oldSignatureId","isFowardSignature","newOrForwardSignatureToSet","CreateSignatureResponse","realSignatureId","signatureKey","editSettings","saveChanges","validationResult","x","ele","updated","o1","o2","c","isReplySignaturePrefisNew","setForwardReplySignatureId","isDefaultSignaturePref","setDefaultSignatureId","findNewSignatures","modifyList","editResult","SettingsHeader","onSave","isDirty","Paper","sx","DisplayMessagesSettings","marginTop"],"sourceRoot":""}