"use strict";(self.webpackChunkcarbonio_mails_ui=self.webpackChunkcarbonio_mails_ui||[]).push([[397],{6279:(e,a,t)=>{t.d(a,{A:()=>d});var l=t(7559),n=t.n(l),o=t(4702),r=t(7196),i=t(6509);const s=({selected:e,label:a,open:t,focus:l})=>n().createElement(i.ZN,{orientation:"horizontal",width:"fill",crossAlignment:"center",mainAlignment:"space-between",borderRadius:"half",background:"gray5",padding:{all:"small"}},n().createElement(o.Row,{width:"100%",takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Row,{orientation:"vertical",crossAlignment:"flex-start",mainAlignment:"flex-start",padding:{left:"small"}},n().createElement(o.Text,{size:"small",color:t||l?"primary":"secondary"},a),n().createElement(i.qN,null,e[0].label)),n().createElement(o.Padding,{right:"small"},n().createElement(i.M6,{color:r.ZIMBRA_STANDARD_COLORS[parseInt(e[0].value,10)].hex}))),n().createElement(o.Icon,{size:"large",icon:t?"ChevronUpOutline":"ChevronDownOutline",color:t||l?"primary":"secondary",style:{alignSelf:"center"}}));function c(e){return(0,r.t)(`color.${e}`,"{{color}}",{context:r.ZIMBRA_STANDARD_COLORS,replace:{color:e}})}function d({onChange:e,defaultColor:a=0,label:t}){const d=(0,l.useMemo)((()=>r.ZIMBRA_STANDARD_COLORS.map(((e,a)=>({label:c(e.zLabel),value:a.toString(),customComponent:n().createElement(o.Container,{width:"100%",mainAlignment:"space-between",orientation:"horizontal",height:"fit"},n().createElement(o.Padding,{left:"small"},n().createElement(i.qN,null,c(e.zLabel))),n().createElement(i.M6,{color:e.hex}))})))),[]),m=(0,l.useMemo)((()=>d[a]),[d,a]);return n().createElement(o.Select,{label:t,onChange:e,items:d,defaultSelection:m,LabelFactory:s,"data-testid":"color-select"})}},612:(e,a,t)=>{t.d(a,{E7:()=>o,kL:()=>n});var l=t(2509);const n=(e,a)=>[{label:e("share.options.share_calendar_role.none","None"),value:""},{label:e("share.options.share_calendar_role.viewer","Viewer"),value:a?"rp":"r"},{label:e("share.options.share_calendar_role.admin","Admin"),value:a?"rwidxap":"rwidxa"},{label:e("share.options.share_calendar_role.manager","Manager"),value:a?"rwidxp":"rwidx"}],o=(e,a)=>(0,l.filter)(e,(e=>e.value===a))[0]?.label},9452:(e,a,t)=>{t.d(a,{v:()=>n});var l=t(7196);function n({parentFolderId:e,name:a}){return(0,l.soapFetch)("CreateFolder",{_jsns:"urn:zimbraMail",folder:{view:"message",l:e||l.FOLDERS.INBOX,name:a}})}},6784:(e,a,t)=>{t.d(a,{A:()=>b});var l=t(7559),n=t.n(l),o=t(4702),r=t(7196),i=t(2509),s=t(9628),c=t(9902),d=t(9518),m=t(7625),g=t(7656),u=t(9452),p=t(9431);const b=({selectedIDs:e,isMessageView:a,isRestore:t,deselectAll:b,onClose:h,folderId:f,dispatch:E})=>{const{createSnackbar:_}=(0,m.m)(),[v,k]=(0,l.useState)(""),[w,C]=(0,l.useState)(),[y,A]=(0,l.useState)(!0),M=(0,l.useCallback)((()=>{A(!0),k(""),C(void 0),h()}),[h]),T=(0,l.useCallback)((a=>{E((0,g.Rs)({operation:"move",ids:e,parent:a})).then((e=>{e.type.includes("fulfilled")?(b?.(),_({key:"edit",replace:!0,type:"info",label:t?(0,r.t)("messages.snackbar.email_restored","E-mail restored in destination folder"):(0,r.t)("messages.snackbar.conversation_move","Conversation successfully moved"),autoHideTimeout:3e3,actionLabel:(0,r.t)("action.goto_folder","GO TO FOLDER"),onActionClick:()=>{(0,r.replaceHistory)(`/folder/${a}`)}})):_({key:"edit",replace:!0,type:"error",label:(0,r.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0}),A(!1),M()})).catch((()=>i.noop))}),[E,e,M,b,_,t]),S=(0,l.useCallback)(((a=0)=>{E((0,g.SU)({operation:"move",ids:e,parent:a})).then((e=>{e.type.includes("fulfilled")?(b?.(),_({key:"edit",replace:!0,type:"info",label:t?(0,r.t)("messages.snackbar.email_restored","E-mail restored in destination folder"):(0,r.t)("messages.snackbar.message_move","Message successfully moved"),autoHideTimeout:3e3,hideButton:!0})):_({key:"edit",replace:!0,type:"error",label:(0,r.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0}),A(!1),M()})).catch((()=>i.noop))}),[E,e,M,b,_,t]),x=(0,l.useMemo)((()=>(0,i.some)(w?.children,["name",v])),[w?.children,v]),R=(0,l.useMemo)((()=>y?!w||w?.id===f||(0,d.jX)(w?.id):!w||!v.length||x),[w,f,x,v?.length,y]),O=(0,l.useMemo)((()=>x?(0,r.t)("folder_panel.modal.new.input.name_exist"):(0,r.t)("folder_panel.modal.new.input.name","Folder Name")),[x]),I=(0,l.useCallback)((()=>{(0,u.v)({parentFolderId:w?.parent??"",name:v}).then((e=>{!("Fault"in e)&&"folder"in e?a?S(e.folder[0].id):T(e.folder[0].id):_({key:"edit",replace:!0,type:"error",label:(0,r.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})})).catch((()=>i.noop)),k(""),C(void 0)}),[_,w?.parent,v,a,T,S]),F=(0,l.useMemo)((()=>y?t?(0,r.t)("label.restore","Restore"):a?(0,r.t)("folder_panel.modal.move.title_modal_message","Move Message"):(0,r.t)("folder_panel.modal.move.title_modal_conversation","Move Conversation"):(0,r.t)("folder_panel.modal.new.title","Create a new folder")),[a,t,y]),B=(0,l.useMemo)((()=>y?a?()=>S(w?.id):()=>T(w?.id):I),[w,a,y,I,T,S]),D=(0,l.useMemo)((()=>y?h:()=>{A(!0)}),[y,h]),N=(0,l.useMemo)((()=>y?(0,r.t)("label.move","Move"):t?(0,r.t)("folder_panel.modal.new.restore_create_footer","Create and Restore"):(0,r.t)("folder_panel.modal.new.create_footer","Create and Move")),[t,y]),L=R?"":(0,r.t)("label.folder_not_valid_destination","The selected folder is not a valid destination");return n().createElement(o.Container,{padding:{all:"large"},mainAlignment:"center",crossAlignment:"flex-start",height:"100%",style:{overflowY:"auto"}},n().createElement(c.A,{onClose:h,title:F}),n().createElement(o.Container,{padding:{all:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit",style:{overflowY:"auto"}},!y&&n().createElement(n().Fragment,null,n().createElement(o.Input,{label:O,backgroundColor:"gray5",hasError:x,defaultValue:v,onChange:e=>{k(e.target.value)}}),x&&n().createElement(o.Padding,{all:"small"},n().createElement(o.Text,{size:"small",color:"error"},(0,r.t)("folder_panel.modal.new.name_exist_warning","Name already exists")))),n().createElement(o.Container,{padding:{all:"small"},mainAlignment:"center",crossAlignment:"flex-start"},n().createElement(o.Text,{overflow:"break-word"},t?(0,r.t)("folder_panel.modal.move.body.message2","Select a folder to restore to:"):(0,r.t)("folder_panel.modal.move.body.message1","Select a folder to move the considered one to:"))),n().createElement(p.W,{selectedFolderId:w?.id,onFolderSelected:C,showSharedAccounts:!0,showTrashFolder:!1,showSpamFolder:!1,allowRootSelection:!1,allowFolderCreation:!1}),n().createElement(s.A,{tooltip:L,onConfirm:B,secondaryAction:D,label:N,secondaryLabel:y?(0,r.t)("label.cancel","Cancel"):(0,r.t)("go_back","Go Back"),disabled:R})))}},1843:(e,a,t)=>{t.d(a,{qQ:()=>y,TL:()=>A,VZ:()=>_,kv:()=>M,nK:()=>T});var l=t(7559),n=t.n(l),o=t(4702),r=t(7196),i=t(2509),s=t(9628),c=t(9902);const d=({onClose:e,tag:a})=>{const t=(0,o.useSnackbar)(),i=(0,l.useMemo)((()=>(0,r.t)("label.delete_tag_name",{name:a?.name,defaultValue:'Delete "{{name}}" tag'})),[a?.name]),d=(0,l.useCallback)((()=>{a&&(0,r.deleteTag)(a?.id).then((l=>{l.action&&t({key:"delete-tag",replace:!0,type:"success",label:(0,r.t)("messages.snackbar.tag_deleted",{name:a?.name,defaultValue:"{{name}} Tag deleted successfully"}),autoHideTimeout:3e3,hideButton:!0}),e()}))}),[t,e,a]);return n().createElement(n().Fragment,null,n().createElement(c.A,{onClose:e,title:i}),n().createElement(o.Container,{padding:{horizontal:"large"}},n().createElement(o.Text,null,(0,r.t)("message.delete_tag_message1",{name:a?.name,defaultValue:'Are you sure to delete "{{name}}" Tag?'})),n().createElement(o.Text,{overflow:"break-word",style:{textAlign:"center"}},(0,r.t)("message.delete_tag_message2","Once deleted, it will be removed from every item marked with it."))),n().createElement(s.A,{onConfirm:d,label:(0,r.t)("label.delete","Delete"),disabled:!1,color:"error"}))};var m=t(2861),g=t(8032),u=t(7625),p=t(7656),b=t(8333),h=t(6279);const f=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+/,E=({onClose:e,editMode:a=!1,tag:t})=>{const[i,d]=(0,l.useState)(t?.name||""),[m,g]=(0,l.useState)(t?.color||0),p=(0,l.useMemo)((()=>a?(0,r.t)("label.edit_tag_name",{name:t?.name,defaultValue:'Edit "{{name}}" tag'}):(0,r.t)("label.create_tag","Create a new Tag")),[a,t?.name]),b=(0,l.useMemo)((()=>(0,r.t)("label.tag_name","Tag name")),[]),E=(0,l.useCallback)((e=>g(e)),[]),_=(0,l.useCallback)((e=>d(e.target.value)),[]),v=(0,l.useMemo)((()=>i.length>=128),[i]),k=(0,l.useMemo)((()=>f.test(i)),[i]),w=(0,l.useMemo)((()=>v||k),[v,k]),C=(0,l.useMemo)((()=>""===i||w),[i,w]),{createSnackbar:y}=(0,u.m)(),A=(0,l.useCallback)((()=>(0,r.createTag)({name:i,color:m}).then((a=>{a.tag&&y({key:"new-tag",replace:!0,type:"info",label:(0,r.t)("messages.snackbar.tag_created",{name:i,defaultValue:"Tag {{name}} successfully created"}),autoHideTimeout:3e3,hideButton:!0}),e()}))),[i,m,e,y]),M=(0,l.useCallback)((()=>{Promise.all([(0,r.renameTag)(`${t?.id}`,i),(0,r.changeTagColor)(`${t?.id}`,Number(m))]).then((()=>{e(),y({key:"update-tag",replace:!0,type:"info",label:(0,r.t)("messages.snackbar.tag_updated","Tag successfully updated"),autoHideTimeout:3e3,hideButton:!0})})).catch((()=>{e(),y({key:"update-tag-error",replace:!0,type:"error",label:(0,r.t)("messages.snackbar.tag_not_updated","Something went wrong, tag not updated. Please try again."),autoHideTimeout:3e3,hideButton:!0})}))}),[m,y,i,e,t?.id]);return n().createElement(n().Fragment,null,n().createElement(c.A,{onClose:e,title:p}),n().createElement(o.Input,{label:b,value:i,onChange:_,backgroundColor:"gray5",textColor:w?"error":"text",hasError:w}),w&&n().createElement(o.Padding,{all:"small"},v&&n().createElement(o.Text,{size:"extrasmall",color:"error",overflow:"break-word"},(0,r.t)("label.tag_max_length","Max 128 characters are allowed")),k&&n().createElement(o.Text,{size:"extrasmall",color:"error",overflow:"break-word"},(0,r.t)("label.no_special_char_allowed","Name should not contain any special character"))),n().createElement(o.Padding,{top:"small"}),n().createElement(h.A,{onChange:E,label:(0,r.t)("label.select_color","Select Color"),defaultColor:m}),n().createElement(s.A,{onConfirm:a?M:A,label:a?(0,r.t)("label.edit","edit"):(0,r.t)("label.create","Create"),disabled:C}))},_=({createModal:e})=>({id:m.Fx.NEW,icon:"TagOutline",label:(0,r.t)("label.create_tag","Create Tag"),onClick:a=>{a&&a.stopPropagation();const t=e&&e({children:n().createElement(b.t,null,n().createElement(E,{onClose:()=>t&&t()}))},!0)}}),v=({createModal:e,tag:a})=>({id:m.Fx.EDIT,icon:"Edit2Outline",label:(0,r.t)("label.edit_tag","Edit Tag"),onClick:t=>{t&&t.stopPropagation();const l=e&&e({children:n().createElement(b.t,null,n().createElement(E,{onClose:()=>l&&l(),tag:a,editMode:!0}))},!0)}}),k=({createModal:e,tag:a})=>({id:m.Fx.DELETE,icon:"Untag",label:(0,r.t)("label.delete_tag","Delete Tag"),onClick:t=>{t&&t.stopPropagation();const l=e&&e({children:n().createElement(b.t,null,n().createElement(d,{onClose:()=>l&&l(),tag:a}))},!0)}}),w=({tag:e,conversation:a,isMessage:t})=>{const{createSnackbar:s}=(0,u.m)(),c=(0,g.j)(),[d,m]=(0,l.useState)((0,i.includes)(a.tags,e.id)),[b,h]=(0,l.useState)(!1),f=(0,l.useCallback)((l=>{m((e=>!e)),c(t?(0,p.SU)({operation:l?"!tag":"tag",ids:[a.id],tagName:e.name}):(0,p.Rs)({operation:l?"!tag":"tag",ids:[a.id],tagName:e.name})).then((a=>{a.type.includes("fulfilled")?s({key:"tag",replace:!0,hideButton:!0,type:"info",label:l?(0,r.t)("snackbar.tag_removed",{tag:e.name,defaultValue:'"{{tag}}" tag removed'}):(0,r.t)("snackbar.tag_applied",{tag:e.name,defaultValue:'"{{tag}}" tag applied'}),autoHideTimeout:3e3}):s({key:"tag",replace:!0,type:"error",label:(0,r.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})}))}),[a.id,s,c,t,e.name]),E=(0,l.useMemo)((()=>r.ZIMBRA_STANDARD_COLORS[e.color||0].hex),[e.color]),_=(0,l.useMemo)((()=>d?"Tag":"TagOutline"),[d]),v=(0,l.useMemo)((()=>d?"Untag":"Tag"),[d]);return n().createElement(o.Row,{"data-testid":`tag-item-${e.id}`,takeAvailableSpace:!0,mainAlignment:"flex-start",onClick:()=>f(d),onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1)},n().createElement(o.Padding,{right:"small"},n().createElement(o.Checkbox,{value:d})),n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},n().createElement(o.Text,null,e.name)),n().createElement(o.Row,{mainAlignment:"flex-end"},n().createElement(o.Icon,{icon:b?v:_,color:E}))))},C=({tag:e,ids:a,tags:t,conversations:s,deselectAll:c,folderId:d,isMessage:m})=>{const{createSnackbar:b}=(0,u.m)(),h=(0,g.j)(),[f,E]=(0,l.useState)(!1),_=(0,i.reduce)(t,((e,a)=>{const t=(0,i.map)(s,(e=>(0,i.includes)(e.tags,a.id)));return(0,i.every)(t)&&e.push(a.id),e}),[]),[v,k]=(0,l.useState)((0,i.includes)(_,e.id)),w=(0,l.useCallback)((t=>{k((e=>!e)),h(m?(0,p.SU)({operation:t?"!tag":"tag",ids:a,tagName:e.name}):(0,p.Rs)({operation:t?"!tag":"tag",ids:a,tagName:e.name})).then((a=>{a.type.includes("fulfilled")?(c&&c(),(0,r.replaceHistory)(`/folder/${d}/`),b({key:"tag",replace:!0,hideButton:!0,type:"info",label:t?(0,r.t)("snackbar.tag_removed",{tag:e.name,defaultValue:'"{{tag}}" tag removed'}):(0,r.t)("snackbar.tag_applied",{tag:e.name,defaultValue:'"{{tag}}" tag applied'}),autoHideTimeout:3e3})):b({key:"tag",replace:!0,type:"error",label:(0,r.t)("label.error_try_again","Something went wrong, please try again"),autoHideTimeout:3e3,hideButton:!0})}))}),[h,m,a,e.name,c,d,b]),C=(0,l.useMemo)((()=>v?"Tag":"TagOutline"),[v]),y=(0,l.useMemo)((()=>v?"Untag":"Tag"),[v]),A=(0,l.useMemo)((()=>r.ZIMBRA_STANDARD_COLORS[e.color||0].hex),[e.color]);return n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start",onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),onClick:()=>w(v)},n().createElement(o.Padding,{right:"small"},n().createElement(o.Checkbox,{value:v})),n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},n().createElement(o.Text,null,e.name)),n().createElement(o.Row,{mainAlignment:"flex-end"},n().createElement(o.Icon,{icon:f?y:C,color:A}))))},y=({tags:e,ids:a,conversations:t,deselectAll:l,folderId:s,isMessage:c})=>{const d=(0,i.reduce)(e,((o,r)=>{const i={id:r.id,label:r.name,icon:"TagOutline",keepOpen:!0,customComponent:n().createElement(C,{tag:r,tags:e,ids:a,conversations:t,deselectAll:l,folderId:s,isMessage:c??!1})};return o.push(i),o}),[]);return{id:m.Fx.Apply,items:d,customComponent:n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},n().createElement(o.Padding,{right:"small"},n().createElement(o.Icon,{icon:"TagsMoreOutline"})),n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Padding,{right:"small"},n().createElement(o.Text,null,(0,r.t)("label.tags","Tags")))))}},A=({conversation:e,tags:a,isMessage:t})=>{const l=(0,i.reduce)(a,((a,l)=>{const o={id:l.id,label:l.name,icon:"TagOutline",keepOpen:!0,customComponent:n().createElement(w,{tag:l,conversation:e,isMessage:t??!1})};return a.push(o),a}),[]);return{id:m.Fx.Apply,items:l,label:(0,r.t)("label.tag","Tag"),icon:"TagsMoreOutline",customComponent:n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"flex-start"},n().createElement(o.Padding,{right:"small"},n().createElement(o.Icon,{icon:"TagsMoreOutline"})),n().createElement(o.Row,{takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(o.Padding,{right:"small"},n().createElement(o.Text,null,(0,r.t)("label.tags","Tags")))))}},M=({tag:e})=>{const a=(0,l.useContext)(o.ModalManagerContext);return(0,l.useMemo)((()=>[_({createModal:a}),v({createModal:a,tag:e}),k({tag:e,createModal:a})]),[a,e])},T=e=>{const a=(()=>{const e=(0,r.useTags)();return(0,l.useMemo)((()=>(0,i.reduce)(e,((e,a)=>(e.push(a),e)),[])),[e])})();return(0,l.useMemo)((()=>(0,i.reduce)(e,((t,l)=>{let n=!1;return((0,i.find)(a,{id:l?.id})||e?.length>0&&(0,i.some)(e,(e=>e.id.includes("nil:"))))&&(n=!0),n}),!1)),[e,a])}}}]);
//# sourceMappingURL=397.2e1bcb2d.chunk.js.map