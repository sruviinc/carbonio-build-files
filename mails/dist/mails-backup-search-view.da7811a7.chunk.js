"use strict";(self.webpackChunkcarbonio_mails_ui=self.webpackChunkcarbonio_mails_ui||[]).push([[677],{4131:(e,t,a)=>{a.d(t,{T:()=>i});var l=a(4702),n=a(4710),r=a.n(n);const o=r()(l.ListItem).withConfig({displayName:"list-item__CustomListItemHelper",componentId:"sc-1ebopzs-0"})([""]),i=r()(o).attrs((({background:e="gray6",active:t,activeBackground:a="highlight",selected:n,selectedBackground:r="gray5",theme:o})=>({$baseBackgroundColor:(0,l.getColor)(t&&a||n&&r||e,o),$focusBackgroundColor:(0,l.getColor)(`${t&&a||"gray6"}.focus`,o)}))).withConfig({displayName:"list-item__CustomListItem",componentId:"sc-1ebopzs-1"})(["transition:none;&:focus,&:active{background:",";","{background:",";}}&:hover{background:",";&:focus,&:active{background:",";}}"],(({$focusBackgroundColor:e})=>e),o,(({$focusBackgroundColor:e})=>e),(({$baseBackgroundColor:e})=>e),(({$focusBackgroundColor:e})=>e))},6019:(e,t,a)=>{a.d(t,{g:()=>r});var l=a(4702),n=a(4710);const r=a.n(n)()(l.ListV2).withConfig({displayName:"list__CustomList",componentId:"sc-gl3s62-0"})(["padding-bottom:0.25rem;min-height:0;"])},9628:(e,t,a)=>{a.d(t,{A:()=>i});var l=a(7559),n=a.n(l),r=a(4702),o=a(8153);const i=({mainAlignment:e="center",crossAlignment:t="center",onConfirm:a,label:i,secondaryAction:c,secondaryLabel:s,primaryBtnType:m="default",secondaryBtnType:d="default",disabled:g,secondaryDisabled:u,background:h="primary",secondarybackground:p,color:b="primary",secondaryColor:E="secondary",size:f="medium",showDivider:y=!0,tooltip:C,secondaryTooltip:v,paddingTop:k="medium",additionalAction:w,additionalBtnType:x="outlined",additionalColor:A="secondary",additionalLabel:S,primaryButtonIcon:_})=>{const[z]=(0,o.useTranslation)(),I=(0,l.useMemo)((()=>z("label.cancel","cancel")),[z]);return n().createElement(r.Container,{mainAlignment:e,crossAlignment:t,padding:{top:k}},y&&n().createElement(r.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"center",crossAlignment:"flex-start",orientation:"horizontal",height:"fit"},n().createElement(r.Divider,null)),n().createElement(r.Container,{orientation:"horizontal",mainAlignment:"space-between"},w&&n().createElement(r.Container,{orientation:"horizontal",width:"fit"},n().createElement(r.Button,{color:A,type:x,onClick:w,label:S??I,size:f}),n().createElement(r.Padding,{horizontal:"extrasmall"})),n().createElement(r.Container,{padding:{top:"small",bottom:"small"},mainAlignment:"flex-end",crossAlignment:"flex-start",orientation:"horizontal",height:"fit"},c&&n().createElement(r.Padding,{right:"small",vertical:"small"},v?n().createElement(r.Tooltip,{label:v,placement:"top",maxWidth:"fit"},n().createElement(r.Button,{backgroundColor:p,color:E,type:d,onClick:c,label:s??I,disabled:u,size:f})):n().createElement(r.Button,{backgroundColor:p,color:E,type:d,onClick:c,label:s??I,disabled:u,size:f})),n().createElement(r.Padding,{vertical:"small"},C?n().createElement(r.Tooltip,{label:C,placement:"top",maxWidth:"fit"},n().createElement(r.Button,{size:f,color:b,onClick:a,label:i,type:m,disabled:g,backgroundColor:b||h,icon:_,iconPlacement:"left"})):n().createElement(r.Button,{size:f,color:b,onClick:a,label:i,type:m,disabled:g,backgroundColor:b||h,icon:_,iconPlacement:"left"})))))}},9902:(e,t,a)=>{a.d(t,{A:()=>o});var l=a(7559),n=a.n(l),r=a(4702);const o=({title:e,onClose:t,showCloseIcon:a=!0})=>n().createElement(r.Container,{mainAlignment:"space-between",width:"100%"},n().createElement(r.Row,{takeAvailableSpace:!0,mainAlignment:"space-between",width:"100%"},n().createElement(r.Row,{width:"calc(100% - 1.5rem)",takeAvailableSpace:!0,mainAlignment:"flex-start"},n().createElement(r.Text,{weight:"bold",size:"large"},e)),t&&a&&n().createElement(r.Row,{mainAlignment:"flex-start"},n().createElement(r.IconButton,{size:"medium",style:{padding:0,margin:0},onClick:t,icon:"CloseOutline"}))),n().createElement(r.Padding,{top:"medium"}),n().createElement(r.Divider,null),n().createElement(r.Padding,{bottom:"medium"}))},8555:(e,t,a)=>{async function l(e){return Promise.allSettled([e]).then((async([e])=>{if("fulfilled"===e.status){const t=await e.value.text();return t?{data:JSON.parse(t)}:{data:{}}}return{error:e.reason}}))}a.d(t,{M:()=>l})},5322:(e,t,a)=>{a.d(t,{C:()=>r});var l=a(7559),n=a(2509);const r=({setCount:e,count:t,items:a=[]})=>{const r=(0,l.useRef)({}),[o,i]=(0,l.useState)(!1),c=(0,l.useMemo)((()=>t===a.length),[t,a.length]),s=(0,l.useCallback)((a=>{r.current[a]?(r.current=(0,n.omit)(r.current,[a]),e((e=>e-1)),t-1==0?i(!1):0===t&&i(!0)):(r.current={...r.current,[a]:!0},e((e=>e+1)),i(!0))}),[t,e]),m=(0,l.useCallback)((()=>{r.current={},e(0),i(!1)}),[e,i]),d=(0,l.useCallback)((()=>{(0,n.map)(a,(e=>{r.current[e.id]||s(e.id)}))}),[a,s,r]),g=(0,l.useCallback)((()=>{r.current={},e(0),setTimeout((()=>{i(!0)}))}),[e]);return{selected:r.current,toggle:s,deselectAll:m,isSelectModeOn:o,setIsSelectModeOn:i,selectAll:d,isAllSelected:c,selectAllModeOff:g}}},6609:(e,t,a)=>{a.d(t,{F:()=>r});var l=a(4702),n=a(4710);const r=a.n(n)()(l.Container).withConfig({displayName:"hover-bar-container__HoverBarContainer",componentId:"sc-10sbfgn-0"})(["top:0;right:0;display:none;position:absolute;background:linear-gradient( to right,transparent,"," );width:calc(100% - 4rem);height:45%;& > *{margin-top:",";margin-right:",";}"],(({background:e,theme:t})=>t.palette[e].hover),(({theme:e})=>e.sizes.padding.small),(({theme:e})=>e.sizes.padding.small))},4713:(e,t,a)=>{a.d(t,{s:()=>i});var l=a(4702),n=a(4710),r=a.n(n),o=a(6609);const i=r()(l.Container).attrs((()=>({background:"transparent"}))).withConfig({displayName:"hover-container__HoverContainer",componentId:"sc-2xkx5d-0"})(["width:100%;position:relative;cursor:pointer;text-decoration:none;&:hover{background:",";& ","{display:flex;}}"],(({$hoverBackground:e,theme:t})=>t.palette[e].hover),o.F)},9303:(e,t,a)=>{a.r(t),a.d(t,{default:()=>T});var l=a(7559),n=a.n(l),r=a(4702),o=a(7196),i=a(7431),c=a(4736);const s=()=>{const e=(0,o.t)("label.clear_search_query","CLEAR SEARCH"),t=(0,o.t)("label.end_date","End Date"),a=(0,o.t)("label.start_date","Start Date"),{searchParams:s}=(0,c.h)(),{zimbraPrefLocale:m}=(0,o.useUserSettings)().prefs,d=[];s.searchString&&d.push({value:s.searchString,hasAvatarIcon:!1}),s.startDate&&d.push({value:`${a}: ${s.startDate.toLocaleDateString(m)}`,hasAvatarIcon:!0,avatarIcon:"CalendarOutline"}),s.endDate&&d.push({value:`${t}: ${s.endDate.toLocaleDateString(m)}`,hasAvatarIcon:!0,avatarIcon:"CalendarOutline"});const g=(0,l.useCallback)((()=>{const e=c.h.getState();e.setMessages([]),e.setSearchParams({}),(0,o.removeRoute)(i.e$),(0,o.replaceHistory)({route:i.lU,path:"/"})}),[]);return n().createElement(n().Fragment,null,n().createElement(r.Container,{orientation:"horizontal",mainAlignment:"flex-start",width:"100%",background:"gray5",height:"fit",minHeight:"3rem",maxHeight:"7.5rem",style:{overflow:"hidden"},padding:{horizontal:"large",vertical:"medium"}},n().createElement(r.Row,{takeAvailableSpace:!0,orientation:"horizontal",mainAlignment:"flex-start"},n().createElement(r.Text,{color:"secondary"},(0,o.t)("label.results_for","Results for: ")),d.map((({value:e,hasAvatarIcon:t,avatarIcon:a},l)=>n().createElement(r.Padding,{left:"small",key:`query-params-${l}`},n().createElement(r.Chip,{label:e,background:"gray2",avatarBackground:"secondary",avatarColor:"white",color:"text",avatarIcon:a,hasAvatar:t}))))),n().createElement(r.Row,{mainAlignment:"space-between",crossAlignment:"flex-end"},n().createElement(r.Button,{label:e,icon:"CloseOutline",color:"primary",type:"ghost",onClick:g}))),n().createElement(r.Divider,{color:"gray3"}))};var m=a(2509),d=a(8698),g=a(643),u=a(4713);const h=({message:e,messageIsSelected:t,toggle:a})=>{const i=(0,o.getUserAccount)()?.name,{zimbraPrefLocale:c}=(0,o.useUserSettings)().prefs,s=(0,m.find)([e.to,e.sender],(e=>!e.includes(i??"")))??i,d=new Date(e?.creationDate).toLocaleDateString(c),h=e.id,p=(0,g.L2)(e.folderId),b=(0,l.useCallback)((()=>{(0,o.replaceHistory)(`/${h}`)}),[h]),E=(0,l.useCallback)((()=>{a(h)}),[h,a]);return n().createElement(u.s,{$hoverBackground:"highlight",orientation:"horizontal",mainAlignment:"flex-start",padding:{all:"medium"}},n().createElement("div",{style:{alignSelf:"center"}},n().createElement(r.Avatar,{onClick:E,selecting:!0,selected:t,label:e.to,colorLabel:e.to,size:"large"})),n().createElement(r.Row,{onClick:b,wrap:"wrap",takeAvailableSpace:!0,padding:{left:"medium"}},n().createElement(r.Container,{height:"fit",width:"fill",crossAlignment:"flex-start"},n().createElement(r.Row,{wrap:"nowrap",takeAvailableSpace:!0,width:"fill",mainAlignment:"space-between"},n().createElement(r.Text,{size:"medium"},s),n().createElement(r.Text,{size:"small"},d)),n().createElement(r.Padding,{bottom:"small"}),n().createElement(r.Row,{wrap:"nowrap",takeAvailableSpace:!0,mainAlignment:"space-between"},n().createElement(r.Text,{size:"medium"},e?.subject),p&&n().createElement(r.Chip,{label:p.name,background:"gray2",color:"text",hasAvatar:!1})))))};var p=a(9628),b=a(9902);const E=({onConfirm:e,onClose:t})=>{const a=(0,o.t)("label.start_recovery_process","Start recovery process"),l=(0,o.t)("label.start_recovery_description","Once the process is completed you will receive a notification in your Inbox and find the recovered e-mails in a brand new folder."),i=(0,o.t)("label.start_recovery","Start Recovery");return n().createElement(r.Container,{padding:{all:"large"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(b.A,{onClose:t,title:a}),n().createElement(r.Container,{padding:{all:"small"},mainAlignment:"center",crossAlignment:"flex-start",height:"fit"},n().createElement(r.Text,{style:{whiteSpace:"pre-line"}},l),n().createElement(p.A,{onConfirm:e,label:i})))};var f=a(8555),y=a(6019),C=a(4131),v=a(5322),k=a(8333);const w=()=>{const[e,t]=(0,l.useState)(0),{messages:a}=(0,c.h)(),{itemId:s}=(0,d.useParams)(),{selected:g,toggle:u,deselectAll:p,selectAll:b,isAllSelected:w}=(0,v.C)({currentFolderId:"backup-search",setCount:t,count:e,items:[...Object.values(a??{})]}),x=(0,l.useMemo)((()=>Object.keys(g)),[g]),A=(0,r.useSnackbar)(),S=(0,l.useCallback)((async e=>{const t=await async function(e){const t=fetch("/zx/backup/v1/restoreMessages",{method:"POST",credentials:"same-origin",body:JSON.stringify({messages:e})});return(0,f.M)(t)}(x);e(),"error"in t?A({replace:!0,type:"error",label:(0,o.t)("label.error_recovering_emails","Error recovering emails"),autoHideTimeout:5e3,hideButton:!0}):(c.h.getState().setStatus(i.vk.empty),c.h.getState().setMessages([]),(0,o.replaceHistory)({route:i.lU,path:"/"}),A({replace:!0,type:"info",label:(0,o.t)("label.recover_emails","The recovery process has started, you will be informed once it is complete"),autoHideTimeout:5e3,hideButton:!0}))}),[A,x]),_=(0,r.useModal)(),z=(0,l.useCallback)((()=>{const e=_({maxHeight:"90vh",children:n().createElement(k.t,null,n().createElement(E,{onConfirm:()=>S((()=>e?.())),onClose:()=>e?.()}))},!0)}),[_,S]),I=(0,l.useMemo)((()=>(0,m.map)(a,(e=>{const t=s===e.id,a=g[e.id];return n().createElement(C.T,{key:e.id,active:t,selected:a,background:"gray6"},(t=>t?n().createElement(h,{message:e,messageIsSelected:a,toggle:u}):n().createElement("div",{style:{height:"4rem"}})))}))),[s,a,g,u]),T=(0,l.useCallback)((()=>{b(),A({key:"selected-all-backupMessages",replace:!0,type:"info",label:(0,o.t)("label.all_items_selected","All visible backupMessages have been selected"),autoHideTimeout:5e3,hideButton:!0})}),[b,A]);return n().createElement(r.Container,{background:"gray6",width:"25%",height:"fill",mainAlignment:"flex-start"},n().createElement(r.Container,{background:"gray5",height:"fit",orientation:"horizontal",padding:{all:"extrasmall"},mainAlignment:"flex-start",width:"100%"},n().createElement(r.Row,{height:"100%",width:"fill",padding:{all:"extrasmall"},mainAlignment:"flex-start",takeAvailableSpace:!0},n().createElement(r.Button,{label:w?(0,o.t)("label.deselect_all","DESELECT all"):(0,o.t)("label.select_all","SELECT all"),color:"primary",onClick:w?p:T,size:"medium",type:"ghost"}),n().createElement(r.Padding,{left:"small"}),n().createElement(r.Row,{takeAvailableSpace:!0},n().createElement(r.Button,{label:(0,o.t)("label.recover_selected_emails","RECOVER SELECTED E-MAILS"),color:"primary",onClick:z,size:"medium",type:"outlined",width:"fill",disabled:!x.length})))),n().createElement(y.g,null,I))};var x=a(4710),A=a.n(x);const S=({title:e,text:t})=>{const a=`${e} : `;return t?n().createElement(r.Row,{padding:"small",mainAlignment:"flex-start",width:"fill"},n().createElement(r.Text,{color:"gray1",overflow:"break-word",weight:"bold",size:"large"},a),n().createElement(r.Text,{color:"gray1",overflow:"break-word",size:"large"},t)):n().createElement(n().Fragment,null)};var _=a(5302);const z=A()(r.Icon).withConfig({displayName:"backup-search-panel__SearchIcon",componentId:"sc-11iiybp-0"})(["width:3.3rem;height:3.3rem;"]),I=()=>{const e=(0,o.t)("label.displayer_restore_emails_title","Select the e-mails you want to restore"),t=(0,o.t)("label.displayer_restore_emails_description","Once the selected email recovery is complete, \n you will receive an email with information regarding the results."),{itemId:a}=(0,d.useParams)(),l=(0,c.h)((e=>e.messages[a??""])),i={title:(0,o.t)("label.subject","Subject"),text:l?.subject},s={title:(0,o.t)("label.from","From"),text:l?.sender},m={title:(0,o.t)("label.to","To"),text:l?.to},g={title:(0,o.t)("label.date_created","Date created"),text:new Date(l?.creationDate).toUTCString()},u={title:(0,o.t)("label.date_deleted","Date deleted"),text:new Date(l?.deletionDate).toUTCString()},h=(0,_.L2)(l?.folderId),p={title:(0,o.t)("label.folder","Folder"),text:h?.name};return l?n().createElement(r.Container,{padding:{left:"8rem"},background:"gray5",width:"fill"},n().createElement(S,{title:i.title,text:i.text}),n().createElement(S,{title:s.title,text:s.text}),n().createElement(S,{title:m.title,text:m.text}),n().createElement(S,{title:g.title,text:g.text}),n().createElement(S,{title:u.title,text:u.text}),n().createElement(S,{title:p.title,text:p.text})):n().createElement(r.Container,{background:"gray5"},n().createElement(z,{icon:"Search",color:"gray1"}),n().createElement(r.Padding,{all:"medium"},n().createElement(r.Text,{color:"gray1",overflow:"break-word",weight:"bold",size:"extralarge",style:{whiteSpace:"pre-line",textAlign:"center"}},e)),n().createElement(r.Text,{size:"small",color:"gray1",overflow:"break-word",style:{whiteSpace:"pre-line",textAlign:"center"}},t))},T=()=>n().createElement(n().Fragment,null,n().createElement(s,null),n().createElement(r.Container,{orientation:"horizontal",background:"gray4",style:{overflowY:"auto"},mainAlignment:"flex-start"},n().createElement(w,null),n().createElement(I,null)))}}]);
//# sourceMappingURL=mails-backup-search-view.da7811a7.chunk.js.map