{"version":3,"file":"mail-sidebar-view.7edd5709.chunk.js","mappings":"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","sources":["webpack://carbonio-mails-ui/./src/helpers/sorting.ts","webpack://carbonio-mails-ui/./src/hooks/use-selection.tsx","webpack://carbonio-mails-ui/./src/sruvi/EditedColors.tsx","webpack://carbonio-mails-ui/./src/ui-actions/modals/select-folder-modal.tsx","webpack://carbonio-mails-ui/./src/store/actions/folder-action.ts","webpack://carbonio-mails-ui/./src/views/sidebar/delete-modal.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/parts/edit/edit-context.ts","webpack://carbonio-mails-ui/./src/store/actions/send-share-notification.ts","webpack://carbonio-mails-ui/./src/views/sidebar/parts/edit/share-folder-properties.tsx","webpack://carbonio-mails-ui/./src/store/actions/share-folder.ts","webpack://carbonio-mails-ui/./src/views/sidebar/edit-permissions-modal.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/parts/edit/folder-details.tsx","webpack://carbonio-mails-ui/./src/carbonio-ui-commons/constants/folders.ts","webpack://carbonio-mails-ui/./src/carbonio-ui-commons/utils/utils.ts","webpack://carbonio-mails-ui/./src/views/sidebar/parts/edit/name-input.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/parts/edit/retention-policies.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/parts/edit/edit-default-modal.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/parts/edit/share-revoke-modal.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/edit-modal.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/empty-modal.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/new-modal.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/shares-info-modal.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/accordion-custom-component.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/use-folder-actions.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/collapsed-sidebar-items.tsx","webpack://carbonio-mails-ui/./src/carbonio-ui-commons/theme/theme-mui.ts","webpack://carbonio-mails-ui/./src/carbonio-ui-commons/components/sidebar/sidebar-accordion-mui.tsx","webpack://carbonio-mails-ui/./src/hooks/use-get-tags-accordions.tsx","webpack://carbonio-mails-ui/./src/views/sidebar/sidebar.tsx"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { editSettings } from '@zextras/carbonio-shell-ui';\nimport { find } from 'lodash';\n\nimport { SORTING_OPTIONS } from '../constants';\nimport { FolderSortOrder } from '../types';\n\nconst fallbackSortOrder = {\n\tsortType: 'date',\n\tsortDirection: 'Desc' as 'Asc' | 'Desc',\n\tsortOrder: 'dateDesc',\n\tremainingFoldersSortOrder: '',\n\tremainingSortOptions: ''\n};\n\n/**\n * Returns sortType, sortDirection and sortOrder for the given folder\n *\n * @param folderId\n * @param prefSortOrder\n *\n * returns an object containing\n * sortType: the sort type for the given folder,\n * sortDirection: the sort direction for the given folder,\n * sortOrder: the concatenation of sortType and sortDirection,\n * remainingFoldersSortOrder: the sort order of the other folders,\n * remainingSortOptions: the sort order of the other options not related to mails\n */\nexport function parseMessageSortingOptions(\n\tfolderId?: string,\n\tprefSortOrder?: string\n): FolderSortOrder {\n\tif (!prefSortOrder || !folderId) {\n\t\treturn fallbackSortOrder;\n\t}\n\tconst splitString = ',BDLV';\n\tconst sortOrderString = prefSortOrder.split(splitString)[0];\n\tconst sortingFolders = sortOrderString.split(',');\n\tconst sortOrderOfFolder = find(\n\t\tsortingFolders,\n\t\t(item) => item.substring(0, item.lastIndexOf(':')) === folderId\n\t);\n\n\tconst remainingSortOptions = splitString.concat(prefSortOrder.split(splitString)[1]) ?? '';\n\tconst remainingFoldersSortOrder =\n\t\tsortingFolders\n\t\t\t.filter((item) => item.substring(0, item.lastIndexOf(':')) !== folderId)\n\t\t\t.join(',') ?? '';\n\tif (!!sortOrderOfFolder && !sortOrderOfFolder.includes(SORTING_OPTIONS.size.value)) {\n\t\tconst sortOrder = sortOrderOfFolder.substring(sortOrderOfFolder.lastIndexOf(':') + 1);\n\t\tconst sortDirection = sortOrder.includes('Desc') ? 'Desc' : 'Asc';\n\t\tconst sortType = sortOrder.split(/Asc|Desc/i)[0];\n\n\t\treturn { sortType, sortDirection, sortOrder, remainingFoldersSortOrder, remainingSortOptions };\n\t}\n\treturn fallbackSortOrder;\n}\n\nfunction modifySettingString(\n\tinputStringA: string,\n\tinputStringB: string,\n\tfolderId?: string\n): string {\n\tconst replaceStr = new RegExp(`${folderId}:(.*?)(Asc|Desc)`);\n\treturn replaceStr.test(inputStringA)\n\t\t? inputStringA.replace(replaceStr, `${inputStringB}`)\n\t\t: `${inputStringA},${inputStringB}`;\n}\n\nexport function updateSortingSettings({\n\tprefSortOrder,\n\tsortingTypeValue,\n\tsortingDirection,\n\tfolderId\n}: {\n\tprefSortOrder?: string;\n\tsortingTypeValue: string;\n\tsortingDirection: string;\n\tfolderId?: string;\n}): void {\n\tif (!prefSortOrder) {\n\t\tconst changes = {\n\t\t\tprefs: {\n\t\t\t\tzimbraPrefSortOrder: `${folderId}:${sortingTypeValue}${sortingDirection},BDLV`\n\t\t\t}\n\t\t};\n\t\teditSettings(changes);\n\t\treturn;\n\t}\n\tconst secondString = prefSortOrder.substring(prefSortOrder.indexOf(',BDLV'));\n\tconst sortingString = `${folderId}:${sortingTypeValue}${sortingDirection}`;\n\tconst splitString = ',BDLV';\n\tconst sortOrderString = prefSortOrder.split(splitString)[0];\n\tconst replacedString = modifySettingString(sortOrderString, sortingString, folderId);\n\tconst finalString = replacedString + secondString;\n\n\tconst changes = {\n\t\tprefs: {\n\t\t\tzimbraPrefSortOrder: finalString\n\t\t}\n\t};\n\teditSettings(changes);\n}\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { useCallback, useMemo, useRef, useState } from 'react';\n\nimport { map, omit } from 'lodash';\n\nimport type { BackupSearchMessage, Conversation, IncompleteMessage } from '../types';\n\ntype UseSelectionProps = {\n\tcurrentFolderId: string;\n\tcount: number;\n\titems?: Array<IncompleteMessage | Conversation | BackupSearchMessage>;\n\tsetCount: (value: number | ((prevState: number) => number)) => void;\n};\n\ntype UseSelectionReturnType = {\n\tselected: Record<string, boolean>;\n\tisSelectModeOn: boolean;\n\tsetIsSelectModeOn: (value: boolean | ((prev: boolean) => boolean)) => void;\n\ttoggle: (id: string) => void;\n\tdeselectAll: () => void;\n\tselectAll: () => void;\n\tisAllSelected: boolean;\n\tselectAllModeOff: () => void;\n};\n\nexport const useSelection = ({\n\tsetCount,\n\tcount,\n\titems = []\n}: UseSelectionProps): UseSelectionReturnType => {\n\tconst selected = useRef<Record<string, boolean>>({});\n\tconst [isSelectModeOn, setIsSelectModeOn] = useState(false);\n\tconst isAllSelected = useMemo(() => count === items.length, [count, items.length]);\n\n\tconst selectItem = useCallback(\n\t\t(id) => {\n\t\t\tif (selected.current[id]) {\n\t\t\t\tselected.current = omit(selected.current, [id]);\n\t\t\t\tsetCount((prev: number) => prev - 1);\n\t\t\t\tif (count - 1 === 0) {\n\t\t\t\t\tsetIsSelectModeOn(false);\n\t\t\t\t} else if (count === 0) {\n\t\t\t\t\tsetIsSelectModeOn(true);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tselected.current = { ...selected.current, [id]: true };\n\t\t\t\tsetCount((prev: number) => prev + 1);\n\t\t\t\tsetIsSelectModeOn(true);\n\t\t\t}\n\t\t},\n\t\t[count, setCount]\n\t);\n\n\tconst deselectAll = useCallback(() => {\n\t\tselected.current = {};\n\t\tsetCount(0);\n\t\tsetIsSelectModeOn(false);\n\t}, [setCount, setIsSelectModeOn]);\n\n\tconst selectAll = useCallback(() => {\n\t\tmap(items, (item) => {\n\t\t\tif (!selected.current[item.id]) {\n\t\t\t\tselectItem(item.id);\n\t\t\t}\n\t\t});\n\t}, [items, selectItem, selected]);\n\n\tconst selectAllModeOff = useCallback(() => {\n\t\tselected.current = {};\n\t\tsetCount(0);\n\t\tsetTimeout(() => {\n\t\t\tsetIsSelectModeOn(true);\n\t\t});\n\t}, [setCount]);\n\n\treturn {\n\t\tselected: selected.current,\n\t\ttoggle: selectItem,\n\t\tdeselectAll,\n\t\tisSelectModeOn,\n\t\tsetIsSelectModeOn,\n\t\tselectAll,\n\t\tisAllSelected,\n\t\tselectAllModeOff\n\t};\n};\n","export const FOREGROUND_COLOR = '#c2e7ff';\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, useCallback, useMemo, useState } from 'react';\n\nimport { Container, Text } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\nimport { isNil } from 'lodash';\n\nimport ModalFooter from '../../carbonio-ui-commons/components/modals/modal-footer';\nimport ModalHeader from '../../carbonio-ui-commons/components/modals/modal-header';\nimport type { Folder, RootFolder } from '../../carbonio-ui-commons/types/folder';\nimport { FolderSelector } from '../../views/sidebar/commons/folder-selector';\n\ntype SelectFolderModalProps = {\n\tfolder?: Folder | RootFolder;\n\tonClose: () => void;\n\theaderTitle: string;\n\tactionLabel: string;\n\tactionTooltip?: string;\n\tdisabledActionTooltip?: string;\n\tinputLabel: string;\n\tconfirmAction: (\n\t\tfolder: Folder | undefined,\n\t\tsetFolder: (_folder: Folder | undefined) => void,\n\t\tonClose: () => void\n\t) => void;\n\tshowSharedAccounts: boolean;\n\tshowTrashFolder: boolean;\n\tshowSpamFolder: boolean;\n\tallowRootSelection: boolean;\n\tallowFolderCreation: boolean;\n};\n\nexport const SelectFolderModal: FC<SelectFolderModalProps> = ({\n\tfolder,\n\tonClose,\n\theaderTitle,\n\tactionLabel,\n\tactionTooltip,\n\tdisabledActionTooltip,\n\tinputLabel,\n\tconfirmAction,\n\tshowSharedAccounts,\n\tshowTrashFolder,\n\tshowSpamFolder,\n\tallowFolderCreation,\n\tallowRootSelection\n}) => {\n\tconst [folderDestination, setFolderDestination] = useState<Folder | undefined>(folder);\n\n\tconst onConfirm = useCallback(() => {\n\t\tconfirmAction(folderDestination, setFolderDestination, onClose);\n\t}, [confirmAction, folderDestination, onClose]);\n\n\tconst isConfirmDisabled = useMemo(\n\t\t() => isNil(folderDestination) || folderDestination?.id === folder?.l,\n\t\t[folder?.l, folderDestination]\n\t);\n\n\tconst confirmActionTooltip = isConfirmDisabled\n\t\t? disabledActionTooltip ??\n\t\t\tt('label.folder_not_valid_destination', 'The selected folder is not a valid destination')\n\t\t: actionTooltip;\n\n\treturn (\n\t\t<Container\n\t\t\tpadding={{ all: 'large' }}\n\t\t\tmainAlignment=\"center\"\n\t\t\tcrossAlignment=\"flex-start\"\n\t\t\theight=\"fit\"\n\t\t\tstyle={{\n\t\t\t\toverflowY: 'auto'\n\t\t\t}}\n\t\t>\n\t\t\t<ModalHeader onClose={onClose} title={headerTitle} />\n\t\t\t<Container\n\t\t\t\tdata-testid=\"select-folder-modal\"\n\t\t\t\tpadding={{ all: 'small' }}\n\t\t\t\tmainAlignment=\"center\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\theight=\"fit\"\n\t\t\t\tstyle={{\n\t\t\t\t\toverflowY: 'auto'\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Container padding={{ all: 'small' }} mainAlignment=\"center\" crossAlignment=\"flex-start\">\n\t\t\t\t\t<Text overflow=\"break-word\">{inputLabel}</Text>\n\t\t\t\t</Container>\n\t\t\t\t<FolderSelector\n\t\t\t\t\tselectedFolderId={folderDestination?.id}\n\t\t\t\t\tonFolderSelected={setFolderDestination}\n\t\t\t\t\tshowTrashFolder={showTrashFolder}\n\t\t\t\t\tshowSpamFolder={showSpamFolder}\n\t\t\t\t\tallowFolderCreation={allowFolderCreation}\n\t\t\t\t\tallowRootSelection={allowRootSelection}\n\t\t\t\t\tshowSharedAccounts={showSharedAccounts}\n\t\t\t\t/>\n\t\t\t\t<ModalFooter\n\t\t\t\t\ttooltip={confirmActionTooltip}\n\t\t\t\t\tonConfirm={onConfirm}\n\t\t\t\t\tsecondaryAction={onClose}\n\t\t\t\t\tlabel={actionLabel}\n\t\t\t\t\tsecondaryLabel={t('label.cancel', 'Cancel')}\n\t\t\t\t\tdisabled={isConfirmDisabled}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</Container>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { soapFetch } from '@zextras/carbonio-shell-ui';\nimport { isEmpty, isNil, omitBy } from 'lodash';\n\nimport type { Folder } from '../../carbonio-ui-commons/types/folder';\nimport { DataProps } from '../../carbonio-ui-commons/types/sidebar';\nimport { FolderActionResponse } from '../../types';\n\nexport type FolderActionProps = {\n\tfolder: Folder | DataProps | Omit<Folder, 'parent'>;\n\tcolor?: number;\n\tzid?: string;\n\top: string;\n\tname?: string;\n\tl?: string;\n\trecursive?: boolean;\n\tretentionPolicy?: unknown;\n\ttype?: string;\n};\n\nexport async function folderAction({\n\tfolder,\n\tcolor,\n\tzid,\n\top,\n\tname,\n\tl,\n\trecursive,\n\tretentionPolicy,\n\ttype\n}: FolderActionProps): Promise<FolderActionResponse> {\n\tconst result = !isEmpty(retentionPolicy)\n\t\t? await soapFetch('Batch', {\n\t\t\t\tFolderActionRequest: [\n\t\t\t\t\t{\n\t\t\t\t\t\taction: {\n\t\t\t\t\t\t\tid: folder.id,\n\t\t\t\t\t\t\top,\n\t\t\t\t\t\t\tl,\n\t\t\t\t\t\t\trecursive,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tcolor\n\t\t\t\t\t\t},\n\t\t\t\t\t\t_jsns: 'urn:zimbraMail'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\taction: {\n\t\t\t\t\t\t\tid: folder.id,\n\t\t\t\t\t\t\top: 'retentionpolicy',\n\t\t\t\t\t\t\tretentionPolicy\n\t\t\t\t\t\t},\n\t\t\t\t\t\t_jsns: 'urn:zimbraMail'\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\t_jsns: 'urn:zimbra'\n\t\t\t})\n\t\t: await soapFetch('FolderAction', {\n\t\t\t\taction: omitBy(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: folder.id,\n\t\t\t\t\t\top,\n\t\t\t\t\t\tl,\n\t\t\t\t\t\trecursive,\n\t\t\t\t\t\tname,\n\t\t\t\t\t\tcolor,\n\t\t\t\t\t\tzid,\n\t\t\t\t\t\t...(type && { type })\n\t\t\t\t\t},\n\t\t\t\t\tisNil\n\t\t\t\t),\n\t\t\t\t_jsns: 'urn:zimbraMail'\n\t\t\t});\n\treturn result as FolderActionResponse;\n}\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, useCallback } from 'react';\n\nimport { Container, Divider, Text } from '@zextras/carbonio-design-system';\nimport { FOLDERS, report, t } from '@zextras/carbonio-shell-ui';\nimport { startsWith } from 'lodash';\n\nimport ModalFooter from '../../carbonio-ui-commons/components/modals/modal-footer';\nimport ModalHeader from '../../carbonio-ui-commons/components/modals/modal-header';\nimport { FOLDER_ACTIONS } from '../../commons/utilities';\nimport { isSharedAccountFolder, isTrashed } from '../../helpers/folders';\nimport { useUiUtilities } from '../../hooks/use-ui-utilities';\nimport { folderAction } from '../../store/actions/folder-action';\nimport type { ModalProps } from '../../types';\n\nexport const DeleteModal: FC<ModalProps> = ({ folder, onClose }) => {\n\tconst { createSnackbar } = useUiUtilities();\n\n\tconst onConfirm = useCallback(() => {\n\t\tconst inTrash = isTrashed({ folder });\n\t\tconst restoreFolder = (): void => {\n\t\t\tfolderAction({\n\t\t\t\tfolder,\n\t\t\t\tl: folder.parent,\n\t\t\t\top: FOLDER_ACTIONS.MOVE\n\t\t\t})\n\t\t\t\t.then((res) => {\n\t\t\t\t\tif (!('Fault' in res)) {\n\t\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\t\tkey: `trash-folder`,\n\t\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\t\tlabel: t('messages.snackbar.folder_restored', 'Folder restored'),\n\t\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\t\thideButton: true\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\t\tkey: `trash`,\n\t\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\t\thideButton: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(report);\n\t\t};\n\n\t\tfolderAction(\n\t\t\tisSharedAccountFolder(folder.id) && !inTrash\n\t\t\t\t? { folder, op: FOLDER_ACTIONS.TRASH }\n\t\t\t\t: {\n\t\t\t\t\t\tfolder,\n\t\t\t\t\t\tl: FOLDERS.TRASH,\n\t\t\t\t\t\top: inTrash ? FOLDER_ACTIONS.DELETE : FOLDER_ACTIONS.MOVE\n\t\t\t\t\t}\n\t\t)\n\t\t\t.then((res) => {\n\t\t\t\tif (!('Fault' in res)) {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `trash-folder`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\tinTrash || isSharedAccountFolder(folder.id)\n\t\t\t\t\t\t\t\t? t('messages.snackbar.folder_deleted', 'Folder permanently deleted.')\n\t\t\t\t\t\t\t\t: t('messages.snackbar.folder_moved_to_trash', 'Folder moved to trash'),\n\t\t\t\t\t\tautoHideTimeout: 5000,\n\t\t\t\t\t\thideButton: inTrash || isSharedAccountFolder(folder.id),\n\t\t\t\t\t\tactionLabel: t('label.undo', 'Undo'),\n\t\t\t\t\t\tonActionClick: () => restoreFolder()\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `trash`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(report);\n\t\tonClose();\n\t}, [createSnackbar, folder, onClose]);\n\n\treturn folder ? (\n\t\t<Container\n\t\t\tpadding={{ all: 'large' }}\n\t\t\tmainAlignment=\"center\"\n\t\t\tcrossAlignment=\"flex-start\"\n\t\t\theight=\"fit\"\n\t\t>\n\t\t\t<ModalHeader title={`${t('label.delete', 'Delete')} ${folder.name}`} onClose={onClose} />\n\t\t\t<Container\n\t\t\t\tpadding={{ all: 'small' }}\n\t\t\t\tmainAlignment=\"center\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\theight=\"fit\"\n\t\t\t>\n\t\t\t\t{startsWith(folder.absFolderPath, '/Trash') ? (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Text overflow=\"break-word\">\n\t\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t\t'folder_panel.modal.delete.body.message2',\n\t\t\t\t\t\t\t\t'Do you want to delete the selected folder permanently?'\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t<Text overflow=\"break-word\">\n\t\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t\t'folder_panel.modal.delete.body.message4',\n\t\t\t\t\t\t\t\t'If you delete it, all the related content will be permanently removed and the folder will no longer be recoverable.'\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</>\n\t\t\t\t) : (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Text overflow=\"break-word\">\n\t\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t\t'folder_panel.modal.delete.body.message1',\n\t\t\t\t\t\t\t\t'Do you want to delete the selected folder?'\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t<Text overflow=\"break-word\">\n\t\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t\t'folder_panel.modal.delete.body.message3',\n\t\t\t\t\t\t\t\t'If you delete it, all the related content will be moved to Trash and the folder will no longer be visible.'\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</Container>\n\t\t\t<Divider />\n\t\t\t<ModalFooter\n\t\t\t\tonConfirm={onConfirm}\n\t\t\t\tsecondaryAction={onClose}\n\t\t\t\tsecondaryLabel={t('label.cancel', 'cancel')}\n\t\t\t\tlabel={t('action.ok', 'Ok')}\n\t\t\t\tcolor=\"error\"\n\t\t\t/>\n\t\t</Container>\n\t) : (\n\t\t<></>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createContext } from 'react';\n\nexport const Context = createContext<{\n\tsetActiveGrant?: (arg: any) => void;\n\tactiveModal?: string;\n\tsetActiveModal?: (arg: string) => void;\n\tactiveGrant?: any;\n\tonClose?: () => void;\n}>({});\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\nimport { map } from 'lodash';\n\nexport const sendShareNotification = createAsyncThunk(\n\t'mail/sendShareNotification',\n\tasync (data: any, { getState }) =>\n\t\tPromise.all(\n\t\t\tmap(data.contacts, (contact, index) =>\n\t\t\t\tfetch('/service/soap/SendShareNotificationRequest', {\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'content-type': 'application/soap+xml'\n\t\t\t\t\t},\n\t\t\t\t\tbody: `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n                <soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\">\n                    <soap:Header>\n                        <context xmlns=\"urn:zimbra\">\n                            <account by=\"name\">${data.accounts[0].name}</account>\n                            <format type=\"js\"/>\n                        </context>\n                    </soap:Header>\n                    <soap:Body>\n                    <SendShareNotificationRequest xmlns=\"urn:zimbraMail\">\n                           <item id=\"${data.folder.id}\"/>\n                           <e a=\"${contact.email}\"/>\n                           ${\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.standardMessage.length > 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? `<notes>${data.standardMessage}</notes>`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n                           \n                    </SendShareNotificationRequest>\t\t\t\t\n                    </soap:Body>\n                </soap:Envelope>\n            `\n\t\t\t\t}).then((resData) => resData.json())\n\t\t\t)\n\t\t)\n);\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, useCallback, useContext, useEffect, useMemo, useState } from 'react';\n\nimport {\n\tButton,\n\tChip,\n\tChipProps,\n\tContainer,\n\tDivider,\n\tPadding,\n\tText,\n\tTooltip\n} from '@zextras/carbonio-design-system';\nimport { Grant, soapFetch, t, useUserAccounts } from '@zextras/carbonio-shell-ui';\nimport { map } from 'lodash';\nimport styled from 'styled-components';\n\nimport { Context } from './edit-context';\nimport { useAppDispatch } from '../../../../hooks/redux';\nimport { useUiUtilities } from '../../../../hooks/use-ui-utilities';\nimport {\n\tfindLabel,\n\tShareCalendarRoleOptions\n} from '../../../../integrations/shared-invite-reply/parts/utils';\nimport { sendShareNotification } from '../../../../store/actions/send-share-notification';\nimport type {\n\tActionProps,\n\tGranteeInfoProps,\n\tGranteeProps,\n\tShareFolderPropertiesProps\n} from '../../../../types';\n\nconst HoverChip = styled(Chip)<ChipProps & { hovered?: boolean }>`\n\tbackground-color: ${({ theme, hovered }): string =>\n\t\thovered ? theme.palette.gray3.hover : theme.palette.gray3.regular};\n`;\n\nexport const GranteeInfo: FC<GranteeInfoProps> = ({ grant, shareCalendarRoleOptions, hovered }) => {\n\tconst role = useMemo(\n\t\t() => findLabel(shareCalendarRoleOptions, grant.perm || ''),\n\t\t[shareCalendarRoleOptions, grant.perm]\n\t);\n\n\tconst label = useMemo(() => {\n\t\tconst composeLabel = (name: string): string => `${name} - ${role}`;\n\t\treturn grant.d ? composeLabel(grant.d) : composeLabel(grant.zid);\n\t}, [grant, role]);\n\n\treturn (\n\t\t<Container crossAlignment=\"flex-start\">\n\t\t\t<Text>\n\t\t\t\t<HoverChip label={label} hovered={hovered} />\n\t\t\t</Text>\n\t\t</Container>\n\t);\n};\n\nconst Actions: FC<ActionProps> = ({\n\tfolder,\n\tgrant,\n\tsetActiveModal,\n\tonMouseLeave,\n\tonMouseEnter\n}) => {\n\tconst accounts = useUserAccounts();\n\tconst { setActiveGrant } = useContext(Context);\n\t// eslint-disable-next-line @typescript-eslint/ban-types\n\tconst dispatch = useAppDispatch() as Function;\n\tconst onRevoke = useCallback(() => {\n\t\tif (setActiveGrant) setActiveGrant(grant);\n\t\tsetActiveModal('revoke');\n\t}, [setActiveModal, setActiveGrant, grant]);\n\n\tconst { createSnackbar } = useUiUtilities();\n\n\tconst onResend = useCallback(() => {\n\t\tdispatch(\n\t\t\tsendShareNotification({\n\t\t\t\tstandardMessage: '',\n\t\t\t\tcontacts: [{ email: grant.d }],\n\t\t\t\tfolder,\n\t\t\t\taccounts\n\t\t\t})\n\t\t).then((res: Response) => {\n\t\t\tif (res.type.includes('fulfilled')) {\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `resend-${folder.id}`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\ttype: 'info',\n\t\t\t\t\tlabel: t('snackbar.share_resend', 'Share invite resent'),\n\t\t\t\t\tautoHideTimeout: 2000,\n\t\t\t\t\thideButton: true\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}, [accounts, createSnackbar, dispatch, folder, grant.d]);\n\tconst onEdit = useCallback(() => {\n\t\tif (setActiveGrant) setActiveGrant(grant);\n\t\tsetActiveModal('edit');\n\t}, [setActiveModal, setActiveGrant, grant]);\n\n\treturn (\n\t\t<Container\n\t\t\torientation=\"horizontal\"\n\t\t\tmainAlignment=\"flex-end\"\n\t\t\tonMouseEnter={onMouseEnter}\n\t\t\tonMouseLeave={onMouseLeave}\n\t\t\tmaxWidth=\"fit\"\n\t\t>\n\t\t\t<Tooltip label={t('tooltip.edit', 'Edit share properties')} placement=\"top\">\n\t\t\t\t<Button type=\"outlined\" label={t('label.edit', 'Edit')} onClick={onEdit} size=\"small\" />\n\t\t\t</Tooltip>\n\t\t\t<Padding horizontal=\"extrasmall\" />\n\t\t\t<Tooltip label={t('tooltip.revoke', 'Revoke access')} placement=\"top\">\n\t\t\t\t<Button\n\t\t\t\t\ttype=\"outlined\"\n\t\t\t\t\tlabel={t('label.revoke', 'Revoke')}\n\t\t\t\t\tcolor=\"error\"\n\t\t\t\t\tonClick={onRevoke}\n\t\t\t\t\tsize=\"small\"\n\t\t\t\t/>\n\t\t\t</Tooltip>\n\t\t\t<Padding horizontal=\"extrasmall\" />\n\t\t\t<Tooltip\n\t\t\t\tlabel={t('tooltip.resend', 'Send mail notification about this share')}\n\t\t\t\tplacement=\"top\"\n\t\t\t\tmaxWidth=\"18.75rem\"\n\t\t\t>\n\t\t\t\t<Button\n\t\t\t\t\ttype=\"outlined\"\n\t\t\t\t\tlabel={t('label.resend', 'Resend')}\n\t\t\t\t\tonClick={onResend}\n\t\t\t\t\tsize=\"small\"\n\t\t\t\t/>\n\t\t\t</Tooltip>\n\t\t</Container>\n\t);\n};\nconst Grantee: FC<GranteeProps> = ({ grant, folder, setActiveModal, shareCalendarRoleOptions }) => {\n\tconst [hovered, setHovered] = useState(false);\n\tconst onMouseEnter = useCallback(() => {\n\t\tsetHovered(true);\n\t}, []);\n\tconst onMouseLeave = useCallback(() => {\n\t\tsetHovered(false);\n\t}, []);\n\treturn (\n\t\t<Container orientation=\"horizontal\" mainAlignment=\"flex-end\" padding={{ bottom: 'small' }}>\n\t\t\t<GranteeInfo\n\t\t\t\tgrant={grant}\n\t\t\t\tshareCalendarRoleOptions={shareCalendarRoleOptions}\n\t\t\t\thovered={hovered}\n\t\t\t/>\n\t\t\t<Actions\n\t\t\t\tfolder={folder}\n\t\t\t\tonMouseLeave={onMouseLeave}\n\t\t\t\tonMouseEnter={onMouseEnter}\n\t\t\t\tgrant={grant}\n\t\t\t\tsetActiveModal={setActiveModal}\n\t\t\t/>\n\t\t</Container>\n\t);\n};\n\nexport const ShareFolderProperties: FC<ShareFolderPropertiesProps> = ({\n\tfolder,\n\tsetActiveModal\n}) => {\n\tconst [grant, setGrant] = useState<Array<Grant> | undefined>();\n\n\tuseEffect(() => {\n\t\tsoapFetch('GetFolder', {\n\t\t\t_jsns: 'urn:zimbraMail',\n\t\t\tfolder: { l: folder.id }\n\t\t}).then((res: any): void => {\n\t\t\tif (res?.folder) {\n\t\t\t\tsetGrant(res.folder[0].acl.grant);\n\t\t\t}\n\t\t});\n\t}, [folder.id]);\n\n\tconst shareCalendarRoleOptions = useMemo(\n\t\t() => ShareCalendarRoleOptions(t, grant?.[0]?.perm?.includes('p')),\n\t\t[grant]\n\t);\n\treturn (\n\t\t<Container mainAlignment=\"center\" crossAlignment=\"flex-start\" height=\"fit\">\n\t\t\t<Padding vertical=\"small\" />\n\t\t\t<Text weight=\"bold\">{t('label.shares_folder_edit', 'Sharing of this folder')}</Text>\n\t\t\t<Padding vertical=\"small\" />\n\t\t\t{map(grant, (item) => (\n\t\t\t\t<Grantee\n\t\t\t\t\tkey={item?.zid}\n\t\t\t\t\tgrant={item}\n\t\t\t\t\tfolder={folder}\n\t\t\t\t\tsetActiveModal={setActiveModal}\n\t\t\t\t\tshareCalendarRoleOptions={shareCalendarRoleOptions}\n\t\t\t\t/>\n\t\t\t))}\n\t\t\t<Padding top=\"medium\" />\n\t\t\t<Divider />\n\t\t\t<Padding bottom=\"medium\" />\n\t\t</Container>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { createAsyncThunk } from '@reduxjs/toolkit';\nimport { Account, BatchRequest, soapFetch } from '@zextras/carbonio-shell-ui';\nimport { BatchResponse } from '@zextras/carbonio-shell-ui/lib/types/network';\nimport { trim } from 'lodash';\n\nimport { Folder } from '../../carbonio-ui-commons/types/folder';\nimport { FolderActionGrant, FolderActionRequest } from '../../types';\n\nexport type ShareFolderDataType = {\n\tsendNotification?: boolean;\n\tstandardMessage?: string;\n\tcontacts: Array<{ email: string }>;\n\tfolder: Folder;\n\tshareWithUserRole: string;\n\taccounts: Array<Account>;\n};\n\nexport const shareFolder = createAsyncThunk(\n\t'mail/shareFolder',\n\tasync (data: ShareFolderDataType) => {\n\t\tconst requests = data?.contacts?.map((contact, index) => ({\n\t\t\t_jsns: 'urn:zimbraMail',\n\t\t\trequestId: index,\n\t\t\taction: {\n\t\t\t\tid: data.folder.id,\n\t\t\t\top: 'grant',\n\t\t\t\tgrant: {\n\t\t\t\t\tgt: 'usr',\n\t\t\t\t\td: trim(contact.email, '<>'),\n\t\t\t\t\tperm: data.shareWithUserRole,\n\t\t\t\t\tpw: '',\n\t\t\t\t\tinh: '1'\n\t\t\t\t}\n\t\t\t} as FolderActionGrant\n\t\t}));\n\n\t\tconst response = await soapFetch<\n\t\t\tBatchRequest & { FolderActionRequest?: Array<FolderActionRequest> },\n\t\t\tBatchResponse\n\t\t>('Batch', {\n\t\t\t_jsns: 'urn:zimbra',\n\t\t\tFolderActionRequest: requests\n\t\t});\n\n\t\treturn { response };\n\t}\n);\n","/*\n/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { ChangeEvent, FC, useCallback, useMemo, useState } from 'react';\n\nimport {\n\tCheckbox,\n\tChipInput,\n\tChipItem,\n\tContainer,\n\tInput,\n\tPadding,\n\tRow,\n\tSelect,\n\tSelectItem,\n\tText\n} from '@zextras/carbonio-design-system';\nimport { t, useIntegratedComponent, useUserAccounts } from '@zextras/carbonio-shell-ui';\nimport { map } from 'lodash';\n\nimport { GranteeInfo } from './parts/edit/share-folder-properties';\nimport ModalFooter from '../../carbonio-ui-commons/components/modals/modal-footer';\nimport ModalHeader from '../../carbonio-ui-commons/components/modals/modal-header';\nimport type { EditPermissionsModalProps } from '../../carbonio-ui-commons/types/sidebar';\nimport { useAppDispatch } from '../../hooks/redux';\nimport { useUiUtilities } from '../../hooks/use-ui-utilities';\nimport {\n\tShareCalendarRoleOptions,\n\tfindLabel\n} from '../../integrations/shared-invite-reply/parts/utils';\nimport { sendShareNotification } from '../../store/actions/send-share-notification';\nimport { shareFolder } from '../../store/actions/share-folder';\n\n// TODO refactor IRIS-4324\nconst EditPermissionsModal: FC<EditPermissionsModalProps> = ({\n\tonClose,\n\tfolder,\n\teditMode = false,\n\tgrant,\n\tgoBack\n}) => {\n\tconst dispatch = useAppDispatch();\n\tconst [ContactInput, integrationAvailable] = useIntegratedComponent('contact-input');\n\tconst shareCalendarRoleOptions = useMemo(() => ShareCalendarRoleOptions(t), []);\n\tconst [sendNotification, setSendNotification] = useState(true);\n\tconst [standardMessage, setStandardMessage] = useState('');\n\tconst [contacts, setContacts] = useState<any>([]);\n\tconst [shareWithUserRole, setshareWithUserRole] = useState(editMode ? grant.perm : 'r');\n\n\tconst { createSnackbar } = useUiUtilities();\n\n\tconst accounts = useUserAccounts();\n\n\tconst title = useMemo(\n\t\t() =>\n\t\t\teditMode\n\t\t\t\t? `${t('label.edit_access', 'Edit access')} `\n\t\t\t\t: `${t('label.share', 'Share')} ${folder.name}`,\n\t\t[editMode, folder.name]\n\t);\n\n\tconst onShareRoleChange = useCallback((shareRole) => {\n\t\tsetshareWithUserRole(shareRole);\n\t}, []);\n\n\tconst onConfirm = useCallback(() => {\n\t\tdispatch(\n\t\t\tshareFolder({\n\t\t\t\tsendNotification,\n\t\t\t\tstandardMessage,\n\t\t\t\tcontacts: editMode ? [{ email: grant.d || grant.zid }] : contacts,\n\t\t\t\tshareWithUserRole,\n\t\t\t\tfolder,\n\t\t\t\taccounts\n\t\t\t})\n\t\t).then((res: { type: string }) => {\n\t\t\tif (!('Fault' in res)) {\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `share-${folder.id}`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\thideButton: true,\n\t\t\t\t\ttype: 'info',\n\t\t\t\t\tlabel: editMode\n\t\t\t\t\t\t? t('snackbar.share_updated', '\"Access rights updated\"')\n\t\t\t\t\t\t: t('snackbar.folder_shared', 'Folder shared'),\n\t\t\t\t\tautoHideTimeout: 3000\n\t\t\t\t});\n\t\t\t\tsendNotification &&\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tsendShareNotification({\n\t\t\t\t\t\t\tsendNotification,\n\t\t\t\t\t\t\tstandardMessage,\n\t\t\t\t\t\t\tcontacts: editMode ? [{ email: grant.d || grant.zid }] : contacts,\n\t\t\t\t\t\t\tshareWithUserRole,\n\t\t\t\t\t\t\tfolder,\n\t\t\t\t\t\t\taccounts\n\t\t\t\t\t\t})\n\t\t\t\t\t).then((res2: { type: string }) => {\n\t\t\t\t\t\tif (!res2.type.includes('fulfilled')) {\n\t\t\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\t\t\tkey: `share-${folder.id}`,\n\t\t\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\thideButton: true,\n\t\t\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\t\t\tautoHideTimeout: 3000\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t}\n\t\t\tonClose();\n\t\t});\n\t}, [\n\t\tdispatch,\n\t\tsendNotification,\n\t\tstandardMessage,\n\t\teditMode,\n\t\tgrant,\n\t\tcontacts,\n\t\tshareWithUserRole,\n\t\tfolder,\n\t\taccounts,\n\t\tonClose,\n\t\tcreateSnackbar\n\t]);\n\n\tconst disableEdit = useMemo(\n\t\t() => grant?.perm === shareWithUserRole,\n\t\t[grant?.perm, shareWithUserRole]\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<Container\n\t\t\t\tmainAlignment=\"center\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\theight=\"fit\"\n\t\t\t\tpadding={{ vertical: 'small' }}\n\t\t\t>\n\t\t\t\t<ModalHeader title={title} onClose={onClose} />\n\t\t\t\t<Padding top=\"small\" />\n\t\t\t\t{editMode ? (\n\t\t\t\t\t<Container\n\t\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t\t\tmainAlignment=\"flex-end\"\n\t\t\t\t\t\tpadding={{ bottom: 'large', top: 'large' }}\n\t\t\t\t\t>\n\t\t\t\t\t\t<GranteeInfo grant={grant} shareCalendarRoleOptions={shareCalendarRoleOptions} />\n\t\t\t\t\t</Container>\n\t\t\t\t) : (\n\t\t\t\t\t<Container height=\"fit\" padding={{ vertical: 'small' }}>\n\t\t\t\t\t\t{integrationAvailable ? (\n\t\t\t\t\t\t\t<ContactInput\n\t\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\t\tbackground=\"gray4\"\n\t\t\t\t\t\t\t\tplaceholder={t('share.recipients_address', 'Recipients e-mail addresses')}\n\t\t\t\t\t\t\t\tonChange={(ev: ChangeEvent<HTMLInputElement>): void => {\n\t\t\t\t\t\t\t\t\tsetContacts(ev);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tdefaultValue={contacts}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<ChipInput\n\t\t\t\t\t\t\t\tplaceholder={t('share.recipients_address', 'Recipients e-mail addresses')}\n\t\t\t\t\t\t\t\tonChange={(items: ChipItem[]): void => {\n\t\t\t\t\t\t\t\t\tsetContacts(map(items, (contact) => ({ email: contact })));\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Container>\n\t\t\t\t)}\n\n\t\t\t\t<Container height=\"fit\">\n\t\t\t\t\t<Select\n\t\t\t\t\t\tdata-testid={'share-role'}\n\t\t\t\t\t\titems={shareCalendarRoleOptions}\n\t\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\t\tlabel={t('label.role', 'Role')}\n\t\t\t\t\t\tonChange={onShareRoleChange}\n\t\t\t\t\t\tdefaultSelection={\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvalue: editMode ? grant?.perm : 'r',\n\t\t\t\t\t\t\t\tlabel: findLabel(shareCalendarRoleOptions, editMode ? grant?.perm : 'r')\n\t\t\t\t\t\t\t} as SelectItem\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</Container>\n\t\t\t\t<Container\n\t\t\t\t\theight=\"fit\"\n\t\t\t\t\tmainAlignment=\"flex-start\"\n\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\tpadding={{ vertical: 'medium' }}\n\t\t\t\t\tdata-testid={'sendNotificationCheckboxContainer'}\n\t\t\t\t>\n\t\t\t\t\t<Checkbox\n\t\t\t\t\t\tvalue={sendNotification}\n\t\t\t\t\t\tdefaultChecked={sendNotification}\n\t\t\t\t\t\tonClick={(): void => setSendNotification(!sendNotification)}\n\t\t\t\t\t\tlabel={t('share.send_notification', 'Send a notification about this share')}\n\t\t\t\t\t/>\n\t\t\t\t</Container>\n\n\t\t\t\t<Container height=\"fit\">\n\t\t\t\t\t<Input\n\t\t\t\t\t\tlabel={t('share.standard_message', 'Add a note to the standard message')}\n\t\t\t\t\t\tvalue={standardMessage}\n\t\t\t\t\t\tonChange={(ev: ChangeEvent<HTMLInputElement>): void => {\n\t\t\t\t\t\t\tsetStandardMessage(ev.target.value);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tdisabled={!sendNotification}\n\t\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t\t/>\n\t\t\t\t</Container>\n\t\t\t\t<Container\n\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t\tcrossAlignment=\"baseline\"\n\t\t\t\t\tmainAlignment=\"baseline\"\n\t\t\t\t\tpadding={{ all: 'small' }}\n\t\t\t\t>\n\t\t\t\t\t<Row padding={{ right: 'small' }}>\n\t\t\t\t\t\t<Text weight=\"bold\" size=\"small\" color=\"gray0\">\n\t\t\t\t\t\t\tNote:\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</Row>\n\t\t\t\t\t<Row padding={{ bottom: 'small' }}>\n\t\t\t\t\t\t<Text overflow=\"break-word\" size=\"small\" color=\"gray1\">\n\t\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t\t'share.share_note',\n\t\t\t\t\t\t\t\t'The standard message displays your name, the name of the shared item, pemissions granted to the recipients, and sign in information, if necessary.'\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</Row>\n\t\t\t\t</Container>\n\t\t\t</Container>\n\t\t\t<ModalFooter\n\t\t\t\tlabel={\n\t\t\t\t\teditMode ? t('action.edit_share', 'Edit Share') : t('action.share_folder', 'Share folder')\n\t\t\t\t}\n\t\t\t\tonConfirm={onConfirm}\n\t\t\t\tdisabled={editMode ? disableEdit : contacts.length < 1}\n\t\t\t\tsecondaryAction={goBack}\n\t\t\t\tsecondaryLabel={t('label.go_back', 'Go Back')}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default EditPermissionsModal;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { Container, Divider, Padding, Row, Text } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\nimport React, { FC } from 'react';\nimport type { Folder } from '../../../../carbonio-ui-commons/types/folder';\n\nconst bytesToSize = (bytes: number): string => {\n\tconst sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n\tif (bytes === 0) return '0 Byte';\n\tconst i = Math.floor(Math.log(bytes) / Math.log(1024));\n\treturn `${Math.round(bytes / 1024 ** i)} ${sizes[i]}`;\n};\n\nexport const FolderDetails: FC<{ folder: Folder }> = ({ folder }) => (\n\t<>\n\t\t<Container\n\t\t\tmainAlignment=\"flex-start\"\n\t\t\tpadding={{ all: 'small' }}\n\t\t\tcrossAlignment=\"flex-start\"\n\t\t\twidth=\"100%\"\n\t\t\torientation=\"horizontal\"\n\t\t>\n\t\t\t<Row orientation=\"vertical\" width=\"33.33%\" crossAlignment=\"flex-start\">\n\t\t\t\t<Text size=\"small\" color=\"secondary\">\n\t\t\t\t\t{t('label.type', 'Type')}\n\t\t\t\t</Text>\n\t\t\t\t<Padding top=\"extrasmall\" />\n\t\t\t\t<Text>{t('label.mail_folder', 'E-mail folder')}</Text>\n\t\t\t</Row>\n\t\t\t<Row orientation=\"vertical\" width=\"33.33%\" crossAlignment=\"flex-start\">\n\t\t\t\t<Text size=\"small\" color=\"secondary\">\n\t\t\t\t\t{t('label.messages', 'Messages')}\n\t\t\t\t</Text>\n\t\t\t\t<Padding top=\"extrasmall\" />\n\t\t\t\t<Text>{folder.n}</Text>\n\t\t\t</Row>\n\t\t\t<Row orientation=\"vertical\" width=\"33.33%\" crossAlignment=\"flex-start\">\n\t\t\t\t<Text size=\"small\" color=\"secondary\">\n\t\t\t\t\t{t('label.size', 'Size')}\n\t\t\t\t</Text>\n\t\t\t\t<Padding top=\"extrasmall\" />\n\t\t\t\t<Text>{bytesToSize(folder.s || 0)}</Text>\n\t\t\t</Row>\n\t\t</Container>\n\t\t<Divider />\n\t\t<Padding bottom=\"medium\" />\n\t</>\n);\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\n// eslint-disable-next-line no-shadow\nexport const FolderActionsType = {\n\tNEW: 'new',\n\tMOVE: 'move',\n\tDELETE: 'delete',\n\tEDIT: 'edit',\n\tEMPTY: 'empty',\n\tREMOVE_FROM_LIST: 'removeFromList',\n\tSHARES_INFO: 'sharesInfo',\n\tSHARE: 'share',\n\tMARK_ALL_READ: 'read'\n} as const;\n","import { FolderActionsType } from '../constants/folders';\nimport { Folder } from '../types/folder';\n\n/*\n * SPDX-FileCopyrightText: 2023 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nexport const isValidFolderName = (folderName: string): boolean => {\n\t// Check if the folder name is empty\n\tif (!folderName.trim()) {\n\t\treturn false;\n\t}\n\n\t// Regular expression pattern for invalid characters\n\tconst invalidChars = /[\"/:]/;\n\n\t// Check if the folder name contains any invalid characters\n\tif (invalidChars.test(folderName)) {\n\t\treturn false;\n\t}\n\n\t// Check if the folder name is too long (limit it to 128 characters)\n\tif (folderName.length > 128) {\n\t\treturn false;\n\t}\n\n\t// If all checks pass, the folder name is considered valid\n\treturn true;\n};\n\nexport const allowedActionOnSharedAccount = (folder: Folder, action: string): boolean => {\n\tconst permission = folder.perm;\n\tswitch (action) {\n\t\tcase FolderActionsType.NEW:\n\t\t\tif (permission)\n\t\t\t\tif (permission.includes('rwidx')) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\treturn true;\n\t\tcase FolderActionsType.SHARE:\n\t\t\tif (permission)\n\t\t\t\tif (permission.includes('rwidxa')) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\treturn true;\n\t\tdefault:\n\t\t\treturn true;\n\t}\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { ChangeEvent, FC } from 'react';\n\nimport { Container, Input, Padding, Text } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\n\nimport type { NameInputRowProps } from '../../../../carbonio-ui-commons/types/sidebar';\nimport { isValidFolderName } from '../../../../carbonio-ui-commons/utils/utils';\nimport ColorPicker from '../../../../integrations/shared-invite-reply/parts/color-select';\n\nconst NameInputRow: FC<NameInputRowProps> = ({\n\tsetInputValue,\n\tinpDisable,\n\tshowWarning,\n\tinputValue,\n\tfolderColor,\n\tsetFolderColor\n}) => (\n\t<Container mainAlignment=\"center\" crossAlignment=\"flex-start\">\n\t\t<Input\n\t\t\tlabel={t('label.folder_name', 'Folder name')}\n\t\t\tonChange={(e: ChangeEvent<HTMLInputElement>): void => setInputValue(e.target.value)}\n\t\t\tdisabled={inpDisable}\n\t\t\tvalue={inputValue}\n\t\t\thasError={showWarning && !inpDisable}\n\t\t\tdata-testid=\"folder-name\"\n\t\t/>\n\t\t{showWarning && !inpDisable && (\n\t\t\t<Padding all=\"small\">\n\t\t\t\t<Text size=\"small\" color=\"error\" data-testid=\"rename-error-msg\">\n\t\t\t\t\t{inputValue && !isValidFolderName(inputValue)\n\t\t\t\t\t\t? t(\n\t\t\t\t\t\t\t\t'folder.modal.edit.invalid_folder_name_warning_msg',\n\t\t\t\t\t\t\t\t'Special characters not allowed. Max lenght is 128 characters.'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t: t('folder.modal.edit.rename_warning', 'You cannot rename a folder as a system one')}\n\t\t\t\t</Text>\n\t\t\t</Padding>\n\t\t)}\n\t\t<Padding top=\"small\" />\n\t\t<ColorPicker\n\t\t\tonChange={(color: string | null): void => setFolderColor(color ?? '')}\n\t\t\tlabel={t('label.select_color', 'Select Color')}\n\t\t\tdefaultColor={parseInt(folderColor ?? '0', 10)}\n\t\t\tdata-testid=\"folder-color\"\n\t\t/>\n\t</Container>\n);\n\nexport default NameInputRow;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { ChangeEvent, FC } from 'react';\nimport {\n\tContainer,\n\tCheckbox,\n\tRow,\n\tPadding,\n\tText,\n\tIconButton,\n\tCollapse,\n\tInput,\n\tSelect\n} from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\nimport type { RetentionPoliciesProps } from '../../../../carbonio-ui-commons/types/sidebar';\n\nconst RetentionPolicies: FC<RetentionPoliciesProps> = ({\n\tshowPolicy,\n\tsetShowPolicy,\n\temptyRtnValue,\n\tsetEmptyRtnValue,\n\tdsblMsgRet,\n\tsetDsblMsgRet,\n\trtnValue,\n\tsetRtnValue,\n\tretentionPeriod,\n\trtnYear,\n\tsetRtnYear,\n\tdsblMsgDis,\n\tsetDsblMsgDis,\n\temptyDisValue,\n\tsetEmptyDisValue,\n\tpurgeValue,\n\tsetPurgeValue,\n\tdspYear,\n\tsetDspYear,\n\trtnRange,\n\tdspRange\n}) => (\n\t<>\n\t\t<Row orientation=\"horizontal\" mainAlignment=\"space-between\" takeAvailableSpace width=\"100%\">\n\t\t\t<Text weight=\"bold\" size=\"large\">\n\t\t\t\t{t('label.retention_policy', 'Retention policy')}\n\t\t\t</Text>\n\n\t\t\t<IconButton\n\t\t\t\tsize=\"medium\"\n\t\t\t\tstyle={{ padding: 0, margin: 0 }}\n\t\t\t\tonClick={(): void => setShowPolicy(!showPolicy)}\n\t\t\t\ticon={showPolicy ? 'ChevronUpOutline' : 'ChevronDownOutline'}\n\t\t\t\tdata-testid=\"retention_policy-icon\"\n\t\t\t/>\n\t\t</Row>\n\t\t<Collapse orientation=\"vertical\" open={showPolicy}>\n\t\t\t<Container mainAlignment=\"flex-start\" crossAlignment=\"flex-start\" padding={{ top: 'medium' }}>\n\t\t\t\t<Checkbox\n\t\t\t\t\tvalue={dsblMsgRet}\n\t\t\t\t\tonClick={(): void => {\n\t\t\t\t\t\temptyRtnValue && setEmptyRtnValue(false);\n\t\t\t\t\t\tsetDsblMsgRet(!dsblMsgRet);\n\t\t\t\t\t}}\n\t\t\t\t\tlabel={t('label.enable_message_retention', 'Enable Message Retention')}\n\t\t\t\t\tdata-testid=\"enableMsgRetention\"\n\t\t\t\t/>\n\t\t\t\t<Container padding={{ all: 'small' }}>\n\t\t\t\t\t<Text overflow=\"break-word\">\n\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t'folder.modal.edit.retention_message',\n\t\t\t\t\t\t\t'Messages in this folder which fall within the retention range will require explicit confirmation before being deleted'\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Text>\n\t\t\t\t</Container>\n\t\t\t\t<Row\n\t\t\t\t\tmainAlignment=\"space-between\"\n\t\t\t\t\tpadding={{ vertical: 'small', horizontal: 'medium' }}\n\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\ttakeAvailableSpace\n\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t>\n\t\t\t\t\t<Row orientation=\"vertical\" width=\"48%\" crossAlignment=\"flex-start\">\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tdisabled={!dsblMsgRet}\n\t\t\t\t\t\t\tonChange={(e: ChangeEvent<HTMLInputElement>): void => {\n\t\t\t\t\t\t\t\temptyRtnValue && setEmptyRtnValue(false);\n\t\t\t\t\t\t\t\tsetRtnValue(e.target.value);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tlabel={t('label.retention_range', 'Retention Range')}\n\t\t\t\t\t\t\tvalue={rtnValue === 0 ? '' : rtnValue}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{emptyRtnValue && (\n\t\t\t\t\t\t\t<Padding all=\"small\">\n\t\t\t\t\t\t\t\t<Text size=\"small\" color=\"error\">\n\t\t\t\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t\t\t\t'folder.modal.edit.retention_duration_warning',\n\t\t\t\t\t\t\t\t\t\t'The retention duration must be a positive number'\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t</Padding>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Row>\n\t\t\t\t\t<Row orientation=\"vertical\" width=\"48%\" crossAlignment=\"flex-start\">\n\t\t\t\t\t\t{rtnRange && rtnYear && (\n\t\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t\tdisabled={!dsblMsgRet}\n\t\t\t\t\t\t\t\titems={retentionPeriod}\n\t\t\t\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\t\t\t\tlabel={t('label.select', 'Select')}\n\t\t\t\t\t\t\t\tdisablePortal\n\t\t\t\t\t\t\t\tmultiple={false}\n\t\t\t\t\t\t\t\t// TS doesn't get the correct overload\n\t\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\t\tonChange={setRtnYear}\n\t\t\t\t\t\t\t\tdefaultSelection={{ label: rtnRange, value: rtnYear }}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Row>\n\t\t\t\t</Row>\n\t\t\t\t<Padding top=\"small\" />\n\t\t\t\t<Container mainAlignment=\"flex-start\" crossAlignment=\"flex-start\">\n\t\t\t\t\t<Checkbox\n\t\t\t\t\t\tvalue={dsblMsgDis}\n\t\t\t\t\t\tonClick={(): void => {\n\t\t\t\t\t\t\temptyDisValue && setEmptyDisValue(false);\n\t\t\t\t\t\t\tsetDsblMsgDis(!dsblMsgDis);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tlabel={t('label.enable_message_disposal', 'Enable Message Disposal')}\n\t\t\t\t\t\tdata-testid=\"enableMsgDisposal\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Container padding={{ all: 'small' }}>\n\t\t\t\t\t\t<Text overflow=\"break-word\">\n\t\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t\t'folder.modal.edit.threshold_message',\n\t\t\t\t\t\t\t\t'Messages in this folder which are older than the disposal threshold will be subject to automated cleanup and deletion.'\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</Container>\n\t\t\t\t\t<Row\n\t\t\t\t\t\tmainAlignment=\"space-between\"\n\t\t\t\t\t\tpadding={{ vertical: 'small', horizontal: 'medium' }}\n\t\t\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\t\t\ttakeAvailableSpace\n\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\torientation=\"horizontal\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Row orientation=\"vertical\" width=\"48%\" crossAlignment=\"flex-start\">\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tlabel={t('label.disposal_threshold', 'Disposal Threshold')}\n\t\t\t\t\t\t\t\tonChange={(e: ChangeEvent<HTMLInputElement>): void => {\n\t\t\t\t\t\t\t\t\temptyDisValue && setEmptyDisValue(false);\n\t\t\t\t\t\t\t\t\tsetPurgeValue(e.target.value);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tdisabled={!dsblMsgDis}\n\t\t\t\t\t\t\t\tvalue={purgeValue === 0 ? '' : purgeValue}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{emptyDisValue && (\n\t\t\t\t\t\t\t\t<Padding all=\"small\">\n\t\t\t\t\t\t\t\t\t<Text size=\"small\" color=\"error\">\n\t\t\t\t\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t\t\t\t\t'folder.modal.edit.retention_duration_warning',\n\t\t\t\t\t\t\t\t\t\t\t'The retention duration must be a positive number'\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t\t</Padding>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t<Row orientation=\"vertical\" width=\"48%\" crossAlignment=\"flex-start\">\n\t\t\t\t\t\t\t{dspRange && dspYear && (\n\t\t\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t\t\tdisabled={!dsblMsgDis}\n\t\t\t\t\t\t\t\t\titems={retentionPeriod}\n\t\t\t\t\t\t\t\t\tbackground=\"gray5\"\n\t\t\t\t\t\t\t\t\tlabel={t('label.select', 'Select')}\n\t\t\t\t\t\t\t\t\tdisablePortal\n\t\t\t\t\t\t\t\t\t// TS doesn't get the correct overload\n\t\t\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\t\t\tonChange={setDspYear}\n\t\t\t\t\t\t\t\t\tdefaultSelection={{ value: dspYear, label: dspRange }}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t</Row>\n\t\t\t\t</Container>\n\t\t\t</Container>\n\t\t</Collapse>\n\t</>\n);\n\nexport default RetentionPolicies;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { Container } from '@zextras/carbonio-design-system';\nimport { FOLDERS, t } from '@zextras/carbonio-shell-ui';\nimport { includes, isEmpty } from 'lodash';\n\nimport { FolderDetails } from './folder-details';\nimport NameInputRow from './name-input';\nimport RetentionPolicies from './retention-policies';\nimport { ShareFolderProperties } from './share-folder-properties';\nimport ModalFooter from '../../../../carbonio-ui-commons/components/modals/modal-footer';\nimport ModalHeader from '../../../../carbonio-ui-commons/components/modals/modal-header';\nimport { FolderActionsType } from '../../../../carbonio-ui-commons/constants/folders';\nimport type { MainEditModalPropType } from '../../../../carbonio-ui-commons/types/sidebar';\nimport {\n\tallowedActionOnSharedAccount,\n\tisValidFolderName\n} from '../../../../carbonio-ui-commons/utils/utils';\nimport { useUiUtilities } from '../../../../hooks/use-ui-utilities';\nimport { folderAction } from '../../../../store/actions/folder-action';\nimport { translatedSystemFolders } from '../../utils';\n\nconst numberRegex = /^\\d+$/;\nconst DAYS_LABEL = 'label.days';\nconst WEEKS_LABEL = 'label.weeks';\nconst MONTHS_LABEL = 'label.months';\nconst YEARS_LABEL = 'label.years';\n\nconst MainEditModal: FC<MainEditModalPropType> = ({ folder, onClose, setActiveModal }) => {\n\tconst [inputValue, setInputValue] = useState(folder.name);\n\tconst [showPolicy, setShowPolicy] = useState(false);\n\tconst [rtnValue, setRtnValue] = useState<number | string>(0);\n\tconst [purgeValue, setPurgeValue] = useState<number | string>(0);\n\tconst [rtnYear, setRtnYear] = useState<string | null>('d');\n\tconst [dspYear, setDspYear] = useState<string | null>('d');\n\tconst [rtnRange, setRtnRange] = useState('');\n\tconst [dspRange, setDspRange] = useState<string>('');\n\tconst [dsblMsgDis, setDsblMsgDis] = useState(false);\n\tconst [dsblMsgRet, setDsblMsgRet] = useState(false);\n\tconst [emptyRtnValue, setEmptyRtnValue] = useState(false);\n\tconst [emptyDisValue, setEmptyDisValue] = useState(false);\n\tconst [folderColor, setFolderColor] = useState(folder?.color ?? 0);\n\n\tconst retentionPeriod = [\n\t\t{\n\t\t\tlabel: t(DAYS_LABEL, 'Days'),\n\t\t\tvalue: 'd'\n\t\t},\n\t\t{\n\t\t\tlabel: t(WEEKS_LABEL, 'Weeks'),\n\t\t\tvalue: 'w'\n\t\t},\n\t\t{\n\t\t\tlabel: t(MONTHS_LABEL, 'Months'),\n\t\t\tvalue: 'm'\n\t\t},\n\t\t{\n\t\t\tlabel: t(YEARS_LABEL, 'Years'),\n\t\t\tvalue: 'y'\n\t\t}\n\t];\n\n\tconst { createSnackbar } = useUiUtilities();\n\n\tuseEffect(() => {\n\t\tif (\n\t\t\tfolder.retentionPolicy &&\n\t\t\tfolder.retentionPolicy?.length &&\n\t\t\tfolder.retentionPolicy[0].keep !== undefined &&\n\t\t\tfolder.retentionPolicy[0].keep &&\n\t\t\tObject.keys(folder.retentionPolicy[0].keep[0]).length !== 0\n\t\t) {\n\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t// @ts-ignore\n\t\t\tconst lifetime = folder.retentionPolicy[0]?.keep[0]?.policy[0]?.lifetime;\n\t\t\t// eslint-disable-next-line radix\n\t\t\tconst d = parseInt(lifetime);\n\t\t\tsetDsblMsgRet(true);\n\t\t\tsetShowPolicy(true);\n\n\t\t\tif (d % 365 === 0) {\n\t\t\t\tsetRtnYear('y');\n\t\t\t\tsetRtnValue(d / 365);\n\t\t\t\tsetRtnRange(t(YEARS_LABEL, 'Years'));\n\t\t\t} else if (d % 31 === 0) {\n\t\t\t\tsetRtnYear('m');\n\t\t\t\tsetRtnValue(d / 31);\n\t\t\t\tsetRtnRange(t(MONTHS_LABEL, 'Months'));\n\t\t\t} else if (d % 7 === 0) {\n\t\t\t\tsetRtnYear('w');\n\t\t\t\tsetRtnValue(d / 7);\n\t\t\t\tsetRtnRange(t(WEEKS_LABEL, 'Weeks'));\n\t\t\t} else {\n\t\t\t\tsetRtnYear('d');\n\t\t\t\tsetRtnValue(d);\n\t\t\t\tsetRtnRange(t(DAYS_LABEL, 'Days'));\n\t\t\t}\n\t\t} else {\n\t\t\tsetRtnYear('d');\n\t\t\tsetRtnRange(t(DAYS_LABEL, 'Days'));\n\t\t}\n\n\t\tif (\n\t\t\tfolder.retentionPolicy &&\n\t\t\tfolder.retentionPolicy.length &&\n\t\t\tfolder.retentionPolicy[0].purge !== undefined &&\n\t\t\tfolder.retentionPolicy[0].purge &&\n\t\t\tObject.keys(folder.retentionPolicy[0].purge[0]).length !== 0\n\t\t) {\n\t\t\tconst lifetime = folder.retentionPolicy[0]?.purge[0]?.policy[0]?.lifetime;\n\t\t\tconst d = parseInt(lifetime, 10);\n\t\t\tsetDsblMsgDis(true);\n\t\t\tsetShowPolicy(true);\n\n\t\t\tif (d % 365 === 0) {\n\t\t\t\tsetDspYear('y');\n\t\t\t\tsetPurgeValue(d / 365);\n\t\t\t\tsetDspRange(t(YEARS_LABEL, 'Years'));\n\t\t\t} else if (d % 31 === 0) {\n\t\t\t\tsetDspYear('m');\n\t\t\t\tsetPurgeValue(d / 31);\n\t\t\t\tsetDspRange(t(MONTHS_LABEL, 'Months'));\n\t\t\t} else if (d % 7 === 0) {\n\t\t\t\tsetDspYear('w');\n\t\t\t\tsetPurgeValue(d / 7);\n\t\t\t\tsetDspRange(t(WEEKS_LABEL, 'Weeks'));\n\t\t\t} else {\n\t\t\t\tsetDspYear('d');\n\t\t\t\tsetPurgeValue(d);\n\t\t\t\tsetDspRange(t(DAYS_LABEL, 'Days'));\n\t\t\t}\n\t\t} else {\n\t\t\tsetDspYear('d');\n\t\t\tsetDspRange(t(DAYS_LABEL, 'Days'));\n\t\t}\n\t}, [folder.retentionPolicy]);\n\n\tconst showWarning = useMemo(\n\t\t() =>\n\t\t\tincludes(translatedSystemFolders(), inputValue) ||\n\t\t\t(inputValue && !isValidFolderName(inputValue)),\n\t\t[inputValue]\n\t);\n\tconst inpDisable = useMemo(\n\t\t() =>\n\t\t\tincludes(\n\t\t\t\t[FOLDERS.INBOX, FOLDERS.TRASH, FOLDERS.SPAM, FOLDERS.SENT, FOLDERS.DRAFTS],\n\t\t\t\tfolder.id\n\t\t\t),\n\t\t[folder]\n\t);\n\n\tconst disableSubmit = useMemo(\n\t\t() => (showWarning || emptyRtnValue) && !inpDisable,\n\t\t[showWarning, emptyRtnValue, inpDisable]\n\t);\n\n\tconst onConfirm = useCallback(() => {\n\t\tlet submit = true;\n\t\tif (dsblMsgRet) {\n\t\t\tsubmit = false;\n\t\t\tif (rtnValue && numberRegex.test(rtnValue.toString())) {\n\t\t\t\tsubmit = true;\n\t\t\t} else {\n\t\t\t\tsetEmptyRtnValue(true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (dsblMsgDis) {\n\t\t\tsubmit = false;\n\t\t\tif (purgeValue && numberRegex.test(purgeValue.toString())) {\n\t\t\t\tsubmit = true;\n\t\t\t} else {\n\t\t\t\tsetEmptyDisValue(true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (inputValue && submit) {\n\t\t\tlet lt;\n\t\t\tlet pr;\n\n\t\t\tif (rtnYear === 'w') lt = Number(rtnValue) * 7;\n\t\t\telse if (rtnYear === 'm') lt = Number(rtnValue) * 31;\n\t\t\telse if (rtnYear === 'y') lt = Number(rtnValue) * 365;\n\t\t\telse lt = Number(rtnValue);\n\n\t\t\tif (dspYear === 'w') pr = Number(purgeValue) * 7;\n\t\t\telse if (dspYear === 'm') pr = Number(purgeValue) * 31;\n\t\t\telse if (dspYear === 'y') pr = Number(purgeValue) * 365;\n\t\t\telse pr = Number(purgeValue);\n\n\t\t\tfolderAction({\n\t\t\t\tfolder: {\n\t\t\t\t\t...folder,\n\t\t\t\t\tparent: folder.l || '',\n\t\t\t\t\tpath: folder.absFolderPath,\n\t\t\t\t\tabsParent: '2',\n\t\t\t\t\tchildren: []\n\t\t\t\t},\n\t\t\t\tname: inputValue,\n\t\t\t\top: 'update',\n\t\t\t\tcolor: Number(folderColor),\n\t\t\t\tretentionPolicy:\n\t\t\t\t\tdsblMsgRet || dsblMsgDis || folder?.retentionPolicy\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tkeep: dsblMsgRet\n\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\t\tpolicy: {\n\t\t\t\t\t\t\t\t\t\t\t\tlifetime: `${lt}d`,\n\t\t\t\t\t\t\t\t\t\t\t\ttype: 'user'\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t: {},\n\t\t\t\t\t\t\t\tpurge: dsblMsgDis\n\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\t\tpolicy: {\n\t\t\t\t\t\t\t\t\t\t\t\tlifetime: `${pr}d`,\n\t\t\t\t\t\t\t\t\t\t\t\ttype: 'user'\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t: {}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t: {}\n\t\t\t}).then((res) => {\n\t\t\t\tif (!('Fault' in res)) {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `edit`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\thideButton: true,\n\t\t\t\t\t\tlabel: t('messages.snackbar.folder_edited', 'Changes correctly saved'),\n\t\t\t\t\t\tautoHideTimeout: 3000\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `edit`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\thideButton: true,\n\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\tautoHideTimeout: 3000\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tsetInputValue('');\n\t\tonClose();\n\t}, [\n\t\tdsblMsgRet,\n\t\tdsblMsgDis,\n\t\tinputValue,\n\t\tonClose,\n\t\trtnValue,\n\t\tpurgeValue,\n\t\trtnYear,\n\t\tdspYear,\n\t\tfolder,\n\t\tfolderColor,\n\t\tcreateSnackbar\n\t]);\n\n\tconst title = t('label.edit_folder_properties', {\n\t\tname: folder.name,\n\t\tdefaultValue: 'Edit {{name}} properties'\n\t});\n\n\treturn (\n\t\t<>\n\t\t\t<ModalHeader onClose={onClose} title={title} />\n\n\t\t\t<NameInputRow\n\t\t\t\tshowWarning={showWarning}\n\t\t\t\tsetInputValue={setInputValue}\n\t\t\t\tinputValue={inputValue}\n\t\t\t\tinpDisable={inpDisable}\n\t\t\t\tfolderColor={String(folderColor)}\n\t\t\t\tsetFolderColor={setFolderColor}\n\t\t\t/>\n\t\t\t<Container mainAlignment=\"flex-start\" crossAlignment=\"flex-start\" padding={{ top: 'medium' }}>\n\t\t\t\t<FolderDetails folder={folder} />\n\n\t\t\t\t{!isEmpty(folder?.acl) && !folder.owner && (\n\t\t\t\t\t<ShareFolderProperties folder={folder} setActiveModal={setActiveModal} />\n\t\t\t\t)}\n\t\t\t\t<RetentionPolicies\n\t\t\t\t\tsetShowPolicy={setShowPolicy}\n\t\t\t\t\temptyRtnValue={emptyRtnValue}\n\t\t\t\t\tsetEmptyRtnValue={setEmptyRtnValue}\n\t\t\t\t\tshowPolicy={showPolicy}\n\t\t\t\t\tdsblMsgRet={dsblMsgRet}\n\t\t\t\t\tsetDsblMsgRet={setDsblMsgRet}\n\t\t\t\t\tsetRtnValue={setRtnValue}\n\t\t\t\t\trtnValue={rtnValue}\n\t\t\t\t\tretentionPeriod={retentionPeriod}\n\t\t\t\t\tsetRtnYear={setRtnYear}\n\t\t\t\t\tdsblMsgDis={dsblMsgDis}\n\t\t\t\t\temptyDisValue={emptyDisValue}\n\t\t\t\t\tsetEmptyDisValue={setEmptyDisValue}\n\t\t\t\t\tsetDsblMsgDis={setDsblMsgDis}\n\t\t\t\t\tsetPurgeValue={setPurgeValue}\n\t\t\t\t\tsetDspYear={setDspYear}\n\t\t\t\t\trtnYear={rtnYear}\n\t\t\t\t\trtnRange={rtnRange}\n\t\t\t\t\tdspYear={dspYear}\n\t\t\t\t\tdspRange={dspRange}\n\t\t\t\t\tpurgeValue={purgeValue}\n\t\t\t\t/>\n\t\t\t</Container>\n\n\t\t\t<ModalFooter\n\t\t\t\tonConfirm={onConfirm}\n\t\t\t\tlabel={t('label.edit', 'Edit')}\n\t\t\t\tsecondaryAction={(): void => setActiveModal('share')}\n\t\t\t\tsecondaryLabel={t('folder.modal.edit.add_share', 'Add Share')}\n\t\t\t\tdisabled={disableSubmit}\n\t\t\t\tsecondaryDisabled={!allowedActionOnSharedAccount(folder, FolderActionsType.SHARE)}\n\t\t\t\tsecondaryBtnType=\"outlined\"\n\t\t\t\tsecondaryColor=\"primary\"\n\t\t\t\ttooltip={\n\t\t\t\t\tdisableSubmit\n\t\t\t\t\t\t? t('folder.modal.edit.enter_valid_folder_name', 'Enter a valid folder name')\n\t\t\t\t\t\t: ''\n\t\t\t\t}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default MainEditModal;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, useCallback, useMemo, useState } from 'react';\n\nimport { Checkbox, Container, Input, Row, Text } from '@zextras/carbonio-design-system';\nimport { t, useUserAccounts } from '@zextras/carbonio-shell-ui';\n\nimport { GranteeInfo } from './share-folder-properties';\nimport ModalFooter from '../../../../carbonio-ui-commons/components/modals/modal-footer';\nimport ModalHeader from '../../../../carbonio-ui-commons/components/modals/modal-header';\nimport type { ShareRevokeModalType } from '../../../../carbonio-ui-commons/types/sidebar';\nimport { useAppDispatch } from '../../../../hooks/redux';\nimport { useUiUtilities } from '../../../../hooks/use-ui-utilities';\nimport { ShareCalendarRoleOptions } from '../../../../integrations/shared-invite-reply/parts/utils';\nimport { folderAction } from '../../../../store/actions/folder-action';\nimport { sendShareNotification } from '../../../../store/actions/send-share-notification';\n\nconst ShareRevokeModal: FC<ShareRevokeModalType> = ({ folder, onClose, grant, goBack }) => {\n\tconst [sendNotification, setSendNotification] = useState(false);\n\tconst [standardMessage, setStandardMessage] = useState('');\n\n\tconst accounts = useUserAccounts();\n\tconst dispatch = useAppDispatch();\n\n\tconst { createSnackbar } = useUiUtilities();\n\n\tconst onConfirm = useCallback(() => {\n\t\tif (sendNotification) {\n\t\t\tdispatch(\n\t\t\t\tsendShareNotification({\n\t\t\t\t\tsendNotification,\n\t\t\t\t\tstandardMessage,\n\t\t\t\t\tcontacts: [{ email: grant?.d }],\n\t\t\t\t\tfolder,\n\t\t\t\t\taccounts\n\t\t\t\t})\n\t\t\t).then(() => {\n\t\t\t\tfolderAction({ folder, zid: grant.zid, op: '!grant' }).then((res) => {\n\t\t\t\t\tif (!('Fault' in res)) {\n\t\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\t\tkey: `remove-share-${folder.id}`,\n\t\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\t\tlabel: t('snackbar.share_revoke', 'Share access revoked'),\n\t\t\t\t\t\t\tautoHideTimeout: 2000,\n\t\t\t\t\t\t\thideButton: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tgoBack();\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\tfolderAction({ folder, zid: grant.zid, op: '!grant' }).then((res) => {\n\t\t\t\tif (!('Fault' in res)) {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `remove-share-${folder.id}`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\tlabel: t('snackbar.share_revoke', 'Share access revoked'),\n\t\t\t\t\t\tautoHideTimeout: 2000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tgoBack();\n\t\t\t});\n\t\t}\n\t}, [\n\t\tsendNotification,\n\t\tdispatch,\n\t\tstandardMessage,\n\t\tgrant.d,\n\t\tgrant.zid,\n\t\tfolder,\n\t\taccounts,\n\t\tgoBack,\n\t\tcreateSnackbar\n\t]);\n\tconst shareCalendarRoleOptions = useMemo(\n\t\t() => ShareCalendarRoleOptions(t, grant.perm?.includes('p')),\n\t\t[grant.perm]\n\t);\n\n\tconst toolTip = useMemo(() => {\n\t\tif (sendNotification && standardMessage.length > 0)\n\t\t\treturn t('label.revoke_with_custom_message', 'Revoke access sending a custom notification');\n\t\tif (sendNotification)\n\t\t\treturn t('label.revoke_access_tooltip', 'Revoke access sending a standard notification');\n\t\treturn t(\n\t\t\t'label.revoke_access_without_notification',\n\t\t\t'Revoke access without sending a notification'\n\t\t);\n\t}, [sendNotification, standardMessage]);\n\treturn (\n\t\t<Container\n\t\t\tpadding={{ all: 'small' }}\n\t\t\tmainAlignment=\"center\"\n\t\t\tcrossAlignment=\"flex-start\"\n\t\t\theight=\"fit\"\n\t\t>\n\t\t\t<ModalHeader title={t('label.revoke_share', 'Revoke share')} onClose={onClose} />\n\t\t\t<Container\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\tmainAlignment=\"flex-end\"\n\t\t\t\tpadding={{ bottom: 'large', top: 'large' }}\n\t\t\t>\n\t\t\t\t<GranteeInfo\n\t\t\t\t\tgrant={grant}\n\t\t\t\t\thovered={false}\n\t\t\t\t\tshareCalendarRoleOptions={shareCalendarRoleOptions}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Checkbox\n\t\t\t\ticonSize=\"medium\"\n\t\t\t\tvalue={sendNotification}\n\t\t\t\tdefaultChecked={sendNotification}\n\t\t\t\tonClick={(): void => setSendNotification(!sendNotification)}\n\t\t\t\tlabel={t('label.send_notification', 'Send a notification message to')}\n\t\t\t/>\n\t\t\t<Container\n\t\t\t\tmainAlignment=\"center\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\theight=\"fit\"\n\t\t\t\tpadding={{ bottom: 'large', top: 'large' }}\n\t\t\t>\n\t\t\t\t<Input\n\t\t\t\t\tlabel={t('share.standard_message', 'Add a note to the standard message')}\n\t\t\t\t\tvalue={standardMessage}\n\t\t\t\t\tonChange={(ev: React.ChangeEvent<HTMLInputElement>): void => {\n\t\t\t\t\t\tsetStandardMessage(ev.target.value);\n\t\t\t\t\t}}\n\t\t\t\t\tdisabled={!sendNotification}\n\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t\t<Container\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\tcrossAlignment=\"baseline\"\n\t\t\t\tmainAlignment=\"baseline\"\n\t\t\t\tpadding={{ all: 'small' }}\n\t\t\t>\n\t\t\t\t<Row padding={{ right: 'small' }}>\n\t\t\t\t\t<Text weight=\"bold\" size=\"small\" color=\"gray0\">\n\t\t\t\t\t\tNote:\n\t\t\t\t\t</Text>\n\t\t\t\t</Row>\n\t\t\t\t<Row padding={{ bottom: 'small' }}>\n\t\t\t\t\t<Text overflow=\"break-word\" size=\"small\" color=\"gray1\">\n\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t'share.share_note',\n\t\t\t\t\t\t\t'The standard message displays your name, the name of the shared item, pemissions granted to the recipients, and sign in information, if necessary.'\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Text>\n\t\t\t\t</Row>\n\t\t\t</Container>\n\t\t\t<Container mainAlignment=\"center\" crossAlignment=\"flex-start\" height=\"fit\">\n\t\t\t\t<ModalFooter\n\t\t\t\t\tbackground=\"error\"\n\t\t\t\t\tonConfirm={onConfirm}\n\t\t\t\t\tsecondaryAction={goBack}\n\t\t\t\t\tsecondaryLabel={t('label.go_back', 'Go Back')}\n\t\t\t\t\tlabel={t('label.revoke', 'Revoke')}\n\t\t\t\t\ttooltip={toolTip}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</Container>\n\t);\n};\nexport default ShareRevokeModal;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { Container } from '@zextras/carbonio-design-system';\nimport React, { FC, useCallback, useState } from 'react';\nimport type { ModalProps } from '../../types';\nimport EditPermissionsModal from './edit-permissions-modal';\nimport { Context } from './parts/edit/edit-context';\nimport MainEditModal from './parts/edit/edit-default-modal';\nimport ShareRevokeModal from './parts/edit/share-revoke-modal';\n\nexport const EditModal: FC<ModalProps> = ({ folder, onClose }) => {\n\tconst [activeModal, setActiveModal] = useState('default');\n\tconst [activeGrant, setActiveGrant] = useState({});\n\tconst goBack = useCallback(() => {\n\t\tsetActiveModal('default');\n\t}, [setActiveModal]);\n\n\treturn (\n\t\t<Context.Provider value={{ activeModal, setActiveModal, activeGrant, setActiveGrant, onClose }}>\n\t\t\t<Container\n\t\t\t\tpadding={{ all: 'medium' }}\n\t\t\t\tmainAlignment=\"center\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\theight=\"fit\"\n\t\t\t>\n\t\t\t\t{activeModal === 'default' && (\n\t\t\t\t\t<MainEditModal folder={folder} onClose={onClose} setActiveModal={setActiveModal} />\n\t\t\t\t)}\n\n\t\t\t\t{activeModal === 'edit' && (\n\t\t\t\t\t<EditPermissionsModal\n\t\t\t\t\t\tfolder={folder}\n\t\t\t\t\t\tonClose={onClose}\n\t\t\t\t\t\tgoBack={goBack}\n\t\t\t\t\t\teditMode\n\t\t\t\t\t\tgrant={Object.keys(activeGrant).length > 0 ? activeGrant : folder?.acl?.grant[0]}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\n\t\t\t\t{activeModal === 'revoke' && (\n\t\t\t\t\t<ShareRevokeModal\n\t\t\t\t\t\tfolder={folder}\n\t\t\t\t\t\tgoBack={goBack}\n\t\t\t\t\t\tgrant={Object.keys(activeGrant).length > 0 ? activeGrant : folder?.acl?.grant[0]}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t{activeModal === 'share' && <EditPermissionsModal folder={folder} onClose={onClose} />}\n\t\t\t</Container>\n\t\t</Context.Provider>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, useCallback, useMemo } from 'react';\n\nimport { Container, Text } from '@zextras/carbonio-design-system';\nimport { FOLDERS, t } from '@zextras/carbonio-shell-ui';\n\nimport ModalFooter from '../../carbonio-ui-commons/components/modals/modal-footer';\nimport ModalHeader from '../../carbonio-ui-commons/components/modals/modal-header';\nimport { getFolderIdParts } from '../../helpers/folders';\nimport { useUiUtilities } from '../../hooks/use-ui-utilities';\nimport { folderAction } from '../../store/actions/folder-action';\nimport type { ModalProps } from '../../types';\n\nexport const EmptyModal: FC<ModalProps> = ({ folder, onClose }) => {\n\tconst { createSnackbar } = useUiUtilities();\n\n\tconst onConfirm = useCallback(() => {\n\t\tfolderAction({ folder, recursive: true, op: 'empty', type: 'emails' }).then((res) => {\n\t\t\tif (!('Fault' in res)) {\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `trash`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\ttype: 'info',\n\t\t\t\t\tlabel:\n\t\t\t\t\t\tgetFolderIdParts(folder.id).id === FOLDERS.TRASH\n\t\t\t\t\t\t\t? t('messages.snackbar.folder_empty', 'Trash successfully emptied')\n\t\t\t\t\t\t\t: t('messages.snackbar.folder_wiped', 'Folder successfully wiped'),\n\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\thideButton: true\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tcreateSnackbar({\n\t\t\t\t\tkey: `trash`,\n\t\t\t\t\treplace: true,\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again.'),\n\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\thideButton: true\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tonClose();\n\t}, [createSnackbar, folder, onClose]);\n\n\tconst title = useMemo(\n\t\t() =>\n\t\t\tgetFolderIdParts(folder.id).id === FOLDERS.TRASH\n\t\t\t\t? `${t('label.empty', 'Empty')} ${folder.name}`\n\t\t\t\t: `${t('label.wipe', 'Wipe')} ${folder.name}`,\n\t\t[folder.id, folder.name]\n\t);\n\treturn (\n\t\t<Container\n\t\t\tpadding={{ all: 'large' }}\n\t\t\tmainAlignment=\"center\"\n\t\t\tcrossAlignment=\"flex-start\"\n\t\t\theight=\"fit\"\n\t\t>\n\t\t\t<ModalHeader title={title} onClose={onClose} />\n\t\t\t<Container padding={{ top: 'large', bottom: 'large' }} crossAlignment=\"flex-start\">\n\t\t\t\t{getFolderIdParts(folder.id).id === FOLDERS.TRASH ? (\n\t\t\t\t\t<Text overflow=\"break-word\">\n\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t'folder_panel.modal.empty.body.message1',\n\t\t\t\t\t\t\t'Do you want to empty the selected folder?'\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t'folder_panel.modal.empty.body.message2',\n\t\t\t\t\t\t\t'If you empty it, all the related content will be deleted permanently.'\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Text>\n\t\t\t\t) : (\n\t\t\t\t\t<Text overflow=\"break-word\">\n\t\t\t\t\t\t{t('folder_panel.modal.wipe.body.message1', 'Do you want to wipe the selected folder?')}\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t{t(\n\t\t\t\t\t\t\t'folder_panel.modal.wipe.body.message2',\n\t\t\t\t\t\t\t'If you wipe it, all the related content will be deleted permanently.'\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Text>\n\t\t\t\t)}\n\t\t\t</Container>\n\n\t\t\t<ModalFooter\n\t\t\t\tonConfirm={onConfirm}\n\t\t\t\tlabel={\n\t\t\t\t\tgetFolderIdParts(folder.id).id === FOLDERS.TRASH\n\t\t\t\t\t\t? t('label.empty', 'Empty')\n\t\t\t\t\t\t: t('label.wipe', 'Wipe')\n\t\t\t\t}\n\t\t\t\tcolor=\"error\"\n\t\t\t/>\n\t\t</Container>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { ChangeEvent, FC, useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { Container, Input, Padding, Text } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\nimport { find, includes, noop } from 'lodash';\n\nimport { FolderSelector } from './commons/folder-selector';\nimport { translatedSystemFolders } from './utils';\nimport ModalFooter from '../../carbonio-ui-commons/components/modals/modal-footer';\nimport ModalHeader from '../../carbonio-ui-commons/components/modals/modal-header';\nimport type { Folder } from '../../carbonio-ui-commons/types/folder';\nimport { isValidFolderName } from '../../carbonio-ui-commons/utils/utils';\nimport { useUiUtilities } from '../../hooks/use-ui-utilities';\nimport { createFolder } from '../../store/actions/create-folder';\nimport type { ModalProps } from '../../types';\n\nexport const NewModal: FC<ModalProps> = ({ folder, onClose }) => {\n\tconst [inputValue, setInputValue] = useState(() => t('new_folder', 'New Folder'));\n\tconst [folderDestination, setFolderDestination] = useState<Folder | undefined>(folder);\n\tconst [disabled, setDisabled] = useState(true);\n\tconst [hasError, setHasError] = useState(false);\n\tconst [label, setLabel] = useState<string>(\n\t\tt('folder_panel.modal.new.input.name', 'Enter Folder Name')\n\t);\n\tconst [errorMsg, setErrorMsg] = useState<string>(\n\t\tt('folder.modal.edit.rename_warning', 'You cannot rename a folder as a system one.')\n\t);\n\tconst showWarning = useMemo(() => {\n\t\tif (includes(translatedSystemFolders(), inputValue)) {\n\t\t\tsetErrorMsg(\n\t\t\t\tt('folder.modal.edit.rename_warning', 'You cannot rename a folder as a system one.')\n\t\t\t);\n\t\t\treturn true;\n\t\t}\n\t\tif (inputValue && !isValidFolderName(inputValue)) {\n\t\t\tsetErrorMsg(\n\t\t\t\tt(\n\t\t\t\t\t'folder.modal.edit.invalid_folder_name_warning_msg',\n\t\t\t\t\t'Special characters not allowed. Max lenght is 128 characters.'\n\t\t\t\t)\n\t\t\t);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}, [inputValue]);\n\n\tconst { createSnackbar } = useUiUtilities();\n\n\tuseEffect(() => {\n\t\tif (!folderDestination || !inputValue.length || showWarning) {\n\t\t\tsetDisabled(true);\n\t\t\treturn;\n\t\t}\n\t\tconst value = !!find(folderDestination?.children, (item) => item.name === inputValue);\n\t\tif (value) {\n\t\t\tsetLabel(t('folder_panel.modal.new.input.name_exist', 'Name already exists in this path'));\n\t\t} else {\n\t\t\tsetLabel(t('folder_panel.modal.new.input.name', 'Enter Folder Name'));\n\t\t}\n\t\tsetHasError(value);\n\t\tsetDisabled(value);\n\t}, [folderDestination, inputValue, showWarning]);\n\n\tconst onConfirm = useCallback(() => {\n\t\tcreateFolder({\n\t\t\tparentFolderId: folderDestination?.id ?? '',\n\t\t\tname: inputValue\n\t\t})\n\t\t\t.then((res) => {\n\t\t\t\tif (!('Fault' in res)) {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `edit`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\tlabel: t('messages.snackbar.folder_created', 'New folder created'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `edit`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(() => noop);\n\t\tsetInputValue('');\n\t\tsetLabel(t('folder_panel.modal.new.input.name', 'Enter Folder Name'));\n\t\tsetFolderDestination(undefined);\n\t\tsetHasError(false);\n\t\tonClose();\n\t}, [createSnackbar, folderDestination?.id, inputValue, onClose]);\n\n\treturn folder ? (\n\t\t<Container\n\t\t\tpadding={{ all: 'large' }}\n\t\t\tmainAlignment=\"center\"\n\t\t\tcrossAlignment=\"flex-start\"\n\t\t\theight=\"fit\"\n\t\t\tstyle={{\n\t\t\t\toverflowY: 'auto'\n\t\t\t}}\n\t\t>\n\t\t\t<ModalHeader\n\t\t\t\ttitle={t('folder_panel.modal.new.title', 'Create a new folder')}\n\t\t\t\tonClose={onClose}\n\t\t\t/>\n\t\t\t<Container\n\t\t\t\tmainAlignment=\"center\"\n\t\t\t\tcrossAlignment=\"flex-start\"\n\t\t\t\theight=\"fit\"\n\t\t\t\tstyle={{\n\t\t\t\t\toverflowY: 'auto'\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Input\n\t\t\t\t\tlabel={label}\n\t\t\t\t\tbackgroundColor=\"gray5\"\n\t\t\t\t\thasError={hasError || showWarning}\n\t\t\t\t\tdefaultValue={inputValue}\n\t\t\t\t\tonChange={(e: ChangeEvent<HTMLInputElement>): void => setInputValue(e.target.value)}\n\t\t\t\t\tdata-testid={'new-folder-name'}\n\t\t\t\t/>\n\t\t\t\t{showWarning && (\n\t\t\t\t\t<Padding all=\"small\">\n\t\t\t\t\t\t<Text size=\"small\" color=\"error\">\n\t\t\t\t\t\t\t{errorMsg}\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</Padding>\n\t\t\t\t)}\n\t\t\t\t<FolderSelector\n\t\t\t\t\tselectedFolderId={folderDestination?.id}\n\t\t\t\t\tonFolderSelected={setFolderDestination}\n\t\t\t\t\tshowSharedAccounts\n\t\t\t\t\tshowTrashFolder={false}\n\t\t\t\t\tshowSpamFolder={false}\n\t\t\t\t\tallowRootSelection\n\t\t\t\t\tallowFolderCreation={false}\n\t\t\t\t/>\n\t\t\t\t<ModalFooter\n\t\t\t\t\tonConfirm={onConfirm}\n\t\t\t\t\tsecondaryAction={onClose}\n\t\t\t\t\tlabel={t('label.create', 'Create')}\n\t\t\t\t\tsecondaryLabel={t('label.cancel', 'Cancel')}\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\ttooltip={\n\t\t\t\t\t\tdisabled\n\t\t\t\t\t\t\t? t('folder.modal.edit.enter_valid_folder_name', 'Enter a valid folder name')\n\t\t\t\t\t\t\t: ''\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t</Container>\n\t\t</Container>\n\t) : (\n\t\t<></>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { Container, Icon, Row, Text } from '@zextras/carbonio-design-system';\nimport { t } from '@zextras/carbonio-shell-ui';\nimport React, { FC, useMemo } from 'react';\nimport ModalHeader from '../../carbonio-ui-commons/components/modals/modal-header';\nimport type { Folder } from '../../carbonio-ui-commons/types/folder';\n\nexport const ShareInfoRow: FC<{\n\ticon: string;\n\tlabel: string;\n\ttext: string | number | undefined;\n}> = ({ icon, label, text }) => (\n\t<Row width=\"fill\" mainAlignment=\"flex-start\" padding={{ all: 'small' }}>\n\t\t<Row padding={{ right: 'small' }}>\n\t\t\t<Icon icon={icon} />\n\t\t\t<Row padding={{ right: 'small', left: 'small' }}>\n\t\t\t\t<Text weight=\"bold\">{`${label}: `}</Text>\n\t\t\t</Row>\n\t\t\t<Row takeAvailableSpace>\n\t\t\t\t<Text overflow=\"break-word\">{text}</Text>\n\t\t\t</Row>\n\t\t</Row>\n\t</Row>\n);\n\ntype SharesInfoModalProps = {\n\tonClose: () => void;\n\tfolder: Folder;\n};\n\nexport const SharesInfoModal: FC<SharesInfoModalProps> = ({ onClose, folder }) => {\n\tconst text = (/r/.test(folder.perm || '') ? `${t('label.read', 'Read')}` : '')\n\t\t.concat(/w/.test(folder.perm || '') ? `, ${t('label.write', 'Write')}` : '')\n\t\t.concat(/i/.test(folder.perm || '') ? `, ${t('label.insert', 'Insert')}` : '')\n\t\t.concat(/d/.test(folder.perm || '') ? `, ${t('label.delete', 'Delete')}` : '')\n\t\t.concat(/a/.test(folder.perm || '') ? `, ${t('label.administer', 'Administer')}` : '')\n\t\t.concat(/p/.test(folder.perm || '') ? `, ${t('label.private', 'Private')}` : '')\n\t\t.concat(/f/.test(folder.perm || '') ? `, ${t('label.freebusy', 'FreeBusy')}` : '')\n\t\t.concat(/c/.test(folder.perm || '') ? `, ${t('label.create', 'Create')}` : '')\n\t\t.concat(/x/.test(folder.perm || '') ? `, ${t('label.workflow', 'WorkFlow')}` : '');\n\n\tconst mailFolderLabel = useMemo(() => t('label.mail_folder', 'E-mail folder'), []);\n\treturn (\n\t\t<Container\n\t\t\tpadding={{ bottom: 'large' }}\n\t\t\tmainAlignment=\"center\"\n\t\t\tcrossAlignment=\"flex-start\"\n\t\t\theight=\"fit\"\n\t\t>\n\t\t\t<ModalHeader title={`${t('label.shares_info', \"Shared folder's info\")} `} onClose={onClose} />\n\t\t\t<ShareInfoRow\n\t\t\t\ticon=\"InfoOutline\"\n\t\t\t\tlabel={`${t('label.shared_item', 'Shared item')}`}\n\t\t\t\ttext={folder.name}\n\t\t\t/>\n\t\t\t<ShareInfoRow\n\t\t\t\ticon=\"PersonOutline\"\n\t\t\t\tlabel={`${t('label.owner', 'Owner: ')}`}\n\t\t\t\ttext={folder.isLink ? folder?.owner : ''}\n\t\t\t/>\n\t\t\t<ShareInfoRow\n\t\t\t\ticon=\"MailModOutline\"\n\t\t\t\tlabel={`${t('label.type', 'Type')}`}\n\t\t\t\ttext={mailFolderLabel}\n\t\t\t/>\n\t\t\t<ShareInfoRow\n\t\t\t\ticon=\"UnlockOutline\"\n\t\t\t\tlabel={`${t('label.allowed_actions', 'Allowed actions')}`}\n\t\t\t\ttext={text}\n\t\t\t/>\n\t\t\t<ShareInfoRow\n\t\t\t\ticon=\"EmailOutline\"\n\t\t\t\tlabel={`${t('label.messages', 'Messages')}`}\n\t\t\t\ttext={String(folder.n)}\n\t\t\t/>\n\t\t</Container>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, useCallback, useMemo } from 'react';\n\nimport { ContainerProps } from '@mui/material';\nimport {\n\tAccordionItem,\n\tAvatar,\n\tContainer,\n\tDrag,\n\tDragObj,\n\tDrop,\n\tDropdown,\n\tIcon,\n\tPadding,\n\tRow,\n\tTooltip\n} from '@zextras/carbonio-design-system';\nimport {\n\tAppLink,\n\tFOLDERS,\n\tROOT_NAME,\n\tpushHistory,\n\treplaceHistory,\n\tt,\n\tuseUserAccount,\n\tuseUserSettings\n} from '@zextras/carbonio-shell-ui';\nimport { useParams } from 'react-router-dom';\nimport styled from 'styled-components';\n\nimport { useFolderActions } from './use-folder-actions';\nimport { getFolderIconColor, getFolderIconName, getFolderTranslatedName } from './utils';\nimport { isSystemFolder } from '../../carbonio-ui-commons/helpers/folders';\nimport type { Folder } from '../../carbonio-ui-commons/types/folder';\nimport type { DragEnterAction, OnDropActionProps } from '../../carbonio-ui-commons/types/sidebar';\nimport { LIST_LIMIT } from '../../constants';\nimport { isDraft, isSpam } from '../../helpers/folders';\nimport { parseMessageSortingOptions } from '../../helpers/sorting';\nimport { useAppDispatch } from '../../hooks/redux';\nimport { useUiUtilities } from '../../hooks/use-ui-utilities';\nimport { convAction, msgAction, search } from '../../store/actions';\nimport { folderAction } from '../../store/actions/folder-action';\n\nconst FittedRow = styled(Row)`\n\tmax-width: calc(100% - (2 * ${({ theme }): string => theme.sizes.padding.small}));\n\theight: 3rem;\n`;\n\nexport const DropOverlayContainer = styled(Container)<ContainerProps & { folder: Folder }>`\n\tposition: absolute;\n\twidth: calc(15.5rem - ${(props): number => props.folder.depth - 2}rem);\n\theight: 5rem;\n\tbackground: #ffffff;\n\tborder-radius: 2rem;\n\tborder: 0.25rem solid #d5e3f6;\n`;\n\nconst DropDenyOverlayContainer = styled(Container)<ContainerProps & { folder: Folder }>`\n\tposition: absolute;\n\twidth: calc(15.5rem - ${(props): number => props.folder.depth - 2}rem);\n\theight: 100%;\n\tbackground: white;\n\tborder-radius: 0.25rem;\n\tborder: 0.25rem solid #d5e3f6;\n`;\n\nconst badgeCount = (v?: number): number | undefined => (v && v > 0 ? v : undefined);\n\nconst AccordionCustomComponent: FC<{ item: Folder }> = ({ item }) => {\n\tconst accountName = useUserAccount().name;\n\tconst dispatch = useAppDispatch();\n\tconst { folderId } = useParams<{ folderId: string }>();\n\tconst { createSnackbar } = useUiUtilities();\n\tconst { prefs } = useUserSettings();\n\n\tconst onDragEnterAction = useCallback(\n\t\t(data: OnDropActionProps): DragEnterAction => {\n\t\t\tif (data.type === 'conversation' || data.type === 'message') {\n\t\t\t\tif (\n\t\t\t\t\tdata.data.parentFolderId === item.id || // same folder not allowed\n\t\t\t\t\t(data.data.parentFolderId === FOLDERS.INBOX && [5, 6].includes(Number(item.id))) || // from inbox not allowed in draft and sent\n\t\t\t\t\t(data.data.parentFolderId === FOLDERS.DRAFTS && ![3].includes(Number(item.id))) || // from draft only allowed in Trash\n\t\t\t\t\t(item.id === FOLDERS.DRAFTS && data.data.parentFolderId !== FOLDERS.TRASH) || // only from Trash can move in Draft\n\t\t\t\t\t(item.isLink && item.perm?.indexOf('w') === -1) || // only if shared folder have write permission\n\t\t\t\t\titem.id === FOLDERS.USER_ROOT ||\n\t\t\t\t\t(item.isLink && item.oname === ROOT_NAME)\n\t\t\t\t) {\n\t\t\t\t\treturn { success: false };\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (data.type === 'folder') {\n\t\t\t\tif (\n\t\t\t\t\titem.id === data.data.id || // same folder not allowed\n\t\t\t\t\titem.isLink || //  shared folder not allowed\n\t\t\t\t\tisDraft(item.id) ||\n\t\t\t\t\tisSpam(item.id) // cannot be moved inside Draft and Spam\n\t\t\t\t)\n\t\t\t\t\treturn { success: false };\n\t\t\t}\n\t\t\treturn undefined;\n\t\t},\n\t\t[item]\n\t);\n\n\tconst onDropAction = (data: OnDropActionProps): void => {\n\t\tconst dragEnterResponse = onDragEnterAction(data);\n\t\tif (dragEnterResponse && dragEnterResponse?.success === false) return;\n\t\tlet convMsgsIds = [data.data.id];\n\t\tif (\n\t\t\tdata.type !== 'folder' &&\n\t\t\tdata.data?.selectedIDs?.length &&\n\t\t\tdata.data?.selectedIDs.includes(data.data.id)\n\t\t) {\n\t\t\tconvMsgsIds = data.data?.selectedIDs;\n\t\t}\n\n\t\tif (data.type === 'folder') {\n\t\t\tfolderAction({ folder: data.data, l: item.id || FOLDERS.USER_ROOT, op: 'move' }).then(\n\t\t\t\t(res) => {\n\t\t\t\t\tif (!('Fault' in res)) {\n\t\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\t\tkey: `move`,\n\t\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\t\tlabel: t('messages.snackbar.folder_moved', 'Folder successfully moved'),\n\t\t\t\t\t\t\tautoHideTimeout: 3000\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\t\tkey: `move`,\n\t\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again.'),\n\t\t\t\t\t\t\tautoHideTimeout: 3000\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t} else if ('messages' in data.data) {\n\t\t\tdispatch(\n\t\t\t\tconvAction({\n\t\t\t\t\toperation: `move`,\n\t\t\t\t\tids: convMsgsIds,\n\t\t\t\t\tparent: item.id\n\t\t\t\t})\n\t\t\t).then((res) => {\n\t\t\t\tif (res.type.includes('fulfilled')) {\n\t\t\t\t\treplaceHistory(`/folder/${folderId}`);\n\t\t\t\t\tdata.data.deselectAll && data.data.deselectAll();\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `edit`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\tlabel: t('messages.snackbar.conversation_move', 'Conversation successfully moved'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\tactionLabel: t('action.goto_folder', 'GO TO FOLDER'),\n\t\t\t\t\t\tonActionClick: () => {\n\t\t\t\t\t\t\treplaceHistory(`/folder/${item.id}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `edit`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tdispatch(\n\t\t\t\tmsgAction({\n\t\t\t\t\toperation: `move`,\n\t\t\t\t\tids: convMsgsIds,\n\t\t\t\t\tparent: item.id\n\t\t\t\t})\n\t\t\t).then((res) => {\n\t\t\t\tif (res.type.includes('fulfilled')) {\n\t\t\t\t\tdata.data.deselectAll && data.data.deselectAll();\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `edit`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'info',\n\t\t\t\t\t\tlabel: t('messages.snackbar.message_move', 'Message successfully moved'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\tactionLabel: t('action.goto_folder', 'GO TO FOLDER'),\n\t\t\t\t\t\tonActionClick: () => {\n\t\t\t\t\t\t\treplaceHistory(`/folder/${item.id}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\tkey: `edit`,\n\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\thideButton: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tconst dragFolderDisable = useMemo(\n\t\t() => isSystemFolder(item.id) || item.isLink, // Default folders and shared folders not allowed to drag\n\t\t[item.id, item.isLink]\n\t);\n\tconst { zimbraPrefGroupMailBy } = useUserSettings().prefs;\n\n\tconst onClick = useCallback((): void => {\n\t\tpushHistory(`/folder/${item.id}`);\n\t\tconst { sortOrder } = parseMessageSortingOptions(item.id, prefs.zimbraPrefSortOrder as string);\n\t\tdispatch(\n\t\t\tsearch({\n\t\t\t\tfolderId: item.id,\n\t\t\t\tlimit: LIST_LIMIT.INITIAL_LIMIT,\n\t\t\t\tsortBy: sortOrder,\n\t\t\t\ttypes:\n\t\t\t\t\titem.id === FOLDERS.DRAFTS || typeof zimbraPrefGroupMailBy !== 'string'\n\t\t\t\t\t\t? 'message'\n\t\t\t\t\t\t: zimbraPrefGroupMailBy\n\t\t\t})\n\t\t);\n\t}, [dispatch, item.id, prefs.zimbraPrefSortOrder, zimbraPrefGroupMailBy]);\n\n\tconst badgeType: 'read' | 'unread' = useMemo(\n\t\t() => (item.id && item.id === FOLDERS.DRAFTS ? 'read' : 'unread'),\n\t\t[item.id]\n\t);\n\n\tconst textProps: { size: 'small' } = useMemo(\n\t\t() => ({\n\t\t\tsize: 'small'\n\t\t}),\n\t\t[]\n\t);\n\tconst accordionItem = useMemo(\n\t\t() => ({\n\t\t\t...item,\n\t\t\tlabel:\n\t\t\t\titem.id === FOLDERS.USER_ROOT\n\t\t\t\t\t? accountName\n\t\t\t\t\t: getFolderTranslatedName({ folderId: item.id, folderName: item.name }) ?? '',\n\t\t\ticon: getFolderIconName(item) ?? undefined,\n\t\t\ticonColor: getFolderIconColor(item) ?? '',\n\t\t\tbadgeCounter: badgeCount(item.id === FOLDERS.DRAFTS ? item.n : item?.u),\n\t\t\tbadgeType,\n\t\t\tto: `/folder/${item.id}`,\n\t\t\ttextProps\n\t\t}),\n\t\t[item, accountName, badgeType, textProps]\n\t);\n\n\tconst dropdownItems = useFolderActions(item);\n\n\tconst statusIcon = useMemo(() => {\n\t\tconst RowWithIcon = (icon: string, color: string, tooltipText: string): React.JSX.Element => (\n\t\t\t<Padding left=\"small\">\n\t\t\t\t<Tooltip placement=\"right\" label={tooltipText}>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Icon icon={icon} color={color} size=\"medium\" />\n\t\t\t\t\t</Row>\n\t\t\t\t</Tooltip>\n\t\t\t</Padding>\n\t\t);\n\n\t\tif (item.acl?.grant) {\n\t\t\tconst tooltipText = t('tooltip.folder_sharing_status', {\n\t\t\t\tcount: item.acl.grant.length,\n\t\t\t\tdefaultValue_one: 'Shared with {{count}} person',\n\t\t\t\tdefaultValue: 'Shared with {{count}} people'\n\t\t\t});\n\t\t\treturn RowWithIcon('Shared', 'shared', tooltipText);\n\t\t}\n\t\tif (item.isLink) {\n\t\t\tconst tooltipText = t('tooltip.folder_linked_status', 'Linked to me');\n\t\t\treturn RowWithIcon('Linked', 'linked', tooltipText);\n\t\t}\n\t\treturn '';\n\t}, [item]);\n\n\t// hide folders where a share was provided and subsequently removed\n\tif (item.isLink && item.broken) {\n\t\treturn <></>;\n\t}\n\n\treturn item.id === FOLDERS.USER_ROOT ||\n\t\t(item.isLink && item.oname === ROOT_NAME) ? // \t{/* <Padding left=\"small\"> // <FittedRow>\n\t// \t\t<Avatar label={accordionItem.label} colorLabel={accordionItem.iconColor} size=\"medium\" />\n\t// \t</Padding> */}\n\t// \t{/* <Tooltip label={accordionItem.label} placement=\"right\" maxWidth=\"100%\">\n\t// \t\t<AccordionItem data-testid={`accordion-folder-item-${item.id}`} item={accordionItem} />\n\t// \t</Tooltip> */}\n\t// </FittedRow>\n\tnull : (\n\t\t<Row width=\"fill\" minWidth={0}>\n\t\t\t<Drop\n\t\t\t\tacceptType={['message', 'conversation', 'folder']}\n\t\t\t\tonDrop={(data: DragObj): void => {\n\t\t\t\t\tonDropAction({\n\t\t\t\t\t\ttype: data.type ?? '',\n\t\t\t\t\t\tdata: data.data,\n\t\t\t\t\t\tevent: data.event\n\t\t\t\t\t} as OnDropActionProps);\n\t\t\t\t}}\n\t\t\t\tonDragEnter={(data: DragObj): { success: boolean } | undefined =>\n\t\t\t\t\tonDragEnterAction({\n\t\t\t\t\t\ttype: data.type ?? '',\n\t\t\t\t\t\tdata: data.data,\n\t\t\t\t\t\tevent: data.event\n\t\t\t\t\t} as OnDropActionProps)\n\t\t\t\t}\n\t\t\t\toverlayAcceptComponent={<DropOverlayContainer folder={item} />}\n\t\t\t\toverlayDenyComponent={<DropDenyOverlayContainer folder={item} />}\n\t\t\t>\n\t\t\t\t<Drag\n\t\t\t\t\ttype=\"folder\"\n\t\t\t\t\tdata={item}\n\t\t\t\t\tdragDisabled={dragFolderDisable}\n\t\t\t\t\tstyle={{ display: 'block' }}\n\t\t\t\t>\n\t\t\t\t\t<AppLink\n\t\t\t\t\t\tonClick={onClick}\n\t\t\t\t\t\tto={`/folder/${item.id}`}\n\t\t\t\t\t\tstyle={{ width: '100%', height: '100%', textDecoration: 'none' }}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Dropdown\n\t\t\t\t\t\t\tdata-testid={`folder-context-menu-${item.id}`}\n\t\t\t\t\t\t\tcontextMenu\n\t\t\t\t\t\t\titems={dropdownItems}\n\t\t\t\t\t\t\tdisplay=\"block\"\n\t\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Row>\n\t\t\t\t\t\t\t\t<Padding left=\"small\" />\n\t\t\t\t\t\t\t\t<Tooltip label={accordionItem.label} placement=\"right\" maxWidth=\"100%\">\n\t\t\t\t\t\t\t\t\t<AccordionItem\n\t\t\t\t\t\t\t\t\t\tdata-testid={`accordion-folder-item-${item.id}`}\n\t\t\t\t\t\t\t\t\t\titem={accordionItem}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{statusIcon}\n\t\t\t\t\t\t\t\t\t</AccordionItem>\n\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t</Dropdown>\n\t\t\t\t\t</AppLink>\n\t\t\t\t</Drag>\n\t\t\t</Drop>\n\t\t</Row>\n\t);\n};\n\nexport default AccordionCustomComponent;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { SyntheticEvent, useMemo } from 'react';\n\nimport { useModal } from '@zextras/carbonio-design-system';\nimport { FOLDERS, t, useAppContext } from '@zextras/carbonio-shell-ui';\nimport { noop, startsWith } from 'lodash';\n\nimport { DeleteModal } from './delete-modal';\nimport { EditModal } from './edit-modal';\nimport { EmptyModal } from './empty-modal';\nimport { NewModal } from './new-modal';\nimport { SharesInfoModal } from './shares-info-modal';\nimport { FolderActionsType } from '../../carbonio-ui-commons/constants/folders';\nimport type { Folder } from '../../carbonio-ui-commons/types/folder';\nimport { allowedActionOnSharedAccount } from '../../carbonio-ui-commons/utils/utils';\nimport { getFolderIdParts } from '../../helpers/folders';\nimport { useAppDispatch, useAppSelector } from '../../hooks/redux';\nimport { useSelection } from '../../hooks/use-selection';\nimport { useUiUtilities } from '../../hooks/use-ui-utilities';\nimport { folderAction } from '../../store/actions/folder-action';\nimport { selectMessagesArray } from '../../store/messages-slice';\nimport { StoreProvider } from '../../store/redux';\nimport { AppContext } from '../../types';\nimport { SelectFolderModal } from '../../ui-actions/modals/select-folder-modal';\nimport MoveConvMessage from '../../ui-actions/move-conv-msg';\n\ntype FolderActionsProps = {\n\tid: string;\n\ticon: string;\n\tlabel: string;\n\tonClick: (e: SyntheticEvent<HTMLElement, Event> | KeyboardEvent) => void;\n\tdisabled?: boolean;\n};\n\nexport const useFolderActions = (folder: Folder): Array<FolderActionsProps> => {\n\tconst dispatch = useAppDispatch();\n\t// eslint-disable-next-line @typescript-eslint/ban-types\n\tconst createModal = useModal();\n\tconst folderIsTrash = getFolderIdParts(folder.id ?? '0').id === FOLDERS.TRASH;\n\tconst messages = useAppSelector(selectMessagesArray);\n\tconst trashMessages = messages.filter(\n\t\t(message) => getFolderIdParts(message.parent).id === FOLDERS.TRASH\n\t);\n\tconst moveMessagesIds = useMemo(\n\t\t() => trashMessages.map((message) => message.id),\n\t\t[trashMessages]\n\t);\n\tconst { setCount } = useAppContext<AppContext>();\n\n\tconst { deselectAll } = useSelection({ currentFolderId: folder.id, setCount, count: 0 });\n\n\tconst { createSnackbar } = useUiUtilities();\n\n\tconst actions = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\tid: FolderActionsType.NEW,\n\t\t\t\t'data-testid': `folder-action-${FolderActionsType.NEW}`,\n\t\t\t\ticon: 'FolderAddOutline',\n\t\t\t\tlabel: t('label.new_folder', 'New Folder'),\n\t\t\t\tonClick: (e: SyntheticEvent<HTMLElement, Event> | KeyboardEvent): void => {\n\t\t\t\t\tif (e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t\tconst closeModal = createModal(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmaxHeight: '90vh',\n\t\t\t\t\t\t\tsize: 'medium',\n\t\t\t\t\t\t\tchildren: (\n\t\t\t\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t\t\t\t<NewModal folder={folder} onClose={(): void => closeModal()} />\n\t\t\t\t\t\t\t\t</StoreProvider>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\ttooltipLabel: !allowedActionOnSharedAccount(folder, FolderActionsType.NEW)\n\t\t\t\t\t? t('label.do_not_have_perm', `You don't have permission`)\n\t\t\t\t\t: '',\n\t\t\t\tdisabled: !allowedActionOnSharedAccount(folder, FolderActionsType.NEW)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: FolderActionsType.MOVE,\n\t\t\t\t'data-testid': `folder-action-${FolderActionsType.MOVE}`,\n\t\t\t\ticon: folderIsTrash ? 'RestoreOutline' : 'MoveOutline',\n\t\t\t\tlabel: folderIsTrash ? t('label.restore', 'Restore') : t('label.move', 'Move'),\n\t\t\t\tonClick: (e: SyntheticEvent<HTMLElement, Event> | KeyboardEvent): void => {\n\t\t\t\t\tif (e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (folderIsTrash) {\n\t\t\t\t\t\tconst closeModal = createModal(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmaxHeight: '90vh',\n\t\t\t\t\t\t\t\tsize: 'medium',\n\t\t\t\t\t\t\t\tchildren: (\n\t\t\t\t\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t\t\t\t\t<MoveConvMessage\n\t\t\t\t\t\t\t\t\t\t\tfolderId={folder.id}\n\t\t\t\t\t\t\t\t\t\t\tselectedIDs={moveMessagesIds}\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Fix it in DS\n\t\t\t\t\t\t\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\t\t\t\t\tonClose={(): void => closeModal()}\n\t\t\t\t\t\t\t\t\t\t\tisMessageView\n\t\t\t\t\t\t\t\t\t\t\tisRestore\n\t\t\t\t\t\t\t\t\t\t\tdeselectAll={deselectAll}\n\t\t\t\t\t\t\t\t\t\t\tdispatch={dispatch}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</StoreProvider>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst inputLabel = t(\n\t\t\t\t\t\t\t'folder_panel.modal.move.body.message1',\n\t\t\t\t\t\t\t'Select a folder to move the considered one to:'\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst confirmAction = (\n\t\t\t\t\t\t\tfolderDestination: Folder | undefined,\n\t\t\t\t\t\t\tsetFolderDestination: (_folder: Folder | undefined) => void,\n\t\t\t\t\t\t\tonClose: () => void\n\t\t\t\t\t\t): void => {\n\t\t\t\t\t\t\tconst restoreFolder = (): Promise<void> =>\n\t\t\t\t\t\t\t\tfolderAction({ folder, l: folder.l, op: 'move' }).then((res) => {\n\t\t\t\t\t\t\t\t\tif (!('Fault' in res)) {\n\t\t\t\t\t\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\t\t\t\t\t\tkey: `move-folder`,\n\t\t\t\t\t\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\t\t\t\t\t\tlabel: t('messages.snackbar.folder_restored', 'Folder restored'),\n\t\t\t\t\t\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\t\t\t\t\t\thideButton: true\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\t\t\t\t\t\tkey: `move`,\n\t\t\t\t\t\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again'),\n\t\t\t\t\t\t\t\t\t\t\tautoHideTimeout: 3000,\n\t\t\t\t\t\t\t\t\t\t\thideButton: true\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tfolderAction({\n\t\t\t\t\t\t\t\tfolder,\n\t\t\t\t\t\t\t\tl: folderDestination?.id ?? FOLDERS.USER_ROOT,\n\t\t\t\t\t\t\t\top: 'move'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\t\t\t\tif (!('Fault' in res)) {\n\t\t\t\t\t\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\t\t\t\t\t\tkey: `move`,\n\t\t\t\t\t\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\t\t\t\t\t\ttype: 'success',\n\t\t\t\t\t\t\t\t\t\t\tlabel: t('messages.snackbar.folder_moved', 'Folder successfully moved'),\n\t\t\t\t\t\t\t\t\t\t\tautoHideTimeout: 5000,\n\t\t\t\t\t\t\t\t\t\t\thideButton: false,\n\t\t\t\t\t\t\t\t\t\t\tactionLabel: t('label.undo', 'Undo'),\n\t\t\t\t\t\t\t\t\t\t\tonActionClick: () => restoreFolder()\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tcreateSnackbar({\n\t\t\t\t\t\t\t\t\t\t\tkey: `move`,\n\t\t\t\t\t\t\t\t\t\t\treplace: true,\n\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\t\t\tlabel: t('label.error_try_again', 'Something went wrong, please try again.'),\n\t\t\t\t\t\t\t\t\t\t\tautoHideTimeout: 3000\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tsetFolderDestination(undefined);\n\t\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(() => noop);\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst closeModal = createModal(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmaxHeight: '90vh',\n\t\t\t\t\t\t\t\tsize: 'medium',\n\t\t\t\t\t\t\t\tchildren: (\n\t\t\t\t\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t\t\t\t\t<SelectFolderModal\n\t\t\t\t\t\t\t\t\t\t\tfolder={folder}\n\t\t\t\t\t\t\t\t\t\t\tonClose={(): void => closeModal()}\n\t\t\t\t\t\t\t\t\t\t\theaderTitle={`${t('label.move', 'Move')} ${folder?.name}`}\n\t\t\t\t\t\t\t\t\t\t\tactionLabel={t('label.move', 'Move')}\n\t\t\t\t\t\t\t\t\t\t\tinputLabel={inputLabel}\n\t\t\t\t\t\t\t\t\t\t\tconfirmAction={confirmAction}\n\t\t\t\t\t\t\t\t\t\t\tallowFolderCreation={false}\n\t\t\t\t\t\t\t\t\t\t\tallowRootSelection\n\t\t\t\t\t\t\t\t\t\t\tshowSharedAccounts={false}\n\t\t\t\t\t\t\t\t\t\t\tshowTrashFolder={false}\n\t\t\t\t\t\t\t\t\t\t\tshowSpamFolder={false}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</StoreProvider>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: FolderActionsType.EMPTY,\n\t\t\t\t'data-testid': `folder-action-${FolderActionsType.EMPTY}`,\n\t\t\t\ticon:\n\t\t\t\t\tgetFolderIdParts(folder.id).id === FOLDERS.TRASH\n\t\t\t\t\t\t? 'DeletePermanentlyOutline'\n\t\t\t\t\t\t: 'EmptyFolderOutline',\n\t\t\t\tlabel:\n\t\t\t\t\tgetFolderIdParts(folder.id).id === FOLDERS.TRASH\n\t\t\t\t\t\t? t('folder_panel.action.empty.trash', 'Empty Trash')\n\t\t\t\t\t\t: t('folder_panel.action.wipe.folder_panel', 'Wipe Folder'),\n\t\t\t\tdisabled: folder.n === 0 && folder.children?.length === 0,\n\t\t\t\tonClick: (e: SyntheticEvent<HTMLElement, Event> | KeyboardEvent): void => {\n\t\t\t\t\tif (e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t\tconst closeModal = createModal(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tchildren: (\n\t\t\t\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t\t\t\t<EmptyModal onClose={(): void => closeModal()} folder={folder} />\n\t\t\t\t\t\t\t\t</StoreProvider>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: FolderActionsType.EDIT,\n\t\t\t\t'data-testid': `folder-action-${FolderActionsType.EDIT}`,\n\t\t\t\ticon: 'Edit2Outline',\n\t\t\t\tlabel: folder.isLink\n\t\t\t\t\t? t('folder_panel.action.edit_properties', 'Edit Properties')\n\t\t\t\t\t: t('label.edit', 'Edit'),\n\t\t\t\tonClick: (e: SyntheticEvent<HTMLElement, Event> | KeyboardEvent): void => {\n\t\t\t\t\tif (e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t\tconst closeModal = createModal(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmaxHeight: '90vh',\n\t\t\t\t\t\t\tchildren: (\n\t\t\t\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t\t\t\t<EditModal onClose={(): void => closeModal()} folder={folder} />\n\t\t\t\t\t\t\t\t</StoreProvider>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: FolderActionsType.DELETE,\n\t\t\t\t'data-testid': `folder-action-${FolderActionsType.DELETE}`,\n\t\t\t\ticon: 'Trash2Outline',\n\t\t\t\tlabel: startsWith(folder.absFolderPath, '/Trash')\n\t\t\t\t\t? t('label.delete_permanently', 'Delete Permanently')\n\t\t\t\t\t: t('label.delete', 'Delete'),\n\t\t\t\tonClick: (e: SyntheticEvent<HTMLElement, Event> | KeyboardEvent): void => {\n\t\t\t\t\tif (e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t\tconst closeModal = createModal(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tchildren: (\n\t\t\t\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t\t\t\t<DeleteModal onClose={(): void => closeModal()} folder={folder} />\n\t\t\t\t\t\t\t\t</StoreProvider>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: FolderActionsType.REMOVE_FROM_LIST,\n\t\t\t\t'data-testid': `folder-action-${FolderActionsType.REMOVE_FROM_LIST}`,\n\t\t\t\ticon: 'CloseOutline',\n\t\t\t\tlabel: t('label.remove_from_this_list', 'Remove from this list'),\n\t\t\t\tonClick: (e: SyntheticEvent<HTMLElement, Event> | KeyboardEvent): void => {\n\t\t\t\t\tif (e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\tfolderAction({ folder, op: 'delete' });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: FolderActionsType.SHARES_INFO,\n\t\t\t\t'data-testid': `folder-action-${FolderActionsType.SHARES_INFO}`,\n\t\t\t\ticon: 'InfoOutline',\n\t\t\t\tlabel: t('label.shares_info', `Shared folder's info`),\n\t\t\t\tonClick: (e: SyntheticEvent<HTMLElement, Event> | KeyboardEvent): void => {\n\t\t\t\t\tif (e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t\tconst closeModal = createModal(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tchildren: (\n\t\t\t\t\t\t\t\t<StoreProvider>\n\t\t\t\t\t\t\t\t\t<SharesInfoModal onClose={(): void => closeModal()} folder={folder} />\n\t\t\t\t\t\t\t\t</StoreProvider>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: FolderActionsType.MARK_ALL_READ,\n\t\t\t\t'data-testid': `folder-action-${FolderActionsType.MARK_ALL_READ}`,\n\t\t\t\ticon: 'EmailReadOutline',\n\t\t\t\tlabel: t('label.mark_all_as_read', 'Mark all as read'),\n\t\t\t\tonClick: (e: SyntheticEvent<HTMLElement, Event> | KeyboardEvent): void => {\n\t\t\t\t\tif (e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\tfolderAction({ folder, op: 'read', l: folder.id });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t],\n\t\t[createModal, createSnackbar, deselectAll, dispatch, folder, folderIsTrash, moveMessagesIds]\n\t);\n\n\tconst defaultFolderActions = useMemo(\n\t\t() =>\n\t\t\tactions.filter(\n\t\t\t\t(action) =>\n\t\t\t\t\taction.id !== FolderActionsType.SHARES_INFO &&\n\t\t\t\t\taction.id !== FolderActionsType.REMOVE_FROM_LIST\n\t\t\t),\n\t\t[actions]\n\t);\n\tconst id =\n\t\tfolder.id.indexOf(':') !== -1 ? folder.id.slice(folder.id.indexOf(':') + 1) : folder.id;\n\n\tswitch (id) {\n\t\t// default folders\n\t\tcase FOLDERS.INBOX:\n\t\tcase FOLDERS.SENT:\n\t\t\t//\tcase FOLDERS.DRAFTS:\n\t\t\treturn defaultFolderActions.map((action) =>\n\t\t\t\taction.id === FolderActionsType.MOVE || action.id === FolderActionsType.DELETE\n\t\t\t\t\t? { ...action, disabled: true }\n\t\t\t\t\t: action\n\t\t\t);\n\t\tcase FOLDERS.DRAFTS:\n\t\t\treturn defaultFolderActions.map((action) =>\n\t\t\t\taction.id === FolderActionsType.MOVE ||\n\t\t\t\taction.id === FolderActionsType.DELETE ||\n\t\t\t\taction.id === FolderActionsType.MARK_ALL_READ\n\t\t\t\t\t? { ...action, disabled: true }\n\t\t\t\t\t: action\n\t\t\t);\n\t\tcase FOLDERS.SPAM:\n\t\t\treturn defaultFolderActions.map((action) =>\n\t\t\t\taction.id === FolderActionsType.NEW ||\n\t\t\t\taction.id === FolderActionsType.MOVE ||\n\t\t\t\taction.id === FolderActionsType.DELETE\n\t\t\t\t\t? { ...action, disabled: true }\n\t\t\t\t\t: action\n\t\t\t);\n\t\tcase FOLDERS.TRASH:\n\t\t\treturn defaultFolderActions.map((action) =>\n\t\t\t\t(action.id === FolderActionsType.MOVE && trashMessages.length === 0) ||\n\t\t\t\taction.id === FolderActionsType.DELETE ||\n\t\t\t\taction.id === FolderActionsType.EDIT\n\t\t\t\t\t? { ...action, disabled: true }\n\t\t\t\t\t: action\n\t\t\t);\n\t\t// customizable folders\n\t\tdefault:\n\t\t\treturn folder.isLink\n\t\t\t\t? actions.filter(\n\t\t\t\t\t\t(action) =>\n\t\t\t\t\t\t\taction.id === FolderActionsType.SHARES_INFO ||\n\t\t\t\t\t\t\taction.id === FolderActionsType.REMOVE_FROM_LIST ||\n\t\t\t\t\t\t\taction.id === FolderActionsType.EDIT\n\t\t\t\t\t)\n\t\t\t\t: defaultFolderActions.map((action) => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tstartsWith(folder.absFolderPath, '/Trash') &&\n\t\t\t\t\t\t\t(action.id === FolderActionsType.NEW || action.id === FolderActionsType.EDIT)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\treturn { ...action, disabled: true };\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn action;\n\t\t\t\t\t});\n\t}\n};\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport { IconButton, Padding, Row, Tooltip } from '@zextras/carbonio-design-system';\nimport { AppLink } from '@zextras/carbonio-shell-ui';\nimport React, { FC, useMemo } from 'react';\nimport type { Folder } from '../../carbonio-ui-commons/types/folder';\nimport { getFolderIconColor, getFolderIconName, getSystemFolderTranslatedName } from './utils';\n\nconst CollapsedSideBarItems: FC<{ folder: Folder }> = ({ folder }) => {\n\tconst folderIconColor = useMemo(() => getFolderIconColor(folder), [folder]);\n\tconst folderIconLabel = useMemo(() => getFolderIconName(folder), [folder]);\n\n\treturn (\n\t\t<AppLink to={`/folder/${folder.id}`} style={{ width: '100%', textDecoration: 'none' }}>\n\t\t\t<Row mainAlignment=\"flex-start\" takeAvailableSpace>\n\t\t\t\t<Tooltip\n\t\t\t\t\tlabel={getSystemFolderTranslatedName({ folderName: folder.name })}\n\t\t\t\t\tplacement=\"right\"\n\t\t\t\t>\n\t\t\t\t\t<Padding all=\"extrasmall\">\n\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\tcustomSize={{ iconSize: 'large', paddingSize: 'small' }}\n\t\t\t\t\t\t\ticon={folderIconLabel ?? ''}\n\t\t\t\t\t\t\tcustomIconColor={folderIconColor}\n\t\t\t\t\t\t\tonClick={(): null => null}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Padding>\n\t\t\t\t</Tooltip>\n\t\t\t</Row>\n\t\t</AppLink>\n\t);\n};\n\nexport default CollapsedSideBarItems;\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport { createTheme, CustomPaletteOptions, CustomTheme } from '@mui/material/styles';\n\nexport const theme: CustomTheme = createTheme(<CustomPaletteOptions>{\n\tpalette: {\n\t\tcurrentColor: {\n\t\t\tregular: 'currentColor',\n\t\t\thover: 'currentColor',\n\t\t\tactive: 'currentColor',\n\t\t\tfocus: 'currentColor',\n\t\t\tdisabled: 'currentColor'\n\t\t},\n\t\ttransparent: {\n\t\t\tregular: 'rgba(0, 0, 0, 0)',\n\t\t\thover: 'rgba(0, 0, 0, 0.05)',\n\t\t\tactive: 'rgba(0, 0, 0, 0.1)',\n\t\t\tfocus: 'rgba(0, 0, 0, 0.05)',\n\t\t\tdisabled: 'rgba(0, 0, 0, 0)'\n\t\t},\n\t\tprimary: {\n\t\t\tregular: '#2b73d2',\n\t\t\thover: '#225ca8',\n\t\t\tactive: '#1e5092',\n\t\t\tfocus: '#225ca8',\n\t\t\tdisabled: '#aac8ee',\n\t\t\tmain: '#2b73d2'\n\t\t},\n\t\tsecondary: {\n\t\t\tregular: '#828282',\n\t\t\thover: '#696969',\n\t\t\tactive: '#5c5c5c',\n\t\t\tfocus: '#696969',\n\t\t\tdisabled: '#cccccc',\n\t\t\tmain: '#828282'\n\t\t},\n\t\theader: {\n\t\t\tregular: '#cfd5dc',\n\t\t\thover: '#b1bbc6',\n\t\t\tactive: '#a3aebc',\n\t\t\tfocus: '#b1bbc6',\n\t\t\tdisabled: '#cfd5dc'\n\t\t},\n\t\thighlight: {\n\t\t\tregular: '#d5e3f6',\n\t\t\thover: '#abc7ed',\n\t\t\tactive: '#96b8e8',\n\t\t\tfocus: '#abc7ed',\n\t\t\tdisabled: '#d5e3f6'\n\t\t},\n\t\tgray0: {\n\t\t\tregular: '#414141',\n\t\t\thover: '#282828',\n\t\t\tactive: '#1b1b1b',\n\t\t\tfocus: '#282828',\n\t\t\tdisabled: '#cccccc'\n\t\t},\n\t\tgray1: {\n\t\t\tregular: '#828282',\n\t\t\thover: '#696969',\n\t\t\tactive: '#5c5c5c',\n\t\t\tfocus: '#696969',\n\t\t\tdisabled: '#cccccc'\n\t\t},\n\t\tgray2: {\n\t\t\tregular: '#cfd5dc',\n\t\t\thover: '#b1bbc6',\n\t\t\tactive: '#a3aebc',\n\t\t\tfocus: '#b1bbc6',\n\t\t\tdisabled: '#cfd5dc'\n\t\t},\n\t\tgray3: {\n\t\t\tregular: '#e6e9ed',\n\t\t\thover: '#c8cfd8',\n\t\t\tactive: '#bac2cd',\n\t\t\tfocus: '#c8cfd8',\n\t\t\tdisabled: '#e6e9ed'\n\t\t},\n\t\tgray4: {\n\t\t\tregular: '#eeeff3',\n\t\t\thover: '#d0d3de',\n\t\t\tactive: '#c1c5d3',\n\t\t\tfocus: '#d0d3de',\n\t\t\tdisabled: '#eeeff3'\n\t\t},\n\t\tgray5: {\n\t\t\tregular: '#f5f6f8',\n\t\t\thover: '#d7dbe3',\n\t\t\tactive: '#c8ced9',\n\t\t\tfocus: '#d7dbe3',\n\t\t\tdisabled: '#f5f6f8'\n\t\t},\n\t\tgray6: {\n\t\t\tregular: '#ffffff',\n\t\t\thover: '#e6e6e6',\n\t\t\tactive: '#d9d9d9',\n\t\t\tfocus: '#e6e6e6',\n\t\t\tdisabled: '#ffffff'\n\t\t},\n\t\twarning: {\n\t\t\tregular: '#ffc107',\n\t\t\thover: '#d39e00',\n\t\t\tactive: '#ba8b00',\n\t\t\tfocus: '#d39e00',\n\t\t\tdisabled: '#ffe699',\n\t\t\tmain: '#ffc107'\n\t\t},\n\t\terror: {\n\t\t\tregular: '#d74942',\n\t\t\thover: '#be3028',\n\t\t\tactive: '#a92a24',\n\t\t\tfocus: '#be3028',\n\t\t\tdisabled: '#edaeab',\n\t\t\tmain: '#d74942'\n\t\t},\n\t\tsuccess: {\n\t\t\tregular: '#8bc34a',\n\t\t\thover: '#71a436',\n\t\t\tactive: '#639030',\n\t\t\tfocus: '#71a436',\n\t\t\tdisabled: '#cee6b2',\n\t\t\tmain: '#8bc34a'\n\t\t},\n\t\tinfo: {\n\t\t\tregular: '#2196d3',\n\t\t\thover: '#1a75a7',\n\t\t\tactive: '#176691',\n\t\t\tfocus: '#1a75a7',\n\t\t\tdisabled: '#a7d7f1',\n\t\t\tmain: '#2196d3'\n\t\t},\n\t\ttext: {\n\t\t\tregular: '#333333',\n\t\t\thover: '#1a1a1a',\n\t\t\tactive: '#0d0d0d',\n\t\t\tfocus: '#1a1a1a',\n\t\t\tdisabled: '#cccccc',\n\t\t\tmain: '#333333'\n\t\t}\n\t},\n\tavatarColors: {\n\t\tavatar_1: '#EF9A9A',\n\t\tavatar_2: '#F48FB1',\n\t\tavatar_3: '#CE93D8',\n\t\tavatar_4: '#B39DDB',\n\t\tavatar_5: '#9FA8DA',\n\t\tavatar_6: '#90CAF9',\n\t\tavatar_7: '#81D4FA',\n\t\tavatar_8: '#80DEEA',\n\t\tavatar_9: '#80CBC4',\n\t\tavatar_10: '#A5D6A7',\n\t\tavatar_11: '#C5E1A5',\n\t\tavatar_12: '#E6EE9C',\n\t\tavatar_13: '#FFE082',\n\t\tavatar_14: '#FFCC80',\n\t\tavatar_15: '#FFAB91',\n\t\tavatar_16: '#BCAAA4',\n\t\tavatar_17: '#E57373',\n\t\tavatar_18: '#F06292',\n\t\tavatar_19: '#BA68C8',\n\t\tavatar_20: '#9575CD',\n\t\tavatar_21: '#7986CB',\n\t\tavatar_22: '#64B5F6',\n\t\tavatar_23: '#4FC3F7',\n\t\tavatar_24: '#4DD0E1',\n\t\tavatar_25: '#4DB6AC',\n\t\tavatar_26: '#81C784',\n\t\tavatar_27: '#AED581',\n\t\tavatar_28: '#DCE775',\n\t\tavatar_29: '#FFD54F',\n\t\tavatar_30: '#FFB74D',\n\t\tavatar_31: '#FF8A65',\n\t\tavatar_32: '#A1887F',\n\t\tavatar_33: '#0097A7',\n\t\tavatar_34: '#EF5350',\n\t\tavatar_35: '#EC407A',\n\t\tavatar_36: '#AB47BC',\n\t\tavatar_37: '#7E57C2',\n\t\tavatar_38: '#5C6BC0',\n\t\tavatar_39: '#42A5F5',\n\t\tavatar_40: '#29B6F6',\n\t\tavatar_41: '#26C6DA',\n\t\tavatar_42: '#26A69A',\n\t\tavatar_43: '#66BB6A',\n\t\tavatar_44: '#9CCC65',\n\t\tavatar_45: '#D4E157',\n\t\tavatar_46: '#FFCA28',\n\t\tavatar_47: '#FFA726',\n\t\tavatar_48: '#FF7043',\n\t\tavatar_49: '#8D6E63',\n\t\tavatar_50: '#0288D1'\n\t}\n});\n\nexport const themeMui = createTheme({\n\tcomponents: {\n\t\tMuiSvgIcon: {\n\t\t\tstyleOverrides: {\n\t\t\t\troot: {\n\t\t\t\t\tcolor: theme.palette.text.regular,\n\t\t\t\t\t'&:hover': { background: theme.palette.gray3.hover },\n\t\t\t\t\tfontSize: '1.25rem',\n\t\t\t\t\tfontWeight: 400\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tMuiAccordionSummary: {\n\t\t\tstyleOverrides: {\n\t\t\t\troot: {\n\t\t\t\t\tpadding: '0 1rem 0 0',\n\t\t\t\t\tmargin: '0',\n\t\t\t\t\tminHeight: '0',\n\t\t\t\t\tjustifyContent: 'left'\n\t\t\t\t},\n\t\t\t\tcontent: {\n\t\t\t\t\tmargin: '0',\n\t\t\t\t\tmaxWidth: 'calc(100% - 1.25rem)'\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tMuiAccordionDetails: {\n\t\t\tstyleOverrides: {\n\t\t\t\troot: {\n\t\t\t\t\tbackground: theme.palette.gray5.regular,\n\t\t\t\t\tpadding: '0 0 0 0.5rem',\n\t\t\t\t\tmargin: '0'\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tMuiButtonBase: {\n\t\t\tstyleOverrides: {\n\t\t\t\troot: {\n\t\t\t\t\tpadding: '0'\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tMuiPaper: {\n\t\t\tstyleOverrides: {\n\t\t\t\troot: {\n\t\t\t\t\tborderBottomLeftRadius: '0',\n\t\t\t\t\tborderTopLeftRadius: '0',\n\t\t\t\t\tborderBottomRightRadius: '0',\n\t\t\t\t\tborderTopRightRadius: '0'\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tMuiAccordion: {\n\t\t\tstyleOverrides: {\n\t\t\t\troot: {\n\t\t\t\t\t':last-of-type': {\n\t\t\t\t\t\tborderBottomLeftRadius: '0',\n\t\t\t\t\t\tborderTopLeftRadius: '0',\n\t\t\t\t\t\tborderBottomRightRadius: '0',\n\t\t\t\t\t\tborderTopRightRadius: '0'\n\t\t\t\t\t},\n\t\t\t\t\t':first-of-type': {\n\t\t\t\t\t\tborderBottomLeftRadius: '0',\n\t\t\t\t\t\tborderTopLeftRadius: '0',\n\t\t\t\t\t\tborderBottomRightRadius: '0',\n\t\t\t\t\t\tborderTopRightRadius: '0'\n\t\t\t\t\t},\n\t\t\t\t\tboxShadow: 'none',\n\t\t\t\t\tbackground: theme.palette.gray5.highlight,\n\t\t\t\t\t'&.MuiAccordion-root:before': {\n\t\t\t\t\t\ttop: '0'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React, { FC, useCallback, useRef } from 'react';\n\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore';\nimport { Accordion, AccordionDetails, AccordionSummary, Container } from '@mui/material';\nimport { useLocalStorage } from '@zextras/carbonio-shell-ui';\n\nimport { theme } from '../../theme/theme-mui';\nimport type { Folder } from '../../types/folder';\nimport type { SidebarAccordionProps } from '../../types/sidebar';\nimport { hasId } from '../../worker/handle-message';\nimport { blue } from '@mui/material/colors';\nimport { FOREGROUND_COLOR } from '../../../sruvi/EditedColors';\n\nexport const SidebarAccordionMui: FC<SidebarAccordionProps> = ({\n\taccordions,\n\tfolderId,\n\tlocalStorageName,\n\tAccordionCustomComponent,\n\tsetSelectedFolder,\n\tbuttonFindShares,\n\tinitialExpanded\n}) => {\n\tconst [openIds, setOpenIds] = useLocalStorage<Array<string>>(\n\t\tlocalStorageName,\n\t\tinitialExpanded ?? []\n\t);\n\tconst sidebarRef = useRef<HTMLInputElement>(null);\n\tconst onClick = useCallback(\n\t\t({ accordion, expanded }: { accordion: Folder; expanded: boolean }): void => {\n\t\t\tif (expanded) {\n\t\t\t\tsetOpenIds((state: Array<string>) =>\n\t\t\t\t\tstate.includes(accordion.id) ? state : [...state, accordion.id]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tsetOpenIds((state: Array<string>) => state.filter((id) => id !== accordion.id));\n\t\t\t}\n\t\t},\n\t\t[setOpenIds]\n\t);\n\n\treturn (\n\t\t<Container ref={sidebarRef} disableGutters>\n\t\t\t{accordions.map((accordion) =>\n\t\t\t\taccordion.id === 'find_shares' ? (\n\t\t\t\t\tbuttonFindShares\n\t\t\t\t) : (\n\t\t\t\t\t<Accordion\n\t\t\t\t\t\tdisableGutters\n\t\t\t\t\t\tTransitionProps={{ unmountOnExit: true }}\n\t\t\t\t\t\texpanded={openIds.includes(accordion.id)}\n\t\t\t\t\t\tkey={accordion.id}\n\t\t\t\t\t>\n\t\t\t\t\t\t<AccordionSummary\n\t\t\t\t\t\t\tonClick={(): void => {\n\t\t\t\t\t\t\t\tsetSelectedFolder && setSelectedFolder(accordion.id);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t// expandIcon={\n\t\t\t\t\t\t\t// \taccordion?.children?.length > 0 &&\n\t\t\t\t\t\t\t// \t!hasId(accordion, 'all') && (\n\t\t\t\t\t\t\t// \t\t<ExpandMoreIcon\n\t\t\t\t\t\t\t// \t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t// \t\t\tonClick={(e): void => {\n\t\t\t\t\t\t\t// \t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t// \t\t\t\tonClick({ accordion, expanded: !openIds.includes(accordion.id) });\n\t\t\t\t\t\t\t// \t\t\t}}\n\t\t\t\t\t\t\t// \t\t/>\n\t\t\t\t\t\t\t// \t)\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\taria-controls=\"panel1a-content\"\n\t\t\t\t\t\t\tid={accordion.id}\n\t\t\t\t\t\t\tsx={{\n\t\t\t\t\t\t\t\tbackgroundColor:\n\t\t\t\t\t\t\t\t\taccordion.id === folderId ? FOREGROUND_COLOR : theme.palette.transperant,\n\t\t\t\t\t\t\t\t'&:hover': {\n\t\t\t\t\t\t\t\t\tbackgroundColor:\n\t\t\t\t\t\t\t\t\t\taccordion.id === folderId\n\t\t\t\t\t\t\t\t\t\t\t? theme.palette.highlight.active\n\t\t\t\t\t\t\t\t\t\t\t: theme.palette.gray5.hover\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tborderRadius: '16px'\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<AccordionCustomComponent item={accordion} />\n\t\t\t\t\t\t</AccordionSummary>\n\t\t\t\t\t\t{accordion?.children?.length > 0 && (\n\t\t\t\t\t\t\t<AccordionDetails>\n\t\t\t\t\t\t\t\t<SidebarAccordionMui\n\t\t\t\t\t\t\t\t\taccordions={accordion.children}\n\t\t\t\t\t\t\t\t\tfolderId={folderId}\n\t\t\t\t\t\t\t\t\tkey={accordion.id}\n\t\t\t\t\t\t\t\t\tlocalStorageName={localStorageName}\n\t\t\t\t\t\t\t\t\tAccordionCustomComponent={AccordionCustomComponent}\n\t\t\t\t\t\t\t\t\tsetSelectedFolder={setSelectedFolder}\n\t\t\t\t\t\t\t\t\tbuttonFindShares={buttonFindShares}\n\t\t\t\t\t\t\t\t\tinitialExpanded={initialExpanded}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</AccordionDetails>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Accordion>\n\t\t\t\t)\n\t\t\t)}\n\t\t</Container>\n\t);\n};\n","/*\n * SPDX-FileCopyrightText: 2022 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\nimport React, { FC, SyntheticEvent, useCallback, useContext, useMemo } from 'react';\n\nimport {\n\tAccordionItem,\n\tDropdown,\n\tIcon,\n\tModalManagerContext,\n\tPadding,\n\tRow,\n\tTooltip\n} from '@zextras/carbonio-design-system';\nimport {\n\tZIMBRA_STANDARD_COLORS,\n\trunSearch,\n\tt,\n\tuseTags,\n\tQueryChip\n} from '@zextras/carbonio-shell-ui';\nimport { reduce } from 'lodash';\n\nimport type { TagsAccordionItems } from '../carbonio-ui-commons/types/tags';\nimport type { ItemType } from '../types';\nimport { createTag, useGetTagsActions } from '../ui-actions/tag-actions';\n\ntype ItemProps = {\n\titem: ItemType;\n};\n\nconst CustomComp: FC<ItemProps> = (props) => {\n\tconst actions = useGetTagsActions({ tag: props?.item });\n\n\tconst triggerSearch = useCallback(\n\t\t() =>\n\t\t\trunSearch(\n\t\t\t\t[\n\t\t\t\t\t// TODO: add a new type for query chips\n\t\t\t\t\t{\n\t\t\t\t\t\tavatarBackground: ZIMBRA_STANDARD_COLORS[props?.item?.color || 0].hex,\n\t\t\t\t\t\tavatarIcon: 'Tag',\n\t\t\t\t\t\tbackground: 'gray2',\n\t\t\t\t\t\thasAvatar: true,\n\t\t\t\t\t\tisGeneric: false,\n\t\t\t\t\t\tisQueryFilter: true,\n\t\t\t\t\t\tlabel: `tag:${props?.item?.name}`,\n\t\t\t\t\t\tvalue: `tag:\"${props?.item?.name}\"`\n\t\t\t\t\t} as QueryChip\n\t\t\t\t],\n\t\t\t\t'mails'\n\t\t\t),\n\t\t[props?.item?.color, props?.item?.name]\n\t);\n\n\treturn (\n\t\t<Dropdown contextMenu items={actions} display=\"block\" width=\"fit\" onClick={triggerSearch}>\n\t\t\t<Row mainAlignment=\"flex-start\" height=\"fit\" padding={{ left: 'large' }} takeAvailableSpace>\n\t\t\t\t<Icon size=\"large\" icon=\"Tag\" color={ZIMBRA_STANDARD_COLORS[props?.item?.color ?? 0].hex} />\n\n\t\t\t\t<Padding right=\"large\" />\n\t\t\t\t<Tooltip label={props?.item?.name} placement=\"right\" maxWidth=\"100%\">\n\t\t\t\t\t<AccordionItem {...props} height=\"2.5rem\" />\n\t\t\t\t</Tooltip>\n\t\t\t</Row>\n\t\t</Dropdown>\n\t);\n};\n\nexport const TagLabel: FC<ItemType> = (props) => {\n\tconst createModal = useContext(ModalManagerContext) as () => () => void;\n\treturn (\n\t\t<Dropdown contextMenu display=\"block\" width=\"fit\" items={[createTag({ createModal })]}>\n\t\t\t<Row mainAlignment=\"flex-start\" padding={{ horizontal: 'large' }} takeAvailableSpace>\n\t\t\t\t<Icon size=\"large\" icon=\"TagsMoreOutline\" /> <Padding right=\"large\" />\n\t\t\t\t<AccordionItem {...{ ...props, color: `${props.color}` }} height=\"2.5rem\" />\n\t\t\t</Row>\n\t\t</Dropdown>\n\t);\n};\n\nconst useGetTagsAccordion = (): TagsAccordionItems => {\n\tconst tagsFromStore = useTags();\n\n\treturn useMemo(\n\t\t() => ({\n\t\t\tid: 'Tags',\n\t\t\tlabel: t('label.tags', 'Tags'),\n\t\t\tactive: false,\n\t\t\topen: false,\n\t\t\tonClick: (e: SyntheticEvent<Element, Event> | KeyboardEvent): void => {\n\t\t\t\te.stopPropagation();\n\t\t\t},\n\t\t\tCustomComponent: TagLabel,\n\t\t\titems: reduce(\n\t\t\t\ttagsFromStore,\n\t\t\t\t(acc: Array<ItemType>, v) => {\n\t\t\t\t\tconst item = {\n\t\t\t\t\t\tid: v.id,\n\t\t\t\t\t\titem: v,\n\t\t\t\t\t\tactive: false,\n\t\t\t\t\t\tcolor: v.color || 0,\n\t\t\t\t\t\tlabel: v.name,\n\t\t\t\t\t\tname: v.name,\n\t\t\t\t\t\topen: false,\n\t\t\t\t\t\tCustomComponent: CustomComp\n\t\t\t\t\t};\n\t\t\t\t\tacc.push(item);\n\t\t\t\t\treturn acc;\n\t\t\t\t},\n\t\t\t\t[]\n\t\t\t)\n\t\t}),\n\t\t[tagsFromStore]\n\t);\n};\n\nexport default useGetTagsAccordion;\n","/*\n * SPDX-FileCopyrightText: 2021 Zextras <https://www.zextras.com>\n *\n * SPDX-License-Identifier: AGPL-3.0-only\n */\n\nimport React, { FC, memo, useMemo } from 'react';\n\nimport { ThemeProvider } from '@mui/material';\nimport { Accordion, Container, Divider } from '@zextras/carbonio-design-system';\nimport { FOLDERS, SecondaryBarComponentProps } from '@zextras/carbonio-shell-ui';\nimport { map } from 'lodash';\nimport { Route, Switch, useParams, useRouteMatch } from 'react-router-dom';\n\nimport AccordionCustomComponent from './accordion-custom-component';\nimport { ButtonFindShares } from './button-find-shares';\nimport CollapsedSideBarItems from './collapsed-sidebar-items';\nimport { SidebarAccordionMui } from '../../carbonio-ui-commons/components/sidebar/sidebar-accordion-mui';\nimport { themeMui } from '../../carbonio-ui-commons/theme/theme-mui';\nimport type { Folder } from '../../carbonio-ui-commons/types/folder';\nimport { LOCAL_STORAGES } from '../../constants';\nimport { useFolders } from '../../hooks/use-folders';\nimport useGetTagsAccordion from '../../hooks/use-get-tags-accordions';\nimport type { SidebarComponentProps } from '../../types/sidebar';\n\nconst SidebarComponent: FC<SidebarComponentProps> = memo(function SidebarComponent({ accordions }) {\n\tconst { folderId } = useParams<{ folderId: string }>();\n\tconst tagsAccordionItems = useGetTagsAccordion();\n\n\tconst accordionsWithFindShare = useMemo(() => {\n\t\tif (!accordions?.[0]?.children.find((folder: Folder) => folder.id === 'find_shares')) {\n\t\t\taccordions[0]?.children?.push({\n\t\t\t\tid: 'find_shares',\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\tdisableHover: true\n\t\t\t});\n\t\t}\n\t\treturn map(accordions, (item) => ({ ...item, background: 'transparent' }));\n\t}, [accordions]);\n\treturn (\n\t\t<Container\n\t\t\torientation=\"vertical\"\n\t\t\tstyle={{ backgroundColor: 'transparent' }}\n\t\t\theight=\"fit\"\n\t\t\twidth=\"fill\"\n\t\t>\n\t\t\t<SidebarAccordionMui\n\t\t\t\taccordions={accordionsWithFindShare}\n\t\t\t\tfolderId={folderId}\n\t\t\t\tlocalStorageName={LOCAL_STORAGES.EXPANDED_FOLDERS}\n\t\t\t\tAccordionCustomComponent={AccordionCustomComponent}\n\t\t\t\tbuttonFindShares={<></>}\n\t\t\t\tinitialExpanded={[FOLDERS.USER_ROOT]}\n\t\t\t/>\n\n\t\t\t{/* <Divider /> */}\n\t\t\t<Accordion background=\"transparent\" items={[tagsAccordionItems]} />\n\t\t</Container>\n\t);\n});\n\n{\n\t/* <ButtonFindShares key=\"button-find-shares\" /> */\n}\n\nconst Sidebar: FC<SecondaryBarComponentProps> = ({ expanded }) => {\n\tconst { path } = useRouteMatch();\n\tconst accordions = useFolders();\n\n\treturn (\n\t\t<>\n\t\t\t<ThemeProvider theme={themeMui}>\n\t\t\t\t{expanded ? (\n\t\t\t\t\t<Switch>\n\t\t\t\t\t\t<Route path={`${path}/folder/:folderId/:type?/:itemId?`}>\n\t\t\t\t\t\t\t<SidebarComponent accordions={accordions} />\n\t\t\t\t\t\t</Route>\n\t\t\t\t\t</Switch>\n\t\t\t\t) : (\n\t\t\t\t\taccordions[0].children.map((folder) => (\n\t\t\t\t\t\t<CollapsedSideBarItems key={folder.id} folder={folder} />\n\t\t\t\t\t))\n\t\t\t\t)}\n\t\t\t</ThemeProvider>\n\t\t</>\n\t);\n};\n\nexport default Sidebar;\n"],"names":["fallbackSortOrder","sortType","sortDirection","sortOrder","remainingFoldersSortOrder","remainingSortOptions","parseMessageSortingOptions","folderId","prefSortOrder","splitString","sortingFolders","split","sortOrderOfFolder","find","item","substring","lastIndexOf","concat","filter","join","includes","SORTING_OPTIONS","size","value","updateSortingSettings","sortingTypeValue","sortingDirection","changes","prefs","zimbraPrefSortOrder","editSettings","secondString","indexOf","sortingString","replacedString","inputStringA","inputStringB","replaceStr","RegExp","test","replace","modifySettingString","useSelection","setCount","count","items","selected","useRef","isSelectModeOn","setIsSelectModeOn","useState","isAllSelected","useMemo","length","selectItem","useCallback","id","current","omit","prev","deselectAll","selectAll","map","selectAllModeOff","setTimeout","toggle","FOREGROUND_COLOR","SelectFolderModal","folder","onClose","headerTitle","actionLabel","actionTooltip","disabledActionTooltip","inputLabel","confirmAction","showSharedAccounts","showTrashFolder","showSpamFolder","allowFolderCreation","allowRootSelection","folderDestination","setFolderDestination","onConfirm","isConfirmDisabled","isNil","l","confirmActionTooltip","t","React","Container","padding","all","mainAlignment","crossAlignment","height","style","overflowY","ModalHeader","title","Text","overflow","FolderSelector","selectedFolderId","onFolderSelected","ModalFooter","tooltip","secondaryAction","label","secondaryLabel","disabled","async","folderAction","color","zid","op","name","recursive","retentionPolicy","type","isEmpty","soapFetch","action","omitBy","_jsns","FolderActionRequest","DeleteModal","createSnackbar","useUiUtilities","inTrash","isTrashed","isSharedAccountFolder","FOLDER_ACTIONS","TRASH","FOLDERS","DELETE","MOVE","then","res","key","autoHideTimeout","hideButton","onActionClick","parent","catch","report","startsWith","absFolderPath","Divider","Context","createContext","sendShareNotification","createAsyncThunk","data","getState","Promise","contacts","contact","index","fetch","method","headers","body","accounts","email","standardMessage","resData","json","HoverChip","styled","Chip","withConfig","displayName","componentId","theme","hovered","palette","gray3","hover","regular","GranteeInfo","grant","shareCalendarRoleOptions","role","findLabel","perm","composeLabel","d","Actions","setActiveModal","onMouseLeave","onMouseEnter","useUserAccounts","setActiveGrant","useContext","dispatch","useAppDispatch","onRevoke","onResend","onEdit","orientation","maxWidth","Tooltip","placement","Button","onClick","Padding","horizontal","Grantee","setHovered","bottom","ShareFolderProperties","setGrant","useEffect","acl","ShareCalendarRoleOptions","vertical","weight","top","shareFolder","requests","requestId","gt","trim","shareWithUserRole","pw","inh","response","EditPermissionsModal","editMode","goBack","ContactInput","integrationAvailable","useIntegratedComponent","sendNotification","setSendNotification","setStandardMessage","setContacts","setshareWithUserRole","onShareRoleChange","shareRole","res2","disableEdit","background","placeholder","onChange","ev","defaultValue","ChipInput","Select","defaultSelection","Checkbox","defaultChecked","Input","target","backgroundColor","Row","right","FolderDetails","width","n","bytes","i","Math","floor","log","round","bytesToSize","s","FolderActionsType","isValidFolderName","folderName","allowedActionOnSharedAccount","permission","NameInputRow","setInputValue","inpDisable","showWarning","inputValue","folderColor","setFolderColor","e","hasError","ColorPicker","defaultColor","parseInt","RetentionPolicies","showPolicy","setShowPolicy","emptyRtnValue","setEmptyRtnValue","dsblMsgRet","setDsblMsgRet","rtnValue","setRtnValue","retentionPeriod","rtnYear","setRtnYear","dsblMsgDis","setDsblMsgDis","emptyDisValue","setEmptyDisValue","purgeValue","setPurgeValue","dspYear","setDspYear","rtnRange","dspRange","takeAvailableSpace","IconButton","margin","icon","Collapse","open","disablePortal","multiple","numberRegex","DAYS_LABEL","WEEKS_LABEL","MONTHS_LABEL","YEARS_LABEL","MainEditModal","setRtnRange","setDspRange","undefined","keep","Object","keys","lifetime","policy","purge","translatedSystemFolders","INBOX","SPAM","SENT","DRAFTS","disableSubmit","submit","toString","lt","pr","Number","path","absParent","children","String","owner","secondaryDisabled","secondaryBtnType","secondaryColor","ShareRevokeModal","toolTip","iconSize","EditModal","activeModal","activeGrant","Provider","EmptyModal","getFolderIdParts","NewModal","setDisabled","setHasError","setLabel","errorMsg","setErrorMsg","createFolder","parentFolderId","noop","ShareInfoRow","text","Icon","left","SharesInfoModal","mailFolderLabel","isLink","sizes","small","DropOverlayContainer","props","depth","DropDenyOverlayContainer","AccordionCustomComponent","accountName","useUserAccount","useParams","useUserSettings","onDragEnterAction","USER_ROOT","oname","ROOT_NAME","isDraft","isSpam","success","dragFolderDisable","isSystemFolder","zimbraPrefGroupMailBy","pushHistory","search","limit","LIST_LIMIT","INITIAL_LIMIT","sortBy","types","badgeType","textProps","accordionItem","getFolderTranslatedName","getFolderIconName","iconColor","getFolderIconColor","badgeCounter","v","u","to","dropdownItems","createModal","useModal","folderIsTrash","trashMessages","useAppSelector","selectMessagesArray","message","moveMessagesIds","useAppContext","currentFolderId","actions","stopPropagation","closeModal","maxHeight","StoreProvider","tooltipLabel","MoveConvMessage","selectedIDs","isMessageView","isRestore","defaultFolderActions","slice","useFolderActions","statusIcon","RowWithIcon","tooltipText","defaultValue_one","broken","minWidth","Drop","acceptType","onDrop","dragEnterResponse","convMsgsIds","convAction","operation","ids","replaceHistory","msgAction","onDropAction","event","onDragEnter","overlayAcceptComponent","overlayDenyComponent","Drag","dragDisabled","display","AppLink","textDecoration","Dropdown","contextMenu","AccordionItem","CollapsedSideBarItems","folderIconColor","folderIconLabel","getSystemFolderTranslatedName","customSize","paddingSize","customIconColor","createTheme","currentColor","active","focus","transparent","primary","main","secondary","header","highlight","gray0","gray1","gray2","gray4","gray5","gray6","warning","error","info","avatarColors","avatar_1","avatar_2","avatar_3","avatar_4","avatar_5","avatar_6","avatar_7","avatar_8","avatar_9","avatar_10","avatar_11","avatar_12","avatar_13","avatar_14","avatar_15","avatar_16","avatar_17","avatar_18","avatar_19","avatar_20","avatar_21","avatar_22","avatar_23","avatar_24","avatar_25","avatar_26","avatar_27","avatar_28","avatar_29","avatar_30","avatar_31","avatar_32","avatar_33","avatar_34","avatar_35","avatar_36","avatar_37","avatar_38","avatar_39","avatar_40","avatar_41","avatar_42","avatar_43","avatar_44","avatar_45","avatar_46","avatar_47","avatar_48","avatar_49","avatar_50","themeMui","components","MuiSvgIcon","styleOverrides","root","fontSize","fontWeight","MuiAccordionSummary","minHeight","justifyContent","content","MuiAccordionDetails","MuiButtonBase","MuiPaper","borderBottomLeftRadius","borderTopLeftRadius","borderBottomRightRadius","borderTopRightRadius","MuiAccordion","boxShadow","SidebarAccordionMui","accordions","localStorageName","setSelectedFolder","buttonFindShares","initialExpanded","openIds","setOpenIds","useLocalStorage","sidebarRef","accordion","expanded","state","ref","disableGutters","Accordion","TransitionProps","unmountOnExit","AccordionSummary","sx","transperant","borderRadius","AccordionDetails","CustomComp","useGetTagsActions","tag","triggerSearch","runSearch","avatarBackground","ZIMBRA_STANDARD_COLORS","hex","avatarIcon","hasAvatar","isGeneric","isQueryFilter","_extends","TagLabel","ModalManagerContext","createTag","SidebarComponent","memo","tagsAccordionItems","useGetTagsAccordion","tagsFromStore","useTags","CustomComponent","reduce","acc","push","accordionsWithFindShare","disableHover","LOCAL_STORAGES","EXPANDED_FOLDERS","Sidebar","useRouteMatch","useFolders","ThemeProvider","Switch","Route"],"sourceRoot":""}