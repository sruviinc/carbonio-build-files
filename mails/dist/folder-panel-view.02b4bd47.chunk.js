"use strict";(self.webpackChunkcarbonio_mails_ui=self.webpackChunkcarbonio_mails_ui||[]).push([[780],{2413:(e,t,l)=>{l.r(t),l.d(t,{default:()=>f});var s=l(7559),i=l.n(s),r=l(4702),a=l(7196),o=l(8698),d=l(4876),n=l(8716),c=l(9518),m=l(8032),u=l(9224);const p=({count:e})=>{const{folderId:t}=(0,o.useParams)(),l=(0,m.G)(u.QJ),d=(0,s.useMemo)((()=>[{title:(0,a.t)("displayer.title1",'Compose a new e-mail by clicking the "NEW"button'),description:""},{title:(0,a.t)("displayer.title2","Click the “NEW” button"),description:(0,a.t)("displayer.description2","Send documents, images and more by composing a new e-mail.")},{title:(0,a.t)("displayer.title3","Stay in touch with other users."),description:(0,a.t)("displayer.title1",'Compose a new e-mail by clicking the "NEW" button')}]),[]),n=(0,s.useMemo)((()=>[{title:(0,a.t)("displayer.title4","Select an e-mail to read it"),description:(0,a.t)("displayer.description4","You can flag it, reply or forward it to other users.")},{title:(0,a.t)("displayer.title4","Select an e-mail to read it"),description:(0,a.t)("displayer.description5","Check out what other users want to talk with you about.")},{title:(0,a.t)("displayer.title4","Select an e-mail to read it"),description:(0,a.t)("displayer.description6","Reply to this e-mail or forward it to other users.")},{title:(0,a.t)("displayer.title3","Stay in touch with other users"),description:(0,a.t)("displayer.description7","Select an e-mail to reply.")},{title:(0,a.t)("displayer.title8","Select an e-mail to read or delete it."),description:""}]),[]),p=(0,s.useMemo)((()=>[{title:(0,a.t)("displayer.spam_title1","How lucky! There are no spam e-mails you have to worry about"),description:""},{title:(0,a.t)("displayer.spam_title2","Click the trash icon to delete a spam e-mail."),description:""}]),[]),f=(0,s.useMemo)((()=>[{title:(0,a.t)("displayer.title3","Stay in touch with other users."),description:(0,a.t)("displayer.title1",'Compose a new e-mail by clicking the "NEW" button')},{title:(0,a.t)("displayer.sent_title2","Select an e-mail to display what you've sent."),description:""}]),[]),h=(0,s.useMemo)((()=>[{title:(0,a.t)("displayer.draft_title1","Saving an e-mail ad a draft allows you to keep the messages that you'd like to send later."),description:""},{title:(0,a.t)("displayer.draft_title2","Select and edit an e-mail to send it to other users."),description:""}]),[]),g=(0,s.useMemo)((()=>[{title:(0,a.t)("displayer.trash_title1","Click the trash icon to delete an e-mail"),description:""},{title:(0,a.t)("displayer.trash_title2","Select and restore e-mails from the trash."),description:""}]),[]),[y,I]=(0,s.useState)(0),[S,E]=(0,s.useState)(0);(0,s.useEffect)((()=>{const e=Math.floor(3*Math.random());I(e)}),[t]),(0,s.useEffect)((()=>{const e=Math.floor(5*Math.random());E(e)}),[t]);const M=(0,s.useMemo)((()=>(0,c.wL)(t).id===a.FOLDERS.SPAM?l?.length>0?p[1]:p[0]:(0,c.wL)(t).id===a.FOLDERS.SENT?l?.length>0?f[1]:f[0]:(0,c.wL)(t).id===a.FOLDERS.DRAFTS?l?.length>0?h[1]:h[0]:(0,c.wL)(t).id===a.FOLDERS.TRASH?l?.length>0?g[1]:g[0]:l&&l.length>0?n[S]:d[y]),[l,d,n,y,S,t,p,f,h,g]),k=(0,s.useMemo)((()=>e>0?(0,a.t)("label.mail_selected",{count:e,defaultValue_one:"{{count}} e-mail selected",defaultValue_other:"{{count}} e-mails selected"}):M?.title),[e,M?.title]),A=(0,s.useMemo)((()=>e>0?null:M?.description),[e,M?.description]);return i().createElement(r.Container,{background:"gray5","data-testid":"selection-interactive"},i().createElement(r.Padding,{all:"medium"},i().createElement(r.Text,{color:"gray1",overflow:"break-word",weight:"bold",size:"large",style:{whiteSpace:"pre-line",textAlign:"center"}},k)),i().createElement(r.Text,{size:"small",color:"gray1",overflow:"break-word",style:{whiteSpace:"pre-line",textAlign:"center"}},A))},f=({})=>{const{path:e}=(0,o.useRouteMatch)(),{count:t}=(0,a.useAppContext)();return i().createElement(r.Container,{width:"100%","data-testid":"third-panel"},i().createElement(o.Switch,null,i().createElement(o.Route,{exact:!0,path:`${e}/folder/:folderId`},i().createElement(p,{count:t})),i().createElement(o.Route,{exact:!0,path:`${e}/folder/:folderId/conversation/:conversationId`},i().createElement(d.t,null)),i().createElement(o.Route,{exact:!0,path:`${e}/folder/:folderId/message/:messageId`},i().createElement(n.V,null))))}},6625:(e,t,l)=>{l.r(t),l.d(t,{default:()=>_});var s=l(7559),i=l.n(s),r=l(4702),a=l(7196),o=l(2509),d=l(8698),n=l(9851),c=l(5086),m=l(4131),u=l(643),p=l(7431),f=l(9518),h=l(9099),g=l(2563);const y=["v","m",".","n"],I=[];let S="";var E=l(8032),M=l(7656),k=l(9224),A=l(5322);const b=()=>{const{folderId:e,itemId:t}=(0,d.useParams)(),{setCount:l,count:r}=(0,a.useAppContext)(),b=(()=>{const{folderId:e}=(0,d.useParams)(),t=(0,E.j)(),{prefs:l}=(0,a.useUserSettings)(),{sortOrder:i}=(0,h.n)(e,l.zimbraPrefSortOrder),r=(0,E.G)(k.KF),n=(0,E.G)(k.QJ),c=(0,u.L2)(e),m=(0,s.useMemo)((()=>c?(0,o.reduce)(n,((e,t)=>(0,o.some)(t.messages,["parent","rid"in c&&c?.rid?`${c.zid}:${c.rid}`:c.id])?[...e,t]:e),[]):[]),[c,n]),f=(0,s.useMemo)((()=>(0,o.sortBy)(m,"sortIndex")),[m]);return(0,s.useEffect)((()=>{null===r&&t((0,M.$P)({folderId:e,limit:p.bh.INITIAL_LIMIT,sortBy:i,types:"conversation"}))}),[t,e,r,i]),f})(),[w,v]=(0,s.useState)(),O=(0,s.useRef)(null),L=(0,E.j)(),R=(0,E.G)(k.KF),_=(0,E.G)((0,k.fk)(e)),{selected:C,toggle:T,deselectAll:D,isSelectModeOn:F,setIsSelectModeOn:x,selectAll:P,isAllSelected:z,selectAllModeOff:N}=(0,A.C)({currentFolderId:e,setCount:l,count:r,items:b}),$=(0,u.a4)(e),G=(0,s.useMemo)((()=>_===p.gU.hasMore),[_]),{prefs:H}=(0,a.useUserSettings)(),{sortOrder:j}=(0,h.n)(e,H.zimbraPrefSortOrder),U=(0,s.useCallback)((()=>{if(!G)return;const t=b.length;L((0,M.$P)({folderId:e,offset:t,sortBy:j,limit:p.bh.LOAD_MORE_LIMIT}))}),[G,b.length,L,e,j]),B=(()=>{const e=(0,g.IO)(),t=(0,g.R5)();return(0,s.useCallback)((({event:l,itemId:s,conversations:i,dispatch:r,deselectAll:a,folderId:d})=>{const n=i.filter((e=>e.id===s))?.[0]?.flagged,c=()=>{l.preventDefault(),l.stopImmediatePropagation()},m=l.target instanceof HTMLElement&&!l.target.isContentEditable&&"INPUT"!==l.target.nodeName&&"TEXTAREA"!==l.target.nodeName,u=()=>{switch(S){case"mr":case"z":m&&(c(),(0,g.Xz)({ids:[s],value:!1,dispatch:r,deselectAll:o.noop,shouldReplaceHistory:!1,folderId:d}).onClick(l));break;case"mu":m&&(c(),(0,g.Xz)({ids:[s],value:!0,dispatch:r,deselectAll:o.noop,shouldReplaceHistory:!1,folderId:d}).onClick(l));break;case"x":m&&s&&(c(),(0,g.Xz)({ids:[s],value:!0,dispatch:r,deselectAll:o.noop,shouldReplaceHistory:!1,folderId:d}).onClick(l));break;case"mf":m&&s&&(c(),(0,g.Dq)({ids:[s],value:n,dispatch:r}).onClick(l));break;case"ms":m&&s&&(c(),e({ids:[s],value:!1,dispatch:r,deselectAll:a}).onClick(l));break;case".t":m&&s&&(c(),t({ids:[s],dispatch:r,deselectAll:a,folderId:d}).onClick(l));break;case".i":case"r":case"a":case"f":case"nf":m&&c()}S=""};S=S.concat(l.key);const p=setTimeout(u,1e3);switch(S.length){case 1:-1===y.indexOf(l.key)&&(clearTimeout(p),u());break;case 2:-1===I.indexOf(l.key)&&(clearTimeout(p),u())}}),[t,e])})();(0,s.useEffect)((()=>{const l=l=>B({event:l,folderId:e,itemId:t,conversations:b,dispatch:L,deselectAll:D});return document.addEventListener("keydown",l),()=>{document.removeEventListener("keydown",l)}}),[e,t,b,L,D,B]);const V=(0,s.useMemo)((()=>0===b?.length?(0,f.wL)(e).id===a.FOLDERS.SPAM?(0,a.t)("displayer.list_spam_title","There are no spam e-mails"):(0,f.wL)(e).id===a.FOLDERS.SENT?(0,a.t)("displayer.list_sent_title","You haven’t sent any e-mail yet"):(0,f.wL)(e).id===a.FOLDERS.DRAFTS?(0,a.t)("displayer.list_draft_title","There are no saved drafts"):(0,f.wL)(e).id===a.FOLDERS.TRASH?(0,a.t)("displayer.list_trash_title","The trash is empty"):(0,a.t)("displayer.list_folder_title","It looks like there are no e-mails yet"):null),[b,e]),W=(0,s.useMemo)((()=>(0,o.map)(b,(l=>{const s=t===l.id,r=C[l.id];return i().createElement(m.T,{active:s,selected:r,background:l.read?"gray6":"gray5",key:l.id},(a=>a?i().createElement(c.o,{item:l,visible:a,selected:r,activeItemId:t,toggle:T,setDraggedIds:v,selectedItems:C,dragImageRef:O,selecting:F,active:s,selectedIds:Object.keys(C),deselectAll:D,folderId:e}):i().createElement("div",{style:{height:"4rem"}})))}))),[b,D,e,F,t,C,T]),X=(0,s.useMemo)((()=>b.length??$?.n??0),[b.length,$?.n]),Y=(0,s.useMemo)((()=>Object.keys(C)),[C]),J=(0,s.useMemo)((()=>R===p.kh.fulfilled),[R]);return i().createElement(n.n,{listItems:W,displayerTitle:V,totalConversations:X,conversationsLoadingCompleted:J,loadMore:U,selectedIds:Y,isSelectModeOn:F,setIsSelectModeOn:x,selectAll:P,isAllSelected:z,selectAllModeOff:N,draggedIds:w,folderId:e,conversations:b,selected:C,deselectAll:D,dragImageRef:O,hasMore:G})};var w=l(9617),v=l(9905),O=l(348);const L=()=>{const{itemId:e,folderId:t}=(0,d.useParams)(),l=(0,u.a4)(t),r=(0,E.j)(),{setCount:n,count:c}=(0,a.useAppContext)(),[g,y]=(0,s.useState)({}),I=(0,s.useRef)(null),S=(0,E.G)(O.eE),k=(0,E.G)((0,O.cV)(t)),b=(()=>{const{folderId:e}=(0,d.useParams)(),t=(0,E.j)(),{prefs:l}=(0,a.useUserSettings)(),{sortOrder:i}=(0,h.n)(e,l.zimbraPrefSortOrder),r=(0,E.G)(O.eE),n=(0,E.G)(O.c0),c=(0,u.L2)(e),m=(0,s.useMemo)((()=>c?(0,o.filter)(n,["parent","rid"in c&&c?.rid?`${c.zid}:${c.rid}`:c.id]):[]),[c,n]),f=(0,s.useMemo)((()=>(0,o.sortBy)(m,"sortIndex")),[m]);return(0,s.useEffect)((()=>{null===r&&t((0,M.$P)({folderId:e,limit:p.bh.INITIAL_LIMIT+1,sortBy:i,types:"message"}))}),[t,e,r,i]),f})(),{prefs:L}=(0,a.useUserSettings)(),{sortOrder:R}=(0,h.n)(t,L.zimbraPrefSortOrder),{selected:_,deselectAll:C,isSelectModeOn:T,setIsSelectModeOn:D,selectAll:F,toggle:x,isAllSelected:P,selectAllModeOff:z}=(0,A.C)({currentFolderId:t,setCount:n,count:c,items:b}),N=(0,s.useMemo)((()=>k===p.gU.hasMore),[k]),$=(0,s.useCallback)((()=>{if(!N)return;const e=b.length;r((0,M.$P)({folderId:t,sortBy:R,offset:e,limit:p.bh.LOAD_MORE_LIMIT,types:"message"}))}),[r,t,N,b.length,R]),G=(0,s.useMemo)((()=>0===b?.length?(0,f.wL)(t).id===a.FOLDERS.SPAM?(0,a.t)("displayer.list_spam_title","There are no spam e-mails"):(0,f.wL)(t).id===a.FOLDERS.SENT?(0,a.t)("displayer.list_sent_title","You havent sent any e-mail yet"):(0,f.wL)(t).id===a.FOLDERS.DRAFTS?(0,a.t)("displayer.list_draft_title","There are no saved drafts"):(0,f.wL)(t).id===a.FOLDERS.TRASH?(0,a.t)("displayer.list_trash_title","The trash is empty"):(0,a.t)("displayer.list_folder_title","It looks like there are no e-mails yet"):null),[b,t]),H=(0,s.useMemo)((()=>(0,o.map)(b,(l=>{const s=_[l.id],r=e===l.id;return i().createElement(m.T,{key:l.id,selected:s,active:r,background:(l.read,"#ffffff")},(e=>e?i().createElement(v.I,{message:l,selected:_,isSelected:s,active:r,toggle:x,isSelectModeOn:T,dragImageRef:I,draggedIds:g,key:l.id,deselectAll:C,visible:e,setDraggedIds:y,currentFolderId:t}):i().createElement("div",{style:{height:"4rem"}})))}))),[C,g,t,T,e,b,_,x]),j=(0,s.useMemo)((()=>"readAsc"===R?b.length:l?.n??b.length??0),[l?.n,b.length,R]),U=(0,s.useMemo)((()=>Object.keys(_)),[_]),B=(0,s.useMemo)((()=>S===p.kh.fulfilled),[S]);return(0,s.useEffect)((()=>{y(_)}),[_]),i().createElement(w.z,{totalMessages:j,displayerTitle:G,listItems:H,loadMore:$,messagesLoadingCompleted:B,selectedIds:U,folderId:t,messages:b,draggedIds:g,setDraggedIds:y,isSelectModeOn:T,setIsSelectModeOn:D,isAllSelected:P,selectAll:F,deselectAll:C,selected:_,selectAllModeOff:z,dragImageRef:I,hasMore:N})};var R=l(8773);const _=()=>{const{folderId:e}=(0,d.useParams)(),t=(0,E.j)(),{isMessageView:l}=(0,a.useAppContext)();return(0,s.useEffect)((()=>{e&&t({type:"conversations/setCurrentFolder",payload:e})}),[e,t]),(0,o.isNil)(l)?i().createElement(R.A,null):i().createElement(r.Container,{orientation:"row",crossAlignment:"flex-start",mainAlignment:"flex-start",width:"fill",background:"white",borderRadius:"none",style:{maxHeight:"100%"}},i().createElement(r.Container,{mainAlignment:"flex-start",borderRadius:"none","data-testid":"list-wrapper"},l||e===a.FOLDERS.DRAFTS?i().createElement(L,null):i().createElement(b,null)))}}}]);
//# sourceMappingURL=folder-panel-view.02b4bd47.chunk.js.map